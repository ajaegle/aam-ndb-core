<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>ndb-core documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	      <link rel="stylesheet" href="../styles/style.css">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">ndb-core documentation</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content component">
                   <div class="content-data">




<ol class="breadcrumb">
  <li>Components</li>
  <li>CompareRevComponent</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="active">
            <a href="#info" role="tab" id="info-tab" data-toggle="tab" data-link="info">Info</a>
        </li>
        <li >
            <a href="#source" role="tab" id="source-tab" data-toggle="tab" data-link="source">Source</a>
        </li>
        <li >
            <a href="#templateData" role="tab" id="templateData-tab" data-toggle="tab" data-link="template">Template</a>
        </li>
        <li >
            <a href="#styleData" role="tab" id="styleData-tab" data-toggle="tab" data-link="style">Styles</a>
        </li>
        <li >
            <a href="#tree" role="tab" id="tree-tab" data-toggle="tab" data-link="dom-tree">DOM Tree</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="c-info"><p class="comment">
    <h3>File</h3>
</p>
<p class="comment">
    <code>src/app/conflict-resolution/compare-rev/compare-rev.component.ts</code>
</p>

    <p class="comment">
        <h3>Description</h3>
    </p>
    <p class="comment">
        <p>Visualize one specific conflicting document revision and offer resolution options.</p>

    </p>




<section>
    <h3>Metadata</h3>
    <table class="table table-sm table-hover">
        <tbody>











            <tr>
                <td class="col-md-3">selector</td>
                <td class="col-md-9"><code>app-compare-rev</code></td>
            </tr>

            <tr>
                <td class="col-md-3">styleUrls</td>
                <td class="col-md-9"><code>./compare-rev.component.scss</code></td>
            </tr>



            <tr>
                <td class="col-md-3">templateUrl</td>
                <td class="col-md-9"><code>./compare-rev.component.html</code></td>
            </tr>








        </tbody>
    </table>
</section>

    <section>
    <h3 id="index">Index</h3>
    <table class="table table-sm table-bordered index-table">
        <tbody>
                <tr>
                    <td class="col-md-4">
                        <h6><b>Properties</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                <a href="#diffs">diffs</a>
                            </li>
                            <li>
                                <a href="#diffsCustom">diffsCustom</a>
                            </li>
                            <li>
                                <a href="#diffsReverse">diffsReverse</a>
                            </li>
                            <li>
                                <a href="#docString">docString</a>
                            </li>
                            <li>
                                <a href="#resolution">resolution</a>
                            </li>
                            <li>
                                <a href="#revDoc">revDoc</a>
                            </li>
                        </ul>
                    </td>
                </tr>

                <tr>
                    <td class="col-md-4">
                        <h6><b>Methods</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                    <span class="modifier">Public</span>
                                    <span class="modifier">Async</span>
                                <a href="#loadRev">loadRev</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#resolveByDelete">resolveByDelete</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                    <span class="modifier">Async</span>
                                <a href="#resolveByManualEdit">resolveByManualEdit</a>
                            </li>
                            <li>
                                <a href="#stringify">stringify</a>
                            </li>
                        </ul>
                    </td>
                </tr>

                <tr>
                    <td class="col-md-4">
                        <h6><b>Inputs</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                <a href="#doc">doc</a>
                            </li>
                            <li>
                                <a href="#rev">rev</a>
                            </li>
                        </ul>
                    </td>
                </tr>




        </tbody>
    </table>
</section>

    <section>
    <h3 id="constructor">Constructor</h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
<code>constructor(db: <a href="../classes/Database.html">Database</a>, confirmationDialog: <a href="../injectables/ConfirmationDialogService.html">ConfirmationDialogService</a>, snackBar: MatSnackBar, conflictResolver: <a href="../injectables/AutoResolutionService.html">AutoResolutionService</a>)</code>
                    </td>
                </tr>
                        <tr>
                            <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="44" class="link-to-prism">src/app/conflict-resolution/compare-rev/compare-rev.component.ts:44</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                            <div>
                                    <b>Parameters :</b>
                                    <table class="params">
                                        <thead>
                                            <tr>
                                                <td>Name</td>
                                                    <td>Type</td>
                                                <td>Optional</td>
                                            </tr>
                                        </thead>
                                        <tbody>
                                                <tr>
                                                        <td>db</td>
                                                  
                                                        <td>
                                                                        <code><a href="../classes/Database.html" target="_self" >Database</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>confirmationDialog</td>
                                                  
                                                        <td>
                                                                        <code><a href="../injectables/ConfirmationDialogService.html" target="_self" >ConfirmationDialogService</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>snackBar</td>
                                                  
                                                        <td>
                                                                    <code>MatSnackBar</code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>conflictResolver</td>
                                                  
                                                        <td>
                                                                        <code><a href="../injectables/AutoResolutionService.html" target="_self" >AutoResolutionService</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                        </tbody>
                                    </table>
                            </div>
                    </td>
                </tr>
            </tbody>
        </table>
</section>

    <section>
    <h3 id="inputs">Inputs</h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="doc"></a>
                        <b>doc</b>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </td>
                </tr>
                        <tr>
                            <td class="col-md-2" colspan="2">
                                    <div class="io-line">Defined in <a href="" data-line="22" class="link-to-prism">src/app/conflict-resolution/compare-rev/compare-rev.component.ts:22</a></div>
                            </td>
                        </tr>
                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>document from the database in the current version </p>
</div>
                    </td>
                </tr>
            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="rev"></a>
                        <b>rev</b>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                    </td>
                </tr>
                        <tr>
                            <td class="col-md-2" colspan="2">
                                    <div class="io-line">Defined in <a href="" data-line="19" class="link-to-prism">src/app/conflict-resolution/compare-rev/compare-rev.component.ts:19</a></div>
                            </td>
                        </tr>
                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>revision key (_rev) of the confliction version to be displayed </p>
</div>
                    </td>
                </tr>
            </tbody>
        </table>
</section>



    <section>
    
    <h3 id="methods">
        Methods
    </h3>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="loadRev"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Public</span>
                            <span class="modifier">Async</span>
                            loadRev
                        </b>
                        <a href="#loadRev"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>loadRev()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="56"
                            class="link-to-prism">src/app/conflict-resolution/compare-rev/compare-rev.component.ts:56</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Load the document version (revision) to be displayed and generate the diffs to be visualized.</p>
</div>

                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="resolveByDelete"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Public</span>
                            resolveByDelete
                        </b>
                        <a href="#resolveByDelete"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>resolveByDelete(docToDelete: <a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank">any</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="93"
                            class="link-to-prism">src/app/conflict-resolution/compare-rev/compare-rev.component.ts:93</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Resolve the displayed conflict by deleting the conflicting revision doc and keeping the current doc.</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                    <td>Description</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>docToDelete</td>
                                    <td>
                                                <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                    <td>
                                        <p>Document to be deleted</p>

                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="resolveByManualEdit"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Public</span>
                            <span class="modifier">Async</span>
                            resolveByManualEdit
                        </b>
                        <a href="#resolveByManualEdit"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>resolveByManualEdit(diffStringToApply: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="143"
                            class="link-to-prism">src/app/conflict-resolution/compare-rev/compare-rev.component.ts:143</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Apply the given diff, save the resulting new document to the database
and remove the conflicting document, thereby resolving the conflict.</p>
<p>This method is also used to resolve the conflict to keep the conflicting version instead of the current doc.
Then this simply applies the diff of the existing conflicting version instead of a user-edited diff.</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                    <td>Description</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>diffStringToApply</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                    <td>
                                        <p>The (user-edited) diff to be applied to the current doc</p>

                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="stringify"></a>
                    <span class="name">
                        <b>
                            stringify
                        </b>
                        <a href="#stringify"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>stringify(entity: <a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank">any</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="81"
                            class="link-to-prism">src/app/conflict-resolution/compare-rev/compare-rev.component.ts:81</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Generate a human-readable string of the given object.</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                    <td>Description</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>entity</td>
                                    <td>
                                                <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                    <td>
                                        <p>Object to be stringified</p>

                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</section>
    <section>
    
        <h3 id="inputs">
            Properties
        </h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="diffs"></a>
                        <span class="name">
                            <b>
                            diffs</b>
                            <a href="#diffs"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="31" class="link-to-prism">src/app/conflict-resolution/compare-rev/compare-rev.component.ts:31</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>changes the conflicting doc has compared to the current doc </p>
</div>
                    </td>
                </tr>

            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="diffsCustom"></a>
                        <span class="name">
                            <b>
                            diffsCustom</b>
                            <a href="#diffsCustom"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="41" class="link-to-prism">src/app/conflict-resolution/compare-rev/compare-rev.component.ts:41</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>the user edited diff that can be applied as an alternative resolution (initialized with same value as <code>diffs</code>) </p>
</div>
                    </td>
                </tr>

            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="diffsReverse"></a>
                        <span class="name">
                            <b>
                            diffsReverse</b>
                            <a href="#diffsReverse"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="38" class="link-to-prism">src/app/conflict-resolution/compare-rev/compare-rev.component.ts:38</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>changes the current doc has compared to the conflicting doc.</p>
<p>This mirrors <code>diffs</code> but shows the things that would be added if the current doc would
overwrite the conflicting version instead of the other way round.</p>
</div>
                    </td>
                </tr>

            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="docString"></a>
                        <span class="name">
                            <b>
                            docString</b>
                            <a href="#docString"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="25" class="link-to-prism">src/app/conflict-resolution/compare-rev/compare-rev.component.ts:25</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>used in the template for a tooltip displaying the full document </p>
</div>
                    </td>
                </tr>

            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="resolution"></a>
                        <span class="name">
                            <b>
                            resolution</b>
                            <a href="#resolution"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>null</code>
                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="44" class="link-to-prism">src/app/conflict-resolution/compare-rev/compare-rev.component.ts:44</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>whether/how this conflict has been resolved </p>
</div>
                    </td>
                </tr>

            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="revDoc"></a>
                        <span class="name">
                            <b>
                            revDoc</b>
                            <a href="#revDoc"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="28" class="link-to-prism">src/app/conflict-resolution/compare-rev/compare-rev.component.ts:28</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>document from the database in the conflicting version </p>
</div>
                    </td>
                </tr>

            </tbody>
        </table>
</section>

</div>


    <div class="tab-pane fade  tab-source-code" id="c-source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { Component, Input } from &quot;@angular/core&quot;;
import { diff } from &quot;deep-object-diff&quot;;
import _ from &quot;lodash&quot;;
import { ConfirmationDialogService } from &quot;../../core/confirmation-dialog/confirmation-dialog.service&quot;;
import { Database } from &quot;../../core/database/database&quot;;
import { MatSnackBar } from &quot;@angular/material/snack-bar&quot;;
import { AutoResolutionService } from &quot;../auto-resolution/auto-resolution.service&quot;;

/**
 * Visualize one specific conflicting document revision and offer resolution options.
 */
@Component({
  selector: &quot;app-compare-rev&quot;,
  templateUrl: &quot;./compare-rev.component.html&quot;,
  styleUrls: [&quot;./compare-rev.component.scss&quot;],
})
export class CompareRevComponent {
  /** revision key (_rev) of the confliction version to be displayed */
  @Input() rev: string;

  /** document from the database in the current version */
  @Input() doc: any;

  /** used in the template for a tooltip displaying the full document */
  docString: string;

  /** document from the database in the conflicting version */
  revDoc: any;

  /** changes the conflicting doc has compared to the current doc */
  diffs;

  /** changes the current doc has compared to the conflicting doc.
   *
   * This mirrors &#x60;diffs&#x60; but shows the things that would be added if the current doc would
   * overwrite the conflicting version instead of the other way round.
   */
  diffsReverse;

  /** the user edited diff that can be applied as an alternative resolution (initialized with same value as &#x60;diffs&#x60;) */
  diffsCustom;

  /** whether/how this conflict has been resolved */
  resolution: string &#x3D; null;

  constructor(
    private db: Database,
    private confirmationDialog: ConfirmationDialogService,
    private snackBar: MatSnackBar,
    private conflictResolver: AutoResolutionService
  ) {}

  /**
   * Load the document version (revision) to be displayed and generate the diffs to be visualized.
   */
  public async loadRev() {
    this.revDoc &#x3D; await this.db.get(this.doc._id, { rev: this.rev });
    const diffObject &#x3D; diff(this.doc, this.revDoc);
    this.diffs &#x3D; this.stringify(diffObject);

    const diffReverseObject &#x3D; diff(this.revDoc, this.doc);
    this.diffsReverse &#x3D; this.stringify(diffReverseObject);
    this.diffsCustom &#x3D; this.stringify(diffReverseObject);

    const isIrrelevantConflictingDoc &#x3D; this.conflictResolver.shouldDeleteConflictingRevision(
      this.doc,
      this.revDoc
    );
    if (isIrrelevantConflictingDoc) {
      const success &#x3D; await this.deleteDoc(this.revDoc);
      if (success) {
        this.resolution &#x3D; &quot;automatically deleted trivial conflict&quot;;
      }
    }
  }

  /**
   * Generate a human-readable string of the given object.
   * @param entity Object to be stringified
   */
  stringify(entity: any) {
    return JSON.stringify(
      entity,
      (k, v) &#x3D;&gt; (k &#x3D;&#x3D;&#x3D; &quot;_rev&quot; ? undefined : v), // ignore &quot;_rev&quot;
      2
    );
  }

  /**
   * Resolve the displayed conflict by deleting the conflicting revision doc and keeping the current doc.
   * @param docToDelete Document to be deleted
   */
  public resolveByDelete(docToDelete: any) {
    const dialogRef &#x3D; this.confirmationDialog.openDialog(
      &quot;Delete Conflicting Version?&quot;,
      &quot;Are you sure you want to keep the current version and delete this conflicting version? &quot; +
        this.stringify(docToDelete)
    );

    dialogRef.afterClosed().subscribe(async (confirmed) &#x3D;&gt; {
      if (confirmed) {
        const success &#x3D; await this.deleteDoc(docToDelete);
        if (success) {
          this.resolution &#x3D; &quot;deleted conflicting version&quot;;
        }
      }
    });
  }

  private async deleteDoc(docToDelete: any): Promise&lt;boolean&gt; {
    try {
      await this.db.remove(docToDelete);
      return true;
    } catch (e) {
      const errorMessage &#x3D; e.message || e.toString();
      this.snackBar.open(
        &quot;Error trying to delete conflicting version: &quot; + errorMessage
      );
      return false;
    }
  }

  private async saveDoc(docToSave: any): Promise&lt;boolean&gt; {
    try {
      await this.db.put(docToSave);
      return true;
    } catch (e) {
      const errorMessage &#x3D; e.message || e.toString();
      this.snackBar.open(&quot;Error trying to save version: &quot; + errorMessage);
      return false;
    }
  }

  /**
   * Apply the given diff, save the resulting new document to the database
   * and remove the conflicting document, thereby resolving the conflict.
   *
   * This method is also used to resolve the conflict to keep the conflicting version instead of the current doc.
   * Then this simply applies the diff of the existing conflicting version instead of a user-edited diff.
   *
   * @param diffStringToApply The (user-edited) diff to be applied to the current doc
   */
  public async resolveByManualEdit(diffStringToApply: string) {
    const originalDoc &#x3D; _.merge({}, this.doc);
    const diffToApply &#x3D; JSON.parse(diffStringToApply);
    _.merge(this.doc, diffToApply);

    const newChanges &#x3D; diff(originalDoc, this.doc);

    const dialogRef &#x3D; this.confirmationDialog.openDialog(
      &quot;Save Changes for Conflict Resolution?&quot;,
      &quot;Are you sure you want to save the following changes and delete the conflicting version? &quot; +
        this.stringify(newChanges)
    );
    dialogRef.afterClosed().subscribe(async (confirmed) &#x3D;&gt; {
      if (confirmed) {
        const successSave &#x3D; await this.saveDoc(this.doc);
        const successDel &#x3D; await this.deleteDoc(this.revDoc);
        if (successSave &amp;&amp; successDel) {
          if (diffStringToApply &#x3D;&#x3D;&#x3D; this.diffs) {
            this.resolution &#x3D; &quot;selected conflicting version&quot;;
          } else {
            this.resolution &#x3D; &quot;resolved manually&quot;;
          }
        }
      }
    });
  }
}
</code></pre>
    </div>

    <div class="tab-pane fade " id="c-templateData">
        <pre class="line-numbers"><code class="language-html">&lt;mat-expansion-panel (opened)&#x3D;&#x27;loadRev()&#x27; *ngIf&#x3D;&#x27;!resolution&#x27;&gt;
  &lt;mat-expansion-panel-header&gt;
    &lt;mat-panel-title&gt;
      &lt;span [matTooltip]&#x3D;&#x27;docString&#x27; (mouseover)&#x3D;&#x27;docString &#x3D; stringify(doc)&#x27;&gt;{{rev}}&lt;/span&gt;
    &lt;/mat-panel-title&gt;
  &lt;/mat-expansion-panel-header&gt;

  &lt;div fxLayout&#x3D;&#x27;row&#x27; fxLayoutGap&#x3D;&#x27;10px&#x27;&gt;
    &lt;div fxFlex&#x3D;&#x27;50&#x27;&gt;
      &lt;label for&#x3D;&#x27;conflictingDiff&#x27;&gt;Conflicting Entity:&lt;/label&gt;
      &lt;textarea id&#x3D;&#x27;conflictingDiff&#x27; cdkTextareaAutosize class&#x3D;&#x27;diffText conflicting&#x27; disabled&gt;
        {{ diffs }}
      &lt;/textarea&gt;
      &lt;button mat-raised-button class&#x3D;&#x27;resolution-btn&#x27; (click)&#x3D;&#x27;resolveByManualEdit(diffs)&#x27;&gt;
        Choose conflicting version
      &lt;/button&gt;
    &lt;/div&gt;

    &lt;div fxFlex&#x3D;&#x27;50&#x27;&gt;
      &lt;label for&#x3D;&#x27;customDiff&#x27;&gt;Custom Resolution:&lt;/label&gt;
      &lt;textarea id&#x3D;&#x27;customDiff&#x27; cdkTextareaAutosize class&#x3D;&#x27;diffText custom&#x27;
                [(ngModel)]&#x3D;&#x27;diffsCustom&#x27;&gt;
      &lt;/textarea&gt;
      &lt;button mat-raised-button class&#x3D;&#x27;resolution-btn&#x27; (click)&#x3D;&#x27;resolveByManualEdit(diffsCustom)&#x27;&gt;
        Save manually resolved record
      &lt;/button&gt;
    &lt;/div&gt;

    &lt;div fxFlex&#x3D;&#x27;50&#x27;&gt;
      &lt;label for&#x3D;&#x27;currentDiff&#x27;&gt;Current Entity:&lt;/label&gt;
      &lt;textarea id&#x3D;&#x27;currentDiff&#x27; cdkTextareaAutosize class&#x3D;&#x27;diffText current&#x27; disabled&gt;
        {{ diffsReverse }}
      &lt;/textarea&gt;
      &lt;button mat-raised-button class&#x3D;&#x27;resolution-btn&#x27; (click)&#x3D;&#x27;resolveByDelete(revDoc)&#x27;&gt;
        Choose current version
      &lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/mat-expansion-panel&gt;


&lt;div *ngIf&#x3D;&#x27;resolution&#x27;&gt;
  &lt;em&gt;Resolved ({{resolution}})&lt;/em&gt;
&lt;/div&gt;
</code></pre>
    </div>

    <div class="tab-pane fade " id="c-styleData">
                <p class="comment">
                    <code>./compare-rev.component.scss</code>
                </p>
                <pre class="line-numbers"><code class="language-scss">
.diffText {
  width: 100%;
  background: white;
}

.resolution-btn {
  width: 100%;
}

.conflicting {
  background: rgba(255, 0, 0, 0.1);
}
.current {
  background: rgba(0, 128, 0, 0.1);
}
.custom {
  background: rgba(0, 0, 255, 0.1);
  font-weight: bold;
}
</code></pre>
    </div>

    <div class="tab-pane fade " id="c-tree">
        <div id="tree-container"></div>
        <div class="tree-legend">
            <div class="title">
                <b>Legend</b>
            </div>
            <div>
                <div class="color htmlelement"></div><span>Html element</span>
            </div>
            <div>
                <div class="color component"></div><span>Component</span>
            </div>
            <div>
                <div class="color directive"></div><span>Html element with directive</span>
            </div>
        </div>
    </div>

    
</div>

<script src="../js/libs/vis.min.js"></script>
<script src="../js/libs/htmlparser.js"></script>
<script src="../js/libs/deep-iterator.js"></script>
<script>
        var COMPONENT_TEMPLATE = '<div><mat-expansion-panel (opened)=\'loadRev()\' *ngIf=\'!resolution\'>  <mat-expansion-panel-header>    <mat-panel-title>      <span [matTooltip]=\'docString\' (mouseover)=\'docString = stringify(doc)\'>{{rev}}</span>    </mat-panel-title>  </mat-expansion-panel-header>  <div fxLayout=\'row\' fxLayoutGap=\'10px\'>    <div fxFlex=\'50\'>      <label for=\'conflictingDiff\'>Conflicting Entity:</label>      <textarea id=\'conflictingDiff\' cdkTextareaAutosize class=\'diffText conflicting\' disabled>        {{ diffs }}      </textarea>      <button mat-raised-button class=\'resolution-btn\' (click)=\'resolveByManualEdit(diffs)\'>        Choose conflicting version      </button>    </div>    <div fxFlex=\'50\'>      <label for=\'customDiff\'>Custom Resolution:</label>      <textarea id=\'customDiff\' cdkTextareaAutosize class=\'diffText custom\'                [(ngModel)]=\'diffsCustom\'>      </textarea>      <button mat-raised-button class=\'resolution-btn\' (click)=\'resolveByManualEdit(diffsCustom)\'>        Save manually resolved record      </button>    </div>    <div fxFlex=\'50\'>      <label for=\'currentDiff\'>Current Entity:</label>      <textarea id=\'currentDiff\' cdkTextareaAutosize class=\'diffText current\' disabled>        {{ diffsReverse }}      </textarea>      <button mat-raised-button class=\'resolution-btn\' (click)=\'resolveByDelete(revDoc)\'>        Choose current version      </button>    </div>  </div></mat-expansion-panel><div *ngIf=\'resolution\'>  <em>Resolved ({{resolution}})</em></div></div>'
    var COMPONENTS = [{'name': 'AddDayAttendanceComponent', 'selector': 'app-add-day-attendance'},{'name': 'AddMonthAttendanceComponent', 'selector': 'app-add-month-attendance'},{'name': 'AdminComponent', 'selector': 'app-admin'},{'name': 'AlertComponent', 'selector': ''},{'name': 'AppComponent', 'selector': 'app-root'},{'name': 'AppVersionComponent', 'selector': 'app-version'},{'name': 'AserComponent', 'selector': 'app-aser'},{'name': 'AttendanceAnalysisComponent', 'selector': 'app-attendance-analysis'},{'name': 'AttendanceAverageDashboardComponent', 'selector': 'app-attendance-average-dashboard'},{'name': 'AttendanceBlockComponent', 'selector': 'app-attendance-block'},{'name': 'AttendanceDayBlockComponent', 'selector': 'app-attendance-day-block]'},{'name': 'AttendanceDaysComponent', 'selector': 'app-attendance-days'},{'name': 'AttendanceDetailsComponent', 'selector': 'app-attendance-details'},{'name': 'AttendanceManagerComponent', 'selector': 'app-attendance-manager'},{'name': 'AttendanceWarningsDashboardComponent', 'selector': 'app-attendance-warnings-dashboard'},{'name': 'AttendanceWeekDashboardComponent', 'selector': 'app-attendance-week-dashboard'},{'name': 'BackgroundProcessingIndicatorComponent', 'selector': 'app-background-processing-indicator'},{'name': 'ChangelogComponent', 'selector': ''},{'name': 'ChildAttendanceComponent', 'selector': 'app-child-attendance'},{'name': 'ChildBlockComponent', 'selector': 'app-child-block'},{'name': 'ChildDetailsComponent', 'selector': 'app-child-details'},{'name': 'ChildMeetingNoteAttendanceComponent', 'selector': 'app-child-meeting-note-attendance'},{'name': 'ChildrenCountDashboardComponent', 'selector': 'app-children-count-dashboard'},{'name': 'ChildrenListComponent', 'selector': 'app-children-list'},{'name': 'ChildSelectComponent', 'selector': 'app-child-select'},{'name': 'CloudFileServiceUserSettingsComponent', 'selector': 'app-cloud-file-service-user-settings'},{'name': 'CompareRevComponent', 'selector': 'app-compare-rev'},{'name': 'ConfirmationDialogComponent', 'selector': 'app-confirmation-dialog'},{'name': 'ConflictResolutionListComponent', 'selector': 'app-conflict-resolution-list'},{'name': 'DashboardComponent', 'selector': 'app-dashboard'},{'name': 'DemoDataGeneratingProgressDialogComponent', 'selector': ''},{'name': 'DropoutFormComponent', 'selector': 'app-dropout-form'},{'name': 'EducationalMaterialComponent', 'selector': 'app-educational-material'},{'name': 'EntitySubrecordComponent', 'selector': 'app-entity-subrecord'},{'name': 'ExportDataComponent', 'selector': 'app-export-data'},{'name': 'FormDialogWrapperComponent', 'selector': 'app-form-dialog-wrapper'},{'name': 'GroupedChildAttendanceComponent', 'selector': 'app-grouped-child-attendance'},{'name': 'HealthCheckupComponent', 'selector': 'app-health-checkup'},{'name': 'HealthFormComponent', 'selector': 'app-health-form'},{'name': 'HowToComponent', 'selector': 'app-help'},{'name': 'InitialSyncDialogComponent', 'selector': ''},{'name': 'LoginComponent', 'selector': 'app-login'},{'name': 'NavigationComponent', 'selector': 'app-navigation'},{'name': 'NoRecentNotesDashboardComponent', 'selector': 'app-no-recent-notes-dashboard'},{'name': 'NoteDetailsComponent', 'selector': 'app-note-details'},{'name': 'NotePresenceListComponent', 'selector': 'app-note-presence-list'},{'name': 'NotesManagerComponent', 'selector': 'app-notes-manager'},{'name': 'NotesOfChildComponent', 'selector': 'app-notes-of-child'},{'name': 'PreviousSchoolsComponent', 'selector': 'app-previous-schools'},{'name': 'PrimaryActionComponent', 'selector': 'app-primary-action'},{'name': 'ProgressDashboardComponent', 'selector': 'app-progress-dashboard'},{'name': 'RecentNotesDashboardComponent', 'selector': 'app-recent-notes-dashboard'},{'name': 'RollCallComponent', 'selector': 'app-roll-call'},{'name': 'SchoolBlockComponent', 'selector': 'app-school-block'},{'name': 'SchoolDetailsComponent', 'selector': 'app-school-details'},{'name': 'SchoolsListComponent', 'selector': 'app-schools-list'},{'name': 'SearchComponent', 'selector': 'app-search'},{'name': 'SelectGroupChildrenComponent', 'selector': 'app-select-group-children'},{'name': 'SyncStatusComponent', 'selector': 'app-sync-status'},{'name': 'UiComponent', 'selector': 'app-ui'},{'name': 'UserAccountComponent', 'selector': 'app-user-account'},{'name': 'UserListComponent', 'selector': 'app-user-list'}];
    var DIRECTIVES = [{'name': 'DynamicComponentDirective', 'selector': '[appDynamicComponent]'}];
    var ACTUAL_COMPONENT = {'name': 'CompareRevComponent'};
</script>
<script src="../js/tree.js"></script>










                   




                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> result-matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'component';
            var COMPODOC_CURRENT_PAGE_URL = 'CompareRevComponent.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>
       <!-- Required to polyfill modern browsers as code is ES5 for IE... -->
       <script src="../js/libs/custom-elements-es5-adapter.js" charset="utf-8" defer></script>
       <script src="../js/menu-wc.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
