{"version":3,"sources":["webpack:///(webpack)/buildin/global.js","webpack:///node_modules/moment/locale sync ^\\.\\/.*$","webpack:///src/$_lazy_route_resource lazy namespace object","webpack:///src/app/app.component.ts","webpack:///src/app/app.module.ts","webpack:///src/app/app.routing.ts","webpack:///src/app/child-dev-project/aser/aser-component/aser.component.ts","webpack:///src/app/child-dev-project/aser/demo-aser-generator.service.ts","webpack:///src/app/child-dev-project/aser/model/aser.ts","webpack:///src/app/child-dev-project/attendance/add-day-attendance/add-day-attendance.component.ts","webpack:///src/app/child-dev-project/attendance/add-day-attendance/add-day-attendance.component.html","webpack:///src/app/child-dev-project/attendance/add-day-attendance/roll-call/roll-call.component.html","webpack:///src/app/child-dev-project/attendance/add-day-attendance/roll-call/roll-call.component.ts","webpack:///src/app/child-dev-project/attendance/add-month-attendance/add-month-attendance.component.html","webpack:///src/app/child-dev-project/attendance/add-month-attendance/add-month-attendance.component.ts","webpack:///src/app/child-dev-project/attendance/attendance-analysis/attendance-analysis.component.html","webpack:///src/app/child-dev-project/attendance/attendance-analysis/attendance-analysis.component.ts","webpack:///src/app/child-dev-project/attendance/attendance-block/attendance-block.component.ts","webpack:///src/app/child-dev-project/attendance/attendance-block/attendance-block.component.html","webpack:///src/app/child-dev-project/attendance/attendance-days/attendance-day-block.component.ts","webpack:///src/app/child-dev-project/attendance/attendance-days/attendance-day-block.component.html","webpack:///src/app/child-dev-project/attendance/attendance-days/attendance-days.component.ts","webpack:///src/app/child-dev-project/attendance/attendance-days/attendance-days.component.html","webpack:///src/app/child-dev-project/attendance/attendance-details/attendance-details.component.ts","webpack:///src/app/child-dev-project/attendance/attendance-details/attendance-details.component.html","webpack:///src/app/child-dev-project/attendance/attendance-manager/attendance-manager.component.ts","webpack:///src/app/child-dev-project/attendance/attendance-manager/attendance-manager.component.html","webpack:///src/app/child-dev-project/attendance/attendance-month-conflict-resolution-strategy.ts","webpack:///src/app/child-dev-project/attendance/child-attendance/child-attendance.component.html","webpack:///src/app/child-dev-project/attendance/child-attendance/child-attendance.component.ts","webpack:///src/app/child-dev-project/attendance/dashboard-widgets/attendance-average-dashboard/attendance-average-dashboard.component.html","webpack:///src/app/child-dev-project/attendance/dashboard-widgets/attendance-average-dashboard/attendance-average-dashboard.component.ts","webpack:///src/app/child-dev-project/attendance/dashboard-widgets/attendance-warnings-dashboard/attendance-warnings-dashboard.component.html","webpack:///src/app/child-dev-project/attendance/dashboard-widgets/attendance-warnings-dashboard/attendance-warnings-dashboard.component.ts","webpack:///src/app/child-dev-project/attendance/dashboard-widgets/attendance-week-dashboard/attendance-week-dashboard.component.html","webpack:///src/app/child-dev-project/attendance/dashboard-widgets/attendance-week-dashboard/attendance-week-dashboard.component.ts","webpack:///src/app/child-dev-project/attendance/demo-attendance-generator.service.ts","webpack:///src/app/child-dev-project/attendance/model/attendance-day.ts","webpack:///src/app/child-dev-project/attendance/model/attendance-month.ts","webpack:///src/app/child-dev-project/children/child-block/child-block.component.html","webpack:///src/app/child-dev-project/children/child-block/child-block.component.ts","webpack:///src/app/child-dev-project/children/child-details/child-details.component.ts","webpack:///src/app/child-dev-project/children/child-details/child-details.component.html","webpack:///src/app/child-dev-project/children/child-photo-service/child-photo.service.ts","webpack:///src/app/child-dev-project/children/child-photo-service/datatype-load-child-photo.ts","webpack:///src/app/child-dev-project/children/child-select/child-select.component.html","webpack:///src/app/child-dev-project/children/child-select/child-select.component.ts","webpack:///src/app/child-dev-project/children/children-count-dashboard/children-count-dashboard.component.html","webpack:///src/app/child-dev-project/children/children-count-dashboard/children-count-dashboard.component.ts","webpack:///src/app/child-dev-project/children/children-list/children-list.component.html","webpack:///src/app/child-dev-project/children/children-list/children-list.component.ts","webpack:///src/app/child-dev-project/children/children.module.ts","webpack:///src/app/child-dev-project/children/children.service.ts","webpack:///src/app/child-dev-project/children/demo-data-generators/demo-child-generator.service.ts","webpack:///src/app/child-dev-project/children/demo-data-generators/demo-child-school-relation-generator.service.ts","webpack:///src/app/child-dev-project/children/demo-data-generators/fixtures/centers.ts","webpack:///src/app/child-dev-project/children/demo-data-generators/fixtures/dropout-types.ts","webpack:///src/app/child-dev-project/children/demo-data-generators/fixtures/languages.ts","webpack:///src/app/child-dev-project/children/demo-data-generators/fixtures/religions.ts","webpack:///src/app/child-dev-project/children/model/Gender.ts","webpack:///src/app/child-dev-project/children/model/child.ts","webpack:///src/app/child-dev-project/children/model/childSchoolRelation.ts","webpack:///src/app/child-dev-project/children/select-group-children/select-group-children.component.html","webpack:///src/app/child-dev-project/children/select-group-children/select-group-children.component.ts","webpack:///src/app/child-dev-project/dashboard/dashboard-component-map.ts","webpack:///src/app/child-dev-project/dashboard/dashboard.module.ts","webpack:///src/app/child-dev-project/dashboard/dashboard/dashboard-widget.directive.ts","webpack:///src/app/child-dev-project/dashboard/dashboard/dashboard.component.ts","webpack:///src/app/child-dev-project/dashboard/dashboard/dashboard.component.html","webpack:///src/app/child-dev-project/dashboard/demo-widget-generator.service.ts","webpack:///src/app/child-dev-project/dashboard/progress-dashboard/progress-dashboard-config.ts","webpack:///src/app/child-dev-project/dashboard/progress-dashboard/progress-dashboard.component.html","webpack:///src/app/child-dev-project/dashboard/progress-dashboard/progress-dashboard.component.ts","webpack:///src/app/child-dev-project/educational-material/demo-educational-material-generator.service.ts","webpack:///src/app/child-dev-project/educational-material/educational-material-component/educational-material.component.ts","webpack:///src/app/child-dev-project/educational-material/educational-material-component/educational-material.component.html","webpack:///src/app/child-dev-project/educational-material/model/educational-material.ts","webpack:///src/app/child-dev-project/health-checkup/demo-data/demo-health-check-generator.service.ts","webpack:///src/app/child-dev-project/health-checkup/demo-data/height-weight.ts","webpack:///src/app/child-dev-project/health-checkup/health-checkup-component/health-checkup.component.ts","webpack:///src/app/child-dev-project/health-checkup/health-checkup-component/health-checkup.component.html","webpack:///src/app/child-dev-project/health-checkup/model/health-check.ts","webpack:///src/app/child-dev-project/notes/dashboard-widgets/no-recent-notes-dashboard/no-recent-notes-dashboard.component.html","webpack:///src/app/child-dev-project/notes/dashboard-widgets/no-recent-notes-dashboard/no-recent-notes-dashboard.component.ts","webpack:///src/app/child-dev-project/notes/dashboard-widgets/recent-notes-dashboard/recent-notes-dashboard.component.html","webpack:///src/app/child-dev-project/notes/dashboard-widgets/recent-notes-dashboard/recent-notes-dashboard.component.ts","webpack:///src/app/child-dev-project/notes/demo-data/demo-note-generator.service.ts","webpack:///src/app/child-dev-project/notes/demo-data/notes_group-stories.ts","webpack:///src/app/child-dev-project/notes/demo-data/notes_individual-stories.ts","webpack:///src/app/child-dev-project/notes/demo-data/remarks.ts","webpack:///src/app/child-dev-project/notes/interaction-types.enum.ts","webpack:///src/app/child-dev-project/notes/meeting-note-attendance.ts","webpack:///src/app/child-dev-project/notes/model/note.ts","webpack:///src/app/child-dev-project/notes/note-details/child-meeting-attendance/child-meeting-note-attendance.component.ts","webpack:///src/app/child-dev-project/notes/note-details/child-meeting-attendance/child-meeting-note-attendance.component.html","webpack:///src/app/child-dev-project/notes/note-details/note-details.component.ts","webpack:///src/app/child-dev-project/notes/note-details/note-details.component.html","webpack:///src/app/child-dev-project/notes/note-details/note-presence-list/note-presence-list.component.ts","webpack:///src/app/child-dev-project/notes/note-details/note-presence-list/note-presence-list.component.html","webpack:///src/app/child-dev-project/notes/notes-manager/notes-manager.component.html","webpack:///src/app/child-dev-project/notes/notes-manager/notes-manager.component.ts","webpack:///src/app/child-dev-project/notes/notes-of-child/notes-of-child.component.ts","webpack:///src/app/child-dev-project/notes/notes-of-child/notes-of-child.component.html","webpack:///src/app/child-dev-project/notes/notes.module.ts","webpack:///src/app/child-dev-project/previous-schools/previous-schools.component.ts","webpack:///src/app/child-dev-project/previous-schools/previous-schools.component.html","webpack:///src/app/child-dev-project/schools/demo-school-generator.service.ts","webpack:///src/app/child-dev-project/schools/model/school.ts","webpack:///src/app/child-dev-project/schools/school-block/school-block.component.html","webpack:///src/app/child-dev-project/schools/school-block/school-block.component.ts","webpack:///src/app/child-dev-project/schools/school-details/school-details.component.html","webpack:///src/app/child-dev-project/schools/school-details/school-details.component.ts","webpack:///src/app/child-dev-project/schools/schools-list/schools-list.component.html","webpack:///src/app/child-dev-project/schools/schools-list/schools-list.component.ts","webpack:///src/app/child-dev-project/schools/schools.module.ts","webpack:///src/app/child-dev-project/schools/schools.service.ts","webpack:///src/app/child-dev-project/warning-level.ts","webpack:///src/app/conflict-resolution/auto-resolution/conflict-resolution-strategy.ts","webpack:///src/app/core/admin/admin.guard.ts","webpack:///src/app/core/admin/admin.module.ts","webpack:///src/app/core/admin/admin/admin.component.ts","webpack:///src/app/core/admin/admin/admin.component.html","webpack:///src/app/core/admin/export-data/export-data.component.ts","webpack:///src/app/core/admin/export-data/export-data.component.html","webpack:///src/app/core/admin/services/backup.service.ts","webpack:///src/app/core/admin/services/child-photo-update.service.ts","webpack:///src/app/core/admin/user-list/user-list.component.html","webpack:///src/app/core/admin/user-list/user-list.component.ts","webpack:///src/app/core/alerts/alert-display.ts","webpack:///src/app/core/alerts/alert.service.ts","webpack:///src/app/core/alerts/alert.ts","webpack:///src/app/core/alerts/alerts.module.ts","webpack:///src/app/core/alerts/alerts/alert.component.ts","webpack:///src/app/core/alerts/alerts/alert.component.html","webpack:///src/app/core/analytics/analytics.service.ts","webpack:///src/app/core/app-config/app-config.module.ts","webpack:///src/app/core/app-config/app-config.ts","webpack:///src/app/core/config/config.module.ts","webpack:///src/app/core/config/config.service.ts","webpack:///src/app/core/confirmation-dialog/confirmation-dialog.module.ts","webpack:///src/app/core/confirmation-dialog/confirmation-dialog.service.ts","webpack:///src/app/core/confirmation-dialog/confirmation-dialog/confirmation-dialog.component.ts","webpack:///src/app/core/confirmation-dialog/confirmation-dialog/confirmation-dialog.component.html","webpack:///src/app/core/database/database.service.provider.ts","webpack:///src/app/core/database/database.ts","webpack:///src/app/core/database/mock-database.ts","webpack:///src/app/core/database/pouch-database.ts","webpack:///src/app/core/demo-data/demo-data-generating-progress-dialog.component.ts","webpack:///src/app/core/demo-data/demo-data-generator.ts","webpack:///src/app/core/demo-data/demo-data.module.ts","webpack:///src/app/core/demo-data/demo-data.service.ts","webpack:///src/app/core/demo-data/faker.ts","webpack:///src/app/core/entity-subrecord/entity-subrecord.module.ts","webpack:///src/app/core/entity-subrecord/entity-subrecord/column-description-input-type.enum.ts","webpack:///src/app/core/entity-subrecord/entity-subrecord/column-description.ts","webpack:///src/app/core/entity-subrecord/entity-subrecord/entity-subrecord.component.html","webpack:///src/app/core/entity-subrecord/entity-subrecord/entity-subrecord.component.ts","webpack:///src/app/core/entity-subrecord/keys-pipe/keys.pipe.ts","webpack:///src/app/core/entity/database-entity.decorator.ts","webpack:///src/app/core/entity/database-field.decorator.ts","webpack:///src/app/core/entity/database-indexing/database-indexing.service.ts","webpack:///src/app/core/entity/entity-mapper.service.ts","webpack:///src/app/core/entity/entity.module.ts","webpack:///src/app/core/entity/entity.ts","webpack:///src/app/core/entity/schema-datatypes/datatype-array.ts","webpack:///src/app/core/entity/schema-datatypes/datatype-date-only.ts","webpack:///src/app/core/entity/schema-datatypes/datatype-date.ts","webpack:///src/app/core/entity/schema-datatypes/datatype-default.ts","webpack:///src/app/core/entity/schema-datatypes/datatype-month.ts","webpack:///src/app/core/entity/schema-datatypes/datatype-number.ts","webpack:///src/app/core/entity/schema-datatypes/datatype-schema-embed.ts","webpack:///src/app/core/entity/schema-datatypes/datatype-string.ts","webpack:///src/app/core/entity/schema/entity-schema.service.ts","webpack:///src/app/core/filter/filter-selection/filter-selection.ts","webpack:///src/app/core/form-dialog/form-dialog-wrapper/form-dialog-wrapper.component.ts","webpack:///src/app/core/form-dialog/form-dialog-wrapper/form-dialog-wrapper.component.html","webpack:///src/app/core/form-dialog/form-dialog.module.ts","webpack:///src/app/core/form-dialog/form-dialog.service.ts","webpack:///src/app/core/help/help.module.ts","webpack:///src/app/core/help/how-to/how-to.component.ts","webpack:///src/app/core/help/how-to/how-to.component.html","webpack:///src/app/core/latest-changes/app-version/app-version.component.ts","webpack:///src/app/core/latest-changes/app-version/app-version.component.html","webpack:///src/app/core/latest-changes/changelog/changelog.component.ts","webpack:///src/app/core/latest-changes/changelog/changelog.component.html","webpack:///src/app/core/latest-changes/latest-changes-dialog.service.ts","webpack:///src/app/core/latest-changes/latest-changes.module.ts","webpack:///src/app/core/latest-changes/latest-changes.service.ts","webpack:///src/app/core/latest-changes/update-manager.service.ts","webpack:///src/app/core/logging/log-level.ts","webpack:///src/app/core/logging/logging-error-handler.ts","webpack:///src/app/core/logging/logging.service.ts","webpack:///src/app/core/navigation/menu-item.ts","webpack:///src/app/core/navigation/navigation.module.ts","webpack:///src/app/core/navigation/navigation/navigation.component.ts","webpack:///src/app/core/navigation/navigation/navigation.component.html","webpack:///src/app/core/session/logged-in-guard/logged-in.guard.ts","webpack:///src/app/core/session/login/login.component.ts","webpack:///src/app/core/session/login/login.component.html","webpack:///src/app/core/session/session-service/local-session.ts","webpack:///src/app/core/session/session-service/mock-session.service.ts","webpack:///src/app/core/session/session-service/remote-session.ts","webpack:///src/app/core/session/session-service/session.service.ts","webpack:///src/app/core/session/session-service/synced-session.service.ts","webpack:///src/app/core/session/session-states/connection-state.enum.ts","webpack:///src/app/core/session/session-states/login-state.enum.ts","webpack:///src/app/core/session/session-states/state-handler.ts","webpack:///src/app/core/session/session-states/sync-state.enum.ts","webpack:///src/app/core/session/session.module.ts","webpack:///src/app/core/session/session.service.provider.ts","webpack:///src/app/core/sync-status/background-processing-indicator/background-processing-indicator.component.ts","webpack:///src/app/core/sync-status/background-processing-indicator/background-processing-indicator.component.html","webpack:///src/app/core/sync-status/sync-status.module.ts","webpack:///src/app/core/sync-status/sync-status/initial-sync-dialog.component.ts","webpack:///src/app/core/sync-status/sync-status/initial-sync-dialog.component.html","webpack:///src/app/core/sync-status/sync-status/sync-status.component.ts","webpack:///src/app/core/sync-status/sync-status/sync-status.component.html","webpack:///src/app/core/ui/primary-action/primary-action.component.ts","webpack:///src/app/core/ui/primary-action/primary-action.component.html","webpack:///src/app/core/ui/search/search.component.html","webpack:///src/app/core/ui/search/search.component.ts","webpack:///src/app/core/ui/ui.module.ts","webpack:///src/app/core/ui/ui/ui.component.ts","webpack:///src/app/core/ui/ui/ui.component.html","webpack:///src/app/core/user/demo-user-generator.service.ts","webpack:///src/app/core/user/user-account/user-account.component.ts","webpack:///src/app/core/user/user-account/user-account.component.html","webpack:///src/app/core/user/user.module.ts","webpack:///src/app/core/user/user.ts","webpack:///src/app/core/view/router.service.ts","webpack:///src/app/core/view/view.module.ts","webpack:///src/app/core/webdav/cloud-file-service-user-settings/cloud-file-service-user-settings.component.html","webpack:///src/app/core/webdav/cloud-file-service-user-settings/cloud-file-service-user-settings.component.ts","webpack:///src/app/core/webdav/cloud-file-service.service.ts","webpack:///src/app/core/webdav/webdav.module.ts","webpack:///src/app/utils/utils.ts","webpack:///src/environments/environment.ts","webpack:///src/main.ts","webpack:///util (ignored)?92aa","webpack:///buffer (ignored)?a8ac","webpack:///buffer (ignored)?45a0","webpack:///buffer (ignored)","webpack:///buffer (ignored)?d019","webpack:///buffer (ignored)?d39f","webpack:///buffer (ignored)?c85e","webpack:///util (ignored)?7ad5","webpack:///util (ignored)","webpack:///util (ignored)?bf05","webpack:///buffer (ignored)?d6e6","webpack:///buffer (ignored)?cdc4","webpack:///crypto (ignored)","webpack:///util (ignored)?3849","webpack:///util (ignored)?81aa"],"names":["g","Function","e","window","module","exports","map","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","Error","code","keys","webpackContextKeys","Object","resolve","webpackEmptyAsyncContext","Promise","then","AppComponent","viewContainerRef","dialog","analyticsService","init","loadDemoData","settings","database","useTemporaryDatabase","loadDemoDataWithLoadingDialog","selector","template","configFactory","configService","loadConfig","AppModule","matIconRegistry","routerService","registerFontClassAlias","setDefaultFontSetClass","initRouting","provide","useClass","useFactory","deps","multi","register","enabled","production","forRoot","developerMode","provider","count","minNotesPerChild","maxNotesPerChild","groupNotes","minCount","maxCount","declarations","imports","providers","bootstrap","initRemoteLogging","dsn","remoteLoggingDsn","whitelistUrls","COMPONENT_MAP","Dashboard","UserAccount","NotesManager","UserList","Help","AttendanceManager","AddMonthAttendance","AddDayAttendance","AttendanceAnalysis","SchoolsList","SchoolDetails","ChildrenList","ChildDetails","ChildAttendance","Admin","routes","path","redirectTo","routing","AserComponent","route","childrenService","datePipe","columns","DATE","v","transform","SELECT","MathLevels","s","value","label","undefined","ReadingLevels","TEXT","paramMap","pipe","subscribe","params","childId","get","toString","loadData","getAserResultsOfChild","results","records","sort","a","b","date","valueOf","child","newAtt","Date","now","DemoAserGeneratorService","demoChildren","data","entities","push","generateAserResultsForChild","admissionDate","getTime","previousResult","firstLanguage","motherTongue","toLowerCase","aserResult","random","uuid","getId","math","selectNextSkillLevel","english","getFullYear","getEarlierDateOrToday","dropoutDate","getWarningLevel","OK","skillRange","previousSkillLevel","previousSkillLevelIndex","indexOf","nextSkillLevelIndex","number","trimToValidIndex","index","array","Math","min","length","Aser","hindi","bengali","remarks","warningLevel","NONE","isReadingPassedOrNA","isMathPassedOrNA","WARNING","level","AddDayAttendanceComponent","currentStage","day","students","stages","selectedStudents","templateUrl","styleUrls","RollCallComponent","entityMapper","complete","isLoading","rollCallList","AttStatus","showDebug","debug","loadList","loadMonthAttendanceRecords","sortRollCallList","goToNextStudent","children","rollCallRecords","getAttendancesOfMonth","toPromise","attendances","forEach","attMonth","find","student","institution","attendanceType","createAttendanceMonth","month","attDay","dailyRegister","d","getDate","getMonth","attendanceMonth","attendanceDay","schoolClass","diff","parseInt","Number","isNaN","status","rollCallListEntry","currentIndex","save","setTimeout","newIndex","displayRecordForDebugging","emit","rollCallRecord","console","log","debugContent","JSON","stringify","backgroundColor","animations","AddMonthAttendanceComponent","confirmDialog","alertService","schools","Array","centers","childrenBySchool","Map","childrenByCenter","attendanceDataSource","columnsToDisplay","loadingExistingRecords","loadType","getChildren","filter","c","isActive","initChildrenLookupTables","center","arr","arrS","schoolId","set","arrC","getFilteredStudents","att","loadExistingAttendanceRecordIfAvailable","result","school","coachingCenter","overridden","daysWorking","workingDays","event","target","valueAsDate","okay","daysAttended","isDataEnteredComplete","openDialog","addInfo","reset","loadTable","recordsToOverwrite","recordToOverwrite","relevantExistingRecords","assign","updateMonth","updateWorkingDays","AttendanceAnalysisComponent","displayType","dataSource","loading","centerFS","dropoutFS","key","filterFun","filterSelections","filterFrom","setDate","filterUntil","setMonth","childrenAll","initCenterFilterOptions","applyFilterSelections","options","filteredData","f","getSelectedFilterFunction","concat","loadChildRecords","recordCoaching","attendance","averageAttendance","recordSchool","getAttendancesOfChild","isLaterOrEqualMonth","isEarlierOrEqualMonth","calculateRecordStats","record","stats","reduce","acc","daysLate","sum","recordCount","totalWorking","totalAttended","totalAbsent","totalLate","AttendanceBlockComponent","tooltip","tooltipTimeout","clearTimeout","showTooltip","hideTooltip","AttendanceDayBlockComponent","showDate","showHighlighted","AttendanceDaysComponent","selectedRecordChanged","statusValues","weekRecordsTrackByFunction","item","recordTrackByFunction","changes","weeks","currentWeek","firstDay","daysUntilFirstOfMonth","getDay","i","unshift","selectedRecord","dayStatusSelect","focus","content","AttendanceDetailsComponent","entity","AttendanceManagerComponent","AttendanceMonthConflictResolutionStrategy","entitySchemaService","currentDoc","conflictingDoc","_id","startsWith","ENTITY_TYPE","transformEntityToDatabaseFormat","currentDocC","merge","_rev","conflictingDocC","isIrrelevantAttendanceMonthConflict","diffObject","simplifiedDiff","removeTrivialDiffValuesRecursively","isObjectLike","isEmpty","trivialValues","k","includes","ChildAttendanceComponent","percentPipe","showDailyAttendanceOfLatest","detailsComponent","MONTH","NUMBER","FUNCTION","TEXTAREA","r","createCurrentMonthsAttendanceIfNotExists","AttendanceAverageDashboardComponent","router","ATTENDANCE_THRESHOLD","lastMonthsTopAttendence","config","loadAverageAttendances","countMap","queryAttendanceLast3Months","attendance3Months","totalCount","summedAverage","rows","studentStat","overallAttendance","queryAttendanceLastMonth","attendanceLastMonth","getChild","from","values","navigate","AttendanceWarningsDashboardComponent","THRESHOLD_WARNING","lastMonthsLowAttendence","loadLastAttendances","queryResults","urgency","THRESHOLD_URGENT","AttendanceWeekDashboardComponent","daysOffset","periodLabel","loadAttendanceOfAbsentees","attendanceRecordsMap","today","previousMonday","previousSaturday","o1","extractRelevantAttendanceDays","o2","filterAbsentees","startDate","endDate","attendanceCoaching","attendanceSchool","relevantDays","attendanceRecords","countAbsencesFun","ABSENT","schoolAbsences","coachingAbsences","ATTENDANCE_PROFILES","present","excused","late","absent","DemoAttendanceGenerator","generateAttendanceRecordsForChild","finalMonth","setFullYear","attendanceProfile","selectNextAttendanceProfile","generateRecord","toISOString","setDayAttendance","includeSaturday","isHoliday","HOLIDAY","PRESENT","EXCUSED","arrayElement","LATE","previousAttendanceProfile","AttendanceStatus","AttendanceDay","UNKNOWN","dataType","AttendanceMonth","_dailyRegister","expectedDays","daysInMonth","currentDays","splice","calculateFromDailyRegister","daysExcused","getAttendancePercentage","URGENT","p_month","warn","updateDailyRegister","daysWorking_manuallyEntered","getDaysWorkingFromDailyAttendance","daysAttended_manuallyEntered","getDaysAttendedFromDailyAttendance","daysExcused_manuallyEntered","getDaysExcusedFromDailyAttendance","daysLate_manuallyEntered","arrayDataType","ext","ChildBlockComponent","tooltipVisible","entityId","tooltipDisabled","linkDisabled","ChildDetailsComponent","entityMapperService","fb","location","snackBar","confirmationDialog","childPhotoService","sessionService","validateForm","creatingNew","editing","gender","genders","documentStatus","eyeStatusValues","vaccinationStatusValues","loadChild","isAdminUser","getCurrentUser","admin","form","group","name","disabled","required","projectNumber","dateOfBirth","religion","address","phone","guardianName","preferredTimeForGuardianMeeting","health_bloodGroup","health_lastDentalCheckup","health_lastEyeCheckup","health_lastENTCheckup","health_lastVitaminD","health_lastDeworming","dropoutType","dropoutRemarks","photoFile","initForm","enablePhotoUpload","canSetImage","markAllAsTouched","valid","assignFormValuesToChild","switchEdit","err","addDanger","invalidFields","getInvalidFields","controls","dialogRef","afterClosed","confirmed","remove","snackBarRef","open","duration","onAction","back","invalid","field","setImage","files","photo","getImage","next","navigateBack","uploadChildPhoto","changedRecordInEntitySubrecord","ChildPhotoService","cloudFileService","basePath","getImageFromCloudService","image","getImageFromAssets","isConnected","imageType","filepath","getFile","trim","getDefaultImage","generatePhotoPath","resultSubject","imageFile","reject","fileExt","substr","lastIndexOf","uploadFile","providedIn","LoadChildPhotoEntitySchemaDatatype","schemaField","schemaService","parent","childDummy","extractEntityIdFromId","getImageAsyncObservable","ChildSelectComponent","searchText","showOnlyActiveChildren","suggestions","allChildren","selectedChildren","valueAsIdsChange","newIdAdded","idRemoved","hasOwnProperty","loadInitial","search","selectInitialSelectedChildren","valueAsIds","selectedId","selectedChild","selectChild","autocomplete","openPanel","suppressChangeEvent","findIndex","inputField","nativeElement","unselectChild","ChildrenCountDashboardComponent","totalChildren","entries","filterString","queryParams","toLocaleLowerCase","ChildrenListComponent","media","childrenList","attendanceList","childrenDataSource","columnGroupSelection","columnGroups","maxAttendanceBlocks","loadUrlParams","user","paginatorPageSize","paginatorSettingsPageSize","paginatorPageIndex","paginatorSettingsPageIndex","media$","change","mqAlias","displayColumnGroup","replaceUrl","selectedOption","paginator","pageIndex","page","pageSize","initOptions","getAttendances","prepareAttendanceData","loadedEntities","x","has","studentsAttendance","filterValue","columnGroupName","found","updateUrl","applyFilter","onPaginateChange","ChildrenModule","ChildrenService","dbIndexing","logger","registerSchemaDatatype","createDatabaseIndices","createAttendanceAnalysisIndex","createNotesIndex","createAttendancesIndex","createChildSchoolRelationIndex","loadedChildren","loadedChild","getCurrentSchoolInfoForChild","childCurrentSchoolInfo","migrateToNewChildSchoolRelationModel","autoMigratedChildSchoolRelation","promise","load","currentSchoolInfo","queryIndex","include_docs","loadedRecord","loadDataIntoEntity","doc","monthString","designDoc","views","by_child","by_month","createIndex","by_school","by_date","querySortedRelations","limit","startkey","endkey","descending","queryType","three_months","getAverageAttendanceMapFunction","last_month","getLastAverageAttendanceMapFunction","childStats","dateOfLatestNoteInDays","max","todayInDays","daysSinceLastNote","note_date_in_days_for_child","h","relations","rel","start","isSameOrBefore","end","isSameOrAfter","DemoChildConfig","DemoChildGenerator","String","firstName","lastName","MALE","FEMALE","past","age","makeChildDropout","between","lorem","sentence","useValue","DemoChildSchoolRelationGenerator","demoSchools","generateChildSchoolRecordsForChild","firstYear","finalYear","currentSchool","offset","selectNextSchool","setChildSchoolAndClassForLegacyUse","year","schoolRelation","latestChildSchoolRelation","centersWithProbability","centersUnique","self","dropoutTypes","languages","religions","Gender","Child","has_aadhar","has_bankAccount","has_kanyashree","has_rationCard","has_BplCard","indices","split","m","filename","ChildSchoolRelation","SelectGroupChildrenComponent","valueChange","centerFilters","schoolFilters","classFilters","loadFilterOptionsForProperty","propertyToBeFiltered","getAllStudentsFilterOption","filterOption","type","selectedCenterFilter","selectSchoolFilter","selectedSchoolFilter","selectClassFilter","selectedClassFilter","selectCenterFilter","confirmSelectedChildren","DASHBOARD_COMPONENT_MAP","DashboardModule","DashboardWidgetDirective","componentFactoryResolver","loggingService","loadWidgetComponent","appDashboardWidget","component","componentFactory","resolveComponentFactory","clear","componentRef","createComponent","instance","initFromConfig","DashboardComponent","activatedRoute","widgets","DemoWidgetGeneratorService","DEMO_TASKS","generateDashboardWidgetSurveyStatus","dashboardProgressWidget","title","task","targetNumber","parts","currentValue","targetValue","ProgressDashboardConfig","currentTotal","entry","targetTotal","ProgressDashboardComponent","dashboardConfigId","configure","addDebug","createDefaultConfig","addWarning","message","addPart","newPart","DemoEducationMaterialConfig","DemoEducationalMaterialGeneratorService","generateEducationalMaterialEntity","specialMaterial","materialType","MATERIAL_OTHER","materialAmount","MATERIAL_ALL","EducationalMaterialComponent","materialTypes","AUTOCOMPLETE","t","getEducationalMaterialsOfChild","summary","previousValue","summaryText","EducationalMaterial","description","MATERIAL_STATIONARIES","DemoHealthCheckGeneratorService","generateHealthCheckHistoryForChild","previousRecord","height","weight","setNextHeightAndWeight","getAgeAtDate","timeDiff","ageRoundedToHalfYear","round","randomHeight","heightRangeForAge","weightRangeForAge","HealthCheckupComponent","READONLY","bmi","toFixed","loadHealthChecks","newHC","getHealthChecksOfChild","HealthCheck","NoRecentNotesDashboardComponent","sinceDays","fromBeginningOfWeek","daysSinceBeginningOfWeek","startOf","concernedChildren","childrenWithNoteInfoDataSource","loadConcernedChildrenFromIndex","getDaysSinceLastNoteOfEachChild","lastNoteStats","resultChildren","isWithinDayRange","RecentNotesDashboardComponent","DemoNoteConfig","DemoNoteGeneratorService","numberOfNotes","generateNoteForChild","generateGroupNote","note","selectedStory","addChild","author","teamMembers","removeFollowUpMarkerForOldNotes","lastMonths","numberOfTeamMembers","_teamMembers","fill","noteGroupStories","category","subject","text","noteIndividualStories","absenceRemarks","InteractionTypes","INTERACTION_TYPE_COLORS","GUARDIAN_MEETING","CHILDREN_MEETING","RATION_DISTRIBUTION","EXCURSION","DISCUSSION","ANNUAL_SURVEY","DAILY_ROUTINE","MeetingNoteAttendance","presence","remark","Note","color","isMeeting","isPresent","getColor","childIds","ChildMeetingNoteAttendanceComponent","showRemarks","NoteDetailsComponent","interactionTypes","smallScreen","innerWidth","recordForm","childSelectComponent","NotePresenceListComponent","sortEntries","NotesManagerComponent","formDialog","entityList","notesDataSource","standard","mobile","followUpFS","n","dateFS","getPreviousSunday","categoryFS","filterSelectionsDropdown","notesList","notes","sortAndAdd","initCategoryFilter","newNotes","newNote","columnGroup","interaction","weeksBack","noteDialogRef","showDetails","val","addNoteClick","NotesOfChildComponent","initNotesOfChild","getNotesOfChild","NotesModule","PreviousSchoolsComponent","schoolsService","formValidation","validationResult","hasPassedValidation","validationMessage","isAfter","initColumnDefinitions","getSchoolsWithRelations","getSchools","schoolMap","resultColorStyleBuilder","newPreviousSchool","lastToDate","NaN","fromPercent","padding","width","percent","DemoSchoolConfig","DemoSchoolGenerator","medium","streetAddress","phoneNumberFormat","privateSchool","upToClass","academicBoard","timing","School","website","SchoolBlockComponent","initFromEntityId","showDetailsPage","SchoolDetailsComponent","schoolService","studentDataSource","displayedColumns","initializeForm","loadSchool","loadStudents","getChildrenForSchool","assignFormValuesToSchool","SchoolsListComponent","schoolDataSource","mediumFS","privateFS","schoolsList","schoolList","mediums","url","addSchoolClick","SchoolsModule","SchoolsService","db","queryRelationsOf","relation","WarningLevel","WarningLevelColor","CONFLICT_RESOLUTION_STRATEGY","AdminGuard","_sessionService","isLoggedIn","isAdmin","state","AdminModule","AdminComponent","backupService","childPhotoUpdateService","appConfig","alerts","updateChildrenPhotoFilenames","getJsonExport","bac","startDownload","getCsvExport","csv","blob","Blob","saveAs","file","fileReader","FileReader","onload","readAsText","pRestorePoint","pLoadedData","readFile","all","newData","restorePoint","clearDatabase","importJson","importCsv","updatePhotoFilenames","saveBackup","loadBackup","saveCsvExport","loadCsv","debugDatabase","ExportDataComponent","format","blobData","getFormattedBlobData","link","createDownloadLink","click","document","createElement","setAttribute","body","appendChild","href","URL","createObjectURL","download","addEventListener","revokeObjectURL","createJson","createCsv","exportData","BackupService","papa","getAll","res","SEPARATOR_ROW","allFields","element","uniqueFields","Set","unparse","fields","quotes","header","userEntityPrefix","getType","allDocs","p","row","json","forceUpdate","promises","put","parse","parsedCsv","dynamicTyping","skipEmptyLines","propertyName","SEPARATOR_COL","ChildPhotoUpdateService","entityService","httpClient","updatePhotoIfFileExists","checkIfFileExists","fileExists","UserListComponent","debugDetails","setAdmin","AlertDisplay","AlertService","alert","displayAlert","logToConsole","snackConfig","panelClass","display","TEMPORARY","PERSISTENT","notificationRef","openFromComponent","DANGER","INFO","info","DEBUG","addAlert","Alert","AlertsModule","AlertComponent","md5","AnalyticsService","angulartics2Piwik","startTracking","setVersion","action","properties","eventTrack","username","setUsername","getUserHash","setUserProperties","dimension1","appVersion","AppConfigModule","initializeAppConfig","AppConfig","http","CONFIG_FILE","DEFAULT_CONFIG_FILE","loadAppConfigJson","jsonFileLocation","response","ConfigModule","ConfigService","prefix","matchingConfigs","ConfirmationDialogModule","ConfirmationDialogService","yesNoButtons","yesNo","ConfirmationDialogComponent","databaseServiceProvider","getDatabase","Database","MockDatabase","exists","object","overwriteExisting","generateWriteResponse","existingObject","writtenObject","ok","rev","fun","isWithinLastMonths","reducerFun","getStatsReduceFun","setHours","searchIndices","some","word","filterForLatestRelationOfChild","allData","filteredResults","reducedResults","childKey","sorted","aValue","zeroPad","bValue","filtered","slice","str","numberOfMonths","months","keyFun","valueFun","existing","PouchDatabase","_pouchDB","returnUndefined","notifyError","resultArray","forceOverwrite","resolveConflict","query","existingDesignDoc","prebuildViewsOfDesignDoc","viewName","queryName","replace","startTime","indexingTime","newObject","overwriteChanges","existingError","resolvedObject","mergeObjects","DemoDataGeneratingProgressDialogComponent","demoDataService","disableClose","afterOpened","publishDemoData","close","error","details","DemoDataGenerator","_entities","generateEntities","DemoDataModule","demoDataGeneratorProviders","ngModule","dataGeneratorProviders","DemoDataServiceConfig","DemoDataService","injector","dataGenerators","registerAllProvidedDemoDataGenerators","service","generator","CustomFaker","baseFaker","minAge","maxAge","currentYear","latest","earliest","faker","EntitySubrecordModule","ColumnDescriptionInputType","ColumnDescription","inputType","selectValues","formatter","visibleFrom","styleBuilder","recordsEditing","EntitySubrecordComponent","_entityMapper","_snackBar","_confirmationDialog","showAddButton","changedRecordsInEntitySubrecordEvent","recordsDataSource","originalRecords","screenWidth","setupTable","formValidationResult","originalRecord","removeFromDataTable","newRecord","newRecordFactory","showRecord","col","input","allSelectValues","columnsHelpArray","entitySubrecordComponent","isVisible","returnVal","match","getColorForId","KeysPipe","args","enumMember","DatabaseEntity","entityType","constructor","parentConstructor","getPrototypeOf","schema","DatabaseField","propertySchema","Reflect","getMetadata","getOwnPropertyDescriptor","DatabaseIndexingService","_indicesRegistered","indexState","pending","indexCreationPromise","saveDatabaseIndex","indexName","asObservable","EntityMapperService","_db","resultEntity","createPrefixedId","allRecordsOfType","rawData","EntityModule","Entity","getConstructor","newEntityId","substring","arrayEntitySchemaDatatype","transformToDatabaseFormat","isArray","arrayElementDatatype","getDatatypeOrDefault","el","generateSubSchemaField","transformToObjectFormat","arraySchemaField","subSchemaField","dateOnlyEntitySchemaDatatype","padStart","dateEntitySchemaDatatype","defaultEntitySchemaDatatype","monthEntitySchemaDatatype","numberEntitySchemaDatatype","schemaEmbedEntitySchemaDatatype","transformDatabaseToEntityFormat","stringEntitySchemaDatatype","EntitySchemaService","schemaTypes","registerBasicDatatypes","datatypeName","newValue","generateIndex","generateSearchIndices","FilterSelection","defaultFilterFunction","option","getOption","getFilterFunction","valuesToMatchAsOptions","attributeName","FormDialogWrapperComponent","onClose","beforeSave","transformedEntity","_entity","originalEntity","contentForm","dirty","cancel","FormDialogModule","FormDialogService","entityDetailsComponent","componentInstance","dialogWrapper","formDialogWrapper","beforeClosed","activelyClosed","isFormDirty","HelpModule","loader","HowToComponent","AppVersionComponent","changelogDialog","currentVersion","getCurrentVersion","showLatestChanges","ChangelogComponent","latestChangesService","showAdvancedDetails","changelog","changelogs","lastDisplayedVersion","tag_name","getChangelogsBeforeVersion","additionalChangelog","scrollToBottomOfReleases","contentContainer","scrollTop","scrollHeight","loadPreviousRelease","LatestChangesDialogService","cookieService","previousVersion","getChangelogsBetweenVersions","check","COOKIE_NAME","LatestChangesModule","updates","latestChangesDialogService","updateManagerService","showLatestChangesIfUpdated","notifyUserWhenUpdateAvailable","regularlyCheckForUpdates","LatestChangesService","getChangelogs","releases","filterReleasesBetween","relevantReleases","releasesUpToCurrentVersion","releasesBackToPreviousVersion","localeCompare","version","filterReleasesBefore","releaseFilter","GITHUB_API","repositoryId","parseGithubApiRelease","githubResponse","releaseNotesWithoutHeading","releaseNotesWithoutCommitRefs","published_at","UpdateManagerService","appRef","isEnabled","available","showUpdateNotification","appIsStable$","isStable","everyHours$","everyHoursOnceAppIsStable$","checkForUpdate","reload","LogLevel","LoggingErrorHandler","LoggingService","WARN","ERROR","logLevel","logToRemoteMonitoring","translateLogLevel","Debug","Info","Warning","defaultOptions","release","tagName","scope","setTag","MenuItem","icon","routerLinkParameters","NavigationModule","NavigationComponent","adminGuard","CONFIG_ID","menuItems","initMenuItemsFromConfig","getConfig","items","configItem","checkMenuItemPermissions","viewConfig","PREFIX_VIEW_CONFIG","requiresAdmin","LoggedInGuard","LoginComponent","loginInProgress","login","password","loginState","LOGGED_IN","onLoginSuccess","getSyncState","getState","ABORTED","getConnectionState","OFFLINE","onLoginFailure","reason","errorMessage","LocalSession","_alertService","_entitySchemaService","LOGGED_OUT","syncState","UNSYNCED","waitForFirstSync","loadUser","userEntity","checkPassword","currentUser","decryptCloudPassword","setLoggingContextUser","setUser","setState","LOGIN_FAILED","toState","FAILED","isInitial","waitForChangeTo","COMPLETED","doc_count","userId","userData","MockSessionService","connectionState","DISCONNECTED","CONNECTED","sync","REJECTED","STARTED","plugin","RemoteSession","thisRemoteSession","remote_url","ajax","rejectUnauthorized","timeout","fetch","opts","credentials","skip_setup","ajaxOpts","headers","Authorization","btoa","logout","SessionService","SyncedSessionService","_loggingService","_localSession","_remoteSession","cancelLoginOfflineRetry","localLogin","remoteLogin","syncPromise","liveSyncDeferred","_offlineRetryLoginScheduleHandle","batch_size","cancelLiveSync","_liveSyncHandle","live","retry","on","_liveSyncScheduledHandle","liveSync","ConnectionState","LoginState","StateHandler","defaultState","stateChanged","oldState","fromState","failOnStates","subscription","getStateChangedStream","unsubscribe","SyncState","SessionModule","sessionServiceFactory","sessionServiceProvider","BackgroundProcessingIndicatorComponent","backgroundProcesses","summarize","summarizeProcesses","taskCounter","taskListDropdownTrigger","openMenu","closeMenu","processes","accumulator","currentEntry","summaryEntry","SyncStatusModule","InitialSyncDialogComponent","SyncStatusComponent","dbIndexingService","_backgroundProcesses","indicesRegistered","indicesStatus","handleIndexingState","handleSyncState","syncInProgress","updateBackgroundProcessesList","indexingProcesses","currentProcesses","PrimaryActionComponent","createNewNote","primaryAction","searchStringChanged","SearchComponent","showSearchToolbar","isSearching","MIN_CHARACTERS_FOR_SEARCH","INPUT_DEBOUNCE_TIME_MS","searchQuery","createSearchIndex","searchString","startSearch","handleSearchQueryResult","isRelevantSearchInput","searchTerms","optionElement","prepareResults","searchMapFunction","by_name","regexp","RegExp","getResultsWithoutDuplicates","transformDocToEntity","containsSecondarySearchTerms","sortResults","itemKey","join","entityComparison","compareEntityTypes","clickOption","toggleSearchToolbar","UiModule","sideNav","UiComponent","titleService","mediaObserver","sideNavMode","site_name","setTitle","moduleId","DemoUserGeneratorService","demoUser","setNewPassword","demoAdmin","UserAccountComponent","webdavEnabled","webdav","pwd","rpwd","UserModule","User","cloudBaseFolder","cryptKeySize","cryptIterations","cryptSalt","WordArray","hash","keySize","iterations","salt","keysize","cloudPasswordEnc","encrypt","cloudPasswordDec","givenPassword","hashPassword","decrypt","Utf8","blobPassword","RouterService","reloadRouting","additionalRoutes","viewConfigs","getAllConfigs","view","importModulePath","loadChildren","importModuleName","canActivate","resetConfig","ViewModule","CloudFileServiceUserSettingsComponent","webdavUrl","cloudUser","cloudUserName","cloudPassword","userPassword","setErrors","incorrectPassword","processing","setCloudPassword","connect","checkConnection","connectionFailed","updateCloudServiceSettings","CloudFileService","domSanitizer","client","createClient","currentlyGettingList","fileList","fileName","doesFileExist","deleteFile","putFileContents","getFileContents","buffer","tmpContent","fromCharCode","apply","Uint8Array","getDirectoryContents","contents","getDir","list","pop","createDirectory","filePath","bufferArrayToBase64","arrayBuffer","base64String","byte","bypassSecurityTrustUrl","WebdavModule","isValidDate","prototype","call","environment","bootstrapModule"],"mappings":"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","file":"main-es5.js","sourcesContent":["var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","var map = {\n\t\"./af\": \"./node_modules/moment/locale/af.js\",\n\t\"./af.js\": \"./node_modules/moment/locale/af.js\",\n\t\"./ar\": \"./node_modules/moment/locale/ar.js\",\n\t\"./ar-dz\": \"./node_modules/moment/locale/ar-dz.js\",\n\t\"./ar-dz.js\": \"./node_modules/moment/locale/ar-dz.js\",\n\t\"./ar-kw\": \"./node_modules/moment/locale/ar-kw.js\",\n\t\"./ar-kw.js\": \"./node_modules/moment/locale/ar-kw.js\",\n\t\"./ar-ly\": \"./node_modules/moment/locale/ar-ly.js\",\n\t\"./ar-ly.js\": \"./node_modules/moment/locale/ar-ly.js\",\n\t\"./ar-ma\": \"./node_modules/moment/locale/ar-ma.js\",\n\t\"./ar-ma.js\": \"./node_modules/moment/locale/ar-ma.js\",\n\t\"./ar-sa\": \"./node_modules/moment/locale/ar-sa.js\",\n\t\"./ar-sa.js\": \"./node_modules/moment/locale/ar-sa.js\",\n\t\"./ar-tn\": \"./node_modules/moment/locale/ar-tn.js\",\n\t\"./ar-tn.js\": \"./node_modules/moment/locale/ar-tn.js\",\n\t\"./ar.js\": \"./node_modules/moment/locale/ar.js\",\n\t\"./az\": \"./node_modules/moment/locale/az.js\",\n\t\"./az.js\": \"./node_modules/moment/locale/az.js\",\n\t\"./be\": \"./node_modules/moment/locale/be.js\",\n\t\"./be.js\": \"./node_modules/moment/locale/be.js\",\n\t\"./bg\": \"./node_modules/moment/locale/bg.js\",\n\t\"./bg.js\": \"./node_modules/moment/locale/bg.js\",\n\t\"./bm\": \"./node_modules/moment/locale/bm.js\",\n\t\"./bm.js\": \"./node_modules/moment/locale/bm.js\",\n\t\"./bn\": \"./node_modules/moment/locale/bn.js\",\n\t\"./bn.js\": \"./node_modules/moment/locale/bn.js\",\n\t\"./bo\": \"./node_modules/moment/locale/bo.js\",\n\t\"./bo.js\": \"./node_modules/moment/locale/bo.js\",\n\t\"./br\": \"./node_modules/moment/locale/br.js\",\n\t\"./br.js\": \"./node_modules/moment/locale/br.js\",\n\t\"./bs\": \"./node_modules/moment/locale/bs.js\",\n\t\"./bs.js\": \"./node_modules/moment/locale/bs.js\",\n\t\"./ca\": \"./node_modules/moment/locale/ca.js\",\n\t\"./ca.js\": \"./node_modules/moment/locale/ca.js\",\n\t\"./cs\": \"./node_modules/moment/locale/cs.js\",\n\t\"./cs.js\": \"./node_modules/moment/locale/cs.js\",\n\t\"./cv\": \"./node_modules/moment/locale/cv.js\",\n\t\"./cv.js\": \"./node_modules/moment/locale/cv.js\",\n\t\"./cy\": \"./node_modules/moment/locale/cy.js\",\n\t\"./cy.js\": \"./node_modules/moment/locale/cy.js\",\n\t\"./da\": \"./node_modules/moment/locale/da.js\",\n\t\"./da.js\": \"./node_modules/moment/locale/da.js\",\n\t\"./de\": \"./node_modules/moment/locale/de.js\",\n\t\"./de-at\": \"./node_modules/moment/locale/de-at.js\",\n\t\"./de-at.js\": \"./node_modules/moment/locale/de-at.js\",\n\t\"./de-ch\": \"./node_modules/moment/locale/de-ch.js\",\n\t\"./de-ch.js\": \"./node_modules/moment/locale/de-ch.js\",\n\t\"./de.js\": \"./node_modules/moment/locale/de.js\",\n\t\"./dv\": \"./node_modules/moment/locale/dv.js\",\n\t\"./dv.js\": \"./node_modules/moment/locale/dv.js\",\n\t\"./el\": \"./node_modules/moment/locale/el.js\",\n\t\"./el.js\": \"./node_modules/moment/locale/el.js\",\n\t\"./en-au\": \"./node_modules/moment/locale/en-au.js\",\n\t\"./en-au.js\": \"./node_modules/moment/locale/en-au.js\",\n\t\"./en-ca\": \"./node_modules/moment/locale/en-ca.js\",\n\t\"./en-ca.js\": \"./node_modules/moment/locale/en-ca.js\",\n\t\"./en-gb\": \"./node_modules/moment/locale/en-gb.js\",\n\t\"./en-gb.js\": \"./node_modules/moment/locale/en-gb.js\",\n\t\"./en-ie\": \"./node_modules/moment/locale/en-ie.js\",\n\t\"./en-ie.js\": \"./node_modules/moment/locale/en-ie.js\",\n\t\"./en-il\": \"./node_modules/moment/locale/en-il.js\",\n\t\"./en-il.js\": \"./node_modules/moment/locale/en-il.js\",\n\t\"./en-in\": \"./node_modules/moment/locale/en-in.js\",\n\t\"./en-in.js\": \"./node_modules/moment/locale/en-in.js\",\n\t\"./en-nz\": \"./node_modules/moment/locale/en-nz.js\",\n\t\"./en-nz.js\": \"./node_modules/moment/locale/en-nz.js\",\n\t\"./en-sg\": \"./node_modules/moment/locale/en-sg.js\",\n\t\"./en-sg.js\": \"./node_modules/moment/locale/en-sg.js\",\n\t\"./eo\": \"./node_modules/moment/locale/eo.js\",\n\t\"./eo.js\": \"./node_modules/moment/locale/eo.js\",\n\t\"./es\": \"./node_modules/moment/locale/es.js\",\n\t\"./es-do\": \"./node_modules/moment/locale/es-do.js\",\n\t\"./es-do.js\": \"./node_modules/moment/locale/es-do.js\",\n\t\"./es-us\": \"./node_modules/moment/locale/es-us.js\",\n\t\"./es-us.js\": \"./node_modules/moment/locale/es-us.js\",\n\t\"./es.js\": \"./node_modules/moment/locale/es.js\",\n\t\"./et\": \"./node_modules/moment/locale/et.js\",\n\t\"./et.js\": \"./node_modules/moment/locale/et.js\",\n\t\"./eu\": \"./node_modules/moment/locale/eu.js\",\n\t\"./eu.js\": \"./node_modules/moment/locale/eu.js\",\n\t\"./fa\": \"./node_modules/moment/locale/fa.js\",\n\t\"./fa.js\": \"./node_modules/moment/locale/fa.js\",\n\t\"./fi\": \"./node_modules/moment/locale/fi.js\",\n\t\"./fi.js\": \"./node_modules/moment/locale/fi.js\",\n\t\"./fil\": \"./node_modules/moment/locale/fil.js\",\n\t\"./fil.js\": \"./node_modules/moment/locale/fil.js\",\n\t\"./fo\": \"./node_modules/moment/locale/fo.js\",\n\t\"./fo.js\": \"./node_modules/moment/locale/fo.js\",\n\t\"./fr\": \"./node_modules/moment/locale/fr.js\",\n\t\"./fr-ca\": \"./node_modules/moment/locale/fr-ca.js\",\n\t\"./fr-ca.js\": \"./node_modules/moment/locale/fr-ca.js\",\n\t\"./fr-ch\": \"./node_modules/moment/locale/fr-ch.js\",\n\t\"./fr-ch.js\": \"./node_modules/moment/locale/fr-ch.js\",\n\t\"./fr.js\": \"./node_modules/moment/locale/fr.js\",\n\t\"./fy\": \"./node_modules/moment/locale/fy.js\",\n\t\"./fy.js\": \"./node_modules/moment/locale/fy.js\",\n\t\"./ga\": \"./node_modules/moment/locale/ga.js\",\n\t\"./ga.js\": \"./node_modules/moment/locale/ga.js\",\n\t\"./gd\": \"./node_modules/moment/locale/gd.js\",\n\t\"./gd.js\": \"./node_modules/moment/locale/gd.js\",\n\t\"./gl\": \"./node_modules/moment/locale/gl.js\",\n\t\"./gl.js\": \"./node_modules/moment/locale/gl.js\",\n\t\"./gom-deva\": \"./node_modules/moment/locale/gom-deva.js\",\n\t\"./gom-deva.js\": \"./node_modules/moment/locale/gom-deva.js\",\n\t\"./gom-latn\": \"./node_modules/moment/locale/gom-latn.js\",\n\t\"./gom-latn.js\": \"./node_modules/moment/locale/gom-latn.js\",\n\t\"./gu\": \"./node_modules/moment/locale/gu.js\",\n\t\"./gu.js\": \"./node_modules/moment/locale/gu.js\",\n\t\"./he\": \"./node_modules/moment/locale/he.js\",\n\t\"./he.js\": \"./node_modules/moment/locale/he.js\",\n\t\"./hi\": \"./node_modules/moment/locale/hi.js\",\n\t\"./hi.js\": \"./node_modules/moment/locale/hi.js\",\n\t\"./hr\": \"./node_modules/moment/locale/hr.js\",\n\t\"./hr.js\": \"./node_modules/moment/locale/hr.js\",\n\t\"./hu\": \"./node_modules/moment/locale/hu.js\",\n\t\"./hu.js\": \"./node_modules/moment/locale/hu.js\",\n\t\"./hy-am\": \"./node_modules/moment/locale/hy-am.js\",\n\t\"./hy-am.js\": \"./node_modules/moment/locale/hy-am.js\",\n\t\"./id\": \"./node_modules/moment/locale/id.js\",\n\t\"./id.js\": \"./node_modules/moment/locale/id.js\",\n\t\"./is\": \"./node_modules/moment/locale/is.js\",\n\t\"./is.js\": \"./node_modules/moment/locale/is.js\",\n\t\"./it\": \"./node_modules/moment/locale/it.js\",\n\t\"./it-ch\": \"./node_modules/moment/locale/it-ch.js\",\n\t\"./it-ch.js\": \"./node_modules/moment/locale/it-ch.js\",\n\t\"./it.js\": \"./node_modules/moment/locale/it.js\",\n\t\"./ja\": \"./node_modules/moment/locale/ja.js\",\n\t\"./ja.js\": \"./node_modules/moment/locale/ja.js\",\n\t\"./jv\": \"./node_modules/moment/locale/jv.js\",\n\t\"./jv.js\": \"./node_modules/moment/locale/jv.js\",\n\t\"./ka\": \"./node_modules/moment/locale/ka.js\",\n\t\"./ka.js\": \"./node_modules/moment/locale/ka.js\",\n\t\"./kk\": \"./node_modules/moment/locale/kk.js\",\n\t\"./kk.js\": \"./node_modules/moment/locale/kk.js\",\n\t\"./km\": \"./node_modules/moment/locale/km.js\",\n\t\"./km.js\": \"./node_modules/moment/locale/km.js\",\n\t\"./kn\": \"./node_modules/moment/locale/kn.js\",\n\t\"./kn.js\": \"./node_modules/moment/locale/kn.js\",\n\t\"./ko\": \"./node_modules/moment/locale/ko.js\",\n\t\"./ko.js\": \"./node_modules/moment/locale/ko.js\",\n\t\"./ku\": \"./node_modules/moment/locale/ku.js\",\n\t\"./ku.js\": \"./node_modules/moment/locale/ku.js\",\n\t\"./ky\": \"./node_modules/moment/locale/ky.js\",\n\t\"./ky.js\": \"./node_modules/moment/locale/ky.js\",\n\t\"./lb\": \"./node_modules/moment/locale/lb.js\",\n\t\"./lb.js\": \"./node_modules/moment/locale/lb.js\",\n\t\"./lo\": \"./node_modules/moment/locale/lo.js\",\n\t\"./lo.js\": \"./node_modules/moment/locale/lo.js\",\n\t\"./lt\": \"./node_modules/moment/locale/lt.js\",\n\t\"./lt.js\": \"./node_modules/moment/locale/lt.js\",\n\t\"./lv\": \"./node_modules/moment/locale/lv.js\",\n\t\"./lv.js\": \"./node_modules/moment/locale/lv.js\",\n\t\"./me\": \"./node_modules/moment/locale/me.js\",\n\t\"./me.js\": \"./node_modules/moment/locale/me.js\",\n\t\"./mi\": \"./node_modules/moment/locale/mi.js\",\n\t\"./mi.js\": \"./node_modules/moment/locale/mi.js\",\n\t\"./mk\": \"./node_modules/moment/locale/mk.js\",\n\t\"./mk.js\": \"./node_modules/moment/locale/mk.js\",\n\t\"./ml\": \"./node_modules/moment/locale/ml.js\",\n\t\"./ml.js\": \"./node_modules/moment/locale/ml.js\",\n\t\"./mn\": \"./node_modules/moment/locale/mn.js\",\n\t\"./mn.js\": \"./node_modules/moment/locale/mn.js\",\n\t\"./mr\": \"./node_modules/moment/locale/mr.js\",\n\t\"./mr.js\": \"./node_modules/moment/locale/mr.js\",\n\t\"./ms\": \"./node_modules/moment/locale/ms.js\",\n\t\"./ms-my\": \"./node_modules/moment/locale/ms-my.js\",\n\t\"./ms-my.js\": \"./node_modules/moment/locale/ms-my.js\",\n\t\"./ms.js\": \"./node_modules/moment/locale/ms.js\",\n\t\"./mt\": \"./node_modules/moment/locale/mt.js\",\n\t\"./mt.js\": \"./node_modules/moment/locale/mt.js\",\n\t\"./my\": \"./node_modules/moment/locale/my.js\",\n\t\"./my.js\": \"./node_modules/moment/locale/my.js\",\n\t\"./nb\": \"./node_modules/moment/locale/nb.js\",\n\t\"./nb.js\": \"./node_modules/moment/locale/nb.js\",\n\t\"./ne\": \"./node_modules/moment/locale/ne.js\",\n\t\"./ne.js\": \"./node_modules/moment/locale/ne.js\",\n\t\"./nl\": \"./node_modules/moment/locale/nl.js\",\n\t\"./nl-be\": \"./node_modules/moment/locale/nl-be.js\",\n\t\"./nl-be.js\": \"./node_modules/moment/locale/nl-be.js\",\n\t\"./nl.js\": \"./node_modules/moment/locale/nl.js\",\n\t\"./nn\": \"./node_modules/moment/locale/nn.js\",\n\t\"./nn.js\": \"./node_modules/moment/locale/nn.js\",\n\t\"./oc-lnc\": \"./node_modules/moment/locale/oc-lnc.js\",\n\t\"./oc-lnc.js\": \"./node_modules/moment/locale/oc-lnc.js\",\n\t\"./pa-in\": \"./node_modules/moment/locale/pa-in.js\",\n\t\"./pa-in.js\": \"./node_modules/moment/locale/pa-in.js\",\n\t\"./pl\": \"./node_modules/moment/locale/pl.js\",\n\t\"./pl.js\": \"./node_modules/moment/locale/pl.js\",\n\t\"./pt\": \"./node_modules/moment/locale/pt.js\",\n\t\"./pt-br\": \"./node_modules/moment/locale/pt-br.js\",\n\t\"./pt-br.js\": \"./node_modules/moment/locale/pt-br.js\",\n\t\"./pt.js\": \"./node_modules/moment/locale/pt.js\",\n\t\"./ro\": \"./node_modules/moment/locale/ro.js\",\n\t\"./ro.js\": \"./node_modules/moment/locale/ro.js\",\n\t\"./ru\": \"./node_modules/moment/locale/ru.js\",\n\t\"./ru.js\": \"./node_modules/moment/locale/ru.js\",\n\t\"./sd\": \"./node_modules/moment/locale/sd.js\",\n\t\"./sd.js\": \"./node_modules/moment/locale/sd.js\",\n\t\"./se\": \"./node_modules/moment/locale/se.js\",\n\t\"./se.js\": \"./node_modules/moment/locale/se.js\",\n\t\"./si\": \"./node_modules/moment/locale/si.js\",\n\t\"./si.js\": \"./node_modules/moment/locale/si.js\",\n\t\"./sk\": \"./node_modules/moment/locale/sk.js\",\n\t\"./sk.js\": \"./node_modules/moment/locale/sk.js\",\n\t\"./sl\": \"./node_modules/moment/locale/sl.js\",\n\t\"./sl.js\": \"./node_modules/moment/locale/sl.js\",\n\t\"./sq\": \"./node_modules/moment/locale/sq.js\",\n\t\"./sq.js\": \"./node_modules/moment/locale/sq.js\",\n\t\"./sr\": \"./node_modules/moment/locale/sr.js\",\n\t\"./sr-cyrl\": \"./node_modules/moment/locale/sr-cyrl.js\",\n\t\"./sr-cyrl.js\": \"./node_modules/moment/locale/sr-cyrl.js\",\n\t\"./sr.js\": \"./node_modules/moment/locale/sr.js\",\n\t\"./ss\": \"./node_modules/moment/locale/ss.js\",\n\t\"./ss.js\": \"./node_modules/moment/locale/ss.js\",\n\t\"./sv\": \"./node_modules/moment/locale/sv.js\",\n\t\"./sv.js\": \"./node_modules/moment/locale/sv.js\",\n\t\"./sw\": \"./node_modules/moment/locale/sw.js\",\n\t\"./sw.js\": \"./node_modules/moment/locale/sw.js\",\n\t\"./ta\": \"./node_modules/moment/locale/ta.js\",\n\t\"./ta.js\": \"./node_modules/moment/locale/ta.js\",\n\t\"./te\": \"./node_modules/moment/locale/te.js\",\n\t\"./te.js\": \"./node_modules/moment/locale/te.js\",\n\t\"./tet\": \"./node_modules/moment/locale/tet.js\",\n\t\"./tet.js\": \"./node_modules/moment/locale/tet.js\",\n\t\"./tg\": \"./node_modules/moment/locale/tg.js\",\n\t\"./tg.js\": \"./node_modules/moment/locale/tg.js\",\n\t\"./th\": \"./node_modules/moment/locale/th.js\",\n\t\"./th.js\": \"./node_modules/moment/locale/th.js\",\n\t\"./tk\": \"./node_modules/moment/locale/tk.js\",\n\t\"./tk.js\": \"./node_modules/moment/locale/tk.js\",\n\t\"./tl-ph\": \"./node_modules/moment/locale/tl-ph.js\",\n\t\"./tl-ph.js\": \"./node_modules/moment/locale/tl-ph.js\",\n\t\"./tlh\": \"./node_modules/moment/locale/tlh.js\",\n\t\"./tlh.js\": \"./node_modules/moment/locale/tlh.js\",\n\t\"./tr\": \"./node_modules/moment/locale/tr.js\",\n\t\"./tr.js\": \"./node_modules/moment/locale/tr.js\",\n\t\"./tzl\": \"./node_modules/moment/locale/tzl.js\",\n\t\"./tzl.js\": \"./node_modules/moment/locale/tzl.js\",\n\t\"./tzm\": \"./node_modules/moment/locale/tzm.js\",\n\t\"./tzm-latn\": \"./node_modules/moment/locale/tzm-latn.js\",\n\t\"./tzm-latn.js\": \"./node_modules/moment/locale/tzm-latn.js\",\n\t\"./tzm.js\": \"./node_modules/moment/locale/tzm.js\",\n\t\"./ug-cn\": \"./node_modules/moment/locale/ug-cn.js\",\n\t\"./ug-cn.js\": \"./node_modules/moment/locale/ug-cn.js\",\n\t\"./uk\": \"./node_modules/moment/locale/uk.js\",\n\t\"./uk.js\": \"./node_modules/moment/locale/uk.js\",\n\t\"./ur\": \"./node_modules/moment/locale/ur.js\",\n\t\"./ur.js\": \"./node_modules/moment/locale/ur.js\",\n\t\"./uz\": \"./node_modules/moment/locale/uz.js\",\n\t\"./uz-latn\": \"./node_modules/moment/locale/uz-latn.js\",\n\t\"./uz-latn.js\": \"./node_modules/moment/locale/uz-latn.js\",\n\t\"./uz.js\": \"./node_modules/moment/locale/uz.js\",\n\t\"./vi\": \"./node_modules/moment/locale/vi.js\",\n\t\"./vi.js\": \"./node_modules/moment/locale/vi.js\",\n\t\"./x-pseudo\": \"./node_modules/moment/locale/x-pseudo.js\",\n\t\"./x-pseudo.js\": \"./node_modules/moment/locale/x-pseudo.js\",\n\t\"./yo\": \"./node_modules/moment/locale/yo.js\",\n\t\"./yo.js\": \"./node_modules/moment/locale/yo.js\",\n\t\"./zh-cn\": \"./node_modules/moment/locale/zh-cn.js\",\n\t\"./zh-cn.js\": \"./node_modules/moment/locale/zh-cn.js\",\n\t\"./zh-hk\": \"./node_modules/moment/locale/zh-hk.js\",\n\t\"./zh-hk.js\": \"./node_modules/moment/locale/zh-hk.js\",\n\t\"./zh-mo\": \"./node_modules/moment/locale/zh-mo.js\",\n\t\"./zh-mo.js\": \"./node_modules/moment/locale/zh-mo.js\",\n\t\"./zh-tw\": \"./node_modules/moment/locale/zh-tw.js\",\n\t\"./zh-tw.js\": \"./node_modules/moment/locale/zh-tw.js\"\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = \"./node_modules/moment/locale sync recursive ^\\\\.\\\\/.*$\";","function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = \"./src/$$_lazy_route_resource lazy recursive\";","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { Component, OnInit, ViewContainerRef } from \"@angular/core\";\nimport { AppConfig } from \"./core/app-config/app-config\";\nimport { MatDialog } from \"@angular/material/dialog\";\nimport { DemoDataGeneratingProgressDialogComponent } from \"./core/demo-data/demo-data-generating-progress-dialog.component\";\nimport { AnalyticsService } from \"./core/analytics/analytics.service\";\n\n/**\n * Component as the main entry point for the app.\n * Actual logic and UI structure is defined in other modules.\n */\n@Component({\n  selector: \"app-root\",\n  template: \"<app-ui></app-ui>\",\n})\nexport class AppComponent implements OnInit {\n  constructor(\n    private viewContainerRef: ViewContainerRef, // need this small hack in order to catch application root view container ref\n    private dialog: MatDialog,\n    private analyticsService: AnalyticsService\n  ) {\n    analyticsService.init();\n  }\n\n  ngOnInit() {\n    this.loadDemoData();\n  }\n\n  // TODO: move loading of demo data to a more suitable place\n  private loadDemoData() {\n    if (AppConfig.settings.database.useTemporaryDatabase) {\n      DemoDataGeneratingProgressDialogComponent.loadDemoDataWithLoadingDialog(\n        this.dialog\n      );\n    }\n  }\n}\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { BrowserModule } from \"@angular/platform-browser\";\nimport { BrowserAnimationsModule } from \"@angular/platform-browser/animations\";\nimport { APP_INITIALIZER, ErrorHandler, NgModule } from \"@angular/core\";\nimport { FormsModule } from \"@angular/forms\";\nimport { HttpClientModule } from \"@angular/common/http\";\n\nimport { AppComponent } from \"./app.component\";\nimport { UiModule } from \"./core/ui/ui.module\";\nimport { AppConfigModule } from \"./core/app-config/app-config.module\";\nimport { routing } from \"./app.routing\";\nimport { AlertsModule } from \"./core/alerts/alerts.module\";\nimport { SessionModule } from \"./core/session/session.module\";\nimport { SyncStatusModule } from \"./core/sync-status/sync-status.module\";\nimport { NavigationModule } from \"./core/navigation/navigation.module\";\nimport { LatestChangesModule } from \"./core/latest-changes/latest-changes.module\";\nimport { UserModule } from \"./core/user/user.module\";\n\nimport { DashboardModule } from \"./child-dev-project/dashboard/dashboard.module\";\nimport { ChildrenModule } from \"./child-dev-project/children/children.module\";\nimport { SchoolsModule } from \"./child-dev-project/schools/schools.module\";\nimport { FlexLayoutModule } from \"@angular/flex-layout\";\nimport { ServiceWorkerModule } from \"@angular/service-worker\";\nimport { environment } from \"../environments/environment\";\nimport { MatIconModule, MatIconRegistry } from \"@angular/material/icon\";\nimport { AdminModule } from \"./core/admin/admin.module\";\nimport { EntityModule } from \"./core/entity/entity.module\";\nimport { CookieService } from \"ngx-cookie-service\";\nimport { HelpModule } from \"./core/help/help.module\";\nimport { DemoDataModule } from \"./core/demo-data/demo-data.module\";\nimport { MatNativeDateModule } from \"@angular/material/core\";\nimport { LoggingErrorHandler } from \"./core/logging/logging-error-handler\";\nimport { DemoChildGenerator } from \"./child-dev-project/children/demo-data-generators/demo-child-generator.service\";\nimport { DemoSchoolGenerator } from \"./child-dev-project/schools/demo-school-generator.service\";\nimport { DemoChildSchoolRelationGenerator } from \"./child-dev-project/children/demo-data-generators/demo-child-school-relation-generator.service\";\nimport { DemoAttendanceGenerator } from \"./child-dev-project/attendance/demo-attendance-generator.service\";\nimport { DemoNoteGeneratorService } from \"./child-dev-project/notes/demo-data/demo-note-generator.service\";\nimport { DemoAserGeneratorService } from \"./child-dev-project/aser/demo-aser-generator.service\";\nimport { DemoEducationalMaterialGeneratorService } from \"./child-dev-project/educational-material/demo-educational-material-generator.service\";\nimport { DemoHealthCheckGeneratorService } from \"./child-dev-project/health-checkup/demo-data/demo-health-check-generator.service\";\nimport { DemoWidgetGeneratorService } from \"./child-dev-project/dashboard/demo-widget-generator.service\";\nimport { DemoUserGeneratorService } from \"./core/user/demo-user-generator.service\";\nimport { ConfirmationDialogModule } from \"./core/confirmation-dialog/confirmation-dialog.module\";\nimport { FormDialogModule } from \"./core/form-dialog/form-dialog.module\";\nimport { LoggingService } from \"./core/logging/logging.service\";\nimport { Angulartics2Module } from \"angulartics2\";\nimport { AnalyticsService } from \"./core/analytics/analytics.service\";\nimport { Angulartics2Piwik } from \"angulartics2/piwik\";\nimport { ConfigService } from \"./core/config/config.service\";\nimport { ViewModule } from \"./core/view/view.module\";\nimport { RouterService } from \"./core/view/router.service\";\n\nexport function configFactory(configService: ConfigService) {\n  return (): Promise<any> => configService.loadConfig();\n}\n\n/**\n * Main entry point of the application.\n * Imports required modules and does basic setup.\n * Real functionality should be implemented in separate modules and imported here rather than being part of this module.\n */\n@NgModule({\n  declarations: [AppComponent],\n  imports: [\n    ServiceWorkerModule.register(\"/ngsw-worker.js\", {\n      enabled: environment.production,\n    }),\n    Angulartics2Module.forRoot({\n      developerMode: !environment.production,\n    }),\n    BrowserModule,\n    BrowserAnimationsModule,\n    FlexLayoutModule,\n    HttpClientModule,\n    routing,\n    ViewModule,\n    FormsModule,\n    ConfirmationDialogModule,\n    FormDialogModule,\n    AlertsModule,\n    EntityModule,\n    AppConfigModule,\n    SessionModule,\n    UiModule,\n    SyncStatusModule,\n    LatestChangesModule,\n    NavigationModule,\n    UserModule,\n    DashboardModule,\n    ChildrenModule,\n    SchoolsModule,\n    AdminModule,\n    MatIconModule,\n    HelpModule,\n    MatNativeDateModule,\n    DemoDataModule.forRoot([\n      ...DemoChildGenerator.provider({ count: 150 }),\n      ...DemoSchoolGenerator.provider({ count: 8 }),\n      ...DemoChildSchoolRelationGenerator.provider(),\n      ...DemoAttendanceGenerator.provider(),\n      ...DemoNoteGeneratorService.provider({\n        minNotesPerChild: 2,\n        maxNotesPerChild: 10,\n        groupNotes: 3,\n      }),\n      ...DemoAserGeneratorService.provider(),\n      ...DemoEducationalMaterialGeneratorService.provider({\n        minCount: 3,\n        maxCount: 8,\n      }),\n      ...DemoHealthCheckGeneratorService.provider(),\n      ...DemoWidgetGeneratorService.provider(),\n      ...DemoUserGeneratorService.provider(),\n    ]),\n  ],\n  providers: [\n    { provide: ErrorHandler, useClass: LoggingErrorHandler },\n    MatIconRegistry,\n    CookieService,\n    AnalyticsService,\n    Angulartics2Piwik,\n    ConfigService,\n    {\n      provide: APP_INITIALIZER,\n      useFactory: configFactory,\n      deps: [ConfigService],\n      multi: true,\n    },\n  ],\n  bootstrap: [AppComponent],\n})\nexport class AppModule {\n  constructor(\n    public matIconRegistry: MatIconRegistry,\n    private routerService: RouterService\n  ) {\n    matIconRegistry.registerFontClassAlias(\"fontawesome\", \"fa\");\n    matIconRegistry.setDefaultFontSetClass(\"fa\");\n\n    routerService.initRouting();\n  }\n}\n\n// Initialize remote logging\nLoggingService.initRemoteLogging({\n  dsn: environment.remoteLoggingDsn,\n  whitelistUrls: [/https?:\\/\\/(.*)\\.?aam-digital\\.com/],\n});\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { RouterModule, Routes } from \"@angular/router\";\nimport { ModuleWithProviders } from \"@angular/core\";\nimport { DashboardComponent } from \"./child-dev-project/dashboard/dashboard/dashboard.component\";\nimport { SchoolsListComponent } from \"./child-dev-project/schools/schools-list/schools-list.component\";\nimport { SchoolDetailsComponent } from \"./child-dev-project/schools/school-details/school-details.component\";\nimport { ChildDetailsComponent } from \"./child-dev-project/children/child-details/child-details.component\";\nimport { UserAccountComponent } from \"./core/user/user-account/user-account.component\";\nimport { ChildrenListComponent } from \"./child-dev-project/children/children-list/children-list.component\";\nimport { ChildAttendanceComponent } from \"./child-dev-project/attendance/child-attendance/child-attendance.component\";\nimport { AdminComponent } from \"./core/admin/admin/admin.component\";\nimport { AdminGuard } from \"./core/admin/admin.guard\";\nimport { NotesManagerComponent } from \"./child-dev-project/notes/notes-manager/notes-manager.component\";\nimport { AddMonthAttendanceComponent } from \"./child-dev-project/attendance/add-month-attendance/add-month-attendance.component\";\nimport { AddDayAttendanceComponent } from \"./child-dev-project/attendance/add-day-attendance/add-day-attendance.component\";\nimport { AttendanceManagerComponent } from \"./child-dev-project/attendance/attendance-manager/attendance-manager.component\";\nimport { HowToComponent } from \"./core/help/how-to/how-to.component\";\nimport { UserListComponent } from \"./core/admin/user-list/user-list.component\";\nimport { AttendanceAnalysisComponent } from \"./child-dev-project/attendance/attendance-analysis/attendance-analysis.component\";\n\nexport const COMPONENT_MAP = {\n  Dashboard: DashboardComponent,\n  UserAccount: UserAccountComponent,\n  NotesManager: NotesManagerComponent,\n  UserList: UserListComponent,\n  Help: HowToComponent,\n  AttendanceManager: AttendanceManagerComponent,\n  AddMonthAttendance: AddMonthAttendanceComponent,\n  AddDayAttendance: AddDayAttendanceComponent,\n  AttendanceAnalysis: AttendanceAnalysisComponent,\n  SchoolsList: SchoolsListComponent,\n  SchoolDetails: SchoolDetailsComponent,\n  ChildrenList: ChildrenListComponent,\n  ChildDetails: ChildDetailsComponent,\n  ChildAttendance: ChildAttendanceComponent,\n  Admin: AdminComponent,\n\n  \"conflict-resolution.module\": () =>\n    import(\"./conflict-resolution/conflict-resolution.module\"),\n};\n\n/**\n * All routes configured for the main app routing.\n */\nexport const routes: Routes = [\n  // routes are added dynamically by the RouterService\n  { path: \"**\", redirectTo: \"/\" },\n];\n\n/**\n * Main app RouterModule with centrally configured routes.\n */\nexport const routing: ModuleWithProviders = RouterModule.forRoot(routes);\n","import { Component, OnInit } from \"@angular/core\";\nimport { ActivatedRoute } from \"@angular/router\";\nimport { DatePipe } from \"@angular/common\";\nimport { Aser } from \"../model/aser\";\nimport { ColumnDescription } from \"../../../core/entity-subrecord/entity-subrecord/column-description\";\nimport { ChildrenService } from \"../../children/children.service\";\nimport { ColumnDescriptionInputType } from \"../../../core/entity-subrecord/entity-subrecord/column-description-input-type.enum\";\nimport { UntilDestroy, untilDestroyed } from \"@ngneat/until-destroy\";\n\n@UntilDestroy()\n@Component({\n  selector: \"app-aser\",\n  template:\n    '<app-entity-subrecord [records]=\"records\" [columns]=\"columns\" [newRecordFactory]=\"generateNewRecordFactory()\">' +\n    \"</app-entity-subrecord>\",\n})\nexport class AserComponent implements OnInit {\n  childId: string;\n  records: Array<Aser>;\n\n  columns: Array<ColumnDescription> = [\n    new ColumnDescription(\n      \"date\",\n      \"Date\",\n      ColumnDescriptionInputType.DATE,\n      null,\n      (v: Date) => this.datePipe.transform(v, \"yyyy-MM-dd\"),\n      \"xs\"\n    ),\n    new ColumnDescription(\n      \"math\",\n      \"Math\",\n      ColumnDescriptionInputType.SELECT,\n      Aser.MathLevels.map((s) => {\n        return { value: s, label: s };\n      }),\n      undefined,\n      \"xs\"\n    ),\n    new ColumnDescription(\n      \"english\",\n      \"English\",\n      ColumnDescriptionInputType.SELECT,\n      Aser.ReadingLevels.map((s) => {\n        return { value: s, label: s };\n      }),\n      undefined,\n      \"xs\"\n    ),\n    new ColumnDescription(\n      \"hindi\",\n      \"Hindi\",\n      ColumnDescriptionInputType.SELECT,\n      Aser.ReadingLevels.map((s) => {\n        return { value: s, label: s };\n      }),\n      undefined,\n      \"md\"\n    ),\n    new ColumnDescription(\n      \"bengali\",\n      \"Bengali\",\n      ColumnDescriptionInputType.SELECT,\n      Aser.ReadingLevels.map((s) => {\n        return { value: s, label: s };\n      }),\n      undefined,\n      \"md\"\n    ),\n    new ColumnDescription(\n      \"remarks\",\n      \"Remarks\",\n      ColumnDescriptionInputType.TEXT,\n      null,\n      undefined,\n      \"md\"\n    ),\n  ];\n\n  constructor(\n    private route: ActivatedRoute,\n    private childrenService: ChildrenService,\n    private datePipe: DatePipe\n  ) {}\n\n  ngOnInit() {\n    this.route.paramMap.pipe(untilDestroyed(this)).subscribe((params) => {\n      this.childId = params.get(\"id\").toString();\n      this.loadData(this.childId);\n    });\n  }\n\n  loadData(id: string) {\n    this.childrenService\n      .getAserResultsOfChild(id)\n      .pipe(untilDestroyed(this))\n      .subscribe((results) => {\n        this.records = results.sort(\n          (a, b) =>\n            (b.date ? b.date.valueOf() : 0) - (a.date ? a.date.valueOf() : 0)\n        );\n      });\n  }\n\n  generateNewRecordFactory() {\n    // define values locally because \"this\" is a different scope after passing a function as input to another component\n    const child = this.childId;\n\n    return () => {\n      const newAtt = new Aser(Date.now().toString());\n      newAtt.date = new Date();\n      newAtt.child = child;\n\n      return newAtt;\n    };\n  }\n}\n","import { DemoChildGenerator } from \"../children/demo-data-generators/demo-child-generator.service\";\nimport { DemoDataGenerator } from \"../../core/demo-data/demo-data-generator\";\nimport { Injectable } from \"@angular/core\";\nimport { Child } from \"../children/model/child\";\nimport { faker } from \"../../core/demo-data/faker\";\nimport { WarningLevel } from \"../warning-level\";\nimport { Aser } from \"./model/aser\";\n\n/**\n * Generate ASER results every 12 months for each Child until passing.\n * Builds upon the generated demo Child entities.\n */\n@Injectable()\nexport class DemoAserGeneratorService extends DemoDataGenerator<Aser> {\n  /**\n   * This function returns a provider object to be used in an Angular Module configuration:\n   *   `providers: [DemoAserGeneratorService.provider()]`\n   */\n  static provider() {\n    return [\n      { provide: DemoAserGeneratorService, useClass: DemoAserGeneratorService },\n    ];\n  }\n\n  constructor(private demoChildren: DemoChildGenerator) {\n    super();\n  }\n\n  public generateEntities(): Aser[] {\n    const data = [];\n\n    for (const child of this.demoChildren.entities) {\n      data.push(...this.generateAserResultsForChild(child));\n    }\n\n    return data;\n  }\n\n  private generateAserResultsForChild(child: Child): Aser[] {\n    const data = [];\n\n    let date = new Date(child.admissionDate.getTime());\n    let previousResult = new Aser(\"\");\n    const firstLanguage = child.motherTongue.toLowerCase();\n    do {\n      const aserResult = new Aser(faker.random.uuid());\n      aserResult.child = child.getId();\n      aserResult.date = date;\n      aserResult.math = this.selectNextSkillLevel(\n        Aser.MathLevels,\n        previousResult.math\n      );\n      aserResult.english = this.selectNextSkillLevel(\n        Aser.ReadingLevels,\n        previousResult.english\n      );\n      aserResult[firstLanguage] = this.selectNextSkillLevel(\n        Aser.ReadingLevels,\n        previousResult[firstLanguage]\n      );\n\n      data.push(aserResult);\n\n      date = new Date(date.getFullYear() + 1, 2, 1);\n      previousResult = aserResult;\n    } while (\n      date < faker.getEarlierDateOrToday(child.dropoutDate) &&\n      previousResult.getWarningLevel() !== WarningLevel.OK\n    );\n\n    return data;\n  }\n\n  /**\n   * Randomly select the next Aser level for a skill based on the previous result.\n   * @param skillRange The array of skill levels for the desired subject (Aser.MathLevels or Aser.ReadingLevels)\n   * @param previousSkillLevel The string indicating the level from the previous test for this subject\n   */\n  private selectNextSkillLevel(\n    skillRange: string[],\n    previousSkillLevel: string\n  ): string {\n    const previousSkillLevelIndex = skillRange.indexOf(previousSkillLevel);\n\n    let nextSkillLevelIndex;\n    const random = faker.random.number(100);\n    if (random < 20) {\n      nextSkillLevelIndex = previousSkillLevelIndex;\n    } else if (random < 90) {\n      nextSkillLevelIndex = previousSkillLevelIndex + 1;\n    } else {\n      nextSkillLevelIndex = previousSkillLevelIndex + 2;\n    }\n\n    return skillRange[this.trimToValidIndex(nextSkillLevelIndex, skillRange)];\n  }\n\n  /**\n   * Convert the given number to a valid index of the array by capping it to a range of [0, array.lenght -1]\n   * @param index\n   * @param array\n   */\n  private trimToValidIndex(index: number, array: any[]) {\n    if (index < 0) {\n      return 0;\n    }\n    return Math.min(index, array.length - 1);\n  }\n}\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { Entity } from \"../../../core/entity/entity\";\nimport { WarningLevel } from \"../../warning-level\";\nimport { DatabaseField } from \"../../../core/entity/database-field.decorator\";\nimport { DatabaseEntity } from \"../../../core/entity/database-entity.decorator\";\n\n@DatabaseEntity(\"Aser\")\nexport class Aser extends Entity {\n  static ReadingLevels = [\n    \"Nothing\",\n    \"Read Letters\",\n    \"Read Words\",\n    \"Read Sentence\",\n    \"Read Paragraph\",\n  ];\n  static MathLevels = [\n    \"Nothing\",\n    \"Numbers 1-9\",\n    \"Numbers 10-99\",\n    \"Subtraction\",\n    \"Division\",\n  ];\n\n  static isReadingPassedOrNA(level: string) {\n    if (level === \"\" || level === undefined) {\n      // not applicable\n      return true;\n    }\n    if (level === this.ReadingLevels[4]) {\n      // passed highest level\n      return true;\n    }\n    return false;\n  }\n  static isMathPassedOrNA(level: string) {\n    if (level === \"\" || level === undefined) {\n      // not applicable\n      return true;\n    }\n    if (level === this.MathLevels[4]) {\n      // passed highest level\n      return true;\n    }\n    return false;\n  }\n\n  @DatabaseField() child: string; // id of Child entity\n  @DatabaseField() date: Date = new Date();\n  @DatabaseField() hindi: string = \"\";\n  @DatabaseField() bengali: string = \"\";\n  @DatabaseField() english: string = \"\";\n  @DatabaseField() math: string = \"\";\n  @DatabaseField() remarks: string = \"\";\n\n  getWarningLevel(): WarningLevel {\n    let warningLevel = WarningLevel.NONE;\n\n    if (\n      Aser.isReadingPassedOrNA(this.english) &&\n      Aser.isReadingPassedOrNA(this.hindi) &&\n      Aser.isReadingPassedOrNA(this.bengali) &&\n      Aser.isMathPassedOrNA(this.math)\n    ) {\n      warningLevel = WarningLevel.OK;\n    } else {\n      warningLevel = WarningLevel.WARNING;\n    }\n\n    return warningLevel;\n  }\n}\n","import { Component } from \"@angular/core\";\nimport { Child } from \"../../children/model/child\";\n\n@Component({\n  selector: \"app-add-day-attendance\",\n  templateUrl: \"./add-day-attendance.component.html\",\n  styleUrls: [\"./add-day-attendance.component.scss\"],\n})\nexport class AddDayAttendanceComponent {\n  currentStage = 0;\n\n  day = new Date();\n  attendanceType: string;\n  students: Child[] = [];\n\n  stages = [\"Setup Roll Call\", \"Select Student Group\", \"Roll Call\"];\n\n  constructor() {}\n\n  finishBasicInformationStage() {\n    this.currentStage = 1;\n  }\n\n  finishStudentSelectionStage(selectedStudents: Child[]) {\n    this.students = selectedStudents;\n\n    this.currentStage = 2;\n  }\n\n  finishRollCallState() {\n    this.currentStage = 0;\n  }\n}\n","<h1>Add Daily Attendance</h1>\n<h2>{{stages[currentStage]}}</h2>\n\n\n<div *ngIf='currentStage===0' fxLayout='column' fxLayoutAlign='space-around start'>\n  <mat-form-field>\n    <input matInput placeholder=\"Date\" [value]='day' (dateChange)='day=$event.target.value' [matDatepicker]=\"addDayAttendanceDatepicker\">\n    <mat-datepicker-toggle matSuffix [for]=\"addDayAttendanceDatepicker\"></mat-datepicker-toggle>\n    <mat-datepicker #addDayAttendanceDatepicker></mat-datepicker>\n  </mat-form-field>\n\n  <div class='form-field' fxFlex>\n    <mat-button-toggle-group name=\"attendanceType\" [(ngModel)]=\"attendanceType\">\n      <mat-button-toggle value=\"school\">School Attendance</mat-button-toggle>\n      <mat-button-toggle value=\"coaching\">Coaching Attendance</mat-button-toggle>\n    </mat-button-toggle-group>\n  </div>\n\n  <button mat-stroked-button (click)='finishBasicInformationStage()' [disabled]='!attendanceType || !day' fxFlex>\n    Continue\n  </button>\n</div>\n\n\n<div *ngIf='currentStage===1' fxLayout='column'>\n  <app-select-group-children (valueChange)='finishStudentSelectionStage($event)'>\n  </app-select-group-children>\n\n\n  <button mat-stroked-button (click)='currentStage = currentStage - 1' class='nav-button' fxFlex>\n    Back\n  </button>\n</div>\n\n\n\n\n<div *ngIf='currentStage===2'>\n  <app-roll-call [day]='day' [attendanceType]='attendanceType' [students]='students'\n                 (complete)='finishRollCallState()'>\n  </app-roll-call>\n</div>\n","<div *ngIf='isLoading'>\n  <mat-progress-bar mode=\"indeterminate\"></mat-progress-bar>\n  <div>Loading attendance list ...</div>\n</div>\n\n<div *ngIf='!isLoading'>\n\n  <!-- Individual Student's Page -->\n  <div *ngFor='let entry of rollCallList; let i = index' [ngClass]='{\"hidden\": (currentIndex!==i)}'>\n    <app-child-block [entity]='entry.child'></app-child-block>\n\n    <div fxLayout='column' fxLayoutAlign='space-between stretch' class='options-wrapper'>\n      <div class='group-select-option'\n           (click)='markAttendance(AttStatus.PRESENT)'\n           [ngClass]=\"{'attendance-P': entry.attendanceDay.status===AttStatus.PRESENT}\">\n        <span class='fa fa-check' *ngIf='entry.attendanceDay.status===AttStatus.PRESENT'></span>\n        Present\n      </div>\n      <div class='group-select-option'\n           (click)='markAttendance(AttStatus.ABSENT)'\n           [ngClass]=\"{'attendance-A': entry.attendanceDay.status===AttStatus.ABSENT}\">\n        <span class='fa fa-check' *ngIf='entry.attendanceDay.status===AttStatus.ABSENT'></span>\n        Absent\n      </div>\n      <div class='group-select-option'\n           (click)='markAttendance(AttStatus.LATE)'\n           [ngClass]=\"{'attendance-L': entry.attendanceDay.status===AttStatus.LATE}\">\n        <span class='fa fa-check' *ngIf='entry.attendanceDay.status===AttStatus.LATE'></span>\n        Late\n      </div>\n      <div class='group-select-option'\n           (click)='markAttendance(AttStatus.HOLIDAY)'\n           [ngClass]=\"{'attendance-H': entry.attendanceDay.status===AttStatus.HOLIDAY}\">\n        <span class='fa fa-check' *ngIf='entry.attendanceDay.status===AttStatus.HOLIDAY'></span>\n        Holiday\n      </div>\n      <div class='group-select-option'\n           (click)='markAttendance(AttStatus.EXCUSED)'\n           [ngClass]=\"{'attendance-E': entry.attendanceDay.status===AttStatus.EXCUSED}\">\n        <span class='fa fa-check' *ngIf='entry.attendanceDay.status===AttStatus.EXCUSED'></span>\n        Excused\n      </div>\n      <div class='group-select-option'\n           (click)='markAttendance(AttStatus.UNKNOWN)'\n           [ngClass]=\"{'attendance-U': entry.attendanceDay.status===AttStatus.UNKNOWN}\">\n        Skip\n      </div>\n    </div>\n\n  </div>\n\n\n  <!-- Completion Page -->\n  <div *ngIf='isFinished()' class='roll-call-complete' [@completeRollCall]>\n    <span class='fa fa-check-circle-o roll-call-complete-icon'></span><br>\n    Roll call completed.\n  </div>\n\n\n  <!-- Control Buttons -->\n  <div>\n    <button mat-stroked-button [disabled]='currentIndex < 1' (click)='currentIndex = currentIndex - 1'\n            class='nav-button' fxFlex>\n      Back\n    </button>\n\n    <button mat-stroked-button *ngIf='!isFinished()' (click)='endRollCall()' class='nav-button' fxFlex>\n      Abort\n    </button>\n\n    <button mat-stroked-button *ngIf='isFinished()' (click)='endRollCall()' class='nav-button' fxFlex>\n      <b>Finish</b>\n    </button>\n  </div>\n\n  <!-- Additional information for debugging issues -->\n  <mat-card *ngIf='showDebug'>\n    <mat-card-title>Debugging Information</mat-card-title>\n    <mat-card-content>\n      <p>Day: <em>{{day}}</em></p>\n      <p>Current Record: <em>{{debugContent}}</em></p>\n    </mat-card-content>\n  </mat-card>\n\n</div>\n","import { Component, EventEmitter, Input, OnInit, Output } from \"@angular/core\";\nimport { AttendanceStatus } from \"../../model/attendance-day\";\nimport { EntityMapperService } from \"../../../../core/entity/entity-mapper.service\";\nimport { Child } from \"../../../children/model/child\";\nimport { AttendanceMonth } from \"../../model/attendance-month\";\nimport { ChildrenService } from \"../../../children/children.service\";\nimport { RollCallRecord } from \"./roll-call-record\";\nimport { animate, style, transition, trigger } from \"@angular/animations\";\nimport { AppConfig } from \"../../../../core/app-config/app-config\";\n\n/**\n * Displays the given children one by one to the user to mark the attendance status for the given day and type.\n * This component itself handles the loading and saving of the attendances entities internally.\n */\n@Component({\n  selector: \"app-roll-call\",\n  templateUrl: \"./roll-call.component.html\",\n  styleUrls: [\"./roll-call.component.scss\"],\n  animations: [\n    trigger(\"completeRollCall\", [\n      transition(\"void => *\", [\n        style({ backgroundColor: \"white\" }),\n        animate(1000),\n      ]),\n    ]),\n  ],\n})\nexport class RollCallComponent implements OnInit {\n  /**\n   * The day for which attendance will be recorded\n   */\n  @Input() day: Date;\n\n  /**\n   * The attendance type to be checked and saved (e.g. 'coaching' or 'school')\n   */\n  @Input() attendanceType: string;\n\n  /**\n   * The children for whom attendance will be recorded\n   */\n  @Input() students: Child[] = [];\n\n  /**\n   * Event emitted when the roll call is finished (or aborted).\n   */\n  @Output() complete = new EventEmitter();\n\n  isLoading: boolean = true;\n  currentIndex: number;\n  rollCallList: RollCallRecord[] = [];\n\n  AttStatus = AttendanceStatus;\n\n  showDebug = AppConfig.settings.debug;\n  debugContent: any;\n\n  constructor(\n    private entityMapper: EntityMapperService,\n    private childrenService: ChildrenService\n  ) {}\n\n  async ngOnInit() {\n    await this.loadList();\n  }\n\n  private async loadList() {\n    this.isLoading = true;\n\n    this.rollCallList = await this.loadMonthAttendanceRecords(this.students);\n    this.sortRollCallList();\n\n    this.goToNextStudent(0);\n\n    this.isLoading = false;\n  }\n\n  private async loadMonthAttendanceRecords(\n    children: Child[]\n  ): Promise<RollCallRecord[]> {\n    const rollCallRecords: RollCallRecord[] = [];\n\n    const attendances = await this.childrenService\n      .getAttendancesOfMonth(this.day)\n      .toPromise();\n    children.forEach((child) => {\n      let attMonth: AttendanceMonth = attendances.find(\n        (a) =>\n          a.student === child.getId() && a.institution === this.attendanceType\n      );\n      if (attMonth === undefined) {\n        attMonth = AttendanceMonth.createAttendanceMonth(\n          child.getId(),\n          this.attendanceType\n        );\n        attMonth.month = new Date(this.day.getTime());\n      }\n\n      const attDay = attMonth.dailyRegister.find(\n        (d) =>\n          d.date.getDate() === this.day.getDate() &&\n          d.date.getMonth() === this.day.getMonth() &&\n          d.date.getFullYear() === this.day.getFullYear()\n      );\n\n      rollCallRecords.push({\n        child: child,\n        attendanceMonth: attMonth,\n        attendanceDay: attDay,\n      });\n    });\n\n    return rollCallRecords;\n  }\n\n  private sortRollCallList() {\n    this.rollCallList.sort((a: RollCallRecord, b: RollCallRecord) => {\n      if (a.child.schoolClass === b.child.schoolClass) {\n        return 0;\n      }\n\n      const diff =\n        parseInt(a.child.schoolClass, 10) - parseInt(b.child.schoolClass, 10);\n      if (!Number.isNaN(diff)) {\n        return diff;\n      }\n\n      if (\n        a.child.schoolClass < b.child.schoolClass ||\n        b.child.schoolClass === undefined\n      ) {\n        return -1;\n      }\n      return 1;\n    });\n  }\n\n  markAttendance(status: AttendanceStatus) {\n    const rollCallListEntry = this.rollCallList[this.currentIndex];\n    rollCallListEntry.attendanceDay.status = status;\n    this.entityMapper.save(rollCallListEntry.attendanceMonth);\n\n    setTimeout(() => this.goToNextStudent(), 750);\n  }\n\n  goToNextStudent(newIndex?: number) {\n    if (newIndex !== undefined) {\n      this.currentIndex = newIndex;\n    } else {\n      this.currentIndex++;\n    }\n\n    this.displayRecordForDebugging(this.rollCallList[this.currentIndex]);\n  }\n\n  endRollCall() {\n    this.complete.emit();\n  }\n\n  isFinished(): boolean {\n    return this.currentIndex >= this.rollCallList.length;\n  }\n\n  displayRecordForDebugging(rollCallRecord: RollCallRecord) {\n    if (!rollCallRecord) {\n      return;\n    }\n\n    console.log(rollCallRecord);\n    this.debugContent = JSON.stringify(rollCallRecord.attendanceDay, null, 2);\n  }\n}\n","<h1>Add Monthly Attendance</h1>\n\n<div fxLayoutGap='10px'>\n  <mat-button-toggle-group name=\"attendanceType\" [(ngModel)]=\"attendanceType\" (valueChange)='loadTable()'>\n    <mat-button-toggle value=\"school\">School</mat-button-toggle>\n    <mat-button-toggle value=\"coaching\">Coaching</mat-button-toggle>\n  </mat-button-toggle-group>\n\n\n  <mat-form-field *ngIf=\"attendanceType === 'school'\" style='width: 300px'>\n    <mat-label>\n      School\n    </mat-label>\n    <mat-select [(ngModel)]='school' (selectionChange)='loadTable()'>\n      <mat-option *ngFor=\"let s of schools\" [value]=\"s.getId()\">\n        <app-school-block [entity]='s' [linkDisabled]='true' class='mat-form-field'></app-school-block>\n      </mat-option>\n    </mat-select>\n  </mat-form-field>\n\n  <mat-form-field *ngIf=\"attendanceType === 'coaching'\">\n    <mat-label>\n      Center\n    </mat-label>\n    <mat-select [(ngModel)]='coachingCenter' (selectionChange)='loadTable()'>\n      <mat-option *ngFor=\"let center of centers\" [value]='center'>\n        {{center}}\n      </mat-option>\n    </mat-select>\n  </mat-form-field>\n</div>\n\n<div fxLayoutGap='10px'>\n  <mat-form-field>\n    <input matInput placeholder=\"Month\" type=\"month\" (change)='updateMonth($event); loadTable();'>\n  </mat-form-field>\n\n  <mat-form-field>\n    <input matInput [(ngModel)]='workingDays' placeholder=\"Working Days\" type=\"number\" (change)='updateWorkingDays()'>\n  </mat-form-field>\n</div>\n\n<div *ngIf='loadingExistingRecords'>\n  <mat-progress-bar mode=\"indeterminate\"></mat-progress-bar>\n  Loading existing attendance records ...\n</div>\n\n<div style='margin-top:20px;'>\n  <table mat-table [dataSource]=\"attendanceDataSource\" matSort class=\"mat-elevation-z8 table-list\">\n    <ng-container matColumnDef=\"student\">\n      <th mat-header-cell *matHeaderCellDef mat-sort-header> Student </th>\n      <td mat-cell *matCellDef=\"let att\"> <app-child-block [entityId]='att.student'></app-child-block></td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"daysAttended\">\n      <th mat-header-cell *matHeaderCellDef mat-sort-header> Attended </th>\n      <td mat-cell *matCellDef=\"let att\">\n        <mat-form-field class='input-number'>\n          <input matInput [(ngModel)]='att.daysAttended' type=\"number\">\n        </mat-form-field>\n      </td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"daysExcused\">\n      <th mat-header-cell *matHeaderCellDef mat-sort-header> Excused </th>\n      <td mat-cell *matCellDef=\"let att\">\n        <mat-form-field class='input-number'>\n          <input matInput [(ngModel)]='att.daysExcused' type=\"number\">\n        </mat-form-field>\n      </td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"remarks\">\n      <th mat-header-cell *matHeaderCellDef mat-sort-header> Remarks </th>\n      <td mat-cell *matCellDef=\"let att\">\n        <mat-form-field>\n          <input matInput [(ngModel)]='att.remarks' type=\"text\">\n        </mat-form-field>\n      </td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"daysWorking\">\n      <th mat-header-cell *matHeaderCellDef mat-sort-header> Working Days </th>\n      <td mat-cell *matCellDef=\"let att\" fxLayoutGap='10px'>\n        <mat-checkbox [(ngModel)]='att.overridden' (change)='resetOverriddenWorkingDays(att)'></mat-checkbox>\n        <mat-form-field class='input-number'>\n          <input matInput [(ngModel)]='att.daysWorking' type=\"number\" [disabled]='!att.overridden'>\n        </mat-form-field>\n      </td>\n    </ng-container>\n\n\n    <tr mat-header-row *matHeaderRowDef=\"columnsToDisplay\"></tr>\n    <tr mat-row *matRowDef=\"let att; columns: columnsToDisplay\"></tr>\n  </table>\n\n</div>\n\n<div style='margin-top:20px;'>\n  <button mat-stroked-button (click)='save()'>Save Attendance Records</button>\n</div>\n","import { Component, OnInit } from \"@angular/core\";\nimport { EntityMapperService } from \"../../../core/entity/entity-mapper.service\";\nimport { Child } from \"../../children/model/child\";\nimport { MatTableDataSource } from \"@angular/material/table\";\nimport { AttendanceMonth } from \"../model/attendance-month\";\nimport { ConfirmationDialogService } from \"../../../core/confirmation-dialog/confirmation-dialog.service\";\nimport { AlertService } from \"../../../core/alerts/alert.service\";\nimport { ChildrenService } from \"../../children/children.service\";\nimport { School } from \"../../schools/model/school\";\nimport { UntilDestroy, untilDestroyed } from \"@ngneat/until-destroy\";\n\n@UntilDestroy()\n@Component({\n  selector: \"app-add-month-attendance\",\n  templateUrl: \"./add-month-attendance.component.html\",\n  styleUrls: [\"./add-month-attendance.component.scss\"],\n})\nexport class AddMonthAttendanceComponent implements OnInit {\n  schools = new Array<School>();\n  centers = new Array<string>();\n\n  children = new Array<Child>();\n  childrenBySchool = new Map<string, Child[]>();\n  childrenByCenter = new Map<string, Child[]>();\n\n  attendanceDataSource = new MatTableDataSource();\n  columnsToDisplay = [\n    \"student\",\n    \"daysAttended\",\n    \"daysExcused\",\n    \"remarks\",\n    \"daysWorking\",\n  ];\n  loadingExistingRecords = false;\n\n  attendanceType = \"school\";\n  school;\n  coachingCenter;\n  workingDays;\n  month;\n\n  constructor(\n    private entityMapper: EntityMapperService,\n    private childrenService: ChildrenService,\n    private confirmDialog: ConfirmationDialogService,\n    private alertService: AlertService\n  ) {}\n\n  ngOnInit() {\n    this.entityMapper\n      .loadType<School>(School)\n      .then((schools) => (this.schools = schools));\n    this.childrenService\n      .getChildren()\n      .pipe(untilDestroyed(this))\n      .subscribe((children) => {\n        this.children = children.filter((c: Child) => c.isActive());\n        this.initChildrenLookupTables(this.children);\n\n        this.centers = children\n          .map((c) => c.center)\n          .filter((value, index, arr) => arr.indexOf(value) === index);\n      });\n  }\n\n  private initChildrenLookupTables(children: Child[]) {\n    this.childrenBySchool = new Map<string, Child[]>();\n    this.childrenByCenter = new Map<string, Child[]>();\n\n    children.forEach((c) => {\n      let arrS = this.childrenBySchool.get(c.schoolId);\n      if (arrS === undefined) {\n        arrS = [];\n        this.childrenBySchool.set(c.schoolId, arrS);\n      }\n      arrS.push(c);\n\n      let arrC = this.childrenByCenter.get(c.center);\n      if (arrC === undefined) {\n        arrC = [];\n        this.childrenByCenter.set(c.center, arrC);\n      }\n      arrC.push(c);\n    });\n  }\n\n  loadTable() {\n    const records = new Array<AttendanceMonth>();\n    this.getFilteredStudents()\n      .sort((a, b) => (a.schoolClass > b.schoolClass ? 1 : -1))\n      .forEach((c: Child) => {\n        const att = AttendanceMonth.createAttendanceMonth(\n          c.getId(),\n          this.attendanceType\n        );\n        att.month = this.month;\n        records.push(att);\n      });\n    this.loadExistingAttendanceRecordIfAvailable(\n      records,\n      this.month,\n      this.attendanceType\n    );\n\n    this.attendanceDataSource.data = records;\n  }\n\n  private getFilteredStudents(): Child[] {\n    let result;\n    if (this.attendanceType === \"school\") {\n      result = this.childrenBySchool.get(this.school);\n    }\n    if (this.attendanceType === \"coaching\") {\n      result = this.childrenByCenter.get(this.coachingCenter);\n    }\n\n    if (result === undefined) {\n      result = [];\n    }\n\n    return result;\n  }\n\n  updateWorkingDays() {\n    this.attendanceDataSource.data.forEach((att: AttendanceMonth) => {\n      if (!att.overridden) {\n        att.daysWorking = this.workingDays;\n      }\n    });\n  }\n\n  updateMonth(event) {\n    this.month = event.target.valueAsDate;\n    this.attendanceDataSource.data.forEach(\n      (att: AttendanceMonth) => (att.month = this.month)\n    );\n  }\n\n  resetOverriddenWorkingDays(att: AttendanceMonth) {\n    if (!att.overridden) {\n      att.daysWorking = this.workingDays;\n    }\n  }\n\n  isDataEnteredComplete() {\n    let okay = true;\n    if (this.month === undefined) {\n      okay = false;\n    }\n\n    this.attendanceDataSource.data.forEach((att: AttendanceMonth) => {\n      if (att.daysAttended === undefined || att.daysWorking === undefined) {\n        okay = false;\n      }\n    });\n\n    return okay;\n  }\n\n  save() {\n    if (!this.isDataEnteredComplete()) {\n      this.confirmDialog.openDialog(\n        \"Incomplete Data\",\n        \"Please complete the information for all students. Excused absences and remarks are optional.\",\n        false\n      );\n      return;\n    }\n\n    this.attendanceDataSource.data.forEach((att: AttendanceMonth) => {\n      this.entityMapper.save(att);\n    });\n    this.alertService.addInfo(\n      this.attendanceDataSource.data.length + \" attendance records saved.\"\n    );\n\n    this.reset();\n  }\n\n  private reset() {\n    this.workingDays = undefined;\n    this.school = undefined;\n    this.coachingCenter = undefined;\n    this.loadTable();\n  }\n\n  private loadExistingAttendanceRecordIfAvailable(\n    recordsToOverwrite: AttendanceMonth[],\n    month: Date,\n    attendanceType: string\n  ) {\n    if (month === undefined) {\n      return;\n    }\n\n    this.loadingExistingRecords = true;\n\n    this.childrenService\n      .getAttendancesOfMonth(this.month)\n      .pipe(untilDestroyed(this))\n      .subscribe((records) => {\n        recordsToOverwrite.forEach((recordToOverwrite) => {\n          const relevantExistingRecords = records.filter(\n            (a: AttendanceMonth) =>\n              a.student === recordToOverwrite.student &&\n              a.institution === attendanceType\n          );\n          if (relevantExistingRecords.length > 0) {\n            Object.assign(recordToOverwrite, relevantExistingRecords[0]);\n            recordToOverwrite.overridden = true;\n          }\n        });\n\n        this.loadingExistingRecords = false;\n      });\n  }\n}\n","<h1>Attendance Analysis</h1>\n\n<mat-expansion-panel\n  expanded=\"true\"\n  fxLayout=\"column\"\n  fxLayoutGap=\"10px\"\n  class=\"filter-panel\"\n>\n  <div fxHide.gt-xs>\n    <button mat-raised-button (click)=\"applyFilterSelections()\">\n      Search records\n    </button>\n  </div>\n  <div fxLayout=\"row\" fxLayoutGap=\"10px\" style=\"margin-top: 20px;\">\n    <div>\n      <mat-form-field>\n        <input\n          matInput\n          placeholder=\"From\"\n          [value]=\"filterFrom\"\n          (dateChange)=\"filterFrom = $event.target.value\"\n          [matDatepicker]=\"attendanceFromDatepicker\"\n        />\n        <mat-datepicker-toggle\n          matSuffix\n          [for]=\"attendanceFromDatepicker\"\n        ></mat-datepicker-toggle>\n        <mat-datepicker #attendanceFromDatepicker></mat-datepicker>\n      </mat-form-field>\n      <mat-form-field>\n        <input\n          matInput\n          placeholder=\"Until\"\n          [value]=\"filterUntil\"\n          (dateChange)=\"filterUntil = $event.target.value\"\n          [matDatepicker]=\"attendanceUntilDatepicker\"\n        />\n        <mat-datepicker-toggle\n          matSuffix\n          [for]=\"attendanceUntilDatepicker\"\n        ></mat-datepicker-toggle>\n        <mat-datepicker #attendanceUntilDatepicker></mat-datepicker>\n      </mat-form-field>\n    </div>\n\n    <div *ngIf=\"false\">\n      <mat-button-toggle-group name=\"displayType\" [(value)]=\"displayType\">\n        <mat-button-toggle value=\"daily\">Daily</mat-button-toggle>\n        <mat-button-toggle value=\"monthly\">Monthly</mat-button-toggle>\n      </mat-button-toggle-group>\n    </div>\n\n    <div *ngIf=\"false\">\n      <mat-button-toggle-group name=\"attendanceType\" [(value)]=\"attendanceType\">\n        <mat-button-toggle value=\"\">Any</mat-button-toggle>\n        <mat-button-toggle value=\"school\">School Attendance</mat-button-toggle>\n        <mat-button-toggle value=\"coaching\"\n          >Coaching Attendance</mat-button-toggle\n        >\n        <mat-button-toggle value=\"none\">Has No Attendance</mat-button-toggle>\n      </mat-button-toggle-group>\n    </div>\n\n    <div fxHide.lt-sm>\n      <button mat-raised-button (click)=\"applyFilterSelections()\">\n        Search records\n      </button>\n    </div>\n  </div>\n\n  <div\n    fxLayout=\"row wrap\"\n    fxLayoutGap=\"10px\"\n    class=\"filter-button\"\n    fxHide.lt-sm\n  >\n    <mat-button-toggle-group\n      *ngFor=\"let filterSelection of filterSelections\"\n      [name]=\"filterSelection.name\"\n      [value]=\"filterSelection.selectedOption\"\n    >\n      <mat-button-toggle\n        *ngFor=\"let option of filterSelection.options\"\n        [value]=\"option.key\"\n        (click)=\"\n          filterSelection.selectedOption = option.key; applyFilterSelections()\n        \"\n      >\n        {{ option.label }}\n      </mat-button-toggle>\n    </mat-button-toggle-group>\n    <div class=\"align-form-field\">\n      (Showing {{ dataSource.filteredData.length / 2 }} children)\n    </div>\n  </div>\n  <div fxLayout=\"row wrap\" fxHide.gt-xs>\n    <mat-form-field\n      *ngFor=\"let filterSelection of filterSelections\"\n      style=\"padding-right: 1%;\"\n    >\n      <mat-label>{{ filterSelection.name }}</mat-label>\n      <mat-select\n        [id]=\"filterSelection.name\"\n        [value]=\"filterSelection.selectedOption\"\n        placeholder=\"filterSelection.name\"\n      >\n        <mat-option\n          *ngFor=\"let option of filterSelection.options\"\n          [value]=\"option.key\"\n          (click)=\"\n            filterSelection.selectedOption = option.key; applyFilterSelections()\n          \"\n        >\n          {{ option.label }}\n        </mat-option>\n      </mat-select>\n    </mat-form-field>\n  </div>\n</mat-expansion-panel>\n\n<div *ngIf=\"loading > 0\">\n  <mat-progress-bar mode=\"indeterminate\"></mat-progress-bar>\n  <div>Loading data ({{ loading }}) ...</div>\n</div>\n\n<table\n  mat-table\n  [dataSource]=\"dataSource\"\n  matSort\n  class=\"mat-elevation-z8 table-list\"\n>\n  <ng-container matColumnDef=\"child\">\n    <th mat-header-cell *matHeaderCellDef mat-sort-header>Student</th>\n    <td mat-cell *matCellDef=\"let record\">\n      <app-child-block [entity]=\"record.child\"></app-child-block>\n    </td>\n  </ng-container>\n\n  <ng-container matColumnDef=\"attendanceType\">\n    <th mat-header-cell *matHeaderCellDef mat-sort-header>Type</th>\n    <td mat-cell *matCellDef=\"let record\">\n      {{ record.attendanceType }}\n    </td>\n  </ng-container>\n\n  <ng-container matColumnDef=\"averageAttendance\">\n    <th mat-header-cell *matHeaderCellDef mat-sort-header>Attendance</th>\n    <td mat-cell *matCellDef=\"let record\">\n      {{ record.averageAttendance | percent: \"1.0-0\" }}\n    </td>\n  </ng-container>\n\n  <ng-container matColumnDef=\"recordCount\">\n    <th mat-header-cell *matHeaderCellDef mat-sort-header>Count</th>\n    <td mat-cell *matCellDef=\"let record\">\n      {{ record.recordCount }}\n    </td>\n  </ng-container>\n\n  <ng-container matColumnDef=\"totalWorking\">\n    <th mat-header-cell *matHeaderCellDef mat-sort-header>Working Days</th>\n    <td mat-cell *matCellDef=\"let record\">\n      {{ record.totalWorking }}\n    </td>\n  </ng-container>\n  <ng-container matColumnDef=\"totalAttended\">\n    <th mat-header-cell *matHeaderCellDef mat-sort-header>Attended</th>\n    <td mat-cell *matCellDef=\"let record\">\n      {{ record.totalAttended }}\n    </td>\n  </ng-container>\n  <ng-container matColumnDef=\"totalAbsent\">\n    <th mat-header-cell *matHeaderCellDef mat-sort-header>Absent</th>\n    <td mat-cell *matCellDef=\"let record\">\n      {{ record.totalAbsent }}\n    </td>\n  </ng-container>\n  <ng-container matColumnDef=\"totalLate\">\n    <th mat-header-cell *matHeaderCellDef mat-sort-header>Late</th>\n    <td mat-cell *matCellDef=\"let record\">\n      {{ record.totalLate }}\n    </td>\n  </ng-container>\n\n  <ng-container matColumnDef=\"attendance\">\n    <th mat-header-cell *matHeaderCellDef mat-sort-header>Attendance</th>\n    <td mat-cell *matCellDef=\"let record\">\n      <app-attendance-block\n        *ngFor=\"let att of record.attendance\"\n        [attendanceData]=\"att\"\n      ></app-attendance-block>\n    </td>\n  </ng-container>\n\n  <tr mat-header-row *matHeaderRowDef=\"columnsToDisplay\"></tr>\n  <tr\n    mat-row\n    *matRowDef=\"let record; columns: columnsToDisplay; let i = index;\"\n    class=\"table-list-item\"\n    angulartics2On=\"click\"\n    angularticsCategory=\"Navigation\"\n    angularticsAction=\"attendance_manager_list_link\"\n    [angularticsLabel]=\"'list-entry-' + i\"\n  ></tr>\n</table>\n","import { AfterViewInit, Component, OnInit, ViewChild } from \"@angular/core\";\nimport { FilterSelection } from \"../../../core/filter/filter-selection/filter-selection\";\nimport { Child } from \"../../children/model/child\";\nimport { ChildrenService } from \"../../children/children.service\";\nimport { MatSort } from \"@angular/material/sort\";\nimport { MatTableDataSource } from \"@angular/material/table\";\nimport { AttendanceMonth } from \"../model/attendance-month\";\nimport { UntilDestroy, untilDestroyed } from \"@ngneat/until-destroy\";\n\n@UntilDestroy()\n@Component({\n  selector: \"app-attendance-analysis\",\n  templateUrl: \"./attendance-analysis.component.html\",\n  styleUrls: [\"./attendance-analysis.component.scss\"],\n})\nexport class AttendanceAnalysisComponent implements OnInit, AfterViewInit {\n  filterFrom: Date;\n  filterUntil: Date;\n  attendanceType = \"\";\n  displayType = \"daily\";\n\n  childrenAll: Child[];\n\n  dataSource = new MatTableDataSource<any>();\n  columnsToDisplay = [\n    \"child\",\n    \"attendanceType\",\n    \"averageAttendance\",\n    \"totalWorking\",\n    \"totalAttended\",\n    \"totalAbsent\",\n    \"totalLate\",\n    \"attendance\",\n    \"recordCount\",\n  ];\n  @ViewChild(MatSort) sort: MatSort;\n  loading = 0;\n\n  centerFS = new FilterSelection(\"center\", []);\n  dropoutFS = new FilterSelection(\"status\", [\n    {\n      key: \"active\",\n      label: \"Current Project Children\",\n      filterFun: (c: Child) => c.isActive(),\n    },\n    {\n      key: \"dropout\",\n      label: \"Dropouts\",\n      filterFun: (c: Child) => !c.isActive(),\n    },\n    { key: \"\", label: \"All\", filterFun: () => true },\n  ]);\n  filterSelections = [this.dropoutFS, this.centerFS];\n\n  constructor(private childrenService: ChildrenService) {}\n\n  ngAfterViewInit() {\n    this.dataSource.sort = this.sort;\n  }\n\n  ngOnInit() {\n    this.filterFrom = new Date();\n    this.filterFrom.setDate(1);\n    this.filterUntil = new Date();\n    this.filterUntil.setDate(1);\n    this.filterUntil.setMonth(this.filterUntil.getMonth() + 1);\n\n    this.childrenService\n      .getChildren()\n      .pipe(untilDestroyed(this))\n      .subscribe((data) => {\n        this.childrenAll = data.filter((c) => c.isActive());\n        this.initCenterFilterOptions();\n        this.applyFilterSelections();\n      });\n  }\n\n  private initCenterFilterOptions() {\n    const centers = this.childrenAll\n      .map((c) => c.center)\n      .filter((value, index, arr) => arr.indexOf(value) === index);\n\n    const options = [{ key: \"\", label: \"All\", filterFun: (c: Child) => true }];\n\n    centers.forEach((center) => {\n      options.push({\n        key: center.toLowerCase(),\n        label: center,\n        filterFun: (c: Child) => c.center === center,\n      });\n    });\n\n    this.centerFS.options = options;\n  }\n\n  applyFilterSelections() {\n    this.loading = 0;\n    let filteredData = this.childrenAll;\n\n    this.filterSelections.forEach((f) => {\n      filteredData = filteredData.filter(f.getSelectedFilterFunction());\n    });\n\n    let data = [];\n    filteredData.forEach(\n      (child) => (data = data.concat(this.loadChildRecords(child)))\n    );\n\n    this.dataSource.data = data;\n  }\n\n  loadChildRecords(child: Child): any[] {\n    this.loading++;\n    const recordCoaching = {\n      child: child,\n      attendanceType: \"coaching\",\n      attendance: [],\n      averageAttendance: 0,\n    };\n    const recordSchool = {\n      child: child,\n      attendanceType: \"school\",\n      attendance: [],\n      averageAttendance: 0,\n    };\n\n    this.childrenService\n      .getAttendancesOfChild(child.getId())\n      .pipe(untilDestroyed(this))\n      .subscribe((attendances) => {\n        attendances.forEach((att) => {\n          if (\n            this.isLaterOrEqualMonth(att.month, this.filterFrom) &&\n            this.isEarlierOrEqualMonth(att.month, this.filterUntil)\n          ) {\n            if (att.institution === \"school\") {\n              recordSchool.attendance.push(att);\n            } else if (att.institution === \"coaching\") {\n              recordCoaching.attendance.push(att);\n            }\n          }\n        });\n\n        this.calculateRecordStats(recordSchool);\n        this.calculateRecordStats(recordCoaching);\n\n        this.loading--;\n      });\n\n    return [recordSchool, recordCoaching];\n  }\n\n  calculateRecordStats(record) {\n    const stats = record.attendance.reduce(\n      (acc, a: AttendanceMonth) => {\n        if (a.daysWorking > 0) {\n          acc.count++;\n          acc.daysWorking += a.daysWorking;\n          acc.daysAttended += a.daysAttended;\n          acc.daysLate += a.daysLate;\n        }\n        return acc;\n      },\n      { sum: 0, count: 0, daysWorking: 0, daysAttended: 0, daysLate: 0 }\n    );\n    record.recordCount = stats.count;\n    record.averageAttendance = stats.daysAttended / stats.daysWorking;\n    record.totalWorking = stats.daysWorking;\n    record.totalAttended = stats.daysAttended;\n    record.totalAbsent = stats.daysWorking - stats.daysAttended;\n    record.totalLate = stats.daysLate;\n  }\n\n  private isLaterOrEqualMonth(month: Date, filterFrom: Date) {\n    return (\n      month.getFullYear() > filterFrom.getFullYear() ||\n      (month.getFullYear() === filterFrom.getFullYear() &&\n        month.getMonth() >= filterFrom.getMonth())\n    );\n  }\n  private isEarlierOrEqualMonth(month: Date, filterUntil: Date) {\n    return (\n      month.getFullYear() < filterUntil.getFullYear() ||\n      (month.getFullYear() === filterUntil.getFullYear() &&\n        month.getMonth() <= filterUntil.getMonth())\n    );\n  }\n}\n","import { Component, Input, OnInit } from \"@angular/core\";\nimport { AttendanceMonth } from \"../model/attendance-month\";\n\n@Component({\n  selector: \"app-attendance-block\",\n  templateUrl: \"./attendance-block.component.html\",\n  styleUrls: [\"./attendance-block.component.scss\"],\n})\nexport class AttendanceBlockComponent implements OnInit {\n  @Input() attendanceData: AttendanceMonth;\n  tooltip = false;\n  tooltipTimeout;\n\n  constructor() {}\n\n  ngOnInit() {}\n\n  showTooltip() {\n    this.tooltip = true;\n    if (this.tooltipTimeout) {\n      clearTimeout(this.tooltipTimeout);\n    }\n  }\n  hideTooltip() {\n    this.tooltipTimeout = setTimeout(() => (this.tooltip = false), 250);\n  }\n}\n","<span class=\"mat-elevation-z1 attendance-block w-{{attendanceData.getWarningLevel()}}\" (mouseenter)=\"showTooltip()\" (mouseleave)=\"hideTooltip()\">\n  {{attendanceData.getAttendancePercentage() | percent:'1.0-0'}}\n</span>\n\n<div style=\"position:absolute;\" *ngIf=\"tooltip\">\n  <div class=\"mat-elevation-z5 attendance-tooltip\" (mouseenter)=\"showTooltip()\" (mouseleave)=\"hideTooltip()\">\n    <div class=\"attendance-tooltip-header\">{{attendanceData.month | date:'yyyy-MM'}} {{attendanceData.institution}}</div>\n    <div class=\"attendance-tooltip-content\">\n      attended {{attendanceData.daysAttended}} / {{attendanceData.daysWorking-attendanceData.daysExcused}} days\n    </div>\n    <div class=\"attendance-tooltip-content\" *ngIf=\"attendanceData.daysExcused>0\">\n      (excluding {{attendanceData.daysExcused}} days excused)\n    </div>\n    <div>\n      <app-attendance-days [attendanceMonth]='attendanceData'></app-attendance-days>\n    </div>\n  </div>\n</div>\n","import { Component, Input, OnInit } from \"@angular/core\";\nimport { AttendanceDay } from \"../model/attendance-day\";\n\n@Component({\n  selector: \"app-attendance-day-block]\",\n  templateUrl: \"./attendance-day-block.component.html\",\n  styleUrls: [\"./attendance-days.component.scss\"],\n})\nexport class AttendanceDayBlockComponent implements OnInit {\n  @Input() entity: AttendanceDay;\n  @Input() showDate = true;\n  @Input() showHighlighted = false;\n\n  constructor() {}\n\n  ngOnInit() {}\n}\n","<div class='day-cell attendance-{{entity.status}}' [ngClass]=\"{'selected': showHighlighted}\"\n    [matTooltip]='entity.remarks' matTooltipPosition='above'>\n  <span class='date' *ngIf='showDate'>\n    {{entity.date.getDate()}}\n  </span>\n  <span class='status'>\n    {{entity.status}}\n    <span *ngIf='entity.remarks'>*</span>\n  </span>\n</div>\n","import {\n  Component,\n  Input,\n  OnChanges,\n  SimpleChanges,\n  ViewChild,\n} from \"@angular/core\";\nimport { AttendanceDay, AttendanceStatus } from \"../model/attendance-day\";\nimport { ConfirmationDialogService } from \"../../../core/confirmation-dialog/confirmation-dialog.service\";\nimport { AttendanceMonth } from \"../model/attendance-month\";\nimport { EntityMapperService } from \"../../../core/entity/entity-mapper.service\";\nimport { MatSelect } from \"@angular/material/select\";\n\n@Component({\n  selector: \"app-attendance-days\",\n  templateUrl: \"./attendance-days.component.html\",\n  styleUrls: [\"./attendance-days.component.scss\"],\n})\nexport class AttendanceDaysComponent implements OnChanges {\n  @Input() attendanceMonth: AttendanceMonth;\n  records: AttendanceDay[] = [];\n\n  selectedRecord: AttendanceDay;\n  selectedRecordChanged = false;\n\n  private dayStatusSelect: MatSelect;\n  @ViewChild(\"dayStatusSelect\") set content(content: MatSelect) {\n    this.dayStatusSelect = content;\n  }\n\n  statusValues = AttendanceStatus;\n\n  constructor(\n    private dialog: ConfirmationDialogService,\n    private entityMapper: EntityMapperService\n  ) {}\n\n  ngOnChanges(changes: SimpleChanges) {\n    this.records = this.attendanceMonth.dailyRegister;\n  }\n\n  weekRecordsTrackByFunction = (index: number, item: any) =>\n    item.length > 0 ? item[0].date.getTime() : undefined;\n  recordTrackByFunction = (index: number, item: any) => item.date.getTime();\n\n  getWeeks(): AttendanceDay[] {\n    if (!this.records || this.records.length === 0) {\n      return [];\n    }\n\n    const weeks = [];\n    let currentWeek = [];\n\n    // fill first week with placeholder days if the month doesn't start on a Monday\n    const firstDay = this.records[0].date;\n    let daysUntilFirstOfMonth = firstDay.getDay();\n    if (firstDay.getDay() === 0) {\n      daysUntilFirstOfMonth = 7;\n    } // workaround if first day of month is Sunday\n    for (let i = 1; i < daysUntilFirstOfMonth; i++) {\n      const d = new Date(\n        firstDay.getFullYear(),\n        firstDay.getMonth(),\n        firstDay.getDate() - i\n      );\n      currentWeek.unshift(new AttendanceDay(d));\n    }\n\n    this.records.forEach((day) => {\n      if (day.date.getDay() === 1) {\n        weeks.push(currentWeek);\n        currentWeek = [];\n      }\n      currentWeek.push(day);\n    });\n    weeks.push(currentWeek);\n\n    return weeks;\n  }\n\n  selectCell(record: AttendanceDay) {\n    if (record.date.getMonth() !== this.attendanceMonth.month.getMonth()) {\n      this.selectedRecord = undefined;\n      return;\n    }\n    if (record === this.selectedRecord) {\n      this.selectedRecord = undefined;\n    } else {\n      this.selectedRecord = record;\n      setTimeout(() => this.dayStatusSelect.focus(), 100);\n    }\n  }\n\n  save() {\n    if (this.selectedRecordChanged) {\n      this.entityMapper.save(this.attendanceMonth, true);\n    }\n    this.selectedRecordChanged = false;\n  }\n}\n","<div>\n  <!-- Week -->\n  <table>\n    <thead>\n      <tr>\n        <th>Mon</th>\n        <th>Tue</th>\n        <th>Wed</th>\n        <th>Thu</th>\n        <th>Fri</th>\n        <th>Sat</th>\n        <th>Sun</th>\n      </tr>\n    </thead>\n    <tbody>\n      <tr *ngFor='let weekRecords of getWeeks(); trackBy: weekRecordsTrackByFunction'>\n        <td *ngFor='let record of weekRecords; trackBy: recordTrackByFunction'\n            (click)='selectCell(record)'>\n          <app-attendance-day-block [entity]='record' class='day-box'\n                                    [showDate]='record.date.getMonth() === attendanceMonth.month.getMonth()'\n                                    [showHighlighted]='(selectedRecord === record)'></app-attendance-day-block>\n        </td>\n      </tr>\n    </tbody>\n  </table>\n\n  <div *ngIf='selectedRecord' class='selected form'>\n    <div>\n      {{selectedRecord.date.toLocaleDateString()}}\n    </div>\n\n    <button mat-icon-button class='form-close' (click)='selectedRecord=undefined'>\n      <span class='fa fa-times'></span>\n    </button>\n\n    <div>\n      <mat-form-field>\n        <mat-select [(ngModel)]='selectedRecord.status' (ngModelChange)='selectedRecordChanged=true; save()' #dayStatusSelect>\n          <mat-option *ngFor=\"let s of statusValues | keys\" [value]=\"s.value\">{{s.key}}</mat-option>\n        </mat-select>\n      </mat-form-field>\n    </div>\n    <div>\n      <mat-form-field style='width: 100%;'>\n        <textarea matInput placeholder=\"Remarks\" [(ngModel)]=\"selectedRecord.remarks\" (ngModelChange)='selectedRecordChanged=true' (blur)='save()'></textarea>\n      </mat-form-field>\n    </div>\n  </div>\n</div>\n","import { Component, Input, ViewChild } from \"@angular/core\";\nimport { AttendanceMonth } from \"../model/attendance-month\";\nimport { ShowsEntity } from \"../../../core/form-dialog/shows-entity.interface\";\n\n@Component({\n  selector: \"app-attendance-details\",\n  templateUrl: \"./attendance-details.component.html\",\n  styleUrls: [\"./attendance-details.component.scss\"],\n})\nexport class AttendanceDetailsComponent implements ShowsEntity {\n  @Input() entity: AttendanceMonth = new AttendanceMonth(\"\");\n  @ViewChild(\"dialogForm\", { static: true }) formDialogWrapper;\n\n  constructor() {}\n}\n","<!--\n  ~     This file is part of ndb-core.\n  ~\n  ~     ndb-core is free software: you can redistribute it and/or modify\n  ~     it under the terms of the GNU General Public License as published by\n  ~     the Free Software Foundation, either version 3 of the License, or\n  ~     (at your option) any later version.\n  ~\n  ~     ndb-core is distributed in the hope that it will be useful,\n  ~     but WITHOUT ANY WARRANTY; without even the implied warranty of\n  ~     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n  ~     GNU General Public License for more details.\n  ~\n  ~     You should have received a copy of the GNU General Public License\n  ~     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n  -->\n\n<app-form-dialog-wrapper #dialogForm [entity]='entity'>\n  <h1>\n    Attendance of <app-child-block [entityId]='entity.student'></app-child-block>\n    for {{entity.month | date:'MM/yyyy' }}\n  </h1>\n\n  <form #entityForm=\"ngForm\">\n    <div fxLayout='row wrap' fxLayoutGap='20px'>\n      <div fxFlex>\n        <mat-form-field>\n          <input matInput placeholder=\"Month\" name=\"month\" type=\"month\"\n                 [valueAsDate]=\"entity.month\" (change)='entity.month=$event.target.valueAsDate;entityForm.form.markAsDirty();'>\n        </mat-form-field>\n      </div>\n      <div fxFlex>\n        <mat-form-field>\n          <mat-label>\n            Type/Institution\n          </mat-label>\n          <mat-select name=\"institution\" [(ngModel)]=\"entity.institution\">\n            <mat-option value=\"school\">School</mat-option>\n            <mat-option value=\"coaching\">Coaching</mat-option>\n          </mat-select>\n        </mat-form-field>\n      </div>\n    </div>\n\n    <div class=\"w-{{entity.getWarningLevel()}}\">\n      <div class='summary'>Attendance: {{entity?.getAttendancePercentage() | percent:'1.0-0'}}</div>\n      <div class='summary'>Late: {{entity?.daysLate / entity?.daysWorking | percent:'1.0-0'}}</div>\n    </div>\n\n    <div fxLayout='row wrap' fxLayoutGap='20px' class=\"w-{{entity.getWarningLevel()}}\">\n      <div fxFlex>\n        <mat-form-field>\n          <input matInput type=\"number\" min=\"0\" placeholder='Working Days'\n                 [value]='entity.daysWorking' (change)=\"entity.daysWorking=$event.target.valueAsNumber;entityForm.form.markAsDirty();\">\n          <button mat-button matSuffix mat-icon-button aria-label=\"Reset\" matTooltip='reset and use daily attendance data'\n                  *ngIf=\"entity.daysWorking_manuallyEntered\" (click)=\"entity.daysWorking_manuallyEntered=undefined\">\n            <mat-icon fontIcon='fa-times'></mat-icon>\n          </button>\n        </mat-form-field>\n\n        <span>\n        ({{entity.getDaysWorkingFromDailyAttendance()}} days\n        <span class='fa fa-question-circle' matTooltip='according to daily attendance register'></span>)\n      </span>\n      </div>\n\n      <div fxFlex>\n        <mat-form-field>\n          <input matInput type=\"number\" min=\"0\" placeholder='Attended Days'\n                 [value]='entity.daysAttended' (change)=\"entity.daysAttended=$event.target.valueAsNumber;entityForm.form.markAsDirty();\">\n          <button mat-button matSuffix mat-icon-button aria-label=\"Reset\" matTooltip='reset and use daily attendance data'\n                  *ngIf=\"entity.daysAttended_manuallyEntered\" (click)=\"entity.daysAttended_manuallyEntered=undefined\">\n            <mat-icon fontIcon='fa-times'></mat-icon>\n          </button>\n        </mat-form-field>\n\n        <span>\n        ({{entity.getDaysAttendedFromDailyAttendance()}} days\n        <span class='fa fa-question-circle' matTooltip='according to daily attendance register'></span>)\n      </span>\n      </div>\n\n      <div fxFlex>\n        <mat-form-field>\n          <input matInput type=\"number\" min=\"0\" placeholder='Excused Days'\n                 [value]='entity.daysExcused' (change)=\"entity.daysExcused=$event.target.valueAsNumber;entityForm.form.markAsDirty();\">\n          <button mat-button matSuffix mat-icon-button aria-label=\"Reset\" matTooltip='reset and use daily attendance data'\n                  *ngIf=\"entity.daysExcused_manuallyEntered\" (click)=\"entity.daysExcused_manuallyEntered=undefined\">\n            <mat-icon fontIcon='fa-times'></mat-icon>\n          </button>\n        </mat-form-field>\n\n        <span>\n        ({{entity.getDaysExcusedFromDailyAttendance()}} days\n        <span class='fa fa-question-circle' matTooltip='according to daily attendance register'></span>)\n      </span>\n      </div>\n\n      <div fxFlex>\n        <mat-form-field>\n          <input matInput type=\"number\" min=\"0\" placeholder='Late Days'\n                 [value]='entity.daysLate' (change)=\"entity.daysLate=$event.target.valueAsNumber;entityForm.form.markAsDirty();\">\n          <button mat-button matSuffix mat-icon-button aria-label=\"Reset\"\n                  *ngIf=\"entity.daysLate_manuallyEntered\" (click)=\"entity.daysLate_manuallyEntered=undefined\">\n            <mat-icon fontIcon='fa-times'></mat-icon>\n          </button>\n        </mat-form-field>\n\n        <span>\n        ({{entity.getDaysLateFromDailyAttendance()}} days\n        <span class='fa fa-question-circle' matTooltip='according to daily attendance register'></span>)\n      </span>\n      </div>\n    </div>\n\n    <div>\n      <mat-form-field class='input-max'>\n        <textarea matInput placeholder=\"Remarks\" name=\"remarks\" [(ngModel)]=\"entity.remarks\"></textarea>\n      </mat-form-field>\n    </div>\n\n    <div>\n      <app-attendance-days [attendanceMonth]='entity'></app-attendance-days>\n    </div>\n  </form>\n</app-form-dialog-wrapper>\n","import { Component } from \"@angular/core\";\n\n@Component({\n  selector: \"app-attendance-manager\",\n  templateUrl: \"./attendance-manager.component.html\",\n  styleUrls: [\"./attendance-manager.component.scss\"],\n})\nexport class AttendanceManagerComponent {\n  constructor() {}\n}\n","<h1>Attendance Register</h1>\n\n<p class=\"general-description\">\n  Attendance data can be seen and edited in an individual's details as well as here across groups.\n</p>\n\n<div fxLayout=\"row wrap\">\n  <mat-card fxFlex>\n    <mat-card-header>\n      <mat-card-title>Roll Call</mat-card-title>\n      <mat-card-subtitle>add a day's attendance</mat-card-subtitle>\n    </mat-card-header>\n    <mat-card-content>\n      Select a group of children and easily mark their attendance one by one.\n      This works well on a smartphone to record attendance on site.\n    </mat-card-content>\n    <mat-card-actions>\n      <button routerLink=\"/attendance/add/day\"\n              angulartics2On=\"click\"\n              angularticsCategory=\"Navigation\"\n              angularticsAction=\"attendance_manager_add_a_day_attendance_link\"\n              class=\"action-button\"\n              mat-stroked-button>\n        Do Roll Call\n      </button>\n    </mat-card-actions>\n  </mat-card>\n\n  <mat-card fxFlex>\n    <mat-card-header>\n      <mat-card-title>Enter Monthly Attendance</mat-card-title>\n      <mat-card-subtitle>add a month's attendance</mat-card-subtitle>\n    </mat-card-header>\n    <mat-card-content>\n      Enter attendance numbers for a whole month in a table format for a group of children.\n      This allows you to quickly record attendance that was collected on paper.\n      However, as you only enter a monthly total for each child you cannot see attendance in the day-wise calender.\n    </mat-card-content>\n    <mat-card-actions>\n      <button routerLink=\"/attendance/add/month\"\n              angulartics2On=\"click\"\n              angularticsCategory=\"Navigation\"\n              angularticsAction=\"attendance_manager_add_a_month_attendance_link\"\n              class=\"action-button\"\n              mat-stroked-button>\n        Enter Attendance\n      </button>\n    </mat-card-actions>\n  </mat-card>\n\n  <mat-card fxFlex>\n    <mat-card-header>\n      <mat-card-title>Analyse Attendance</mat-card-title>\n      <mat-card-subtitle>calculate summaries and averages</mat-card-subtitle>\n    </mat-card-header>\n    <mat-card-content>\n      Analyse and compare attendance for all children.\n      To see an individual's attendance history you can open the child's overall details page.\n    </mat-card-content>\n    <mat-card-actions>\n      <button routerLink=\"/attendance/analysis\"\n              class=\"action-button\"\n              mat-stroked-button>\n        Analyse Attendance\n      </button>\n    </mat-card-actions>\n  </mat-card>\n</div>\n","import { Injectable } from \"@angular/core\";\nimport { ConflictResolutionStrategy } from \"../../conflict-resolution/auto-resolution/conflict-resolution-strategy\";\nimport { AttendanceMonth } from \"./model/attendance-month\";\nimport _ from \"lodash\";\nimport { diff } from \"deep-object-diff\";\nimport { EntitySchemaService } from \"../../core/entity/schema/entity-schema.service\";\n\n/**\n * Auto resolve simple database document conflicts concerning {@link AttendanceMonth} entities.\n */\n@Injectable()\nexport class AttendanceMonthConflictResolutionStrategy\n  implements ConflictResolutionStrategy {\n  constructor(private entitySchemaService: EntitySchemaService) {}\n\n  /**\n   * Checks if the given conflict is about AttendanceMonth entities (otherwise this strategy doesn't apply)\n   * and suggests whether the conflict is trivial and can be automatically deleted.\n   * @param currentDoc The currently active revision\n   * @param conflictingDoc The conflicting revision to be checked whether it can be deleted\n   */\n  public autoDeleteConflictingRevision(\n    currentDoc: any,\n    conflictingDoc: any\n  ): boolean {\n    if (!currentDoc._id.startsWith(AttendanceMonth.ENTITY_TYPE)) {\n      return false;\n    }\n\n    if (typeof currentDoc.getId === \"function\") {\n      currentDoc = this.entitySchemaService.transformEntityToDatabaseFormat(\n        currentDoc\n      );\n    }\n    if (typeof conflictingDoc.getId === \"function\") {\n      conflictingDoc = this.entitySchemaService.transformEntityToDatabaseFormat(\n        conflictingDoc\n      );\n    }\n\n    const currentDocC = _.merge({}, currentDoc);\n    delete currentDocC._rev;\n    const conflictingDocC = _.merge({}, conflictingDoc);\n    delete conflictingDocC._rev;\n\n    return this.isIrrelevantAttendanceMonthConflict(\n      currentDocC,\n      conflictingDocC\n    );\n  }\n\n  /**\n   * Calculate a diff between the two objects discarding trivial differences.\n   * @param currentDoc The object to compare against\n   * @param conflictingDoc The conflicting object version to compare\n   */\n  private isIrrelevantAttendanceMonthConflict(\n    currentDoc: any,\n    conflictingDoc: any\n  ): boolean {\n    const diffObject = diff(currentDoc, conflictingDoc);\n\n    const simplifiedDiff = this.removeTrivialDiffValuesRecursively(diffObject, [\n      \"?\",\n      \"\",\n      undefined,\n      null,\n    ]);\n\n    console.log(currentDoc);\n    console.log(conflictingDoc);\n    console.log(\"isIrrelevantAttendanceMonthConflict\", simplifiedDiff);\n\n    return _.isObjectLike(simplifiedDiff) && _.isEmpty(simplifiedDiff);\n  }\n\n  /**\n   * Changes the given object, deep scanning it to remove any values given as the second argument.\n   * @param diffObject\n   * @param trivialValues\n   */\n  private removeTrivialDiffValuesRecursively(\n    diffObject: any,\n    trivialValues: any[]\n  ) {\n    for (const k of Object.keys(diffObject)) {\n      if (trivialValues.includes(diffObject[k])) {\n        delete diffObject[k];\n      }\n\n      if (typeof diffObject[k] === \"object\" && diffObject[k] !== null) {\n        this.removeTrivialDiffValuesRecursively(diffObject[k], trivialValues);\n\n        if (_.isObjectLike(diffObject[k]) && _.isEmpty(diffObject[k])) {\n          delete diffObject[k];\n        }\n      }\n    }\n\n    return diffObject;\n  }\n}\n","<app-attendance-days [attendanceMonth]='records[0]' *ngIf='showDailyAttendanceOfLatest && records && records.length > 0'></app-attendance-days>\n\n<app-entity-subrecord [records]=\"records\" [columns]=\"columns\" [newRecordFactory]=\"generateNewRecordFactory()\" [detailsComponent]=\"detailsComponent\">\n</app-entity-subrecord>\n","import { Component, Input, OnChanges, SimpleChanges } from \"@angular/core\";\nimport { AttendanceMonth } from \"../model/attendance-month\";\nimport { ChildrenService } from \"../../children/children.service\";\nimport { ColumnDescription } from \"../../../core/entity-subrecord/entity-subrecord/column-description\";\nimport { DatePipe, PercentPipe } from \"@angular/common\";\nimport { AttendanceDetailsComponent } from \"../attendance-details/attendance-details.component\";\nimport { ColumnDescriptionInputType } from \"../../../core/entity-subrecord/entity-subrecord/column-description-input-type.enum\";\nimport { UntilDestroy, untilDestroyed } from \"@ngneat/until-destroy\";\n\n@UntilDestroy()\n@Component({\n  selector: \"app-child-attendance\",\n  templateUrl: \"./child-attendance.component.html\",\n})\nexport class ChildAttendanceComponent implements OnChanges {\n  @Input() childId: string;\n  @Input() institution: string;\n  @Input() showDailyAttendanceOfLatest = false;\n\n  records: Array<AttendanceMonth>;\n  detailsComponent = AttendanceDetailsComponent;\n\n  columns: Array<ColumnDescription> = [\n    new ColumnDescription(\n      \"month\",\n      \"Month\",\n      ColumnDescriptionInputType.MONTH,\n      null,\n      (v: Date) => this.datePipe.transform(v, \"yyyy-MM\"),\n      \"xs\"\n    ),\n    new ColumnDescription(\n      \"daysAttended\",\n      \"Present\",\n      ColumnDescriptionInputType.NUMBER,\n      null,\n      undefined,\n      \"xs\"\n    ),\n    new ColumnDescription(\n      \"daysWorking\",\n      \"Working Days\",\n      ColumnDescriptionInputType.NUMBER,\n      null,\n      undefined,\n      \"xs\"\n    ),\n    new ColumnDescription(\n      \"getAttendancePercentage\",\n      \"Attended\",\n      ColumnDescriptionInputType.FUNCTION,\n      null,\n      (v: number) => this.percentPipe.transform(v, \"1.0-0\"),\n      \"md\"\n    ),\n    new ColumnDescription(\n      \"daysExcused\",\n      \"Excused\",\n      ColumnDescriptionInputType.NUMBER,\n      null,\n      undefined,\n      \"md\"\n    ),\n    new ColumnDescription(\n      \"remarks\",\n      \"Remarks\",\n      ColumnDescriptionInputType.TEXTAREA,\n      null,\n      undefined,\n      \"xl\"\n    ),\n  ];\n\n  constructor(\n    private childrenService: ChildrenService,\n    private datePipe: DatePipe,\n    private percentPipe: PercentPipe\n  ) {}\n\n  ngOnChanges(changes: SimpleChanges) {\n    this.loadData(this.childId);\n  }\n\n  loadData(id: string) {\n    this.childrenService\n      .getAttendancesOfChild(id)\n      .pipe(untilDestroyed(this))\n      .subscribe((results) => {\n        this.records = results\n          .filter(\n            (r) =>\n              this.institution === undefined ||\n              r.institution === this.institution\n          )\n          .sort(\n            (a, b) =>\n              (b.month ? b.month.valueOf() : 0) -\n              (a.month ? a.month.valueOf() : 0)\n          );\n\n        if (this.showDailyAttendanceOfLatest) {\n          this.createCurrentMonthsAttendanceIfNotExists();\n        }\n      });\n  }\n\n  private createCurrentMonthsAttendanceIfNotExists() {\n    const now = new Date();\n    if (\n      this.records.length === 0 ||\n      this.records[0].month.getFullYear() !== now.getFullYear() ||\n      this.records[0].month.getMonth() !== now.getMonth()\n    ) {\n      this.records.unshift(\n        AttendanceMonth.createAttendanceMonth(this.childId, this.institution)\n      );\n    }\n  }\n\n  generateNewRecordFactory() {\n    // define values locally because 'this' is a different scope after passing a function as input to another component\n    const child = this.childId;\n    const institution = this.institution;\n\n    return () => {\n      return AttendanceMonth.createAttendanceMonth(child, institution);\n    };\n  }\n}\n","<mat-card class=\"dashboard-widget\">\n  <mat-card-header class=\"app-attendance\">\n    <div mat-card-avatar>\n      <mat-icon fontIcon=\"fa-line-chart\"></mat-icon>\n    </div>\n    <mat-card-title>{{ overallAttendance | percent: \"1.0-0\" }}</mat-card-title>\n    <mat-card-subtitle>Average Attendance Last 3 Months</mat-card-subtitle>\n  </mat-card-header>\n  <mat-card-content>\n    <p class=\"dashboard-desc\">\n      Students above {{ ATTENDANCE_THRESHOLD | percent: \"1.0-0\" }} attendance\n      last month:\n    </p>\n    <table class=\"dashboard-table\">\n      <tr>\n        <th class=\"dashboard-table-cell\"></th>\n        <th class=\"dashboard-table-cell\">last month</th>\n        <th class=\"dashboard-table-cell\">3 months</th>\n        <th class=\"dashboard-table-cell\"></th>\n      </tr>\n      <tr\n        *ngFor=\"let entry of lastMonthsTopAttendence; let i=index;\"\n        class=\"dashboard-table-row w-OK\"\n        (click)=\"goToChild(entry[0].getId())\"\n        style=\"cursor: pointer;\"\n        angulartics2On=\"click\"\n        angularticsCategory=\"Navigation\"\n        angularticsAction=\"dashboard_attendance_average_list_link\"\n        [angularticsLabel]=\"'list-entry-' + i\"\n      >\n        <td class=\"dashboard-table-cell\">\n          <app-child-block\n            *ngIf=\"entry[0]\"\n            [entity]=\"entry[0]\"\n          ></app-child-block>\n        </td>\n        <td class=\"dashboard-table-cell\" style=\"text-align: right;\">\n          {{ entry[2] | percent: \"1.0-0\" }}\n        </td>\n        <td class=\"dashboard-table-cell\" style=\"text-align: right;\">\n          {{ entry[1] | percent: \"1.0-0\" }}\n        </td>\n        <td class=\"dashboard-table-cell\">\n          <span class=\"fa fa-external-link-square\"></span>\n        </td>\n      </tr>\n    </table>\n  </mat-card-content>\n</mat-card>\n","import { Component, OnInit } from \"@angular/core\";\nimport { ChildrenService } from \"../../../children/children.service\";\nimport { Child } from \"../../../children/model/child\";\nimport { Router } from \"@angular/router\";\nimport { UntilDestroy, untilDestroyed } from \"@ngneat/until-destroy\";\nimport { DashboardWidgetComponent } from \"app/child-dev-project/dashboard/dashboard-widget.component\";\n\n@UntilDestroy()\n@Component({\n  selector: \"app-attendance-average-dashboard\",\n  templateUrl: \"./attendance-average-dashboard.component.html\",\n  styleUrls: [\"./attendance-average-dashboard.component.scss\"],\n})\nexport class AttendanceAverageDashboardComponent\n  implements DashboardWidgetComponent, OnInit {\n  readonly ATTENDANCE_THRESHOLD = 0.9;\n\n  overallAttendance: number;\n  lastMonthsTopAttendence = []; // [[Child, average_last_3_months, last_months_attendance]]\n\n  constructor(\n    private childrenService: ChildrenService,\n    private router: Router\n  ) {}\n\n  initFromConfig(config: any) {}\n\n  async ngOnInit() {\n    await this.loadAverageAttendances();\n  }\n\n  async loadAverageAttendances() {\n    const countMap = new Map<string, [Child, number, number]>();\n\n    const attendance3Months = await this.childrenService.queryAttendanceLast3Months();\n    let totalCount = 0;\n    let summedAverage = 0;\n    attendance3Months.rows.forEach((studentStat) => {\n      totalCount += studentStat.value.count;\n      summedAverage += studentStat.value.sum;\n\n      countMap.set(studentStat.key, [\n        undefined,\n        studentStat.value.sum / studentStat.value.count,\n        0,\n      ]);\n    });\n\n    this.overallAttendance = summedAverage / totalCount;\n\n    const attendanceLastMonth = await this.childrenService.queryAttendanceLastMonth();\n    attendanceLastMonth.rows.forEach((studentStat) => {\n      const record = countMap.get(studentStat.key);\n      record[2] = studentStat.value.sum / studentStat.value.count;\n\n      if (record[2] >= this.ATTENDANCE_THRESHOLD) {\n        this.childrenService\n          .getChild(studentStat.key)\n          .pipe(untilDestroyed(this))\n          .subscribe((child) => (record[0] = child));\n      } else {\n        countMap.delete(studentStat.key);\n      }\n    });\n\n    // remove elements that don't have a matching attendance from last month\n    countMap.forEach((v, k) => {\n      if (v[2] === 0) {\n        countMap.delete(k);\n      }\n    });\n\n    this.lastMonthsTopAttendence = Array.from(countMap.values()); // direct use of Map creates change detection problems\n  }\n\n  goToChild(childId: string) {\n    this.router.navigate([\"/child\", childId]);\n  }\n}\n","<mat-card class=\"dashboard-widget\">\n  <mat-card-header class=\"app-attendance\">\n    <div mat-card-avatar>\n      <mat-icon fontIcon=\"fa-exclamation-triangle\"></mat-icon>\n    </div>\n    <mat-card-title>{{ lastMonthsLowAttendence.length }}</mat-card-title>\n    <mat-card-subtitle>Students with low attendance</mat-card-subtitle>\n  </mat-card-header>\n  <mat-card-content>\n    <p class=\"dashboard-desc\">\n      Students below {{ ATTENDANCE_THRESHOLD | percent: \"1.0-0\" }} attendance\n      last month:\n    </p>\n    <table class=\"dashboard-table\">\n      <tr\n        *ngFor=\"let entry of lastMonthsLowAttendence; let i = index\"\n        class=\"dashboard-table-row w-{{ entry[2] }}\"\n        (click)=\"goToChild(entry[0].getId())\"\n        style=\"cursor: pointer;\"\n        angulartics2On=\"click\"\n        angularticsCategory=\"Navigation\"\n        angularticsAction=\"dashboard_attendance_warnings_list_link\"\n        [angularticsLabel]=\"'list-entry-' + i\"\n      >\n        <td class=\"dashboard-table-cell\">\n          <app-child-block\n            *ngIf=\"entry[0]\"\n            [entity]=\"entry[0]\"\n          ></app-child-block>\n        </td>\n        <td class=\"dashboard-table-cell\" style=\"text-align: right;\">\n          {{ entry[1] | percent: \"1.0-0\" }}\n        </td>\n        <td class=\"dashboard-table-cell\">\n          <span class=\"fa fa-external-link-square\"></span>\n        </td>\n      </tr>\n    </table>\n  </mat-card-content>\n</mat-card>\n","import { Component, OnInit } from \"@angular/core\";\nimport { ChildrenService } from \"../../../children/children.service\";\nimport { Router } from \"@angular/router\";\nimport { AttendanceMonth } from \"../../model/attendance-month\";\nimport { UntilDestroy, untilDestroyed } from \"@ngneat/until-destroy\";\nimport { DashboardWidgetComponent } from \"app/child-dev-project/dashboard/dashboard-widget.component\";\n\n@UntilDestroy()\n@Component({\n  selector: \"app-attendance-warnings-dashboard\",\n  templateUrl: \"./attendance-warnings-dashboard.component.html\",\n  styleUrls: [\"./attendance-warnings-dashboard.component.scss\"],\n})\nexport class AttendanceWarningsDashboardComponent\n  implements DashboardWidgetComponent, OnInit {\n  readonly ATTENDANCE_THRESHOLD = AttendanceMonth.THRESHOLD_WARNING;\n\n  lastMonthsLowAttendence = []; // [[Child, last_months_attendance]]\n\n  constructor(\n    private childrenService: ChildrenService,\n    private router: Router\n  ) {}\n\n  initFromConfig(config: any) {}\n\n  async ngOnInit() {\n    await this.loadLastAttendances();\n  }\n\n  async loadLastAttendances() {\n    await this.childrenService\n      .queryAttendanceLastMonth()\n      .then((queryResults) => {\n        this.lastMonthsLowAttendence = [];\n        queryResults.rows.forEach((studentStat) => {\n          const att = studentStat.value.sum / studentStat.value.count;\n\n          let urgency = \"WARNING\";\n          if (att < AttendanceMonth.THRESHOLD_URGENT) {\n            urgency = \"URGENT\";\n          }\n\n          if (att < this.ATTENDANCE_THRESHOLD) {\n            this.childrenService\n              .getChild(studentStat.key)\n              .pipe(untilDestroyed(this))\n              .subscribe((child) =>\n                this.lastMonthsLowAttendence.push([child, att, urgency])\n              );\n          }\n        });\n        this.lastMonthsLowAttendence.sort((a, b) => a[1] - b[1]);\n      });\n  }\n\n  goToChild(childId: string) {\n    this.router.navigate([\"/child\", childId]);\n  }\n}\n","<mat-card class=\"dashboard-widget\">\n  <mat-card-header class=\"app-attendance\">\n    <div mat-card-avatar>\n      <mat-icon fontIcon=\"fa-exclamation-triangle\"></mat-icon>\n    </div>\n    <mat-card-title>{{ attendanceRecords?.length }}</mat-card-title>\n    <mat-card-subtitle\n      >Students more than one day absent\n      <em>{{ periodLabel }}</em></mat-card-subtitle\n    >\n  </mat-card-header>\n  <mat-card-content>\n    <table class=\"dashboard-table\">\n      <tr\n        *ngFor=\"let record of attendanceRecords; trackBy: recordTrackByFunction; let i=index;\"\n        class=\"dashboard-table-row w-WARNING\"\n        (click)=\"goToChild(record.child.getId())\"\n        style=\"cursor: pointer;\"\n        angulartics2On=\"click\"\n        angularticsCategory=\"Navigation\"\n        angularticsAction=\"dashboard_attendance_warnings_list_link\"\n        [angularticsLabel]=\"'list-entry-' + i\"\n      >\n        <td class=\"dashboard-table-first-cell dashboard-table-cell\">\n          <app-child-block [entity]=\"record.child\"></app-child-block>\n        </td>\n        <td class=\"dashboard-table-last-cell dashboard-table-cell\">\n          <table class=\"attendance-week-table\">\n            <tr>\n              <td *ngFor=\"let day of record.attendanceSchool\">\n                <app-attendance-day-block\n                  [entity]=\"day\"\n                  [showDate]=\"false\"\n                  class=\"day-box\"\n                ></app-attendance-day-block>\n              </td>\n            </tr>\n            <tr>\n              <td *ngFor=\"let day of record.attendanceCoaching\">\n                <app-attendance-day-block\n                  [entity]=\"day\"\n                  [showDate]=\"false\"\n                  class=\"day-box\"\n                ></app-attendance-day-block>\n              </td>\n            </tr>\n          </table>\n        </td>\n      </tr>\n    </table>\n  </mat-card-content>\n</mat-card>\n","import { Component, Input, OnInit } from \"@angular/core\";\nimport { ChildrenService } from \"../../../children/children.service\";\nimport { Router } from \"@angular/router\";\nimport { AttendanceMonth } from \"../../model/attendance-month\";\nimport { AttendanceDay, AttendanceStatus } from \"../../model/attendance-day\";\nimport { Child } from \"../../../children/model/child\";\nimport { forkJoin } from \"rxjs\";\nimport { UntilDestroy, untilDestroyed } from \"@ngneat/until-destroy\";\nimport { DashboardWidgetComponent } from \"app/child-dev-project/dashboard/dashboard-widget.component\";\n\n@UntilDestroy()\n@Component({\n  selector: \"app-attendance-week-dashboard\",\n  templateUrl: \"./attendance-week-dashboard.component.html\",\n  styleUrls: [\"./attendance-week-dashboard.component.scss\"],\n})\nexport class AttendanceWeekDashboardComponent\n  implements DashboardWidgetComponent, OnInit {\n  @Input() daysOffset: number;\n  @Input() periodLabel: string;\n\n  attendanceRecordsMap: Map<\n    string,\n    {\n      childId: string;\n      child: Child;\n      attendanceSchool: AttendanceDay[];\n      attendanceCoaching: AttendanceDay[];\n      schoolAbsences?: number;\n      coachingAbsences?: number;\n    }\n  >;\n  attendanceRecords;\n\n  constructor(\n    private childrenService: ChildrenService,\n    private router: Router\n  ) {}\n\n  initFromConfig(config: any) {\n    if (config?.daysOffset) {\n      this.daysOffset = config.daysOffset;\n    }\n    if (config?.periodLabel) {\n      this.periodLabel = config.periodLabel;\n    }\n  }\n\n  ngOnInit() {\n    this.loadAttendanceOfAbsentees(this.daysOffset);\n  }\n\n  recordTrackByFunction = (index, item) => item.childId;\n\n  loadAttendanceOfAbsentees(daysOffset = 0) {\n    this.attendanceRecordsMap = new Map();\n\n    const today = new Date();\n    const previousMonday = new Date(\n      today.getFullYear(),\n      today.getMonth(),\n      today.getDate() - today.getDay() - 6 + daysOffset\n    );\n    const previousSaturday = new Date(\n      previousMonday.getFullYear(),\n      previousMonday.getMonth(),\n      previousMonday.getDate() + 5\n    );\n\n    const o1 = this.childrenService.getAttendancesOfMonth(previousMonday);\n    o1.pipe(untilDestroyed(this)).subscribe((attendances) => {\n      attendances.forEach((a) =>\n        this.extractRelevantAttendanceDays(a, previousMonday, previousSaturday)\n      );\n    });\n    let o2 = o1;\n    if (previousMonday.getMonth() !== previousSaturday.getMonth()) {\n      o2 = this.childrenService.getAttendancesOfMonth(previousSaturday);\n      o2.pipe(untilDestroyed(this)).subscribe((attendances) =>\n        attendances.forEach((a) =>\n          this.extractRelevantAttendanceDays(\n            a,\n            previousMonday,\n            previousSaturday\n          )\n        )\n      );\n    }\n    forkJoin(o1, o2).subscribe(() => this.filterAbsentees());\n  }\n\n  private extractRelevantAttendanceDays(\n    attendanceMonth: AttendanceMonth,\n    startDate: Date,\n    endDate: Date\n  ) {\n    let record = this.attendanceRecordsMap.get(attendanceMonth.student);\n    if (record === undefined) {\n      record = {\n        childId: attendanceMonth.student,\n        child: undefined,\n        attendanceCoaching: [],\n        attendanceSchool: [],\n      };\n      this.childrenService\n        .getChild(attendanceMonth.student)\n        .pipe(untilDestroyed(this))\n        .subscribe((child) => (record.child = child));\n      this.attendanceRecordsMap.set(attendanceMonth.student, record);\n    }\n\n    const relevantDays = attendanceMonth.dailyRegister.filter(\n      (a) =>\n        a.date.getTime() >= startDate.getTime() &&\n        a.date.getTime() <= endDate.getTime()\n    );\n\n    if (attendanceMonth.institution === \"coaching\") {\n      record.attendanceCoaching = record.attendanceCoaching\n        .concat(relevantDays)\n        .sort(\n          (a, b) =>\n            (a.date ? a.date.getTime() : 0) - (b.date ? b.date.getTime() : 0)\n        );\n    } else if (attendanceMonth.institution === \"school\") {\n      record.attendanceSchool = record.attendanceSchool\n        .concat(relevantDays)\n        .sort(\n          (a, b) =>\n            (a.date ? a.date.getTime() : 0) - (b.date ? b.date.getTime() : 0)\n        );\n    }\n  }\n\n  private filterAbsentees() {\n    this.attendanceRecords = [];\n\n    this.attendanceRecordsMap.forEach((record) => {\n      const countAbsencesFun = (acc, v) =>\n        v.status === AttendanceStatus.ABSENT ? acc + 1 : acc;\n      record.schoolAbsences = record.attendanceSchool.reduce(\n        countAbsencesFun,\n        0\n      );\n      record.coachingAbsences = record.attendanceCoaching.reduce(\n        countAbsencesFun,\n        0\n      );\n      if (record.schoolAbsences > 1 || record.coachingAbsences > 1) {\n        this.attendanceRecords.push(record);\n      }\n    });\n  }\n\n  goToChild(childId: string) {\n    this.router.navigate([\"/child\", childId]);\n  }\n}\n","import { DemoChildGenerator } from \"../children/demo-data-generators/demo-child-generator.service\";\nimport { DemoDataGenerator } from \"../../core/demo-data/demo-data-generator\";\nimport { Injectable } from \"@angular/core\";\nimport { Child } from \"../children/model/child\";\nimport { faker } from \"../../core/demo-data/faker\";\nimport { AttendanceMonth } from \"./model/attendance-month\";\nimport { AttendanceDay, AttendanceStatus } from \"./model/attendance-day\";\n\ninterface AttendanceProfile {\n  id: number;\n  present: number;\n  excused: number;\n  late: number;\n  absent: number;\n}\n\nconst ATTENDANCE_PROFILES: AttendanceProfile[] = [\n  {\n    id: 0,\n    present: 94,\n    excused: 3,\n    late: 1,\n    absent: 2,\n  },\n  {\n    id: 1,\n    present: 80,\n    excused: 5,\n    late: 5,\n    absent: 10,\n  },\n  {\n    id: 2,\n    present: 70,\n    excused: 5,\n    late: 10,\n    absent: 15,\n  },\n  {\n    id: 3,\n    present: 50,\n    excused: 5,\n    late: 5,\n    absent: 40,\n  },\n];\n\n/**\n * Generate AttendanceMonth entities for the last 15 months\n * Builds upon the generated demo Child entities.\n */\n@Injectable()\nexport class DemoAttendanceGenerator extends DemoDataGenerator<\n  AttendanceMonth\n> {\n  /**\n   * This function returns a provider object to be used in an Angular Module configuration:\n   *   `providers: [DemoAttendanceGenerator.provider()]`\n   */\n  static provider() {\n    return [\n      { provide: DemoAttendanceGenerator, useClass: DemoAttendanceGenerator },\n    ];\n  }\n\n  public static isHoliday(date: Date) {\n    switch (date.getMonth()) {\n      case 0:\n        return (\n          (date.getDate() >= 1 && date.getDate() <= 6) ||\n          date.getDate() === 23 ||\n          date.getDate() === 26\n        );\n      case 2:\n        return (\n          date.getDate() === 4 || (date.getDate() >= 20 && date.getDate() <= 21)\n        );\n      case 3:\n        return (\n          date.getDate() === 15 ||\n          (date.getDate() >= 20 && date.getDate() <= 21)\n        );\n      case 4:\n        return date.getDate() === 1 || date.getDate() >= 23;\n      case 5:\n        return date.getDate() <= 21;\n      case 6:\n        return date.getDate() === 4;\n      case 7:\n        return date.getDate() === 15;\n      case 8:\n        return date.getDate() === 11;\n      case 9:\n        return date.getDate() >= 5 && date.getDate() <= 16;\n      case 10:\n        return date.getDate() === 2 || date.getDate() === 10;\n      case 11:\n        return date.getDate() >= 24;\n    }\n\n    return false;\n  }\n\n  constructor(private demoChildren: DemoChildGenerator) {\n    super();\n  }\n\n  generateEntities(): AttendanceMonth[] {\n    const data = [];\n\n    for (const child of this.demoChildren.entities) {\n      data.push(...this.generateAttendanceRecordsForChild(child as Child));\n    }\n\n    return data;\n  }\n\n  private generateAttendanceRecordsForChild(child: Child): AttendanceMonth[] {\n    const data = [];\n\n    const finalMonth = faker.getEarlierDateOrToday(child.dropoutDate);\n    finalMonth.setDate(1);\n\n    const month = new Date();\n    month.setDate(1);\n    month.setMonth(month.getMonth() - 15);\n    if (child.admissionDate > month) {\n      month.setMonth(child.admissionDate.getMonth());\n      month.setFullYear(child.admissionDate.getFullYear());\n    }\n\n    let attendanceProfile = undefined;\n    while (month <= finalMonth) {\n      attendanceProfile = this.selectNextAttendanceProfile(attendanceProfile);\n\n      data.push(\n        this.generateRecord(\n          child,\n          new Date(month.toISOString()),\n          \"school\",\n          attendanceProfile\n        )\n      );\n      data.push(\n        this.generateRecord(\n          child,\n          new Date(month.toISOString()),\n          \"coaching\",\n          attendanceProfile\n        )\n      );\n\n      month.setMonth(month.getMonth() + 1);\n    }\n\n    return data;\n  }\n\n  private generateRecord(\n    child: Child,\n    month: Date,\n    institution: string,\n    attendanceProfile: AttendanceProfile\n  ) {\n    const attendanceMonth = new AttendanceMonth(faker.random.uuid());\n    attendanceMonth.month = month;\n    attendanceMonth.student = child.getId();\n    attendanceMonth.institution = institution;\n    attendanceMonth.dailyRegister.forEach((attendanceDay) =>\n      this.setDayAttendance(\n        attendanceDay,\n        institution !== \"school\",\n        attendanceProfile\n      )\n    );\n    return attendanceMonth;\n  }\n\n  private setDayAttendance(\n    attendanceDay: AttendanceDay,\n    includeSaturday: boolean,\n    attendanceProfile: AttendanceProfile\n  ) {\n    if (attendanceDay.date > new Date()) {\n      return;\n    }\n\n    if (\n      attendanceDay.date.getDay() === 0 || // Sunday\n      (!includeSaturday && attendanceDay.date.getDay() === 6) // Saturday\n    ) {\n      return;\n    }\n\n    if (DemoAttendanceGenerator.isHoliday(attendanceDay.date)) {\n      attendanceDay.status = AttendanceStatus.HOLIDAY;\n      return;\n    }\n\n    const random = faker.random.number(100);\n    if (random < attendanceProfile.present) {\n      attendanceDay.status = AttendanceStatus.PRESENT;\n    } else if (random < attendanceProfile.present + attendanceProfile.excused) {\n      attendanceDay.status = AttendanceStatus.EXCUSED;\n      attendanceDay.remarks = faker.random.arrayElement([\n        \"fever\",\n        \"cough\",\n        \"death in family\",\n        \"family out of town\",\n      ]);\n    } else if (\n      random <\n      attendanceProfile.present +\n        attendanceProfile.excused +\n        attendanceProfile.late\n    ) {\n      attendanceDay.status = AttendanceStatus.LATE;\n    } else {\n      attendanceDay.status = AttendanceStatus.ABSENT;\n    }\n  }\n\n  /**\n   * Select a new attendance profile (likelihood for absences, etc.).\n   * It's most likely the profile will remain the same as in previous month.\n   * @param previousAttendanceProfile\n   */\n  private selectNextAttendanceProfile(\n    previousAttendanceProfile: AttendanceProfile\n  ) {\n    if (!previousAttendanceProfile) {\n      return faker.random.arrayElement(ATTENDANCE_PROFILES);\n    }\n\n    if (faker.random.number(100) < 80) {\n      return previousAttendanceProfile;\n    } else {\n      return faker.random.arrayElement(ATTENDANCE_PROFILES);\n    }\n  }\n}\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { DatabaseField } from \"../../../core/entity/database-field.decorator\";\n\nexport enum AttendanceStatus {\n  UNKNOWN = \"?\",\n  HOLIDAY = \"H\",\n  ABSENT = \"A\",\n  PRESENT = \"P\",\n  LATE = \"L\",\n  EXCUSED = \"E\",\n}\n\nexport class AttendanceDay {\n  @DatabaseField({ dataType: \"date-only\" }) date: Date;\n  @DatabaseField() status: AttendanceStatus;\n  @DatabaseField() remarks: string = \"\";\n\n  constructor(date: Date, status: AttendanceStatus = AttendanceStatus.UNKNOWN) {\n    this.date = date;\n    this.status = status;\n  }\n}\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { Entity } from \"../../../core/entity/entity\";\nimport { WarningLevel } from \"../../warning-level\";\nimport { AttendanceDay, AttendanceStatus } from \"./attendance-day\";\nimport { DatabaseEntity } from \"../../../core/entity/database-entity.decorator\";\nimport { DatabaseField } from \"../../../core/entity/database-field.decorator\";\n\n@DatabaseEntity(\"AttendanceMonth\")\nexport class AttendanceMonth extends Entity {\n  static readonly THRESHOLD_URGENT = 0.6;\n  static readonly THRESHOLD_WARNING = 0.8;\n\n  public static createAttendanceMonth(childId: string, institution: string) {\n    const month = new Date();\n    const newAtt = new AttendanceMonth(\n      childId +\n        \"_\" +\n        month.getFullYear() +\n        \"-\" +\n        (month.getMonth() + 1) +\n        \"_\" +\n        institution\n    );\n    newAtt.month = month;\n    newAtt.student = childId;\n    newAtt.institution = institution;\n    return newAtt;\n  }\n\n  @DatabaseField() student: string; // id of Child entity\n  @DatabaseField() remarks: string = \"\";\n  @DatabaseField() institution: string;\n\n  private p_month: Date;\n  @DatabaseField({ dataType: \"month\" })\n  get month(): Date {\n    return this.p_month;\n  }\n  set month(value: Date) {\n    if (!(value instanceof Date)) {\n      console.warn(\n        \"Trying to set invalid date \" +\n          JSON.stringify(value) +\n          \" to Entity \" +\n          this._id\n      );\n      return;\n    }\n\n    if (value.getDate() !== 2) {\n      value.setDate(2);\n    }\n    this.p_month = new Date(value);\n    this.updateDailyRegister();\n  }\n\n  daysWorking_manuallyEntered: number;\n  @DatabaseField()\n  get daysWorking(): number {\n    if (this.daysWorking_manuallyEntered !== undefined) {\n      return this.daysWorking_manuallyEntered;\n    } else {\n      return this.getDaysWorkingFromDailyAttendance();\n    }\n  }\n\n  set daysWorking(value: number) {\n    this.daysWorking_manuallyEntered = value;\n  }\n\n  daysAttended_manuallyEntered: number;\n  @DatabaseField()\n  get daysAttended(): number {\n    if (this.daysAttended_manuallyEntered !== undefined) {\n      return this.daysAttended_manuallyEntered;\n    } else {\n      return this.getDaysAttendedFromDailyAttendance();\n    }\n  }\n\n  set daysAttended(value: number) {\n    this.daysAttended_manuallyEntered = value;\n  }\n\n  daysExcused_manuallyEntered: number;\n  @DatabaseField()\n  get daysExcused(): number {\n    if (this.daysExcused_manuallyEntered !== undefined) {\n      return this.daysExcused_manuallyEntered;\n    } else {\n      return this.getDaysExcusedFromDailyAttendance();\n    }\n  }\n\n  set daysExcused(value: number) {\n    this.daysExcused_manuallyEntered = value;\n  }\n\n  daysLate_manuallyEntered: number;\n  @DatabaseField()\n  get daysLate(): number {\n    if (this.daysLate_manuallyEntered !== undefined) {\n      return this.daysLate_manuallyEntered;\n    } else {\n      return this.calculateFromDailyRegister(AttendanceStatus.LATE);\n    }\n  }\n  set daysLate(value: number) {\n    this.daysLate_manuallyEntered = value;\n  }\n\n  overridden = false; // indicates individual override during bulk adding\n\n  private _dailyRegister = new Array<AttendanceDay>();\n  set dailyRegister(value: AttendanceDay[]) {\n    if (!value) {\n      return;\n    }\n\n    for (const attDay of value) {\n      if (typeof attDay.date.getTime !== \"function\") {\n        attDay.date = new Date(attDay.date);\n      }\n    }\n    this._dailyRegister = value;\n  }\n  @DatabaseField({ arrayDataType: \"schema-embed\", ext: AttendanceDay })\n  get dailyRegister(): AttendanceDay[] {\n    return this._dailyRegister;\n  }\n\n  constructor(id: string) {\n    super(id);\n    this.month = new Date();\n  }\n\n  private updateDailyRegister() {\n    if (this.month === undefined) {\n      return;\n    }\n\n    if (this.dailyRegister === undefined) {\n      this.dailyRegister = new Array<AttendanceDay>();\n    }\n\n    const expectedDays = daysInMonth(this.month);\n    const currentDays = this.dailyRegister.length;\n    if (currentDays < expectedDays) {\n      for (let i = currentDays + 1; i <= expectedDays; i++) {\n        const date = new Date(\n          this.month.getFullYear(),\n          this.month.getMonth(),\n          i\n        );\n        const day = new AttendanceDay(date);\n        this.dailyRegister.push(day);\n      }\n    } else if (currentDays > expectedDays) {\n      this.dailyRegister.splice(expectedDays);\n    }\n\n    this.dailyRegister.forEach((day) => {\n      day.date.setMonth(this.month.getMonth());\n      day.date.setFullYear(this.month.getFullYear());\n    });\n  }\n\n  private calculateFromDailyRegister(status: AttendanceStatus) {\n    let count = 0;\n    this.dailyRegister.forEach((day) => {\n      if (day.status === status) {\n        count++;\n      }\n    });\n    return count;\n  }\n\n  public getDaysWorkingFromDailyAttendance() {\n    return (\n      this.dailyRegister.length -\n      this.calculateFromDailyRegister(AttendanceStatus.HOLIDAY) -\n      this.calculateFromDailyRegister(AttendanceStatus.UNKNOWN)\n    );\n  }\n\n  public getDaysAttendedFromDailyAttendance() {\n    return (\n      this.calculateFromDailyRegister(AttendanceStatus.PRESENT) +\n      this.calculateFromDailyRegister(AttendanceStatus.LATE)\n    );\n  }\n\n  public getDaysExcusedFromDailyAttendance() {\n    return this.calculateFromDailyRegister(AttendanceStatus.EXCUSED);\n  }\n\n  public getDaysLateFromDailyAttendance() {\n    return this.calculateFromDailyRegister(AttendanceStatus.LATE);\n  }\n\n  getAttendancePercentage() {\n    return this.daysAttended / (this.daysWorking - this.daysExcused);\n  }\n\n  getWarningLevel() {\n    const attendance = this.getAttendancePercentage();\n    if (attendance < AttendanceMonth.THRESHOLD_URGENT) {\n      return WarningLevel.URGENT;\n    } else if (attendance < AttendanceMonth.THRESHOLD_WARNING) {\n      return WarningLevel.WARNING;\n    } else {\n      return WarningLevel.OK;\n    }\n  }\n}\n\nexport function daysInMonth(date: Date) {\n  return new Date(date.getFullYear(), date.getMonth() + 1, 0).getDate();\n}\n","<span *ngIf=\"entity\"\n      (mouseenter)=\"showTooltip()\" (mouseleave)=\"hideTooltip()\" (click)=\"showDetailsPage()\"\n      [ngClass]=\"{ 'inactive': !entity.isActive() }\">\n  <img [src]=\"entity?.photo?.value\" class=\"child-pic\">\n  {{entity?.name}} <span style=\"font-size: x-small\">({{entity?.projectNumber}})</span>\n</span>\n\n<div style=\"position:absolute;\" *ngIf=\"tooltipVisible\">\n  <div class=\"mat-elevation-z5 child-tooltip\" (mouseenter)=\"showTooltip()\" (mouseleave)=\"hideTooltip()\" fxLayout='row'>\n    <div fxFlex='30'>\n      <img [src]=\"entity?.photo?.value\" class=\"child-pic-large\">\n    </div>\n    <div fxFlex>\n      <h3>{{entity?.name}}</h3>\n      <p><span class='fa fa-phone'></span> {{entity?.phone}}</p>\n      <p><app-school-block [entityId]='entity?.schoolId'></app-school-block>,\n        class {{entity?.schoolClass}}\n      </p>\n    </div>\n  </div>\n</div>\n","import { Component, Input, OnInit } from \"@angular/core\";\nimport { Router } from \"@angular/router\";\nimport { ChildrenService } from \"../children.service\";\nimport { Child } from \"../model/child\";\nimport { UntilDestroy, untilDestroyed } from \"@ngneat/until-destroy\";\n\n@UntilDestroy()\n@Component({\n  selector: \"app-child-block\",\n  templateUrl: \"./child-block.component.html\",\n  styleUrls: [\"./child-block.component.scss\"],\n})\nexport class ChildBlockComponent implements OnInit {\n  @Input() entity: Child;\n  @Input() entityId: string;\n\n  /** prevent clicks on the component to navigate to the details page */\n  @Input() linkDisabled: boolean;\n\n  /** prevent additional details to be displayed in a tooltip on mouse over */\n  @Input() tooltipDisabled: boolean;\n  tooltipVisible = false;\n  tooltipTimeout;\n\n  constructor(\n    private router: Router,\n    private childrenService: ChildrenService\n  ) {}\n\n  async ngOnInit() {\n    if (this.entityId) {\n      this.childrenService\n        .getChild(this.entityId)\n        .pipe(untilDestroyed(this))\n        .subscribe((child) => {\n          this.entity = child;\n        });\n    }\n  }\n\n  showTooltip() {\n    if (this.tooltipDisabled) {\n      return;\n    }\n\n    this.tooltipVisible = true;\n    if (this.tooltipTimeout) {\n      clearTimeout(this.tooltipTimeout);\n    }\n  }\n\n  hideTooltip() {\n    this.tooltipTimeout = setTimeout(() => (this.tooltipVisible = false), 250);\n  }\n\n  showDetailsPage() {\n    if (this.linkDisabled) {\n      return;\n    }\n\n    this.router.navigate([\"/child\", this.entity.getId()]);\n  }\n}\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { Component, Inject, OnInit } from \"@angular/core\";\nimport { Child } from \"../model/child\";\nimport { EntityMapperService } from \"../../../core/entity/entity-mapper.service\";\nimport { Gender } from \"../model/Gender\";\nimport { ActivatedRoute, Router } from \"@angular/router\";\nimport { FormBuilder, FormGroup, Validators } from \"@angular/forms\";\nimport { MatSnackBar } from \"@angular/material/snack-bar\";\nimport { Location } from \"@angular/common\";\nimport { ConfirmationDialogService } from \"../../../core/confirmation-dialog/confirmation-dialog.service\";\nimport * as uniqid from \"uniqid\";\nimport { AlertService } from \"../../../core/alerts/alert.service\";\nimport { ChildrenService } from \"../children.service\";\nimport { ChildPhotoService } from \"../child-photo-service/child-photo.service\";\nimport { SessionService } from \"../../../core/session/session-service/session.service\";\nimport { UntilDestroy, untilDestroyed } from \"@ngneat/until-destroy\";\n\n@UntilDestroy()\n@Component({\n  selector: \"app-child-details\",\n  templateUrl: \"./child-details.component.html\",\n  styleUrls: [\"./child-details.component.scss\"],\n})\nexport class ChildDetailsComponent implements OnInit {\n  child: Child = new Child(\"\");\n\n  validateForm = false;\n  form: FormGroup;\n  healthCheckForm: FormGroup;\n  creatingNew = false;\n  editing = false;\n  enablePhotoUpload;\n  gender = Gender;\n\n  genders = Gender;\n  documentStatus = [\n    \"OK (copy with us)\",\n    \"OK (copy needed for us)\",\n    \"needs correction\",\n    \"applied\",\n    \"doesn't have\",\n    \"not eligible\",\n    \"\",\n  ];\n  eyeStatusValues = [\"Good\", \"Has Glasses\", \"Needs Glasses\", \"Needs Checkup\"];\n  vaccinationStatusValues = [\n    \"Good\",\n    \"Vaccination Due\",\n    \"Needs Checking\",\n    \"No Card/Information\",\n  ];\n  isAdminUser: boolean;\n\n  constructor(\n    private entityMapperService: EntityMapperService,\n    private childrenService: ChildrenService,\n    private route: ActivatedRoute,\n    @Inject(FormBuilder) public fb: FormBuilder,\n    private router: Router,\n    private location: Location,\n    private snackBar: MatSnackBar,\n    private confirmationDialog: ConfirmationDialogService,\n    private alertService: AlertService,\n    private childPhotoService: ChildPhotoService,\n    private sessionService: SessionService\n  ) {\n    this.route.paramMap.subscribe((params) => this.loadChild(params.get(\"id\")));\n    this.isAdminUser = this.sessionService.getCurrentUser().admin;\n  }\n\n  initForm() {\n    this.form = this.fb.group({\n      name: [\n        { value: this.child.name, disabled: !this.editing },\n        Validators.required,\n      ],\n      // gender:         [{value: this.child.gender}], // reactive forms seem broken for mat-select, using ngModel instead\n      projectNumber: [\n        { value: this.child.projectNumber, disabled: !this.editing },\n      ],\n      dateOfBirth: [{ value: this.child.dateOfBirth, disabled: !this.editing }],\n      motherTongue: [\n        { value: this.child.motherTongue, disabled: !this.editing },\n      ],\n      religion: [{ value: this.child.religion, disabled: !this.editing }],\n\n      center: [\n        { value: this.child.center, disabled: !this.editing },\n        Validators.required,\n      ],\n      status: [{ value: this.child.status, disabled: !this.editing }],\n      admissionDate: [\n        { value: this.child.admissionDate, disabled: !this.editing },\n      ],\n\n      address: [{ value: this.child.address, disabled: !this.editing }],\n      phone: [{ value: this.child.phone, disabled: !this.editing }],\n      guardianName: [\n        { value: this.child.guardianName, disabled: !this.editing },\n      ],\n      preferredTimeForGuardianMeeting: [\n        {\n          value: this.child.preferredTimeForGuardianMeeting,\n          disabled: !this.editing,\n        },\n      ],\n\n      // aadhar:         [{value: this.child.has_aadhar,         disabled: !this.editing}],\n      // kanyashree:     [{value: this.child.has_kanyashree,     disabled: !this.editing}],\n      // bankAccount:    [{value: this.child.has_bankAccount,    disabled: !this.editing}],\n      // rationCard:     [{value: this.child.has_rationCard,     disabled: !this.editing}],\n      // bplCard:        [{value: this.child.has_BplCard,        disabled: !this.editing}],\n\n      // health_vaccinationStatus:    [{value: this.child.health_vaccinationStatus,    disabled: !this.editing}],\n      health_bloodGroup: [\n        { value: this.child.health_bloodGroup, disabled: !this.editing },\n      ],\n      health_lastDentalCheckup: [\n        { value: this.child.health_lastDentalCheckup, disabled: !this.editing },\n      ],\n      health_lastEyeCheckup: [\n        { value: this.child.health_lastEyeCheckup, disabled: !this.editing },\n      ],\n      // health_eyeHealthStatus:   [{value: this.child.health_eyeHealthStatus,    disabled: !this.editing}],\n      health_lastENTCheckup: [\n        { value: this.child.health_lastENTCheckup, disabled: !this.editing },\n      ],\n      health_lastVitaminD: [\n        { value: this.child.health_lastVitaminD, disabled: !this.editing },\n      ],\n      health_lastDeworming: [\n        { value: this.child.health_lastDeworming, disabled: !this.editing },\n      ],\n\n      dropoutDate: [{ value: this.child.dropoutDate, disabled: !this.editing }],\n      dropoutType: [{ value: this.child.dropoutType, disabled: !this.editing }],\n      dropoutRemarks: [\n        { value: this.child.dropoutRemarks, disabled: !this.editing },\n      ],\n\n      photoFile: [{ value: this.child.photoFile, disabled: !this.editing }],\n    });\n  }\n\n  ngOnInit() {}\n\n  loadChild(id: string) {\n    if (id === \"new\") {\n      this.creatingNew = true;\n      this.editing = true;\n      this.child = new Child(uniqid());\n    } else {\n      this.childrenService\n        .getChild(id)\n        .pipe(untilDestroyed(this))\n        .subscribe((child) => {\n          this.child = child;\n          this.initForm();\n        });\n    }\n    this.initForm();\n  }\n\n  changedRecordInEntitySubrecord() {\n    this.childrenService\n      .getChild(this.child.getId())\n      .pipe(untilDestroyed(this))\n      .subscribe((child) => {\n        this.child = child;\n      });\n  }\n\n  switchEdit() {\n    this.editing = !this.editing;\n    this.enablePhotoUpload = this.childPhotoService.canSetImage();\n    this.initForm();\n  }\n\n  save() {\n    // errors regarding invalid fields wont be displayed unless marked as touched\n    this.form.markAllAsTouched();\n    this.validateForm = true;\n\n    if (this.form.valid) {\n      this.assignFormValuesToChild(this.child, this.form);\n\n      this.entityMapperService\n        .save<Child>(this.child)\n        .then(() => {\n          if (this.creatingNew) {\n            this.router.navigate([\"/child\", this.child.getId()]);\n            this.creatingNew = false;\n          }\n          this.alertService.addInfo(\"Saving Succesfull\");\n          this.switchEdit();\n        })\n        .catch((err) =>\n          this.alertService.addDanger(\n            'Could not save Child \"' + this.child.name + '\": ' + err\n          )\n        );\n    } else {\n      const invalidFields = this.getInvalidFields(this.form);\n      this.alertService.addDanger(\n        \"Form invalid, required fields (\" + invalidFields + \") missing\"\n      );\n    }\n  }\n\n  private assignFormValuesToChild(child: Child, form: FormGroup) {\n    Object.keys(form.controls).forEach((key) => {\n      const value = form.get(key).value;\n      if (value !== null) {\n        child[key] = value;\n      }\n    });\n  }\n\n  removeChild() {\n    const dialogRef = this.confirmationDialog.openDialog(\n      \"Delete?\",\n      \"Are you sure you want to delete this Child?\"\n    );\n\n    dialogRef.afterClosed().subscribe((confirmed) => {\n      if (confirmed) {\n        this.entityMapperService\n          .remove<Child>(this.child)\n          .then(() => this.router.navigate([\"/child\"]));\n\n        const snackBarRef = this.snackBar.open(\n          'Deleted Child \"' + this.child.name + '\"',\n          \"Undo\",\n          { duration: 8000 }\n        );\n        snackBarRef.onAction().subscribe(() => {\n          this.entityMapperService.save(this.child, true);\n          this.router.navigate([\"/child\", this.child.getId()]);\n        });\n      }\n    });\n  }\n\n  navigateBack() {\n    this.location.back();\n  }\n\n  getInvalidFields(form: FormGroup) {\n    const invalid = [];\n    const controls = this.form.controls;\n    for (const field in controls) {\n      if (controls[field].invalid) {\n        invalid.push(field);\n      }\n    }\n    return invalid;\n  }\n\n  /**\n   * hands over the selected file to the cloudFileService together with the childId\n   * @param event The event of the file upload dialog\n   */\n  async uploadChildPhoto(event) {\n    await this.childPhotoService.setImage(\n      event.target.files[0],\n      this.child.entityId\n    );\n    this.child.photo.next(await this.childPhotoService.getImage(this.child));\n  }\n}\n","<!--\n  ~     This file is part of ndb-core.\n  ~\n  ~     ndb-core is free software: you can redistribute it and/or modify\n  ~     it under the terms of the GNU General Public License as published by\n  ~     the Free Software Foundation, either version 3 of the License, or\n  ~     (at your option) any later version.\n  ~\n  ~     ndb-core is distributed in the hope that it will be useful,\n  ~     but WITHOUT ANY WARRANTY; without even the implied warranty of\n  ~     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n  ~     GNU General Public License for more details.\n  ~\n  ~     You should have received a copy of the GNU General Public License\n  ~     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n  -->\n\n<div fxLayout=\"row\" fxLayoutAlign=\"space-between\">\n  <div>\n    <h1 class=\"page-header section-child\">\n      <button\n        mat-icon-button\n        (click)=\"navigateBack()\"\n        matTooltip=\"Back\"\n        style=\"vertical-align: middle;\"\n      >\n        <mat-icon fontIcon=\"fa-backward\"></mat-icon>\n      </button>\n\n      <i class=\"fa fa-child fa-fw\"></i>\n      <span *ngIf=\"!creatingNew\"\n        >{{ child.name }} [{{ child.projectNumber }}]</span\n      >\n      <span *ngIf=\"creatingNew\">Adding new Child</span>\n    </h1>\n  </div>\n\n  <div>\n    <button\n      *ngIf=\"creatingNew || editing\"\n      mat-stroked-button\n      class=\"edit-button\"\n      (click)=\"save()\"\n    >\n      Save\n    </button>\n\n    <button\n      *ngIf=\"!creatingNew && editing\"\n      mat-stroked-button\n      class=\"edit-button\"\n      style=\"color: red;\"\n      (click)=\"removeChild()\"\n    >\n      Delete\n    </button>\n\n    <button\n      *ngIf=\"creatingNew || editing\"\n      mat-stroked-button\n      class=\"edit-button\"\n      (click)=\"switchEdit()\"\n    >\n      Cancel\n    </button>\n\n    <button\n      *ngIf=\"!editing\"\n      mat-stroked-button\n      class=\"edit-button\"\n      (click)=\"switchEdit()\"\n    >\n      Edit\n    </button>\n  </div>\n</div>\n\n<mat-accordion multi=\"true\">\n  <form [formGroup]=\"form\">\n    <mat-expansion-panel\n      hideToggle=\"true\"\n      [expanded]=\"child.isActive()\"\n      title=\"Basic Information\"\n    >\n      <mat-expansion-panel-header class=\"section-header\">\n        <mat-panel-title>\n          Basic Information\n        </mat-panel-title>\n      </mat-expansion-panel-header>\n\n      <div\n        fxLayout=\"row\"\n        fxLayout.xs=\"column wrap\"\n        fxLayout.md=\"column wrap\"\n        fxLayout.sm=\"column wrap\"\n      >\n        <div fxFlex=\"160px\" class=\"child-pic-container\">\n          <img\n            [src]=\"child?.photo?.value\"\n            class=\"child-pic\"\n            alt=\"child's photo\"\n          />\n\n          <input\n            style=\"display: none;\"\n            type=\"file\"\n            accept=\".jpg, .jpeg, .png\"\n            (change)=\"uploadChildPhoto($event)\"\n            #fileUpload\n          />\n          <button\n            *ngIf=\"enablePhotoUpload && (creatingNew || editing)\"\n            class=\"child-pic-upload\"\n            (click)=\"fileUpload.click()\"\n          >\n            <mat-icon class=\"upload-icon\" fontIcon=\"fa-upload\"></mat-icon>\n          </button>\n\n          <mat-form-field\n            *ngIf=\"(creatingNew || editing) && isAdminUser\"\n            class=\"child-pic-photofile\"\n          >\n            <input\n              #photoFileInput\n              matTooltip=\"filename for child photo uploaded by server administrator\"\n              matInput\n              formControlName=\"photoFile\"\n              placeholder=\"Photo filename\"\n              title=\"photoFile\"\n              type=\"text\"\n            />\n            <span\n              matSuffix\n              (click)=\"photoFileInput.value = ''\"\n              class=\"fa fa-times\"\n            ></span>\n          </mat-form-field>\n        </div>\n\n        <div fxFlex>\n          <mat-form-field style=\"width: 300px;\">\n            <input\n              matInput\n              formControlName=\"name\"\n              placeholder=\"Name\"\n              title=\"name\"\n              type=\"text\"\n            />\n            <mat-error *ngIf=\"this.form.get('name').invalid && validateForm\">\n              Name is required\n            </mat-error>\n          </mat-form-field>\n\n          <mat-form-field style=\"width: 100px;\">\n            <input\n              matInput\n              formControlName=\"projectNumber\"\n              placeholder=\"Project Number\"\n              type=\"text\"\n            />\n          </mat-form-field>\n\n          <mat-form-field>\n            <input\n              matInput\n              formControlName=\"center\"\n              placeholder=\"Center\"\n              type=\"text\"\n            />\n            <mat-error *ngIf=\"this.form.get('center').invalid && validateForm\">\n              Center is required\n            </mat-error>\n          </mat-form-field>\n\n          <mat-form-field>\n            <input\n              matInput\n              formControlName=\"status\"\n              placeholder=\"Project Status\"\n              type=\"text\"\n            />\n          </mat-form-field>\n        </div>\n\n        <div>\n          <mat-form-field style=\"width: 50px;\">\n            <input\n              matInput\n              placeholder=\"Age\"\n              type=\"number\"\n              [value]=\"child.age\"\n              [disabled]=\"true\"\n            />\n          </mat-form-field>\n          <mat-form-field style=\"width: 120px;\">\n            <input\n              matInput\n              formControlName=\"dateOfBirth\"\n              placeholder=\"Date of Birth\"\n              [matDatepicker]=\"dateOfBirthDatepicker\"\n              [disabled]=\"!editing\"\n            />\n            <mat-datepicker-toggle\n              matSuffix\n              [for]=\"dateOfBirthDatepicker\"\n            ></mat-datepicker-toggle>\n            <mat-datepicker #dateOfBirthDatepicker></mat-datepicker>\n          </mat-form-field>\n\n          <mat-form-field>\n            <mat-label>\n              Gender\n            </mat-label>\n            <mat-select\n              [disabled]=\"!editing\"\n              [(ngModel)]=\"child.gender\"\n              [ngModelOptions]=\"{ standalone: true }\"\n            >\n              <mat-option *ngFor=\"let g of genders | keys\" [value]=\"g.value\">{{\n                g.key\n              }}</mat-option>\n            </mat-select>\n          </mat-form-field>\n\n          <mat-form-field>\n            <input\n              matInput\n              formControlName=\"motherTongue\"\n              placeholder=\"Mother Tongue\"\n              type=\"text\"\n            />\n          </mat-form-field>\n\n          <mat-form-field>\n            <input\n              matInput\n              formControlName=\"religion\"\n              placeholder=\"Religion\"\n              title=\"Religion\"\n              type=\"text\"\n            />\n          </mat-form-field>\n        </div>\n\n        <div>\n          <mat-form-field style=\"width: 180px;\">\n            <input\n              matInput\n              formControlName=\"admissionDate\"\n              placeholder=\"Admission Date\"\n              [matDatepicker]=\"admissionDatepicker\"\n              [disabled]=\"!editing\"\n            />\n            <mat-datepicker-toggle\n              matSuffix\n              [for]=\"admissionDatepicker\"\n            ></mat-datepicker-toggle>\n            <mat-datepicker #admissionDatepicker></mat-datepicker>\n          </mat-form-field>\n\n          <mat-form-field>\n            <mat-label>\n              Aadhar Status\n            </mat-label>\n            <mat-select\n              [disabled]=\"!editing\"\n              [(ngModel)]=\"child.has_aadhar\"\n              [ngModelOptions]=\"{ standalone: true }\"\n            >\n              <mat-option *ngFor=\"let s of documentStatus\" [value]=\"s\">{{\n                s\n              }}</mat-option>\n            </mat-select>\n          </mat-form-field>\n\n          <mat-form-field>\n            <mat-label>\n              Kanyashree Status\n            </mat-label>\n            <mat-select\n              [disabled]=\"!editing\"\n              [(ngModel)]=\"child.has_kanyashree\"\n              [ngModelOptions]=\"{ standalone: true }\"\n            >\n              <mat-option *ngFor=\"let s of documentStatus\" [value]=\"s\">{{\n                s\n              }}</mat-option>\n            </mat-select>\n          </mat-form-field>\n\n          <mat-form-field>\n            <mat-label>\n              Bank Account Status\n            </mat-label>\n            <mat-select\n              [disabled]=\"!editing\"\n              [(ngModel)]=\"child.has_bankAccount\"\n              [ngModelOptions]=\"{ standalone: true }\"\n            >\n              <mat-option *ngFor=\"let s of documentStatus\" [value]=\"s\">{{\n                s\n              }}</mat-option>\n            </mat-select>\n          </mat-form-field>\n\n          <mat-form-field>\n            <mat-label>\n              Ration Card Status\n            </mat-label>\n            <mat-select\n              [disabled]=\"!editing\"\n              [(ngModel)]=\"child.has_rationCard\"\n              [ngModelOptions]=\"{ standalone: true }\"\n            >\n              <mat-option *ngFor=\"let s of documentStatus\" [value]=\"s\">{{\n                s\n              }}</mat-option>\n            </mat-select>\n          </mat-form-field>\n\n          <mat-form-field>\n            <mat-label>\n              BPL Card Status\n            </mat-label>\n            <mat-select\n              [disabled]=\"!editing\"\n              [(ngModel)]=\"child.has_BplCard\"\n              [ngModelOptions]=\"{ standalone: true }\"\n            >\n              <mat-option *ngFor=\"let s of documentStatus\" [value]=\"s\">{{\n                s\n              }}</mat-option>\n            </mat-select>\n          </mat-form-field>\n        </div>\n\n        <div>\n          <mat-form-field style=\"width: 300px;\">\n            <input\n              matInput\n              type=\"text\"\n              formControlName=\"address\"\n              placeholder=\"Address\"\n            />\n          </mat-form-field>\n\n          <mat-form-field>\n            <input\n              matInput\n              type=\"text\"\n              formControlName=\"phone\"\n              placeholder=\"Phone No.\"\n            />\n          </mat-form-field>\n\n          <mat-form-field>\n            <input\n              matInput\n              type=\"text\"\n              formControlName=\"guardianName\"\n              placeholder=\"Guardians\"\n            />\n          </mat-form-field>\n\n          <mat-form-field>\n            <input\n              matInput\n              type=\"text\"\n              formControlName=\"preferredTimeForGuardianMeeting\"\n              placeholder=\"Preferred time for guardians meeting\"\n            />\n          </mat-form-field>\n        </div>\n      </div>\n    </mat-expansion-panel>\n\n    <mat-expansion-panel\n      expanded=\"false\"\n      title=\"Education\"\n      [disabled]=\"creatingNew\">\n      <mat-expansion-panel-header class=\"section-header\">\n        <mat-icon fontIcon=\"fa-exclamation-triangle\" *ngIf=\"creatingNew\"\n                  class=\"locked-icon\"\n                  matTooltip=\"Please save before entering further data\"\n                  [matTooltipDisabled]=\"!creatingNew\">\n        </mat-icon>\n        Education\n      </mat-expansion-panel-header>\n\n      <div\n        *ngIf=\"child.schoolId\"\n        matTooltip=\"To edit the current school or class, please add to the school history below\"\n      >\n        <em>\n          Currently attending class {{ child.schoolClass }} at\n          <app-school-block [entityId]=\"child.schoolId\"></app-school-block>\n        </em>\n      </div>\n\n      <div>\n        <h3>School History</h3>\n        <app-previous-schools\n          [childId]=\"child.getId()\"\n          (changedRecordInEntitySubrecord)=\"changedRecordInEntitySubrecord()\"\n        >\n        </app-previous-schools>\n      </div>\n      <br />\n\n      <div>\n        <h3>ASER Results</h3>\n        <app-aser></app-aser>\n      </div>\n    </mat-expansion-panel>\n\n    <mat-expansion-panel expanded=\"false\" title=\"Attendance\"\n                         [disabled]=\"creatingNew\">\n      <mat-expansion-panel-header class=\"section-header\">\n        <mat-icon fontIcon=\"fa-exclamation-triangle\" *ngIf=\"creatingNew\"\n                  class=\"locked-icon\"\n                  matTooltip=\"Please save before entering further data\"\n                  [matTooltipDisabled]=\"!creatingNew\">\n        </mat-icon>\n        Attendance\n      </mat-expansion-panel-header>\n\n      <div fxLayout=\"row wrap\" fxLayout.lt-lg=\"column\" fxLayoutGap=\"2em\">\n        <div fxFlex=\"45\">\n          <h3>School Attendance</h3>\n          <app-child-attendance\n            [childId]=\"child.getId()\"\n            institution=\"school\"\n            [showDailyAttendanceOfLatest]=\"true\"\n          ></app-child-attendance>\n        </div>\n        <div fxFlex=\"45\">\n          <h3>Coaching Attendance</h3>\n          <app-child-attendance\n            [childId]=\"child.getId()\"\n            institution=\"coaching\"\n            [showDailyAttendanceOfLatest]=\"true\"\n          ></app-child-attendance>\n        </div>\n      </div>\n    </mat-expansion-panel>\n\n\n    <mat-expansion-panel expanded=\"false\"\n                         [disabled]=\"creatingNew\">\n      <mat-expansion-panel-header class=\"section-header\">\n        <mat-icon fontIcon=\"fa-exclamation-triangle\" *ngIf=\"creatingNew\"\n                  class=\"locked-icon\"\n                  matTooltip=\"Please save before entering further data\"\n                  [matTooltipDisabled]=\"!creatingNew\">\n        </mat-icon>\n        Notes & Reports\n      </mat-expansion-panel-header>\n\n      <app-notes-of-child [childId]=\"child.getId()\"></app-notes-of-child>\n    </mat-expansion-panel>\n\n\n    <mat-expansion-panel [expanded]=\"false\"\n                         [disabled]=\"creatingNew\">\n      <mat-expansion-panel-header class=\"section-header\">\n        <mat-icon fontIcon=\"fa-exclamation-triangle\" *ngIf=\"creatingNew\"\n                  class=\"locked-icon\"\n                  matTooltip=\"Please save before entering further data\"\n                  [matTooltipDisabled]=\"!creatingNew\">\n        </mat-icon>\n        Health\n      </mat-expansion-panel-header>\n\n      <div>\n        <mat-form-field>\n          <mat-label>\n            Vaccination Status\n          </mat-label>\n          <mat-select\n            [disabled]=\"!editing\"\n            [(ngModel)]=\"child.health_vaccinationStatus\"\n            [ngModelOptions]=\"{ standalone: true }\"\n          >\n            <mat-option\n              *ngFor=\"let value of vaccinationStatusValues\"\n              [value]=\"value\"\n              >{{ value }}</mat-option\n            >\n          </mat-select>\n        </mat-form-field>\n\n        <mat-form-field>\n          <mat-label>\n            Eye Status\n          </mat-label>\n          <mat-select\n            [disabled]=\"!editing\"\n            [(ngModel)]=\"child.health_eyeHealthStatus\"\n            [ngModelOptions]=\"{ standalone: true }\"\n          >\n            <mat-option *ngFor=\"let value of eyeStatusValues\" [value]=\"value\">{{\n              value\n            }}</mat-option>\n          </mat-select>\n        </mat-form-field>\n\n        <mat-form-field>\n          <!-- TODO: replace bloodGroup text field with a custom-select, once it is user configurable (#236) -->\n          <input\n            matInput\n            formControlName=\"health_bloodGroup\"\n            placeholder=\"Blood Group\"\n            type=\"text\"\n          />\n        </mat-form-field>\n      </div>\n\n      <div>\n        <mat-form-field>\n          <input\n            matInput\n            formControlName=\"health_lastDentalCheckup\"\n            placeholder=\"Last Dental Check-Up\"\n            [matDatepicker]=\"lastDentalCheckupDatepicker\"\n            [disabled]=\"!editing\"\n          />\n          <mat-datepicker-toggle\n            matSuffix\n            [for]=\"lastDentalCheckupDatepicker\"\n          ></mat-datepicker-toggle>\n          <mat-datepicker #lastDentalCheckupDatepicker></mat-datepicker>\n        </mat-form-field>\n\n        <mat-form-field>\n          <input\n            matInput\n            formControlName=\"health_lastEyeCheckup\"\n            placeholder=\"Last Eye Check-Up\"\n            [matDatepicker]=\"lastEyeCheckupDatepicker\"\n            [disabled]=\"!editing\"\n          />\n          <mat-datepicker-toggle\n            matSuffix\n            [for]=\"lastEyeCheckupDatepicker\"\n          ></mat-datepicker-toggle>\n          <mat-datepicker #lastEyeCheckupDatepicker></mat-datepicker>\n        </mat-form-field>\n\n        <mat-form-field>\n          <input\n            matInput\n            formControlName=\"health_lastENTCheckup\"\n            placeholder=\"Last ENT Check-Up\"\n            [matDatepicker]=\"lastENTCheckupDatepicker\"\n            [disabled]=\"!editing\"\n          />\n          <mat-datepicker-toggle\n            matSuffix\n            [for]=\"lastENTCheckupDatepicker\"\n          ></mat-datepicker-toggle>\n          <mat-datepicker #lastENTCheckupDatepicker></mat-datepicker>\n        </mat-form-field>\n\n        <mat-form-field>\n          <input\n            matInput\n            formControlName=\"health_lastVitaminD\"\n            placeholder=\"Last Vitamin D\"\n            [matDatepicker]=\"lastVitaminDDatepicker\"\n            [disabled]=\"!editing\"\n          />\n          <mat-datepicker-toggle\n            matSuffix\n            [for]=\"lastVitaminDDatepicker\"\n          ></mat-datepicker-toggle>\n          <mat-datepicker #lastVitaminDDatepicker></mat-datepicker>\n        </mat-form-field>\n        <mat-form-field>\n          <input\n            matInput\n            formControlName=\"health_lastDeworming\"\n            placeholder=\"Last De-Worming\"\n            [matDatepicker]=\"lastDewormingDatepicker\"\n            [disabled]=\"!editing\"\n          />\n          <mat-datepicker-toggle\n            matSuffix\n            [for]=\"lastDewormingDatepicker\"\n          ></mat-datepicker-toggle>\n          <mat-datepicker #lastDewormingDatepicker></mat-datepicker>\n        </mat-form-field>\n      </div>\n\n      <div>\n        <h3>Height & Weight Tracking</h3>\n        <app-health-checkup></app-health-checkup>\n      </div>\n    </mat-expansion-panel>\n\n    <mat-expansion-panel [expanded]=\"false\"\n                         [disabled]=\"creatingNew\">\n      <mat-expansion-panel-header class=\"section-header\">\n        <mat-icon fontIcon=\"fa-exclamation-triangle\" *ngIf=\"creatingNew\"\n                  class=\"locked-icon\"\n                  matTooltip=\"Please save before entering further data\"\n                  [matTooltipDisabled]=\"!creatingNew\">\n        </mat-icon>\n        Educational Materials\n      </mat-expansion-panel-header>\n\n      <app-educational-material></app-educational-material>\n    </mat-expansion-panel>\n\n    <mat-expansion-panel [expanded]=\"!child.isActive()\"\n                         [disabled]=\"creatingNew\">\n      <mat-expansion-panel-header class=\"section-header\">\n        <mat-icon fontIcon=\"fa-exclamation-triangle\" *ngIf=\"creatingNew\"\n                  class=\"locked-icon\"\n                  matTooltip=\"Please save before entering further data\"\n                  [matTooltipDisabled]=\"!creatingNew\">\n        </mat-icon>\n        Dropout\n      </mat-expansion-panel-header>\n\n      <mat-form-field>\n        <input\n          matInput\n          formControlName=\"dropoutDate\"\n          placeholder=\"Dropout Date\"\n          [matDatepicker]=\"dropoutDatepicker\"\n          [disabled]=\"!editing\"\n        />\n        <mat-datepicker-toggle\n          matSuffix\n          [for]=\"dropoutDatepicker\"\n        ></mat-datepicker-toggle>\n        <mat-datepicker #dropoutDatepicker></mat-datepicker>\n      </mat-form-field>\n\n      <mat-form-field>\n        <input\n          matInput\n          formControlName=\"dropoutType\"\n          placeholder=\"Dropout Type\"\n          type=\"text\"\n        />\n      </mat-form-field>\n\n      <mat-form-field>\n        <textarea\n          matInput\n          formControlName=\"dropoutRemarks\"\n          placeholder=\"Dropout Remarks\"\n          type=\"text\"\n        >\n        </textarea>\n      </mat-form-field>\n    </mat-expansion-panel>\n  </form>\n</mat-accordion>\n","import { Injectable } from \"@angular/core\";\nimport { SafeUrl } from \"@angular/platform-browser\";\nimport { CloudFileService } from \"../../../core/webdav/cloud-file-service.service\";\nimport { Child } from \"../model/child\";\nimport { BehaviorSubject } from \"rxjs\";\n\n@Injectable({\n  providedIn: \"root\",\n})\nexport class ChildPhotoService {\n  private basePath = \"photos/\";\n\n  constructor(private cloudFileService: CloudFileService) {}\n\n  /**\n   * Creates an ArrayBuffer of the photo for that Child or the default image url.\n   * @param child\n   */\n  public async getImage(child: {\n    entityId: string;\n    photoFile?: string;\n  }): Promise<SafeUrl> {\n    let image = await this.getImageFromCloudService(child);\n    if (!image) {\n      image = this.getImageFromAssets(child);\n    }\n    return image;\n  }\n\n  private async getImageFromCloudService(child: {\n    entityId: string;\n  }): Promise<SafeUrl> {\n    let image;\n    if (this.cloudFileService.isConnected()) {\n      const imageType = [\".png\", \".jpg\", \".jpeg\", \"\"];\n      for (const ext of imageType) {\n        const filepath = this.basePath + child.entityId + ext;\n        try {\n          image = await this.cloudFileService.getFile(filepath);\n          break;\n        } catch (err) {\n          if (err === \"File not found\") {\n            // ignore and try next file extension\n          } else {\n            console.warn(\"Error loading image: \", err);\n          }\n        }\n      }\n    }\n    return image;\n  }\n\n  private getImageFromAssets(child: { photoFile?: string }): SafeUrl {\n    if (!child.photoFile || child.photoFile.trim() === \"\") {\n      return this.getDefaultImage();\n    }\n    return Child.generatePhotoPath(child.photoFile);\n  }\n\n  private getDefaultImage(): SafeUrl {\n    return \"assets/child.png\";\n  }\n\n  /**\n   * Load the image for the given child asynchronously, immediately returning an Observable\n   * that initially emits the static image and later resolves to the image from the cloud service if one exists.\n   * This allows to immediately display a proper placeholder while the loading may take some time.\n   * @param child The Child instance for which the photo should be loaded.\n   */\n  public getImageAsyncObservable(child: {\n    entityId: string;\n    photoFile?: string;\n  }): BehaviorSubject<SafeUrl> {\n    const resultSubject = new BehaviorSubject(this.getImageFromAssets(child));\n    this.getImageFromCloudService(child).then((photo) => {\n      if (photo && photo !== resultSubject.value) {\n        resultSubject.next(photo);\n      }\n      resultSubject.complete();\n    });\n    return resultSubject;\n  }\n\n  /**\n   * Check if saving/uploading images is supported in the current state.\n   */\n  public canSetImage(): boolean {\n    return this.cloudFileService.isConnected();\n  }\n\n  /**\n   * Uploads a given image through the CloudFileService if connected.\n   * @param imageFile Image to be stored\n   * @param childId Id of child for which one wants to store the image\n   */\n  public async setImage(imageFile: any, childId: string): Promise<void> {\n    if (!this.canSetImage()) {\n      return Promise.reject(\"CloudFileService not connected.\");\n    }\n\n    const fileExt = imageFile.name.substr(imageFile.name.lastIndexOf(\".\"));\n    return this.cloudFileService.uploadFile(\n      imageFile,\n      this.basePath + childId + fileExt\n    );\n  }\n}\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { EntitySchemaDatatype } from \"../../../core/entity/schema/entity-schema-datatype\";\nimport { ChildPhotoService } from \"./child-photo.service\";\nimport { EntitySchemaField } from \"../../../core/entity/schema/entity-schema-field\";\nimport { EntitySchemaService } from \"../../../core/entity/schema/entity-schema.service\";\nimport { Entity } from \"../../../core/entity/entity\";\n\n/**\n * Dynamically load the child's photo through the ChildPhotoService during Entity loading process.\n */\nexport class LoadChildPhotoEntitySchemaDatatype\n  implements EntitySchemaDatatype {\n  public readonly name = \"load-child-photo\";\n\n  constructor(private childPhotoService: ChildPhotoService) {}\n\n  public transformToDatabaseFormat(value) {\n    return undefined;\n  }\n\n  public transformToObjectFormat(\n    value,\n    schemaField: EntitySchemaField,\n    schemaService: EntitySchemaService,\n    parent: Entity\n  ) {\n    const childDummy: any = Object.assign({}, parent);\n    if (!childDummy.entityId) {\n      childDummy.entityId = Entity.extractEntityIdFromId(childDummy._id);\n    }\n\n    return this.childPhotoService.getImageAsyncObservable(childDummy);\n  }\n}\n","<div>\n  <mat-form-field style='width: 100%'>\n    <input #inputField matInput placeholder='Children' (input)='search()' [matAutocomplete]='autoSuggestions'\n           [(ngModel)]='searchText'>\n    <span *ngFor='let child of selectedChildren' class=\"selected-entity-block\">\n        <span class='fa fa-minus-square-o' (click)='unselectChild(child)'></span>\n        <app-child-block [entity]='child' [linkDisabled]='true' [tooltipDisabled]=\"true\"></app-child-block>\n        &nbsp;\n    </span>\n  </mat-form-field>\n\n  <mat-autocomplete #autoSuggestions='matAutocomplete' (optionSelected)='selectChild($event.option.value)'>\n    <mat-option *ngFor='let res of suggestions' [value]='res'>\n      <app-child-block [entity]='res' [linkDisabled]='true' [tooltipDisabled]=\"true\"></app-child-block>\n    </mat-option>\n    <button mat-button *ngIf=\"showOnlyActiveChildren\" (click)=\"showAll()\"\n            matTooltip=\"extend the list to also show inactive records\">\n      Show Dropouts\n    </button>\n  </mat-autocomplete>\n</div>\n","import {\n  Component,\n  EventEmitter,\n  Input,\n  OnChanges,\n  Output,\n  SimpleChanges,\n  ViewChild,\n} from \"@angular/core\";\nimport { Child } from \"../model/child\";\nimport { ChildrenService } from \"../children.service\";\nimport { UntilDestroy, untilDestroyed } from \"@ngneat/until-destroy\";\nimport { MatAutocompleteTrigger } from \"@angular/material/autocomplete\";\n\n@UntilDestroy()\n@Component({\n  selector: \"app-child-select\",\n  templateUrl: \"./child-select.component.html\",\n  styleUrls: [\"./child-select.component.scss\"],\n})\nexport class ChildSelectComponent implements OnChanges {\n  searchText = \"\";\n  showOnlyActiveChildren: boolean = true;\n  suggestions = new Array<Child>();\n  allChildren = new Array<Child>();\n  selectedChildren = new Array<Child>();\n\n  @Input() valueAsIds: string[];\n  @Output() valueAsIdsChange = new EventEmitter();\n  @Output() newIdAdded = new EventEmitter();\n  @Output() idRemoved = new EventEmitter();\n\n  @ViewChild(\"inputField\", { static: true }) inputField;\n  @ViewChild(MatAutocompleteTrigger) autocomplete: MatAutocompleteTrigger;\n\n  constructor(private childrenService: ChildrenService) {}\n\n  ngOnChanges(changes: SimpleChanges): void {\n    if (changes.hasOwnProperty(\"valueAsIds\")) {\n      this.loadInitial();\n    }\n  }\n\n  private loadInitial() {\n    this.childrenService\n      .getChildren()\n      .pipe(untilDestroyed(this))\n      .subscribe((children) => {\n        this.allChildren = [...children]; // clone array\n        this.search();\n\n        this.selectInitialSelectedChildren();\n      });\n  }\n\n  private selectInitialSelectedChildren() {\n    if (this.valueAsIds === undefined) {\n      return;\n    }\n\n    this.selectedChildren = [];\n\n    this.valueAsIds.forEach((selectedId) => {\n      const selectedChild: Child = this.allChildren.find(\n        (c) => c.getId() === selectedId\n      );\n      if (selectedChild) {\n        this.selectChild(selectedChild, true);\n      }\n    });\n  }\n\n  search() {\n    this.searchText = this.searchText.toLowerCase();\n\n    this.suggestions = this.allChildren.filter((child) => {\n      const key = \"\" + child.name + \" \" + child.projectNumber;\n      if (this.showOnlyActiveChildren && !child.isActive()) {\n        return false;\n      }\n      return key.toLowerCase().includes(this.searchText);\n    });\n  }\n\n  showAll() {\n    this.showOnlyActiveChildren = false;\n    this.search();\n    setTimeout(() => this.autocomplete.openPanel());\n  }\n\n  selectChild(child: Child, suppressChangeEvent = false) {\n    if (\n      this.selectedChildren.findIndex((c) => c.getId() === child.getId()) !== -1\n    ) {\n      // skip if already selected\n      return;\n    }\n\n    this.selectedChildren.push(child);\n    if (!suppressChangeEvent) {\n      this.newIdAdded.emit(child.getId());\n      this.valueAsIdsChange.emit(this.selectedChildren.map((c) => c.getId()));\n    }\n\n    const i = this.allChildren.findIndex((e) => e.getId() === child.getId());\n    this.allChildren.splice(i, 1);\n\n    this.searchText = \"\";\n    this.inputField.nativeElement.value = \"\";\n  }\n\n  unselectChild(child: Child) {\n    const i = this.selectedChildren.findIndex(\n      (e) => e.getId() === child.getId()\n    );\n    this.selectedChildren.splice(i, 1);\n    this.allChildren.unshift(child);\n\n    this.idRemoved.emit(child.getId());\n    this.valueAsIdsChange.emit(this.selectedChildren.map((c) => c.getId()));\n  }\n\n  unselectChildId(childId: string) {\n    const child = this.selectedChildren.find((c) => c.getId() === childId);\n    if (child) {\n      this.unselectChild(child);\n    }\n  }\n}\n","<mat-card class='dashboard-widget'>\n  <mat-card-header class='app-child'>\n    <div mat-card-avatar>\n      <mat-icon fontIcon='fa-child'></mat-icon>\n    </div>\n    <mat-card-title>{{totalChildren}}</mat-card-title>\n    <mat-card-subtitle>Children</mat-card-subtitle>\n  </mat-card-header>\n  <mat-card-content>\n    <table class=\"dashboard-table\">\n      <tr *ngFor=\"let entry of childrenByCenter; let i = index;\"\n          class=\"dashboard-table-row\"\n          (click)=\"goToChildrenList(entry[0])\"\n          style=\"cursor: pointer;\"\n\n          angulartics2On=\"click\"\n          angularticsCategory=\"Navigation\"\n          angularticsAction=\"dashboard_children_count_school_link\"\n          [angularticsLabel]=\"'list-entry-' + i\"\n      >\n          <td class=\"dashboard-table-cell\">{{entry[0]}}:</td>\n          <td class=\"dashboard-table-cell\">{{entry[1]}}</td>\n          <td class=\"dashboard-table-cell\"><span class=\"fa fa-external-link-square\"></span></td>\n      </tr>\n    </table>\n  </mat-card-content>\n</mat-card>\n","import { Component, OnInit } from \"@angular/core\";\nimport { ChildrenService } from \"../children.service\";\nimport { Router } from \"@angular/router\";\nimport { UntilDestroy, untilDestroyed } from \"@ngneat/until-destroy\";\nimport { DashboardWidgetComponent } from \"app/child-dev-project/dashboard/dashboard-widget.component\";\nimport { DashboardWidgetConfig } from \"app/child-dev-project/dashboard/dashboard-widget-config.interface\";\n\n@UntilDestroy()\n@Component({\n  selector: \"app-children-count-dashboard\",\n  templateUrl: \"./children-count-dashboard.component.html\",\n  styleUrls: [\"./children-count-dashboard.component.scss\"],\n})\nexport class ChildrenCountDashboardComponent\n  implements DashboardWidgetComponent, OnInit {\n  totalChildren: number;\n  childrenByCenter = [];\n\n  constructor(\n    private childrenService: ChildrenService,\n    public router: Router\n  ) {}\n\n  initFromConfig(config: DashboardWidgetConfig) {}\n\n  ngOnInit() {\n    this.childrenService\n      .getChildren()\n      .pipe(untilDestroyed(this))\n      .subscribe((results) => {\n        this.totalChildren = 0;\n\n        const countMap = new Map<string, number>();\n        results.forEach((child) => {\n          if (child.isActive()) {\n            let count = countMap.get(child.center);\n            if (count === undefined) {\n              count = 0;\n            }\n\n            count++;\n            this.totalChildren++;\n            countMap.set(child.center, count);\n          }\n        });\n        this.childrenByCenter = Array.from(countMap.entries()); // direct use of Map creates change detection problems\n      });\n  }\n\n  goToChildrenList(filterString: string) {\n    this.router.navigate([\"/child\"], {\n      queryParams: { center: filterString.toLocaleLowerCase() },\n    });\n  }\n}\n","<h1>Children List</h1>\n\n<mat-expansion-panel\n  expanded=\"true\"\n  fxLayout=\"column wrap\"\n  fxLayoutGap=\"10px\"\n  class=\"filter-panel\"\n>\n  <div fxLayout=\"row\" fxLayoutGap=\"10px\" fxLayoutAlign=\"none end\">\n    <!-- text search -->\n    <div fxFlex=\"50\">\n      <mat-form-field style=\"width: 100%;\">\n        <input\n          matInput\n          placeholder=\"Filter\"\n          (ngModelChange)=\"applyFilter($event)\"\n          [(ngModel)]=\"filterString\"\n        />\n        <button\n          mat-icon-button\n          *ngIf=\"filterString\"\n          matSuffix\n          aria-label=\"Clear\"\n          (click)=\"filterString = ''; applyFilter('')\"\n        >\n          <mat-icon fontIcon=\"fa-times\"></mat-icon>\n        </button>\n      </mat-form-field>\n    </div>\n    <!-- number of table entries -->\n    <div fxFlex=\"25\" fxHide.xs=\"true\" class=\"align-form-field\">\n      (Showing {{ childrenDataSource.filteredData.length }} children)\n    </div>\n    <!-- add new button -->\n    <div fxFlex=\"25\" class=\"align-form-field\">\n      <button\n        mat-stroked-button\n        color=\"accent\"\n        [routerLink]=\"['/child', 'new']\"\n        angulartics2On=\"click\"\n        angularticsCategory=\"UserAction\"\n        angularticsAction=\"children_list_add_new\"\n      >\n        <mat-icon\n          class=\"button-icon\"\n          aria-label=\"add child\"\n          fontIcon=\"fa-plus-circle\"\n        ></mat-icon>\n        <span fxHide.lt-md=\"true\">\n          Add New\n        </span>\n      </button>\n      <app-export-data\n        [data]=\"childrenList\"\n        format=\"csv\"\n        filename=\"ChildrenList\"\n        angulartics2On=\"click\"\n        angularticsCategory=\"UserAction\"\n        angularticsAction=\"children_list_csv_export\"\n      >\n        <mat-icon\n          class=\"button-icon\"\n          aria-label=\"download csv\"\n          fontIcon=\"fa-download\"\n        ></mat-icon>\n        <span fxHide.lt-md=\"true\">\n          Download CSV\n        </span>\n      </app-export-data>\n    </div>\n  </div>\n  <!--\n  <mat-form-field>\n    <mat-select fxShow.xs=\"true\" [value]=\"columnGroupSelection\">\n      <mat-option *ngFor=\"let item of columnGroups\" [value]=\"item.name\"\n                  (click)=\"displayColumnGroup(item.name)\">\n        {{item.name}}\n      </mat-option>\n    </mat-select>\n  </mat-form-field>\n  -->\n  <div\n    fxLayout=\"row wrap\"\n    fxLayoutGap=\"10px\"\n    class=\"filter-button\"\n    fxHide.lt-sm\n  >\n    <mat-button-toggle-group\n      name=\"columnSelection\"\n      [(value)]=\"columnGroupSelection\"\n      fxLayout=\"row wrap\"\n    >\n      <mat-button-toggle\n        *ngFor=\"let item of columnGroups\"\n        [value]=\"item.name\"\n        (click)=\"displayColumnGroup(item.name)\"\n      >\n        {{ item.name }}\n      </mat-button-toggle>\n    </mat-button-toggle-group>\n\n    <mat-button-toggle-group\n      *ngFor=\"let filterSelection of filterSelections\"\n      [name]=\"filterSelection.name\"\n      [value]=\"filterSelection.selectedOption\"\n    >\n      <mat-button-toggle\n        *ngFor=\"let option of filterSelection.options\"\n        [value]=\"option.key\"\n        (click)=\"\n          filterSelection.selectedOption = option.key; applyFilterSelections()\n        \"\n      >\n        {{ option.label }}\n      </mat-button-toggle>\n    </mat-button-toggle-group>\n  </div>\n  <div fxLayout=\"row wrap\" fxHide.gt-xs>\n    <mat-form-field\n      *ngFor=\"let filterSelection of filterSelections\"\n      style=\"padding-right: 1%;\"\n    >\n      <mat-label>{{ filterSelection.name }}</mat-label>\n      <mat-select\n        [id]=\"filterSelection.name\"\n        [value]=\"filterSelection.selectedOption\"\n        placeholder=\"filterSelection.name\"\n      >\n        <mat-option\n          *ngFor=\"let option of filterSelection.options\"\n          [value]=\"option.key\"\n          (click)=\"\n            filterSelection.selectedOption = option.key; applyFilterSelections()\n          \"\n        >\n          {{ option.label }}\n        </mat-option>\n      </mat-select>\n    </mat-form-field>\n  </div>\n</mat-expansion-panel>\n\n<!--<mat-divider></mat-divider>-->\n\n<div class=\"mat-elevation-z8 table-list\">\n  <table mat-table [dataSource]=\"childrenDataSource\" matSort style=\"width: 100%\">\n    <ng-container matColumnDef=\"projectNumber\">\n      <th mat-header-cell *matHeaderCellDef mat-sort-header>PN</th>\n      <td mat-cell *matCellDef=\"let child\">{{ child.projectNumber }}</td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"name\">\n      <th mat-header-cell *matHeaderCellDef mat-sort-header>Name</th>\n      <td mat-cell *matCellDef=\"let child\">\n        <app-child-block [entity]=\"child\"></app-child-block>\n      </td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"age\">\n      <th mat-header-cell *matHeaderCellDef mat-sort-header>Age</th>\n      <td mat-cell *matCellDef=\"let child\">{{ child.age }}</td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"dateOfBirth\">\n      <th mat-header-cell *matHeaderCellDef mat-sort-header>DoB</th>\n      <td mat-cell *matCellDef=\"let child\">\n        {{ child.dateOfBirth | date: \"longDate\" }}\n      </td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"gender\">\n      <th mat-header-cell *matHeaderCellDef mat-sort-header>Gender</th>\n      <td mat-cell *matCellDef=\"let child\">{{ child.gender }}</td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"schoolClass\">\n      <th mat-header-cell *matHeaderCellDef mat-sort-header>Class</th>\n      <td mat-cell *matCellDef=\"let child\">{{ child.schoolClass }}</td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"schoolId\">\n      <th mat-header-cell *matHeaderCellDef mat-sort-header>School</th>\n      <td mat-cell *matCellDef=\"let child\">\n        <app-school-block [entityId]=\"child.schoolId\"></app-school-block>\n      </td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"attendance-school\">\n      <th mat-header-cell #attendanceSchoolCell *matHeaderCellDef> Attendance (School)</th>\n      <td mat-cell class=\"cell-with-blocks\" *matCellDef=\"let child\">\n        <app-attendance-block\n          *ngFor=\"\n            let att of attendanceList.get(child.getId())\n              | filterBy: {'institution': 'school'}\n              | slice:0:maxAttendanceBlocks\n          \"\n          [attendanceData]=\"att\"\n        ></app-attendance-block>\n      </td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"attendance-coaching\">\n      <th mat-header-cell #attendanceCoachingCell *matHeaderCellDef> Attendance (Coaching)</th>\n      <td mat-cell class=\"cell-with-blocks\" *matCellDef=\"let child\">\n        <app-attendance-block\n          *ngFor=\"\n            let att of attendanceList.get(child.getId())\n              | filterBy: {'institution': 'coaching'}\n              | slice:0:maxAttendanceBlocks\n          \"\n          [attendanceData]=\"att\"\n        ></app-attendance-block>\n      </td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"center\">\n      <th mat-header-cell *matHeaderCellDef mat-sort-header>Center</th>\n      <td mat-cell *matCellDef=\"let child\">{{ child.center }}</td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"status\">\n      <th mat-header-cell *matHeaderCellDef mat-sort-header>Status</th>\n      <td mat-cell *matCellDef=\"let child\">{{ child.status }}</td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"admissionDate\">\n      <th mat-header-cell *matHeaderCellDef mat-sort-header>Admission</th>\n      <td mat-cell *matCellDef=\"let child\">{{ child.admissionDate }}</td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"motherTongue\">\n      <th mat-header-cell *matHeaderCellDef mat-sort-header>Mother Tongue</th>\n      <td mat-cell *matCellDef=\"let child\">{{ child.motherTongue }}</td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"has_aadhar\">\n      <th mat-header-cell *matHeaderCellDef mat-sort-header>Aadhar</th>\n      <td mat-cell *matCellDef=\"let child\">{{ child.has_aadhar }}</td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"has_bankAccount\">\n      <th mat-header-cell *matHeaderCellDef mat-sort-header>Bank Account</th>\n      <td mat-cell *matCellDef=\"let child\">{{ child.has_bankAccount }}</td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"has_kanyashree\">\n      <th mat-header-cell *matHeaderCellDef mat-sort-header>Kanyashree</th>\n      <td mat-cell *matCellDef=\"let child\">{{ child.has_kanyashree }}</td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"has_rationCard\">\n      <th mat-header-cell *matHeaderCellDef mat-sort-header>Ration Card</th>\n      <td mat-cell *matCellDef=\"let child\">{{ child.has_rationCard }}</td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"has_bplCard\">\n      <th mat-header-cell *matHeaderCellDef mat-sort-header>BPL Card</th>\n      <td mat-cell *matCellDef=\"let child\">{{ child.has_BplCard }}</td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"health_vaccinationStatus\">\n      <th mat-header-cell *matHeaderCellDef mat-sort-header>\n        Vaccination Status\n      </th>\n      <td mat-cell *matCellDef=\"let child\">\n        {{ child.health_vaccinationStatus }}\n      </td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"health_bloodGroup\">\n      <th mat-header-cell *matHeaderCellDef mat-sort-header>Blood Group</th>\n      <td mat-cell *matCellDef=\"let child\">{{ child.health_bloodGroup }}</td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"health_eyeHealthStatus\">\n      <th mat-header-cell *matHeaderCellDef mat-sort-header>Eye Status</th>\n      <td mat-cell *matCellDef=\"let child\">\n        {{ child.health_eyeHealthStatus }}\n      </td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"health_LastEyeCheckup\">\n      <th mat-header-cell *matHeaderCellDef mat-sort-header>\n        Last Eye Check-Up\n      </th>\n      <td mat-cell *matCellDef=\"let child\">\n        {{ child.health_lastEyeCheckup }}\n      </td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"health_LastDentalCheckup\">\n      <th mat-header-cell *matHeaderCellDef mat-sort-header>\n        Last Dental Check-Ups\n      </th>\n      <td mat-cell *matCellDef=\"let child\">\n        {{ child.health_lastDentalCheckup }}\n      </td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"health_LastENTCheckup\">\n      <th mat-header-cell *matHeaderCellDef mat-sort-header>\n        Last ENT Check-Up\n      </th>\n      <td mat-cell *matCellDef=\"let child\">\n        {{ child.health_lastENTCheckup }}\n      </td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"health_LastVitaminD\">\n      <th mat-header-cell *matHeaderCellDef mat-sort-header>Last Vitamin D</th>\n      <td mat-cell *matCellDef=\"let child\">{{ child.health_lastVitaminD }}</td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"health_LastDeworming\">\n      <th mat-header-cell *matHeaderCellDef mat-sort-header>Last De-Worming</th>\n      <td mat-cell *matCellDef=\"let child\">{{ child.health_lastDeworming }}</td>\n    </ng-container>\n\n    <tr mat-header-row *matHeaderRowDef=\"columnsToDisplay\"></tr>\n    <tr\n      mat-row\n      *matRowDef=\"let child; columns: columnsToDisplay\"\n      [routerLink]=\"['/child', child.getId()]\"\n      style=\"cursor: pointer;\"\n      class=\"table-list-item\"\n    ></tr>\n  </table>\n  <mat-paginator\n    (page)=\"onPaginateChange($event)\"\n    [pageSize]=\"paginatorPageSize\"\n    [pageIndex]=\"paginatorPageIndex\"\n    [pageSizeOptions]=\"[3, 10, 20, 50]\"\n    [showFirstLastButtons]=\"true\"\n  ></mat-paginator>\n</div>\n","import {\n  AfterViewInit,\n  Component,\n  OnInit,\n  ViewChild,\n  ElementRef,\n  HostListener,\n} from \"@angular/core\";\nimport { Child } from \"../model/child\";\nimport { MatSort } from \"@angular/material/sort\";\nimport { MatTableDataSource } from \"@angular/material/table\";\nimport { ActivatedRoute, Router } from \"@angular/router\";\nimport { ChildrenService } from \"../children.service\";\nimport { AttendanceMonth } from \"../../attendance/model/attendance-month\";\nimport { FilterSelection } from \"../../../core/filter/filter-selection/filter-selection\";\nimport { MediaChange, MediaObserver } from \"@angular/flex-layout\";\nimport { MatPaginator, PageEvent } from \"@angular/material/paginator\";\nimport { UntilDestroy, untilDestroyed } from \"@ngneat/until-destroy\";\nimport { SessionService } from \"../../../core/session/session-service/session.service\";\nimport { User } from \"../../../core/user/user\";\nimport { EntityMapperService } from \"../../../core/entity/entity-mapper.service\";\nimport { floor, min } from \"lodash\";\n\nexport interface ColumnGroup {\n  name: string;\n  columns: string[];\n}\n\n@UntilDestroy()\n@Component({\n  selector: \"app-children-list\",\n  templateUrl: \"./children-list.component.html\",\n  styleUrls: [\"./children-list.component.scss\"],\n})\nexport class ChildrenListComponent implements OnInit, AfterViewInit {\n  childrenList: Child[] = [];\n  attendanceList = new Map<string, AttendanceMonth[]>();\n  childrenDataSource = new MatTableDataSource();\n\n  centerFS = new FilterSelection(\"center\", []);\n  dropoutFS = new FilterSelection(\"status\", [\n    {\n      key: \"active\",\n      label: \"Current Project Children\",\n      filterFun: (c: Child) => c.isActive(),\n    },\n    {\n      key: \"dropout\",\n      label: \"Dropouts\",\n      filterFun: (c: Child) => !c.isActive(),\n    },\n    { key: \"\", label: \"All\", filterFun: () => true },\n  ]);\n  filterSelections = [this.dropoutFS, this.centerFS];\n\n  @ViewChild(MatSort) sort: MatSort;\n  @ViewChild(MatPaginator) paginator: MatPaginator;\n  columnGroupSelection = \"School Info\";\n  columnGroups: ColumnGroup[] = [\n    {\n      name: \"Basic Info\",\n      columns: [\n        \"projectNumber\",\n        \"name\",\n        \"age\",\n        \"gender\",\n        \"schoolClass\",\n        \"schoolId\",\n        \"center\",\n        \"status\",\n      ],\n    },\n    {\n      name: \"School Info\",\n      columns: [\n        \"projectNumber\",\n        \"name\",\n        \"age\",\n        \"schoolClass\",\n        \"schoolId\",\n        \"attendance-school\",\n        \"attendance-coaching\",\n        \"motherTongue\",\n      ],\n    },\n    {\n      name: \"Status\",\n      columns: [\n        \"projectNumber\",\n        \"name\",\n        \"center\",\n        \"status\",\n        \"admissionDate\",\n        \"has_aadhar\",\n        \"has_kanyashree\",\n        \"has_bankAccount\",\n        \"has_rationCard\",\n        \"has_bplCard\",\n      ],\n    },\n    {\n      name: \"Health\",\n      columns: [\n        \"projectNumber\",\n        \"name\",\n        \"center\",\n        \"health_vaccinationStatus\",\n        \"health_bloodGroup\",\n        \"health_eyeHealthStatus\",\n        \"health_LastEyeCheckup\",\n        \"health_LastDentalCheckup\",\n        \"health_LastENTCheckup\",\n        \"health_LastVitaminD\",\n        \"health_LastDeworming\",\n        \"gender\",\n        \"age\",\n        \"dateOfBirth\",\n      ],\n    },\n    {\n      name: \"Mobile\",\n      columns: [\"projectNumber\", \"name\", \"age\", \"schoolId\"],\n    },\n  ];\n  columnsToDisplay = [\"projectNumber\", \"name\"];\n  filterString = \"\";\n\n  public paginatorPageSize: number;\n  public paginatorPageIndex: number;\n  private user: User;\n\n  /** dynamically calculated number of attendance blocks displayed in a column to avoid overlap */\n  maxAttendanceBlocks: number = 3;\n  @ViewChild(\"attendanceSchoolCell\") schoolCell: ElementRef;\n  @ViewChild(\"attendanceCoachingCell\") coachingCell: ElementRef;\n\n  constructor(\n    private childrenService: ChildrenService,\n    private router: Router,\n    private route: ActivatedRoute,\n    private media: MediaObserver,\n    private sessionService: SessionService,\n    private entityMapperService: EntityMapperService\n  ) {}\n\n  ngOnInit() {\n    this.loadData();\n    this.loadUrlParams();\n    this.user = this.sessionService.getCurrentUser();\n    this.paginatorPageSize = this.user.paginatorSettingsPageSize.childrenList;\n    this.paginatorPageIndex = this.user.paginatorSettingsPageIndex.childrenList;\n    this.media.media$\n      .pipe(untilDestroyed(this))\n      .subscribe((change: MediaChange) => {\n        switch (change.mqAlias) {\n          case \"xs\":\n          case \"sm\": {\n            this.displayColumnGroup(\"Mobile\");\n            this.maxAttendanceBlocks = 1;\n            break;\n          }\n          case \"md\": {\n            this.displayColumnGroup(\"School Info\");\n            this.maxAttendanceBlocks = 2;\n            break;\n          }\n          case \"lg\": {\n            this.maxAttendanceBlocks = 3;\n            break;\n          }\n          case \"xl\": {\n            this.maxAttendanceBlocks = 6;\n            break;\n          }\n        }\n      });\n  }\n\n  private loadUrlParams(replaceUrl: boolean = false) {\n    this.route.queryParams.subscribe((params) => {\n      this.columnGroupSelection = params[\"view\"]\n        ? params[\"view\"]\n        : this.columnGroupSelection;\n      this.displayColumnGroup(this.columnGroupSelection);\n\n      this.filterSelections.forEach((f) => {\n        f.selectedOption = params[f.name];\n        if (f.selectedOption === undefined && f.options.length > 0) {\n          f.selectedOption = f.options[0].key;\n        }\n      });\n      this.applyFilterSelections(replaceUrl);\n    });\n  }\n\n  ngAfterViewInit() {\n    this.childrenDataSource.sort = this.sort;\n    this.childrenDataSource.paginator = this.paginator;\n    setTimeout(() => {\n      this.paginator.pageIndex = this.paginatorPageIndex;\n      this.paginator.page.next({\n        pageIndex: this.paginator.pageIndex,\n        pageSize: this.paginator.pageSize,\n        length: this.paginator.length,\n      });\n    });\n  }\n\n  onPaginateChange(event: PageEvent) {\n    this.paginatorPageSize = event.pageSize;\n    this.paginatorPageIndex = event.pageIndex;\n    this.user.paginatorSettingsPageSize.childrenList = this.paginatorPageSize;\n    this.user.paginatorSettingsPageIndex.childrenList = this.paginatorPageIndex;\n    this.entityMapperService.save<User>(this.user);\n  }\n\n  private loadData(replaceUrl: boolean = false) {\n    this.childrenService\n      .getChildren()\n      .pipe(untilDestroyed(this))\n      .subscribe((children) => {\n        this.childrenList = children;\n        const centers = children\n          .map((c) => c.center)\n          .filter((value, index, arr) => value && arr.indexOf(value) === index);\n        this.centerFS.initOptions(centers, \"center\");\n\n        this.applyFilterSelections(replaceUrl);\n      });\n    this.childrenService\n      .getAttendances()\n      .pipe(untilDestroyed(this))\n      .subscribe((results) => this.prepareAttendanceData(results));\n  }\n  /*\n  private initCenterFilterOptions(centersWithProbability: string[]) {\n    const options = [{key: '', label: 'All', filterFun: (c: Child) => true}];\n\n    centersWithProbability.forEach(center => {\n      options.push({key: center.toLowerCase(), label: center, filterFun: (c: Child) => c.center === center});\n    });\n\n    this.centerFS.options = options;\n  } */\n\n  prepareAttendanceData(loadedEntities: AttendanceMonth[]) {\n    this.attendanceList = new Map<string, AttendanceMonth[]>();\n    loadedEntities.forEach((x) => {\n      if (!this.attendanceList.has(x.student)) {\n        this.attendanceList.set(x.student, new Array<AttendanceMonth>());\n      }\n      this.attendanceList.get(x.student).push(x);\n    });\n\n    this.attendanceList.forEach((studentsAttendance) => {\n      studentsAttendance.sort((a, b) => {\n        // descending by date\n        if (a.month > b.month) {\n          return -1;\n        }\n        if (a.month < b.month) {\n          return 1;\n        }\n        return 0;\n      });\n    });\n  }\n\n  applyFilter(filterValue: string) {\n    filterValue = filterValue.trim();\n    filterValue = filterValue.toLowerCase(); // MatTableDataSource defaults to lowercase matches\n    this.childrenDataSource.filter = filterValue;\n  }\n\n  displayColumnGroup(columnGroupName: string) {\n    this.columnGroupSelection = columnGroupName;\n    let found = false;\n    let group: ColumnGroup;\n    let i = 0;\n    while (!found && i < this.columnGroups.length) {\n      if (this.columnGroups[i].name === columnGroupName) {\n        found = true;\n        group = this.columnGroups[i];\n      }\n      i++;\n    }\n    this.columnsToDisplay = group.columns;\n    this.updateUrl();\n  }\n\n  updateUrl(replaceUrl: boolean = false) {\n    const params = {};\n    this.filterSelections.forEach((f) => {\n      params[f.name] = f.selectedOption;\n    });\n\n    params[\"view\"] = this.columnGroupSelection;\n\n    this.router.navigate([\"child\"], {\n      queryParams: params,\n      replaceUrl: replaceUrl,\n    });\n  }\n\n  applyFilterSelections(replaceUrl: boolean = false) {\n    let filteredData = this.childrenList;\n\n    this.filterSelections.forEach((f) => {\n      filteredData = filteredData.filter(f.getSelectedFilterFunction());\n    });\n\n    this.childrenDataSource.data = filteredData;\n\n    this.updateUrl(replaceUrl);\n  }\n}\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { NgModule } from \"@angular/core\";\nimport { CommonModule, DatePipe, PercentPipe } from \"@angular/common\";\nimport { ChildDetailsComponent } from \"./child-details/child-details.component\";\nimport { MatFormFieldModule } from \"@angular/material/form-field\";\nimport { MatSelectModule } from \"@angular/material/select\";\nimport { MatInputModule } from \"@angular/material/input\";\nimport { MatExpansionModule } from \"@angular/material/expansion\";\nimport { ChildrenListComponent } from \"./children-list/children-list.component\";\nimport { MatAutocompleteModule } from \"@angular/material/autocomplete\";\nimport { MatButtonModule } from \"@angular/material/button\";\nimport { MatButtonToggleModule } from \"@angular/material/button-toggle\";\nimport { MatCardModule } from \"@angular/material/card\";\nimport { MatCheckboxModule } from \"@angular/material/checkbox\";\nimport { MatDialogModule } from \"@angular/material/dialog\";\nimport { MatIconModule } from \"@angular/material/icon\";\nimport { MatListModule } from \"@angular/material/list\";\nimport { MatProgressBarModule } from \"@angular/material/progress-bar\";\nimport { MatSidenavModule } from \"@angular/material/sidenav\";\nimport { MatSnackBarModule } from \"@angular/material/snack-bar\";\nimport { MatSortModule } from \"@angular/material/sort\";\nimport { MatTableModule } from \"@angular/material/table\";\nimport { MatTooltipModule } from \"@angular/material/tooltip\";\nimport { FlexLayoutModule } from \"@angular/flex-layout\";\nimport { ChildrenService } from \"./children.service\";\nimport { AttendanceBlockComponent } from \"../attendance/attendance-block/attendance-block.component\";\nimport { ChildAttendanceComponent } from \"../attendance/child-attendance/child-attendance.component\";\nimport { EntitySubrecordModule } from \"../../core/entity-subrecord/entity-subrecord.module\";\nimport { ChildBlockComponent } from \"./child-block/child-block.component\";\nimport { ChildrenCountDashboardComponent } from \"./children-count-dashboard/children-count-dashboard.component\";\nimport { FormsModule, ReactiveFormsModule } from \"@angular/forms\";\nimport { RouterModule } from \"@angular/router\";\nimport { AttendanceAverageDashboardComponent } from \"../attendance/dashboard-widgets/attendance-average-dashboard/attendance-average-dashboard.component\";\nimport { AttendanceWarningsDashboardComponent } from \"../attendance/dashboard-widgets/attendance-warnings-dashboard/attendance-warnings-dashboard.component\";\nimport { NotesOfChildComponent } from \"../notes/notes-of-child/notes-of-child.component\";\nimport { ChildSelectComponent } from \"./child-select/child-select.component\";\nimport { SchoolsModule } from \"../schools/schools.module\";\nimport { EducationalMaterialComponent } from \"../educational-material/educational-material-component/educational-material.component\";\nimport { AserComponent } from \"../aser/aser-component/aser.component\";\nimport { FilterPipeModule } from \"ngx-filter-pipe\";\nimport { AddMonthAttendanceComponent } from \"../attendance/add-month-attendance/add-month-attendance.component\";\nimport { AttendanceDaysComponent } from \"../attendance/attendance-days/attendance-days.component\";\nimport { AttendanceDetailsComponent } from \"../attendance/attendance-details/attendance-details.component\";\nimport { BrowserAnimationsModule } from \"@angular/platform-browser/animations\";\nimport { AddDayAttendanceComponent } from \"../attendance/add-day-attendance/add-day-attendance.component\";\nimport { AttendanceWeekDashboardComponent } from \"../attendance/dashboard-widgets/attendance-week-dashboard/attendance-week-dashboard.component\";\nimport { NoRecentNotesDashboardComponent } from \"../notes/dashboard-widgets/no-recent-notes-dashboard/no-recent-notes-dashboard.component\";\nimport { AttendanceDayBlockComponent } from \"../attendance/attendance-days/attendance-day-block.component\";\nimport { AttendanceManagerComponent } from \"../attendance/attendance-manager/attendance-manager.component\";\nimport { HealthCheckupComponent } from \"../health-checkup/health-checkup-component/health-checkup.component\";\nimport { MatDatepickerModule } from \"@angular/material/datepicker\";\nimport { PreviousSchoolsComponent } from \"../previous-schools/previous-schools.component\";\nimport { WebdavModule } from \"app/core/webdav/webdav.module\";\nimport { AdminModule } from \"../../core/admin/admin.module\";\nimport { SelectGroupChildrenComponent } from \"./select-group-children/select-group-children.component\";\nimport { RollCallComponent } from \"../attendance/add-day-attendance/roll-call/roll-call.component\";\nimport { MatProgressSpinnerModule } from \"@angular/material/progress-spinner\";\nimport { RecentNotesDashboardComponent } from \"../notes/dashboard-widgets/recent-notes-dashboard/recent-notes-dashboard.component\";\nimport { FormDialogModule } from \"../../core/form-dialog/form-dialog.module\";\nimport { ConfirmationDialogModule } from \"../../core/confirmation-dialog/confirmation-dialog.module\";\nimport { CONFLICT_RESOLUTION_STRATEGY } from \"../../conflict-resolution/auto-resolution/conflict-resolution-strategy\";\nimport { AttendanceMonthConflictResolutionStrategy } from \"../attendance/attendance-month-conflict-resolution-strategy\";\nimport { MatPaginatorModule } from \"@angular/material/paginator\";\nimport { Angulartics2Module } from \"angulartics2\";\nimport { AttendanceAnalysisComponent } from \"../attendance/attendance-analysis/attendance-analysis.component\";\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    FlexLayoutModule,\n    RouterModule,\n    MatFormFieldModule,\n    MatInputModule,\n    MatCheckboxModule,\n    MatSelectModule,\n    MatDatepickerModule,\n    MatExpansionModule,\n    MatTableModule,\n    MatPaginatorModule,\n    MatSortModule,\n    MatSidenavModule,\n    MatButtonModule,\n    MatButtonToggleModule,\n    MatIconModule,\n    MatCardModule,\n    MatSnackBarModule,\n    MatProgressBarModule,\n    MatAutocompleteModule,\n    MatTooltipModule,\n    BrowserAnimationsModule,\n    ReactiveFormsModule,\n    FilterPipeModule,\n    EntitySubrecordModule,\n    SchoolsModule,\n    ReactiveFormsModule,\n    MatDialogModule,\n    AdminModule,\n    MatListModule,\n    WebdavModule,\n    MatProgressSpinnerModule,\n    ConfirmationDialogModule,\n    FormDialogModule,\n    Angulartics2Module,\n  ],\n  declarations: [\n    AttendanceBlockComponent,\n    ChildBlockComponent,\n    ChildAttendanceComponent,\n    NotesOfChildComponent,\n    ChildDetailsComponent,\n    ChildrenListComponent,\n    ChildrenCountDashboardComponent,\n    AttendanceAverageDashboardComponent,\n    AttendanceWarningsDashboardComponent,\n    ChildSelectComponent,\n    EducationalMaterialComponent,\n    AserComponent,\n    AddMonthAttendanceComponent,\n    AttendanceDayBlockComponent,\n    AttendanceDaysComponent,\n    AttendanceDetailsComponent,\n    AddDayAttendanceComponent,\n    RollCallComponent,\n    SelectGroupChildrenComponent,\n    AttendanceWeekDashboardComponent,\n    NoRecentNotesDashboardComponent,\n    RecentNotesDashboardComponent,\n    AttendanceManagerComponent,\n    AttendanceAnalysisComponent,\n    HealthCheckupComponent,\n    PreviousSchoolsComponent,\n  ],\n  providers: [\n    ChildrenService,\n    DatePipe,\n    PercentPipe,\n    {\n      provide: CONFLICT_RESOLUTION_STRATEGY,\n      useClass: AttendanceMonthConflictResolutionStrategy,\n      multi: true,\n    },\n  ],\n  exports: [\n    ChildBlockComponent,\n    ChildSelectComponent,\n    ChildrenCountDashboardComponent,\n    AttendanceAverageDashboardComponent,\n    AttendanceWarningsDashboardComponent,\n    AttendanceWarningsDashboardComponent,\n    AttendanceWeekDashboardComponent,\n    NoRecentNotesDashboardComponent,\n    RecentNotesDashboardComponent,\n    AttendanceDaysComponent,\n  ],\n})\nexport class ChildrenModule {}\n","import { Injectable } from \"@angular/core\";\nimport { from, Observable, Subject } from \"rxjs\";\nimport { Child } from \"./model/child\";\nimport { EntityMapperService } from \"../../core/entity/entity-mapper.service\";\nimport { AttendanceMonth } from \"../attendance/model/attendance-month\";\nimport { Note } from \"../notes/model/note\";\nimport { EducationalMaterial } from \"../educational-material/model/educational-material\";\nimport { Aser } from \"../aser/model/aser\";\nimport { ChildSchoolRelation } from \"./model/childSchoolRelation\";\nimport { HealthCheck } from \"../health-checkup/model/health-check\";\nimport { EntitySchemaService } from \"../../core/entity/schema/entity-schema.service\";\nimport { ChildPhotoService } from \"./child-photo-service/child-photo.service\";\nimport { LoadChildPhotoEntitySchemaDatatype } from \"./child-photo-service/datatype-load-child-photo\";\nimport moment from \"moment\";\nimport * as uniqid from \"uniqid\";\nimport { LoggingService } from \"../../core/logging/logging.service\";\nimport { DatabaseIndexingService } from \"../../core/entity/database-indexing/database-indexing.service\";\n\n@Injectable()\nexport class ChildrenService {\n  constructor(\n    private entityMapper: EntityMapperService,\n    private entitySchemaService: EntitySchemaService,\n    private dbIndexing: DatabaseIndexingService,\n    childPhotoService: ChildPhotoService,\n    private logger: LoggingService\n  ) {\n    this.entitySchemaService.registerSchemaDatatype(\n      new LoadChildPhotoEntitySchemaDatatype(childPhotoService)\n    );\n    this.createDatabaseIndices();\n  }\n\n  public createDatabaseIndices() {\n    this.createAttendanceAnalysisIndex();\n    this.createNotesIndex();\n    this.createAttendancesIndex();\n    this.createChildSchoolRelationIndex();\n  }\n\n  /**\n   * returns an observable which retrieves children from the database and loads their pictures\n   */\n  getChildren(): Observable<Child[]> {\n    const results = new Subject<Child[]>();\n\n    this.entityMapper.loadType<Child>(Child).then(async (loadedChildren) => {\n      results.next(loadedChildren);\n\n      for (const loadedChild of loadedChildren) {\n        const childCurrentSchoolInfo = await this.getCurrentSchoolInfoForChild(\n          loadedChild.getId()\n        );\n        await this.migrateToNewChildSchoolRelationModel(\n          loadedChild,\n          childCurrentSchoolInfo\n        );\n        loadedChild.schoolClass = childCurrentSchoolInfo.schoolClass;\n        loadedChild.schoolId = childCurrentSchoolInfo.schoolId;\n      }\n      results.next(loadedChildren);\n      results.complete();\n    });\n\n    return results;\n  }\n\n  /**\n   * DATA MODEL UPGRADE\n   * Check if the Child Entity still contains direct links to schoolId and schoolClass\n   * and create a new ChildSchoolRelation if necessary.\n   * @param loadedChild Child entity to be checked and migrated\n   * @param childCurrentSchoolInfo Currently available school information according to new data model from ChildSchoolRelation entities\n   */\n  private async migrateToNewChildSchoolRelationModel(\n    loadedChild: Child,\n    childCurrentSchoolInfo: { schoolId: string; schoolClass: string }\n  ) {\n    if (!loadedChild.schoolClass && !loadedChild.schoolId) {\n      // no data from old model -> skip migration\n      return;\n    }\n\n    if (\n      loadedChild.schoolId !== childCurrentSchoolInfo.schoolId ||\n      loadedChild.schoolClass !== childCurrentSchoolInfo.schoolClass\n    ) {\n      // generate a ChildSchoolRelation entity from the information of the previous data model\n      const autoMigratedChildSchoolRelation = new ChildSchoolRelation(uniqid());\n      autoMigratedChildSchoolRelation.childId = loadedChild.getId();\n      autoMigratedChildSchoolRelation.schoolId = loadedChild.schoolId;\n      autoMigratedChildSchoolRelation.schoolClass = loadedChild.schoolClass;\n      await this.entityMapper.save(autoMigratedChildSchoolRelation);\n      this.logger.debug(\n        \"migrated Child entity to new ChildSchoolRelation model \" +\n          loadedChild._id\n      );\n      console.log(autoMigratedChildSchoolRelation);\n    }\n\n    // save the Child entity to remove the deprecated attributes from the doc in the database\n    await this.entityMapper.save(loadedChild);\n  }\n\n  /**\n   * returns an observable which retrieves a single child and loads its photo\n   * @param id id of child\n   */\n  getChild(id: string): Observable<Child> {\n    const promise = this.entityMapper\n      .load<Child>(Child, id)\n      .then((loadedChild) => {\n        return this.getCurrentSchoolInfoForChild(id).then(\n          (currentSchoolInfo) => {\n            loadedChild.schoolClass = currentSchoolInfo.schoolClass;\n            loadedChild.schoolId = currentSchoolInfo.schoolId;\n            return loadedChild;\n          }\n        );\n      });\n    return from(promise);\n  }\n\n  getAttendances(): Observable<AttendanceMonth[]> {\n    return from(this.entityMapper.loadType<AttendanceMonth>(AttendanceMonth));\n  }\n\n  getAttendancesOfChild(childId: string): Observable<AttendanceMonth[]> {\n    const promise = this.dbIndexing\n      .queryIndex(\"attendances_index/by_child\", {\n        key: childId,\n        include_docs: true,\n      })\n      .then((loadedEntities) => {\n        return loadedEntities.rows.map((loadedRecord) => {\n          const entity = new AttendanceMonth(\"\");\n          this.entitySchemaService.loadDataIntoEntity(entity, loadedRecord.doc);\n          return entity;\n        });\n      });\n\n    return from(promise);\n  }\n\n  getAttendancesOfMonth(month: Date): Observable<AttendanceMonth[]> {\n    const monthString =\n      month.getFullYear().toString() + \"-\" + (month.getMonth() + 1).toString();\n    const promise = this.dbIndexing\n      .queryIndex(\"attendances_index/by_month\", {\n        key: monthString,\n        include_docs: true,\n      })\n      .then((loadedEntities) => {\n        return loadedEntities.rows.map((loadedRecord) => {\n          const entity = new AttendanceMonth(\"\");\n          this.entitySchemaService.loadDataIntoEntity(entity, loadedRecord.doc);\n          return entity;\n        });\n      });\n\n    return from(promise);\n  }\n\n  private createAttendancesIndex(): Promise<any> {\n    const designDoc = {\n      _id: \"_design/attendances_index\",\n      views: {\n        by_child: {\n          map:\n            \"(doc) => { \" +\n            'if (!doc._id.startsWith(\"' +\n            AttendanceMonth.ENTITY_TYPE +\n            '\")) return;' +\n            \"emit(doc.student); \" +\n            \"}\",\n        },\n        by_month: {\n          map:\n            \"(doc) => { \" +\n            'if (!doc._id.startsWith(\"' +\n            AttendanceMonth.ENTITY_TYPE +\n            '\")) return;' +\n            \"emit(doc.month); \" +\n            \"}\",\n        },\n      },\n    };\n\n    return this.dbIndexing.createIndex(designDoc);\n  }\n\n  private createChildSchoolRelationIndex(): Promise<any> {\n    const designDoc = {\n      _id: \"_design/childSchoolRelations_index\",\n      views: {\n        by_child: {\n          map: `(doc) => {\n            if (!doc._id.startsWith(\"${ChildSchoolRelation.ENTITY_TYPE}\")) return;\n            emit(doc.childId);\n            }`,\n        },\n        by_school: {\n          map: `(doc) => {\n            if ( (!doc._id.startsWith(\"${ChildSchoolRelation.ENTITY_TYPE}\")) ||\n                (doc.start && (new Date(doc.start) > new Date().setHours(0, 0, 0, 0))) ||\n                (doc.end && (new Date(doc.end) < new Date().setHours(0, 0, 0, 0))) ) {\n              return;\n            }\n            emit(doc.schoolId);\n            }`,\n        },\n        by_date: {\n          map: `(doc) => {\n            if (!doc._id.startsWith(\"${ChildSchoolRelation.ENTITY_TYPE}\")) return;\n            let timestamp = (new Date(doc.start || '3000-01-01')).getTime().toString().padStart(14, \"0\");\n            emit(doc.childId + '_' + timestamp);\n            }`,\n        },\n      },\n    };\n    return this.dbIndexing.createIndex(designDoc);\n  }\n\n  queryLatestRelation(childId: string): Promise<ChildSchoolRelation> {\n    return this.querySortedRelations(childId, 1).then(\n      (children) => children[0]\n    );\n  }\n\n  querySortedRelations(\n    childId: string,\n    limit?: number\n  ): Promise<ChildSchoolRelation[]> {\n    const options: any = {\n      startkey: childId + \"_\\uffff\", //  higher value needs to be startkey\n      endkey: childId + \"_\", //  \\uffff is not a character -> only relations staring with childId will be selected\n      descending: true,\n      include_docs: true,\n      limit: limit,\n    };\n    return this.dbIndexing\n      .queryIndex(\"childSchoolRelations_index/by_date\", options)\n      .then((loadedEntities) => {\n        return loadedEntities.rows.map((loadedRecord) => {\n          const entity = new ChildSchoolRelation(\"\");\n          this.entitySchemaService.loadDataIntoEntity(entity, loadedRecord.doc);\n          return entity;\n        });\n      });\n  }\n\n  queryRelationsOf(\n    queryType: \"child\" | \"school\",\n    id: string\n  ): Promise<ChildSchoolRelation[]> {\n    return this.dbIndexing\n      .queryIndex(\"childSchoolRelations_index/by_\" + queryType, {\n        key: id,\n        include_docs: true,\n      })\n      .then((loadedEntities) => {\n        return loadedEntities.rows.map((loadedRecord) => {\n          const entity = new ChildSchoolRelation(\"\");\n          this.entitySchemaService.loadDataIntoEntity(entity, loadedRecord.doc);\n          return entity;\n        });\n      });\n  }\n\n  queryAttendanceLast3Months() {\n    return this.dbIndexing.queryIndex(\"avg_attendance_index/three_months\", {\n      reduce: true,\n      group: true,\n    });\n  }\n\n  queryAttendanceLastMonth() {\n    return this.dbIndexing.queryIndex(\"avg_attendance_index/last_month\", {\n      reduce: true,\n      group: true,\n    });\n  }\n\n  private createAttendanceAnalysisIndex(): Promise<any> {\n    const designDoc = {\n      _id: \"_design/avg_attendance_index\",\n      views: {\n        three_months: {\n          map: this.getAverageAttendanceMapFunction(),\n          reduce: \"_stats\",\n        },\n        last_month: {\n          map: this.getLastAverageAttendanceMapFunction(),\n          reduce: \"_stats\",\n        },\n      },\n    };\n\n    return this.dbIndexing.createIndex(designDoc);\n  }\n\n  private getAverageAttendanceMapFunction() {\n    return (\n      \"(doc) => {\" +\n      'if (!doc._id.startsWith(\"AttendanceMonth:\") ) { return; }' +\n      \"if (!isWithinLast3Months(new Date(doc.month), new Date())) { return; }\" +\n      \"var attendance = (doc.daysAttended / (doc.daysWorking - doc.daysExcused));\" +\n      \"if (!Number.isNaN(attendance)) { emit(doc.student, attendance); }\" +\n      \"function isWithinLast3Months(date, now) {\" +\n      \"  let months;\" +\n      \"  months = (now.getFullYear() - date.getFullYear()) * 12;\" +\n      \"  months -= date.getMonth();\" +\n      \"  months += now.getMonth();\" +\n      \"  if (months < 0) { return false; }\" +\n      \"  return months <= 3;\" +\n      \"}\" +\n      \"}\"\n    );\n  }\n\n  private getLastAverageAttendanceMapFunction() {\n    return (\n      \"(doc) => {\" +\n      'if (!doc._id.startsWith(\"AttendanceMonth:\")) { return; }' +\n      \"if (!isWithinLastMonth(new Date(doc.month), new Date())) { return; }\" +\n      \"var attendance = (doc.daysAttended / (doc.daysWorking - doc.daysExcused));\" +\n      \"if (!Number.isNaN(attendance)) { emit(doc.student, attendance); }\" +\n      \"function isWithinLastMonth(date, now) {\" +\n      \"  let months;\" +\n      \"  months = (now.getFullYear() - date.getFullYear()) * 12;\" +\n      \"  months -= date.getMonth();\" +\n      \"  months += now.getMonth();\" +\n      \"  return months === 1;\" +\n      \"}\" +\n      \"}\"\n    );\n  }\n\n  getNotesOfChild(childId: string): Observable<Note[]> {\n    const promise = this.dbIndexing\n      .queryIndex(\"notes_index/by_child\", { key: childId, include_docs: true })\n      .then((loadedEntities) => {\n        return loadedEntities.rows.map((loadedRecord) => {\n          const entity = new Note(\"\");\n          this.entitySchemaService.loadDataIntoEntity(entity, loadedRecord.doc);\n          return entity;\n        });\n      });\n\n    return from(promise);\n  }\n\n  /**\n   * Query how many days ago the last note for each child was added.\n   *\n   * Warning: Children without any notes will be missing from this map.\n   *\n   * @return A map of childIds as key and days since last note as value\n   */\n  public async getDaysSinceLastNoteOfEachChild(): Promise<Map<string, number>> {\n    const stats = await this.dbIndexing.queryIndex(\n      \"notes_index/note_date_in_days_for_child\",\n      { reduce: true, group: true }\n    );\n\n    const results = new Map();\n    for (const childStats of stats.rows) {\n      const dateOfLatestNoteInDays = childStats.value.max;\n      const todayInDays = new Date().getTime() / 86400000; // ms/day: 1000*60*60*24 = 86400000\n      const daysSinceLastNote = todayInDays - dateOfLatestNoteInDays;\n      results.set(childStats.key, daysSinceLastNote);\n    }\n\n    return results;\n  }\n\n  private createNotesIndex(): Promise<any> {\n    const designDoc = {\n      _id: \"_design/notes_index\",\n      views: {\n        by_child: {\n          map:\n            \"(doc) => { \" +\n            'if (!doc._id.startsWith(\"' +\n            Note.ENTITY_TYPE +\n            '\")) return;' +\n            \"if (!Array.isArray(doc.children)) return;\" +\n            \"doc.children.forEach(childId => emit(childId)); \" +\n            \"}\",\n        },\n        note_date_in_days_for_child: {\n          map:\n            \"(doc) => { \" +\n            'if (!doc._id.startsWith(\"' +\n            Note.ENTITY_TYPE +\n            '\")) return;' +\n            \"if (!Array.isArray(doc.children) || !doc.date) return;\" +\n            \"doc.children.forEach(childId => emit(childId, (new Date(doc.date)).getTime()/86400000)); \" + // ms/day: 1000*60*60*24 = 86400000\n            \"}\",\n          reduce: \"_stats\",\n        },\n      },\n    };\n\n    return this.dbIndexing.createIndex(designDoc);\n  }\n\n  getEducationalMaterialsOfChild(\n    childId: string\n  ): Observable<EducationalMaterial[]> {\n    return from(\n      this.entityMapper\n        .loadType<EducationalMaterial>(EducationalMaterial)\n        .then((loadedEntities) => {\n          return loadedEntities.filter((o) => o.child === childId);\n        })\n    );\n  }\n\n  /**\n   *\n   * @param childId should be set in the specific components and is passed by the URL as a parameter\n   * This function should be considered refactored and should use a index, once they're made generic\n   */\n  getHealthChecksOfChild(childId: string): Observable<HealthCheck[]> {\n    return from(\n      this.entityMapper\n        .loadType<HealthCheck>(HealthCheck)\n        .then((loadedEntities) => {\n          return loadedEntities.filter((h) => h.child === childId);\n        })\n    );\n  }\n\n  getAserResultsOfChild(childId: string): Observable<Aser[]> {\n    return from(\n      this.entityMapper.loadType<Aser>(Aser).then((loadedEntities) => {\n        return loadedEntities.filter((o) => o.child === childId);\n      })\n    );\n  }\n\n  async getCurrentSchoolInfoForChild(\n    childId: string\n  ): Promise<{ schoolId: string; schoolClass: string }> {\n    const relations = (await this.querySortedRelations(childId)) || [];\n    for (const rel of relations) {\n      if (\n        moment(rel.start).isSameOrBefore(moment(), \"days\") &&\n        moment(rel.end).isSameOrAfter(moment(), \"days\")\n      ) {\n        return {\n          schoolId: rel.schoolId,\n          schoolClass: rel.schoolClass,\n        };\n      }\n    }\n\n    return {\n      schoolId: null,\n      schoolClass: null,\n    };\n  }\n\n  async getSchoolsWithRelations(\n    childId: string\n  ): Promise<ChildSchoolRelation[]> {\n    return await this.querySortedRelations(childId);\n  }\n}\n","import { Child } from \"../model/child\";\nimport { Gender } from \"../model/Gender\";\nimport { religions } from \"./fixtures/religions\";\nimport { languages } from \"./fixtures/languages\";\nimport { dropoutTypes } from \"./fixtures/dropout-types\";\nimport { Injectable } from \"@angular/core\";\nimport { DemoDataGenerator } from \"../../../core/demo-data/demo-data-generator\";\nimport { faker } from \"../../../core/demo-data/faker\";\nimport { centersWithProbability } from \"./fixtures/centers\";\n\nexport class DemoChildConfig {\n  count: number;\n}\n\n@Injectable()\nexport class DemoChildGenerator extends DemoDataGenerator<Child> {\n  static count: number;\n\n  /**\n   * This function returns a provider object to be used in an Angular Module configuration:\n   *   `providers: [DemoUserProvider.provider({count: 150})]`\n   * @param config The configuration specifying the number of entities the service should generate.\n   */\n  static provider(config: DemoChildConfig) {\n    return [\n      { provide: DemoChildGenerator, useClass: DemoChildGenerator },\n      { provide: DemoChildConfig, useValue: config },\n    ];\n  }\n\n  constructor(public config: DemoChildConfig) {\n    super();\n  }\n\n  generateEntities(): Child[] {\n    const data = [];\n\n    for (let i = 1; i <= this.config.count; i++) {\n      const child = new Child(String(i));\n      child.name = faker.name.firstName() + \" \" + faker.name.lastName();\n      child.projectNumber = String(i);\n      child.religion = faker.random.arrayElement(religions);\n      child.gender = faker.random.arrayElement([Gender.MALE, Gender.FEMALE]);\n      child.dateOfBirth = faker.dateOfBirth(5, 20);\n      child.motherTongue = faker.random.arrayElement(languages);\n      child.center = faker.random.arrayElement(centersWithProbability);\n\n      child.admissionDate = faker.date.past(child.age - 4);\n\n      if (faker.random.number(100) > 80) {\n        this.makeChildDropout(child);\n      }\n\n      data.push(child);\n    }\n    return data;\n  }\n\n  private makeChildDropout(child: Child) {\n    child.dropoutDate = faker.date.between(child.admissionDate, new Date());\n    child.dropoutRemarks = faker.lorem.sentence();\n    child.dropoutType = faker.random.arrayElement(dropoutTypes);\n    child.status = \"Dropout\";\n  }\n}\n","import { DemoChildGenerator } from \"./demo-child-generator.service\";\nimport { DemoSchoolGenerator } from \"../../schools/demo-school-generator.service\";\nimport { DemoDataGenerator } from \"../../../core/demo-data/demo-data-generator\";\nimport { Injectable } from \"@angular/core\";\nimport { Child } from \"../model/child\";\nimport { ChildSchoolRelation } from \"../model/childSchoolRelation\";\nimport { faker } from \"../../../core/demo-data/faker\";\nimport { School } from \"../../schools/model/school\";\n\n/**\n * Generate ChildSchoolRelation entities linking a child to a school for a specific year.\n * Builds upon the generated demo Child and demo School entities,\n * generating relations for each Child from the date of admission till dropout or today.\n */\n@Injectable()\nexport class DemoChildSchoolRelationGenerator extends DemoDataGenerator<\n  ChildSchoolRelation\n> {\n  /**\n   * This function returns a provider object to be used in an Angular Module configuration:\n   *   `providers: [DemoChildSchoolRelationGenerator.provider()]`\n   */\n  static provider() {\n    return [\n      {\n        provide: DemoChildSchoolRelationGenerator,\n        useClass: DemoChildSchoolRelationGenerator,\n      },\n    ];\n  }\n\n  constructor(\n    private demoChildren: DemoChildGenerator,\n    private demoSchools: DemoSchoolGenerator\n  ) {\n    super();\n  }\n\n  generateEntities(): ChildSchoolRelation[] {\n    const data = [];\n\n    for (const child of this.demoChildren.entities) {\n      data.push(...this.generateChildSchoolRecordsForChild(child as Child));\n    }\n\n    return data;\n  }\n\n  private generateChildSchoolRecordsForChild(\n    child: Child\n  ): ChildSchoolRelation[] {\n    const data = [];\n\n    const firstYear = child.admissionDate.getFullYear();\n    let finalYear = new Date().getFullYear();\n    if (child.dropoutDate) {\n      finalYear = child.dropoutDate.getFullYear();\n    }\n\n    let currentSchool: School = undefined;\n    let offset = 0;\n    while (firstYear + offset <= finalYear && offset <= 12) {\n      currentSchool = this.selectNextSchool(currentSchool);\n      data.push(\n        this.generateRecord(\n          child,\n          firstYear + offset,\n          offset + 1,\n          currentSchool\n        )\n      );\n\n      offset++;\n    }\n    if (Math.random() < 0.8) {\n      // 80% of the latest records for each child don't have an end date, which means the child currently attends this school.\n      (data[data.length - 1] as ChildSchoolRelation).end = null;\n    }\n\n    this.setChildSchoolAndClassForLegacyUse(child, data[data.length - 1]);\n\n    return data;\n  }\n\n  private generateRecord(\n    child: Child,\n    year,\n    schoolClass: number,\n    school: School\n  ): ChildSchoolRelation {\n    const schoolRelation = new ChildSchoolRelation(faker.random.uuid());\n    schoolRelation.childId = child.getId();\n    schoolRelation.start = new Date(year + \"-01-01\");\n    schoolRelation.end = new Date(year + \"-12-31\");\n    schoolRelation.schoolClass = String(schoolClass);\n    schoolRelation.schoolId = school.getId();\n    schoolRelation.result = faker.random.number(100);\n    return schoolRelation;\n  }\n\n  /**\n   * Select a different school randomly in a certain percentages of cases keeping the currentSchool otherwise.\n   * @param currentSchool\n   */\n  private selectNextSchool(currentSchool: School) {\n    if (!currentSchool) {\n      return faker.random.arrayElement(this.demoSchools.entities);\n    }\n\n    if (faker.random.number(100) > 75) {\n      return faker.random.arrayElement(this.demoSchools.entities);\n    } else {\n      return currentSchool;\n    }\n  }\n\n  private setChildSchoolAndClassForLegacyUse(\n    child: Child,\n    latestChildSchoolRelation: ChildSchoolRelation\n  ) {\n    child.schoolId = latestChildSchoolRelation.schoolId;\n    child.schoolClass = latestChildSchoolRelation.schoolClass;\n  }\n}\n","export const centersWithProbability = [\n  // multiple entries for the same value increase its probability\n  \"Alipore\",\n  \"Alipore\",\n  \"Tollygunge\",\n  \"Barabazar\",\n];\n\nexport const centersUnique = centersWithProbability.filter(\n  (value, index, self) => self.indexOf(value) === index\n);\n","export const dropoutTypes = [\n  // multiple entries for the same value increase its probability\n  \"Finished School or Training\",\n  \"Dropout\",\n  \"Continues Education without project\",\n  \"Moved away\",\n];\n","export const languages = [\n  // multiple entries for the same value increase its probability\n  \"Hindi\",\n  \"Hindi\",\n  \"Hindi\",\n  \"Urdu\",\n  \"Bengali\",\n  \"Bengali\",\n  \"\",\n];\n","export const religions = [\n  // multiple entries for the same value increase its probability\n  \"Hindu\",\n  \"Hindu\",\n  \"Hindu\",\n  \"Muslim\",\n  \"Muslim\",\n  \"Christian\",\n  \"Sikh\",\n  \"\",\n  \"\",\n];\n","export enum Gender {\n  MALE = \"M\",\n  FEMALE = \"F\",\n}\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { Entity } from \"../../../core/entity/entity\";\nimport { Gender } from \"./Gender\";\nimport { DatabaseEntity } from \"../../../core/entity/database-entity.decorator\";\nimport { DatabaseField } from \"../../../core/entity/database-field.decorator\";\nimport { SafeUrl } from \"@angular/platform-browser\";\nimport { BehaviorSubject } from \"rxjs\";\n\n@DatabaseEntity(\"Child\")\nexport class Child extends Entity {\n  /**\n   * Returns the full relative filePath to a child photo given a filename, adding the relevant folders to it.\n   * @param filename The given filename with file extension.\n   */\n  public static generatePhotoPath(filename: string): string {\n    return \"assets/child-photos/\" + filename;\n  }\n\n  @DatabaseField() name: string;\n  @DatabaseField() projectNumber: string; // project number\n  @DatabaseField({ dataType: \"string\" }) gender: Gender; // M or F\n  @DatabaseField({ dataType: \"date-only\" }) dateOfBirth: Date;\n  @DatabaseField() motherTongue: string = \"\";\n  @DatabaseField() religion: string = \"\";\n\n  @DatabaseField() center: string = \"\";\n  @DatabaseField() admissionDate: Date;\n  @DatabaseField() status: string = \"\";\n\n  /** current school (as determined through the ChildSchoolRelation docs) set during loading through ChildrenService */\n  schoolId: string = \"\";\n  /** current class (as determined through the ChildSchoolRelation docs) set during loading through ChildrenService */\n  schoolClass: string = \"\";\n\n  @DatabaseField() address: string = \"\";\n  @DatabaseField() phone: string = \"\";\n  @DatabaseField() guardianName: string = \"\";\n  @DatabaseField() preferredTimeForGuardianMeeting: string = \"\";\n\n  @DatabaseField() has_aadhar: string = \"\";\n  @DatabaseField() has_bankAccount: string = \"\";\n  @DatabaseField() has_kanyashree: string = \"\";\n  @DatabaseField() has_rationCard: string = \"\";\n  @DatabaseField() has_BplCard: string = \"\";\n\n  @DatabaseField() dropoutDate: Date;\n  @DatabaseField() dropoutType: string;\n  @DatabaseField() dropoutRemarks: string;\n\n  @DatabaseField() health_vaccinationStatus: string;\n  @DatabaseField() health_bloodGroup: string;\n  @DatabaseField() health_lastDentalCheckup: Date;\n  @DatabaseField() health_lastEyeCheckup: Date;\n  @DatabaseField() health_lastENTCheckup: Date;\n  @DatabaseField() health_eyeHealthStatus: string;\n  @DatabaseField() health_lastVitaminD: Date;\n  @DatabaseField() health_lastDeworming: Date;\n\n  /**\n   * Url to an image that is displayed for the child\n   * as a fallback option if no CloudFileService file or connection is available.\n   */\n  @DatabaseField() photoFile: string;\n\n  @DatabaseField({ dataType: \"load-child-photo\" })\n  photo: BehaviorSubject<SafeUrl>;\n\n  get age(): number {\n    let age = -1;\n\n    if (this.dateOfBirth) {\n      const now = new Date();\n      const dateOfBirth = new Date(this.dateOfBirth);\n\n      age = now.getFullYear() - dateOfBirth.getFullYear();\n      const m = now.getMonth() - dateOfBirth.getMonth();\n      if (m < 0 || (m === 0 && now.getDate() < dateOfBirth.getDate())) {\n        age--;\n      }\n    }\n\n    return age;\n  }\n\n  isActive(): boolean {\n    return this.status !== \"Dropout\";\n  }\n\n  public toString() {\n    return this.name;\n  }\n\n  public generateSearchIndices(): string[] {\n    let indices = [];\n\n    if (this.name !== undefined) {\n      indices = indices.concat(this.name.split(\" \"));\n    }\n    if (this.projectNumber !== undefined) {\n      indices.push(this.projectNumber);\n    }\n\n    return indices;\n  }\n}\n","import { Entity } from \"../../../core/entity/entity\";\nimport { DatabaseEntity } from \"../../../core/entity/database-entity.decorator\";\nimport { DatabaseField } from \"../../../core/entity/database-field.decorator\";\n\n/**\n * Record of a school year that a Child attended a certain class in a School.\n */\n@DatabaseEntity(\"ChildSchoolRelation\")\nexport class ChildSchoolRelation extends Entity {\n  @DatabaseField() childId: string;\n  @DatabaseField() schoolId: string;\n  @DatabaseField() schoolClass: string;\n  @DatabaseField({ dataType: \"date-only\" }) start: Date;\n  @DatabaseField({ dataType: \"date-only\" }) end: Date;\n\n  /** percentage achieved in the final school exams of that year */\n  @DatabaseField() result: number;\n}\n","<div fxLayout='column'>\n  <div>\n    <mat-form-field fxFlex>\n      <mat-label>\n        Select center\n      </mat-label>\n      <mat-select (valueChange)='selectCenterFilter($event)'>\n        <mat-option *ngFor=\"let group of centerFilters.options\" [value]=\"group\">\n          <span>{{group.label}}</span>\n        </mat-option>\n      </mat-select>\n    </mat-form-field>\n  </div>\n\n  <div>\n    <mat-form-field fxFlex>\n      <mat-label>\n        Select school\n      </mat-label>\n      <mat-select (valueChange)='selectSchoolFilter($event)' [disabled]='schoolFilters.options.length === 0'>\n        <mat-option *ngFor=\"let group of schoolFilters.options\" [value]=\"group\">\n          <span *ngIf='!group.type'>{{group.label}}</span>\n          <app-school-block *ngIf=\"group.type==='valueFilter'\" [entityId]='group.label' [linkDisabled]='true'></app-school-block>\n        </mat-option>\n      </mat-select>\n    </mat-form-field>\n  </div>\n\n  <div>\n    <mat-form-field fxFlex>\n      <mat-label>\n        Select class\n      </mat-label>\n      <mat-select (valueChange)='selectClassFilter($event)' [disabled]='schoolFilters.options.length === 0'>\n        <mat-option *ngFor=\"let group of classFilters.options\" [value]=\"group\">\n          <span>{{group.label}}</span>\n        </mat-option>\n      </mat-select>\n    </mat-form-field>\n  </div>\n\n\n  <div>\n    Total students selected: {{ value.length }}\n  </div>\n\n  <div>\n    <button mat-stroked-button (click)='confirmSelectedChildren()' class='nav-button' fxFlex>\n      Continue\n    </button>\n  </div>\n\n</div>\n","import { Component, EventEmitter, OnInit, Output } from \"@angular/core\";\nimport { Child } from \"../model/child\";\nimport { ChildrenService } from \"../children.service\";\nimport {\n  FilterSelection,\n  FilterSelectionOption,\n} from \"../../../core/filter/filter-selection/filter-selection\";\nimport { UntilDestroy, untilDestroyed } from \"@ngneat/until-destroy\";\n\n/**\n * Use this component in your template to allow the user to select a group of children.\n */\n@UntilDestroy()\n@Component({\n  selector: \"app-select-group-children\",\n  templateUrl: \"./select-group-children.component.html\",\n  styleUrls: [\"./select-group-children.component.scss\"],\n})\nexport class SelectGroupChildrenComponent implements OnInit {\n  @Output() valueChange = new EventEmitter<Child[]>();\n  value: Child[] = [];\n\n  children: Child[];\n\n  centerFilters = new FilterSelection<Child>(\"Centers\", []);\n  private selectedCenterFilter: FilterSelectionOption<Child>;\n\n  schoolFilters = new FilterSelection<Child>(\"Schools\", []);\n  private selectedSchoolFilter: FilterSelectionOption<Child>;\n\n  classFilters = new FilterSelection<Child>(\"Classes\", []);\n  private selectedClassFilter: FilterSelectionOption<Child>;\n\n  constructor(private childrenService: ChildrenService) {}\n\n  ngOnInit() {\n    this.childrenService\n      .getChildren()\n      .pipe(untilDestroyed(this))\n      .subscribe((children) => {\n        this.children = children.filter((c) => c.isActive());\n        this.centerFilters.options = this.loadFilterOptionsForProperty(\n          this.children,\n          \"center\"\n        );\n      });\n  }\n\n  private loadFilterOptionsForProperty(\n    children: Child[],\n    propertyToBeFiltered: string\n  ) {\n    const options = [this.getAllStudentsFilterOption()];\n    children\n      .map((c) => c[propertyToBeFiltered])\n      .filter((value, index, arr) => arr.indexOf(value) === index)\n      .forEach((id) => {\n        if (!id) {\n          return;\n        }\n\n        const filterOption = {\n          key: id,\n          label: id,\n          type: \"valueFilter\",\n          filterFun: (c: Child) => c[propertyToBeFiltered] === id,\n        };\n        options.push(filterOption);\n      });\n    return options;\n  }\n\n  private getAllStudentsFilterOption(): FilterSelectionOption<Child> {\n    return {\n      key: \"all\",\n      label: \"All Students\",\n      filterFun: () => true,\n    };\n  }\n\n  selectCenterFilter(group: FilterSelectionOption<Child>) {\n    this.selectedCenterFilter = group;\n    this.value = this.children.filter(this.selectedCenterFilter.filterFun);\n\n    this.schoolFilters.options = this.loadFilterOptionsForProperty(\n      this.value,\n      \"schoolId\"\n    );\n    this.selectSchoolFilter(this.schoolFilters.options[0]); // reset to the default \"All Students\" filter\n  }\n\n  selectSchoolFilter(group: FilterSelectionOption<Child>) {\n    this.selectedSchoolFilter = group;\n    this.value = this.children\n      .filter(this.selectedCenterFilter.filterFun)\n      .filter(this.selectedSchoolFilter.filterFun);\n\n    this.classFilters.options = this.loadFilterOptionsForProperty(\n      this.value,\n      \"schoolClass\"\n    );\n    this.selectClassFilter(this.classFilters.options[0]); // reset to the default \"All Students\" filter\n  }\n\n  selectClassFilter(group: FilterSelectionOption<Child>) {\n    this.selectedClassFilter = group;\n    this.value = this.children\n      .filter(this.selectedCenterFilter.filterFun)\n      .filter(this.selectedSchoolFilter.filterFun)\n      .filter(this.selectedClassFilter.filterFun);\n  }\n\n  confirmSelectedChildren() {\n    this.valueChange.emit(this.value);\n  }\n}\n","import { AttendanceAverageDashboardComponent } from \"app/child-dev-project/attendance/dashboard-widgets/attendance-average-dashboard/attendance-average-dashboard.component\";\nimport { AttendanceWarningsDashboardComponent } from \"app/child-dev-project/attendance/dashboard-widgets/attendance-warnings-dashboard/attendance-warnings-dashboard.component\";\nimport { AttendanceWeekDashboardComponent } from \"app/child-dev-project/attendance/dashboard-widgets/attendance-week-dashboard/attendance-week-dashboard.component\";\nimport { ChildrenCountDashboardComponent } from \"app/child-dev-project/children/children-count-dashboard/children-count-dashboard.component\";\nimport { NoRecentNotesDashboardComponent } from \"app/child-dev-project/notes/dashboard-widgets/no-recent-notes-dashboard/no-recent-notes-dashboard.component\";\nimport { RecentNotesDashboardComponent } from \"app/child-dev-project/notes/dashboard-widgets/recent-notes-dashboard/recent-notes-dashboard.component\";\nimport { ProgressDashboardComponent } from \"./progress-dashboard/progress-dashboard.component\";\n\nexport const DASHBOARD_COMPONENT_MAP = new Map<string, any>([\n  [\"ChildrenCountDashboard\", ChildrenCountDashboardComponent],\n  [\"RecentNotesDashboard\", RecentNotesDashboardComponent],\n  [\"NoRecentNotesDashboard\", NoRecentNotesDashboardComponent],\n  [\"AttendanceWeekDashboard\", AttendanceWeekDashboardComponent],\n  [\"ProgressDashboard\", ProgressDashboardComponent],\n  [\"AttendanceAverageDashboard\", AttendanceAverageDashboardComponent],\n  [\"AttendanceWarningsDashboard\", AttendanceWarningsDashboardComponent],\n]);\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { NgModule } from \"@angular/core\";\nimport { CommonModule } from \"@angular/common\";\nimport { DashboardComponent } from \"./dashboard/dashboard.component\";\nimport { FlexLayoutModule } from \"@angular/flex-layout\";\nimport { MatButtonModule } from \"@angular/material/button\";\nimport { MatCardModule } from \"@angular/material/card\";\nimport { MatFormFieldModule } from \"@angular/material/form-field\";\nimport { MatIconModule } from \"@angular/material/icon\";\nimport { MatInputModule } from \"@angular/material/input\";\nimport { MatProgressBarModule } from \"@angular/material/progress-bar\";\nimport { ChildrenModule } from \"../children/children.module\";\nimport { ProgressDashboardComponent } from \"./progress-dashboard/progress-dashboard.component\";\nimport { FormsModule } from \"@angular/forms\";\nimport { DashboardWidgetDirective } from \"./dashboard/dashboard-widget.directive\";\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    FlexLayoutModule,\n    MatCardModule,\n    MatIconModule,\n    MatButtonModule,\n    MatProgressBarModule,\n    MatInputModule,\n    MatFormFieldModule,\n    ChildrenModule,\n  ],\n  declarations: [\n    DashboardComponent,\n    DashboardWidgetDirective,\n    ProgressDashboardComponent,\n  ],\n})\nexport class DashboardModule {}\n","import {\n  ComponentFactoryResolver,\n  Directive,\n  Input,\n  OnChanges,\n  SimpleChanges,\n  ViewContainerRef,\n} from \"@angular/core\";\nimport { LoggingService } from \"app/core/logging/logging.service\";\nimport { DASHBOARD_COMPONENT_MAP } from \"../dashboard-component-map\";\nimport { DashboardWidgetConfig } from \"../dashboard-widget-config.interface\";\nimport { DashboardWidgetComponent } from \"../dashboard-widget.component\";\n\n/**\n * Directive to mark a template into which a DashboardWidgetComponent should be loaded.\n * Pass the DashboardWidgetConfig into the directive to define the widget.\n */\n@Directive({\n  selector: \"[appDashboardWidget]\",\n})\nexport class DashboardWidgetDirective implements OnChanges {\n  @Input() appDashboardWidget: DashboardWidgetConfig;\n\n  constructor(\n    public viewContainerRef: ViewContainerRef,\n    private componentFactoryResolver: ComponentFactoryResolver,\n    private loggingService: LoggingService\n  ) {}\n\n  ngOnChanges(changes: SimpleChanges): void {\n    this.loadWidgetComponent();\n  }\n\n  private loadWidgetComponent() {\n    if (!this.appDashboardWidget) {\n      return;\n    }\n\n    const component = DASHBOARD_COMPONENT_MAP.get(\n      this.appDashboardWidget.component\n    );\n    if (!component) {\n      this.loggingService.warn(\n        \"Could not load dashboard widget - component not found: \" +\n          this.appDashboardWidget.component\n      );\n      return;\n    }\n\n    const componentFactory = this.componentFactoryResolver.resolveComponentFactory<\n      DashboardWidgetComponent\n    >(component);\n\n    this.viewContainerRef.clear();\n\n    const componentRef = this.viewContainerRef.createComponent<\n      DashboardWidgetComponent\n    >(componentFactory);\n    componentRef.instance.initFromConfig(this.appDashboardWidget.config);\n  }\n}\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { Component, OnInit, ViewChild } from \"@angular/core\";\nimport { ActivatedRoute } from \"@angular/router\";\nimport { DashboardWidgetConfig } from \"../dashboard-widget-config.interface\";\n\n@Component({\n  selector: \"app-dashboard\",\n  templateUrl: \"./dashboard.component.html\",\n  styleUrls: [\"./dashboard.component.scss\"],\n})\nexport class DashboardComponent implements OnInit {\n  widgets: DashboardWidgetConfig[] = [];\n\n  constructor(private activatedRoute: ActivatedRoute) {}\n\n  ngOnInit() {\n    this.activatedRoute.data.subscribe((config) => {\n      this.widgets = config.widgets;\n    });\n  }\n}\n","<!--\n  ~     This file is part of ndb-core.\n  ~\n  ~     ndb-core is free software: you can redistribute it and/or modify\n  ~     it under the terms of the GNU General Public License as published by\n  ~     the Free Software Foundation, either version 3 of the License, or\n  ~     (at your option) any later version.\n  ~\n  ~     ndb-core is distributed in the hope that it will be useful,\n  ~     but WITHOUT ANY WARRANTY; without even the implied warranty of\n  ~     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n  ~     GNU General Public License for more details.\n  ~\n  ~     You should have received a copy of the GNU General Public License\n  ~     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n  -->\n\n<div fxLayout=\"row wrap\" fxLayout.xs=\"column wrap\" fxLayoutGap=\"20px\" class='widget-wrapper'>\n  <div fxFlex=\"30\" *ngFor=\"let widgetConfig of widgets\">\n    <ng-template [appDashboardWidget]=\"widgetConfig\"></ng-template>\n  </div>\n</div>\n\n","import { faker } from \"../../core/demo-data/faker\";\nimport { Injectable } from \"@angular/core\";\nimport { DemoDataGenerator } from \"../../core/demo-data/demo-data-generator\";\nimport { ProgressDashboardConfig } from \"./progress-dashboard/progress-dashboard-config\";\n\n@Injectable()\nexport class DemoWidgetGeneratorService extends DemoDataGenerator<any> {\n  /**\n   * This function returns a provider object to be used in an Angular Module configuration:\n   *   `providers: [DemoWidgetGeneratorService.provider()]`\n   */\n  static provider() {\n    return [\n      {\n        provide: DemoWidgetGeneratorService,\n        useClass: DemoWidgetGeneratorService,\n      },\n    ];\n  }\n\n  private readonly DEMO_TASKS = [\n    \"Clubs visited\",\n    \"Schools checked\",\n    \"Government Officials met\",\n  ];\n\n  constructor() {\n    super();\n  }\n\n  generateEntities(): any[] {\n    const data = [];\n\n    data.push(this.generateDashboardWidgetSurveyStatus());\n\n    return data;\n  }\n\n  private generateDashboardWidgetSurveyStatus(): ProgressDashboardConfig {\n    const dashboardProgressWidget = new ProgressDashboardConfig(\"1\");\n    dashboardProgressWidget.title = \"Annual Survey\";\n\n    for (const task of this.DEMO_TASKS) {\n      const targetNumber = faker.random.number({ min: 5, max: 50 });\n      dashboardProgressWidget.parts.push({\n        label: task,\n        currentValue: faker.random.number(targetNumber),\n        targetValue: targetNumber,\n      });\n    }\n    return dashboardProgressWidget;\n  }\n}\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { Entity } from \"../../../core/entity/entity\";\nimport { DatabaseEntity } from \"../../../core/entity/database-entity.decorator\";\nimport { DatabaseField } from \"../../../core/entity/database-field.decorator\";\n\n@DatabaseEntity(\"ProgressDashboardConfig\")\nexport class ProgressDashboardConfig extends Entity {\n  @DatabaseField() title: string = \"Progress Widget\";\n  @DatabaseField() parts: Array<ProgressDashboardPart> = [];\n\n  getTotalPercentage() {\n    const currentTotal = this.parts.reduce(\n      (acc, entry) => acc + entry.currentValue,\n      0\n    );\n    const targetTotal = this.parts.reduce(\n      (acc, entry) => acc + entry.targetValue,\n      0\n    );\n    return currentTotal / targetTotal;\n  }\n}\n\nexport interface ProgressDashboardPart {\n  label: string;\n  currentValue: number;\n  targetValue: number;\n}\n","<mat-card class=\"dashboard-widget\">\n  <mat-card-header class=\"app-child\">\n    <div mat-card-avatar>\n      <mat-icon fontIcon=\"fa-list\"></mat-icon>\n    </div>\n    <mat-card-title>{{ data.getTotalPercentage() | percent:'1.0-0'}}</mat-card-title>\n    <mat-card-subtitle>{{data.title}}</mat-card-subtitle>\n  </mat-card-header>\n  <mat-card-content>\n    <p class=\"dashboard-desc\">\n      Status of current processes:\n    </p>\n    <table class=\"dashboard-table\">\n      <tr *ngFor=\"let entry of data?.parts\" class=\"dashboard-table-row\">\n        <td class=\"dashboard-table-cell\">{{entry.label}}</td>\n        <td class=\"dashboard-table-cell filler\">\n          <mat-progress-bar mode=\"determinate\" [value]=\"entry.currentValue/entry.targetValue*100\"></mat-progress-bar>\n        </td>\n        <td class=\"dashboard-table-cell\">{{entry.currentValue/entry.targetValue | percent:'1.0-0'}}</td>\n        <td class=\"dashboard-table-cell\" style=\"white-space: nowrap\">{{entry.currentValue}} / {{entry.targetValue}}</td>\n      </tr>\n    </table>\n\n    <div [ngClass]=\"{'dashboard-config': configure}\">\n      <div style='text-align: right;'>\n        <button mat-icon-button (click)='addPart()' *ngIf='configure'>\n          <mat-icon aria-label=\"add part\" fontIcon=\"fa-plus\"></mat-icon>\n        </button>\n        <button mat-icon-button (click)='save()' *ngIf='configure'>\n          <mat-icon aria-label=\"save\" fontIcon=\"fa-check\"></mat-icon>\n        </button>\n        <button mat-icon-button (click)='configure=true' *ngIf='!configure'>\n          <mat-icon aria-label=\"configure\" fontIcon=\"fa-wrench\"></mat-icon>\n        </button>\n      </div>\n\n      <!-- TODO: remove ugly negative margins -->\n      <div class=\"dashboard-table-cell\" *ngIf='configure' style=\"border-bottom: 1px solid black\">\n        <mat-form-field style=\"margin-bottom: -10px\">\n          <input matInput type=\"text\" placeholder=\"Title\" [value]=\"data.title\" (input)='data.title=$event.target.value'>\n        </mat-form-field>\n      </div>\n\n      <table class=\"dashboard-table\" *ngIf='configure'>\n        <tr *ngFor=\"let entry of data.parts; let i = index\" class=\"dashboard-table-row\">\n          <td class=\"dashboard-table-cell\" style=\"width: calc(100% - 20px); display: inline-block\">\n            <mat-form-field class=\"filler\">\n              <input matInput type=\"text\" placeholder=\"Label\" [value]=\"entry.label\" (input)=\"entry.label=$event.target.value\">\n            </mat-form-field>\n          </td>\n          <td class=\"dashboard-table-cell\" style=\"display: inline-block; margin-top: -20px; margin-bottom: -10px\">\n            <mat-form-field class=\"small\">\n              <input matInput type=\"number\" placeholder=\"Current\" [value]=\"entry.currentValue\" (change)=\"entry.currentValue=$event.target.valueAsNumber\">\n            </mat-form-field>\n\n            <mat-form-field class=\"small\" style=\"margin: 0px 10px\">\n              <input matInput type=\"number\" placeholder=\"Target\"  [value]=\"entry.targetValue\" (change)=\"entry.targetValue=$event.target.valueAsNumber\">\n            </mat-form-field>\n          </td>\n          <td>\n            <button mat-icon-button (click)='data.parts.splice(i, 1)'>\n              <mat-icon aria-label=\"remove\" fontIcon=\"fa-trash\"></mat-icon>\n            </button>\n          </td>\n        </tr>\n      </table>\n    </div>\n  </mat-card-content>\n</mat-card>\n","import { Component, Input, OnInit } from \"@angular/core\";\nimport {\n  ProgressDashboardConfig,\n  ProgressDashboardPart,\n} from \"./progress-dashboard-config\";\nimport { EntityMapperService } from \"../../../core/entity/entity-mapper.service\";\nimport { AlertService } from \"../../../core/alerts/alert.service\";\nimport { DashboardWidgetComponent } from \"../dashboard-widget.component\";\nimport { DashboardWidgetConfig } from \"../dashboard-widget-config.interface\";\n\n@Component({\n  selector: \"app-progress-dashboard\",\n  templateUrl: \"./progress-dashboard.component.html\",\n  styleUrls: [\"./progress-dashboard.component.scss\"],\n})\nexport class ProgressDashboardComponent\n  implements DashboardWidgetComponent, OnInit {\n  @Input() dashboardConfigId = \"\";\n  data: ProgressDashboardConfig;\n  configure = false;\n\n  constructor(\n    private entityMapper: EntityMapperService,\n    private alertService: AlertService\n  ) {}\n\n  initFromConfig(config: any) {\n    this.dashboardConfigId = config.dashboardConfigId;\n  }\n\n  ngOnInit() {\n    this.data = new ProgressDashboardConfig(this.dashboardConfigId);\n    this.entityMapper\n      .load<ProgressDashboardConfig>(\n        ProgressDashboardConfig,\n        this.dashboardConfigId\n      )\n      .then((config) => {\n        this.data = config;\n      })\n      .catch((e) => {\n        if (e.status === 404) {\n          this.alertService.addDebug(\n            `ProgressDashboardConfig (${this.dashboardConfigId}) not found. Creating ...`\n          );\n          this.createDefaultConfig();\n        } else {\n          this.alertService.addWarning(\n            `Error loading ProgressDashboardConfig (${this.dashboardConfigId}): ${e.message}`\n          );\n        }\n      });\n  }\n\n  private createDefaultConfig() {\n    this.data.title = \"Progress of X\";\n    this.addPart();\n    this.addPart();\n    this.save();\n  }\n\n  addPart() {\n    const newPart: ProgressDashboardPart = {\n      label: \"Part\",\n      currentValue: 1,\n      targetValue: 10,\n    };\n    this.data.parts.push(newPart);\n  }\n\n  async save() {\n    await this.entityMapper.save(this.data);\n    this.configure = false;\n  }\n}\n","import { DemoChildGenerator } from \"../children/demo-data-generators/demo-child-generator.service\";\nimport { DemoDataGenerator } from \"../../core/demo-data/demo-data-generator\";\nimport { Injectable } from \"@angular/core\";\nimport { Child } from \"../children/model/child\";\nimport { faker } from \"../../core/demo-data/faker\";\nimport { EducationalMaterial } from \"./model/educational-material\";\n\nexport class DemoEducationMaterialConfig {\n  minCount: number;\n  maxCount: number;\n}\n\n/**\n * Generate EducationalMaterial records.\n * Builds upon the generated demo Child entities.\n */\n@Injectable()\nexport class DemoEducationalMaterialGeneratorService extends DemoDataGenerator<\n  EducationalMaterial\n> {\n  /**\n   * This function returns a provider object to be used in an Angular Module configuration:\n   *   `providers: [DemoEducationalMaterialGeneratorService.provider()]`\n   */\n  static provider(config: DemoEducationMaterialConfig) {\n    return [\n      {\n        provide: DemoEducationalMaterialGeneratorService,\n        useClass: DemoEducationalMaterialGeneratorService,\n      },\n      { provide: DemoEducationMaterialConfig, useValue: config },\n    ];\n  }\n\n  constructor(\n    private config: DemoEducationMaterialConfig,\n    private demoChildren: DemoChildGenerator\n  ) {\n    super();\n  }\n\n  public generateEntities(): EducationalMaterial[] {\n    const data = [];\n\n    for (const child of this.demoChildren.entities) {\n      const count = faker.random.number({\n        min: this.config.minCount,\n        max: this.config.maxCount,\n      });\n      for (let i = 1; i < count; i++) {\n        data.push(this.generateEducationalMaterialEntity(child));\n      }\n\n      const specialMaterial = this.generateEducationalMaterialEntity(child);\n      specialMaterial.materialType = faker.random.arrayElement(\n        EducationalMaterial.MATERIAL_OTHER\n      );\n      specialMaterial.materialAmount = 1;\n      data.push(specialMaterial);\n    }\n\n    return data;\n  }\n\n  private generateEducationalMaterialEntity(child: Child): EducationalMaterial {\n    const entity = new EducationalMaterial(faker.random.uuid());\n\n    entity.child = child.getId();\n    entity.date = faker.date.between(\n      child.admissionDate,\n      faker.getEarlierDateOrToday(child.dropoutDate)\n    );\n    entity.materialAmount = faker.random.arrayElement([1, 1, 1, 2, 3]);\n    entity.materialType = faker.random.arrayElement(\n      EducationalMaterial.MATERIAL_ALL\n    );\n\n    return entity;\n  }\n}\n","import { Component, OnInit } from \"@angular/core\";\nimport { ActivatedRoute } from \"@angular/router\";\nimport { DatePipe } from \"@angular/common\";\nimport { EducationalMaterial } from \"../model/educational-material\";\nimport { ColumnDescription } from \"../../../core/entity-subrecord/entity-subrecord/column-description\";\nimport { ChildrenService } from \"../../children/children.service\";\nimport { ColumnDescriptionInputType } from \"../../../core/entity-subrecord/entity-subrecord/column-description-input-type.enum\";\nimport { UntilDestroy, untilDestroyed } from \"@ngneat/until-destroy\";\n\n@UntilDestroy()\n@Component({\n  selector: \"app-educational-material\",\n  templateUrl: \"./educational-material.component.html\",\n})\nexport class EducationalMaterialComponent implements OnInit {\n  childId: string;\n  records = new Array<EducationalMaterial>();\n\n  materialTypes = EducationalMaterial.MATERIAL_ALL;\n\n  columns: Array<ColumnDescription> = [\n    new ColumnDescription(\n      \"date\",\n      \"Date\",\n      ColumnDescriptionInputType.DATE,\n      null,\n      (v: Date) => this.datePipe.transform(v, \"yyyy-MM-dd\"),\n      \"xs\"\n    ),\n    new ColumnDescription(\n      \"materialType\",\n      \"Material\",\n      ColumnDescriptionInputType.AUTOCOMPLETE,\n      this.materialTypes.map((t) => {\n        return { value: t, label: t };\n      }),\n      undefined,\n      \"xs\"\n    ),\n    new ColumnDescription(\n      \"materialAmount\",\n      \"Amount\",\n      ColumnDescriptionInputType.NUMBER,\n      null,\n      undefined,\n      \"md\"\n    ),\n    new ColumnDescription(\n      \"description\",\n      \"Description/Remarks\",\n      ColumnDescriptionInputType.TEXT,\n      null,\n      undefined,\n      \"md\"\n    ),\n  ];\n\n  constructor(\n    private route: ActivatedRoute,\n    private childrenService: ChildrenService,\n    private datePipe: DatePipe\n  ) {}\n\n  ngOnInit() {\n    this.route.paramMap.subscribe((params) => {\n      this.childId = params.get(\"id\").toString();\n      this.loadData(this.childId);\n    });\n  }\n\n  loadData(id: string) {\n    this.childrenService\n      .getEducationalMaterialsOfChild(id)\n      .pipe(untilDestroyed(this))\n      .subscribe((results) => {\n        this.records = results.sort(\n          (a, b) =>\n            (b.date ? b.date.valueOf() : 0) - (a.date ? a.date.valueOf() : 0)\n        );\n      });\n  }\n\n  generateNewRecordFactory() {\n    // define values locally because \"this\" is a different scope after passing a function as input to another component\n    const child = this.childId;\n\n    return () => {\n      const newAtt = new EducationalMaterial(Date.now().toString());\n\n      // use last entered date as default, otherwise today's date\n      newAtt.date = this.records.length > 0 ? this.records[0].date : new Date();\n\n      newAtt.child = child;\n\n      return newAtt;\n    };\n  }\n\n  getSummary() {\n    if (this.records.length === 0) {\n      return \"\";\n    }\n\n    const summary = new Map<string, number>();\n    this.records.forEach((m) => {\n      const previousValue = summary.has(m.materialType)\n        ? summary.get(m.materialType)\n        : 0;\n      summary.set(m.materialType, previousValue + m.materialAmount);\n    });\n\n    let summaryText = \"\";\n    summary.forEach(\n      (v, k) => (summaryText = summaryText + k + \": \" + v + \", \")\n    );\n    return summaryText;\n  }\n}\n","<app-entity-subrecord\n  [records]=\"records\"\n  [columns]=\"columns\"\n  [newRecordFactory]=\"generateNewRecordFactory()\">\n</app-entity-subrecord>\n\n<div style='margin-top: 20px'>\n  Total: {{getSummary()}}\n</div>\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { Entity } from \"../../../core/entity/entity\";\nimport { DatabaseEntity } from \"../../../core/entity/database-entity.decorator\";\nimport { DatabaseField } from \"../../../core/entity/database-field.decorator\";\n\n@DatabaseEntity(\"EducationalMaterial\")\nexport class EducationalMaterial extends Entity {\n  static MATERIAL_STATIONARIES = [\n    \"pencil\",\n    \"eraser\",\n    \"sharpener\",\n    \"pen (black)\",\n    \"pen (blue)\",\n    \"oil pastels\",\n    \"crayons\",\n    \"sketch pens\",\n    \"scale (big)\",\n    \"scale (small)\",\n    \"geometry box\",\n    \"copy (single line, small)\",\n    \"copy (single line, big)\",\n    \"copy (four line)\",\n    \"copy (squared)\",\n    \"copy (plain)\",\n    \"copy (line-plain)\",\n    \"copy (drawing)\",\n    \"copy (practical)\",\n    \"graph book\",\n    \"project papers\",\n    \"project file\",\n    \"scrap book\",\n    \"exam board\",\n  ];\n  static MATERIAL_OTHER = [\n    \"Bag\",\n    \"School Uniform\",\n    \"School Shoes\",\n    \"Sports Dress\",\n    \"Sports Shoes\",\n    \"Raincoat\",\n  ];\n  static MATERIAL_ALL = EducationalMaterial.MATERIAL_STATIONARIES.concat(\n    EducationalMaterial.MATERIAL_OTHER\n  );\n\n  @DatabaseField() child: string; // id of Child entity\n  @DatabaseField() date: Date;\n  @DatabaseField() materialType = \"\";\n  @DatabaseField() materialAmount: number;\n  @DatabaseField() description = \"\";\n\n  public getColor() {\n    if (EducationalMaterial.MATERIAL_STATIONARIES.includes(this.materialType)) {\n      return \"white\";\n    } else {\n      return \"#B3E5FC\";\n    }\n  }\n}\n","import { DemoChildGenerator } from \"../../children/demo-data-generators/demo-child-generator.service\";\nimport { DemoDataGenerator } from \"../../../core/demo-data/demo-data-generator\";\nimport { Injectable } from \"@angular/core\";\nimport { Child } from \"../../children/model/child\";\nimport { faker } from \"../../../core/demo-data/faker\";\nimport { HealthCheck } from \"../model/health-check\";\nimport { heightRangeForAge, weightRangeForAge } from \"./height-weight\";\n\n/**\n * Generate HealthCheck records every 6 months for children up to the age of 12.\n * Builds upon the generated demo Child entities.\n */\n@Injectable()\nexport class DemoHealthCheckGeneratorService extends DemoDataGenerator<\n  HealthCheck\n> {\n  /**\n   * This function returns a provider object to be used in an Angular Module configuration:\n   *   `providers: [DemoHealthCheckGeneratorService.provider()]`\n   */\n  static provider() {\n    return [\n      {\n        provide: DemoHealthCheckGeneratorService,\n        useClass: DemoHealthCheckGeneratorService,\n      },\n    ];\n  }\n\n  constructor(private demoChildren: DemoChildGenerator) {\n    super();\n  }\n\n  public generateEntities(): HealthCheck[] {\n    const data = [];\n\n    for (const child of this.demoChildren.entities) {\n      data.push(...this.generateHealthCheckHistoryForChild(child));\n    }\n\n    return data;\n  }\n\n  private generateHealthCheckHistoryForChild(child: Child): HealthCheck[] {\n    const data = [];\n\n    let date = new Date(child.admissionDate.getTime());\n    let previousRecord = new HealthCheck(\"\");\n    previousRecord.height = 0;\n    previousRecord.weight = 0;\n    do {\n      const record = new HealthCheck(faker.random.uuid());\n      record.child = child.getId();\n      record.date = date;\n      this.setNextHeightAndWeight(\n        record,\n        previousRecord,\n        this.getAgeAtDate(child, date)\n      );\n\n      data.push(record);\n\n      if (date.getMonth() === 0) {\n        date = new Date(date.getFullYear(), 5, 1);\n      } else {\n        date = new Date(date.getFullYear() + 1, 0, 1);\n      }\n      previousRecord = record;\n    } while (\n      date < faker.getEarlierDateOrToday(child.dropoutDate) &&\n      this.getAgeAtDate(child, date) < 12\n    );\n\n    return data;\n  }\n\n  private getAgeAtDate(child: Child, date: Date): number {\n    const timeDiff = date.getTime() - child.dateOfBirth.getTime();\n    return timeDiff / (1000 * 60 * 60 * 24 * 365);\n  }\n\n  private setNextHeightAndWeight(\n    record: HealthCheck,\n    previousRecord: HealthCheck,\n    age: number\n  ) {\n    const ageRoundedToHalfYear = Math.round(2 * age) / 2;\n\n    const randomHeight = faker.random.number(\n      heightRangeForAge.get(ageRoundedToHalfYear)\n    );\n    record.height = Math.max(randomHeight, previousRecord.height); // height will not become less\n\n    record.weight = faker.random.number(\n      weightRangeForAge.get(ageRoundedToHalfYear)\n    );\n  }\n}\n","// values based on https://www.cdc.gov/growthcharts/percentile_data_files.htm\n\nexport const heightRangeForAge = new Map<number, any>([\n  [2, { min: 78, max: 91 }],\n  [2.5, { min: 83, max: 97 }],\n  [3, { min: 86, max: 101 }],\n  [3.5, { min: 89, max: 105 }],\n  [4, { min: 93, max: 109 }],\n  [4.5, { min: 96, max: 113 }],\n  [5, { min: 99, max: 117 }],\n  [5.5, { min: 102, max: 121 }],\n  [6, { min: 105, max: 125 }],\n  [6.5, { min: 108, max: 129 }],\n  [7, { min: 111, max: 132 }],\n  [7.5, { min: 114, max: 136 }],\n  [8, { min: 116, max: 138 }],\n  [8.5, { min: 119, max: 142 }],\n  [9, { min: 121, max: 145 }],\n  [9.5, { min: 123, max: 148 }],\n  [10, { min: 125, max: 150 }],\n  [10.5, { min: 127, max: 154 }],\n  [11, { min: 130, max: 157 }],\n  [11.5, { min: 133, max: 161 }],\n  [12, { min: 136, max: 164 }],\n  [12.5, { min: 140, max: 167 }],\n  [13, { min: 144, max: 170 }],\n  [13.5, { min: 146, max: 171 }],\n  [14, { min: 148, max: 172 }],\n  [14.5, { min: 148, max: 173 }],\n]);\n\nexport const weightRangeForAge = new Map<number, any>([\n  [2, { min: 10, max: 15 }],\n  [2.5, { min: 10, max: 16 }],\n  [3, { min: 11, max: 17 }],\n  [3.5, { min: 11, max: 19 }],\n  [4, { min: 12, max: 20 }],\n  [4.5, { min: 13, max: 22 }],\n  [5, { min: 14, max: 24 }],\n  [5.5, { min: 15, max: 26 }],\n  [6, { min: 15, max: 28 }],\n  [6.5, { min: 16, max: 30 }],\n  [7, { min: 17, max: 32 }],\n  [7.5, { min: 18, max: 35 }],\n  [8, { min: 19, max: 38 }],\n  [8.5, { min: 20, max: 40 }],\n  [9, { min: 21, max: 44 }],\n  [9.5, { min: 22, max: 47 }],\n  [10, { min: 23, max: 50 }],\n  [10.5, { min: 25, max: 54 }],\n  [11, { min: 26, max: 58 }],\n  [11.5, { min: 28, max: 61 }],\n  [12, { min: 29, max: 65 }],\n  [12.5, { min: 31, max: 68 }],\n  [13, { min: 33, max: 71 }],\n  [13.5, { min: 34, max: 74 }],\n  [14, { min: 36, max: 77 }],\n  [14.5, { min: 38, max: 79 }],\n]);\n","import { Component, OnInit } from \"@angular/core\";\nimport { HealthCheck } from \"../model/health-check\";\nimport { ColumnDescription } from \"../../../core/entity-subrecord/entity-subrecord/column-description\";\nimport { ActivatedRoute } from \"@angular/router\";\nimport { ChildrenService } from \"../../children/children.service\";\nimport { DatePipe } from \"@angular/common\";\nimport { ColumnDescriptionInputType } from \"../../../core/entity-subrecord/entity-subrecord/column-description-input-type.enum\";\nimport { UntilDestroy, untilDestroyed } from \"@ngneat/until-destroy\";\n\n@UntilDestroy()\n@Component({\n  selector: \"app-health-checkup\",\n  templateUrl: \"./health-checkup.component.html\",\n  styleUrls: [\"./health-checkup.component.scss\"],\n})\nexport class HealthCheckupComponent implements OnInit {\n  records = new Array<HealthCheck>();\n  /**\n   * Column Description for the SubentityRecordComponent\n   * The Date-Column needs to be transformed to apply the MathFormCheck in the SubentityRecordComponent\n   * BMI is rounded to 2 decimal digits\n   */\n  columns: Array<ColumnDescription> = [\n    new ColumnDescription(\n      \"date\",\n      \"Date\",\n      ColumnDescriptionInputType.DATE,\n      null,\n      (v: Date) => this.datePipe.transform(v, \"yyyy-MM-dd\")\n    ),\n    new ColumnDescription(\n      \"height\",\n      \"Height [cm]\",\n      ColumnDescriptionInputType.NUMBER,\n      null,\n      (height: Number) => height + \" cm\"\n    ),\n    new ColumnDescription(\n      \"weight\",\n      \"Weight [kg]\",\n      ColumnDescriptionInputType.NUMBER,\n      null,\n      (weight: Number) => weight + \" kg\"\n    ),\n    new ColumnDescription(\n      \"bmi\",\n      \"BMI\",\n      ColumnDescriptionInputType.READONLY,\n      null,\n      (bmi: Number) => bmi.toFixed(2)\n    ),\n  ];\n  childId: string;\n  constructor(\n    private route: ActivatedRoute,\n    private childrenService: ChildrenService,\n    private datePipe: DatePipe\n  ) {}\n\n  ngOnInit() {\n    this.route.paramMap.subscribe((params) => {\n      this.childId = params.get(\"id\").toString();\n      this.loadHealthChecks();\n    });\n  }\n\n  /**\n   *\n   */\n  generateNewRecordFactory() {\n    // define values locally because \"this\" is a different scope after passing a function as input to another component\n    const childId = this.childId;\n\n    return () => {\n      const newHC = new HealthCheck(Date.now().toString());\n\n      // use last entered date as default, otherwise today's date\n      newHC.date = this.records.length > 0 ? this.records[0].date : new Date();\n      newHC.child = childId;\n\n      return newHC;\n    };\n  }\n\n  /**\n   * implements the health check loading from the children service and is called in the onInit()\n   */\n  loadHealthChecks() {\n    this.childrenService\n      .getHealthChecksOfChild(this.childId)\n      .pipe(untilDestroyed(this))\n      .subscribe((results) => {\n        this.records = results.sort(\n          (a, b) =>\n            (b.date ? b.date.valueOf() : 0) - (a.date ? a.date.valueOf() : 0)\n        );\n      });\n  }\n}\n","<app-entity-subrecord [records]=\"records\" [columns]=\"columns\" [newRecordFactory]=\"generateNewRecordFactory()\"></app-entity-subrecord>","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { Entity } from \"../../../core/entity/entity\";\nimport { DatabaseEntity } from \"../../../core/entity/database-entity.decorator\";\nimport { DatabaseField } from \"../../../core/entity/database-field.decorator\";\nimport { WarningLevel } from \"../../warning-level\";\n\n/**\n * Model Class for the Health Checks that are taken for a Child.\n * It stores the Child's ID in a String and both, the height and weight in cm as a number, and the Date\n */\n@DatabaseEntity(\"HealthCheck\")\nexport class HealthCheck extends Entity {\n  @DatabaseField() child: string;\n  @DatabaseField() date: Date;\n\n  /** height measurement in cm **/\n  @DatabaseField() height: number;\n\n  /** weight measurement in kg **/\n  @DatabaseField() weight: number;\n\n  get bmi(): number {\n    return this.weight / ((this.height / 100) * (this.height / 100));\n  }\n\n  getWarningLevel() {\n    if (this.bmi <= 16 || this.bmi >= 30) {\n      return WarningLevel.URGENT;\n    } else if (this.bmi >= 18 && this.bmi <= 25) {\n      return WarningLevel.OK;\n    } else {\n      return WarningLevel.WARNING;\n    }\n  }\n}\n","<mat-card class=\"dashboard-widget\">\n  <mat-card-header class=\"app-note\">\n    <div mat-card-avatar>\n      <mat-icon fontIcon=\"fa-file-text-o\"></mat-icon>\n    </div>\n    <mat-card-title style=\"position: relative;\">\n      <span *ngIf=\"isLoading\">\n        <mat-spinner [diameter]=\"40\" class=\"loading-indicator\"></mat-spinner>\n        &nbsp;\n      </span>\n      <span *ngIf=\"!isLoading\">\n        {{ concernedChildren?.length }}\n      </span>\n    </mat-card-title>\n    <mat-card-subtitle\n      [matTooltip]=\"\n        'includes children without a note ' +\n        (fromBeginningOfWeek ? 'since beginning of week ' : '') +\n        (sinceDays > 0 ? 'within the last ' + sinceDays + ' days' : '')\n      \"\n    >\n      Children\n      <span class=\"subtitle-highlight\">without</span>\n      recent report\n    </mat-card-subtitle>\n  </mat-card-header>\n  <mat-card-content>\n    <div class=\"mat-elevation-z8 table-list\">\n      <table\n        mat-table\n        [dataSource]=\"childrenWithNoteInfoDataSource\"\n        matSort\n        width=\"100%\"\n      >\n        <ng-container matColumnDef=\"name\">\n          <th mat-header-cell *matHeaderCellDef mat-sort-header>Name</th>\n          <td mat-cell *matCellDef=\"let child\">\n            <app-child-block [entity]=\"child\"></app-child-block>\n          </td>\n        </ng-container>\n        <ng-container matColumnDef=\"daysSinceLastNote\">\n          <th mat-header-cell *matHeaderCellDef mat-sort-header>Days passed</th>\n          <td\n            mat-cell\n            *matCellDef=\"let child\"\n            class=\"dashboard-table-additional-info-cell\"\n          >\n            {{ child.daysSinceLastNote | number: \"1.0-0\" }} days\n          </td>\n        </ng-container>\n        <tr\n          mat-header-row\n          *matHeaderRowDef=\"columnsToDisplay\"\n          style=\"display: none;\"\n        ></tr>\n        <tr\n          mat-row\n          *matRowDef=\"let child; columns: columnsToDisplay; let i = index;\"\n          [routerLink]=\"['/child', child.getId()]\"\n          angulartics2On=\"click\"\n          angularticsCategory=\"Navigation\"\n          angularticsAction=\"dashboard_no_recent_notes_link\"\n          [angularticsLabel]=\"'list-entry-' + i\"\n          class=\"dashboard-table-row w-WARNING\"\n          style=\"cursor: pointer;\"\n        ></tr>\n      </table>\n      <mat-paginator\n        [pageSize]=\"4\"\n        [hidePageSize]=\"true\"\n        [showFirstLastButtons]=\"true\"\n      ></mat-paginator>\n    </div>\n  </mat-card-content>\n</mat-card>\n","import {\n  AfterViewInit,\n  Component,\n  Input,\n  OnInit,\n  ViewChild,\n} from \"@angular/core\";\nimport { ChildrenService } from \"../../../children/children.service\";\nimport { Child } from \"../../../children/model/child\";\nimport moment from \"moment\";\nimport { take } from \"rxjs/operators\";\nimport { MatTableDataSource } from \"@angular/material/table\";\nimport { MatSort } from \"@angular/material/sort\";\nimport { MatPaginator } from \"@angular/material/paginator\";\nimport { DashboardWidgetComponent } from \"app/child-dev-project/dashboard/dashboard-widget.component\";\n\n/**\n * Dashboard Widget displaying children that do not have a recently added Note.\n *\n * If you do not set \"sinceDays\" of \"fromBeginningOfWeek\" inputs\n * by default notes since beginning of the current week are considered.\n */\n@Component({\n  selector: \"app-no-recent-notes-dashboard\",\n  templateUrl: \"./no-recent-notes-dashboard.component.html\",\n  styleUrls: [\"./no-recent-notes-dashboard.component.scss\"],\n})\nexport class NoRecentNotesDashboardComponent\n  implements DashboardWidgetComponent, OnInit, AfterViewInit {\n  /**\n   * number of days since last note that children should be considered having a \"recent\" note.\n   */\n  @Input() sinceDays: number = 0;\n\n  /** Whether an additional offset should be automatically added to include notes from the beginning of the week */\n  @Input() fromBeginningOfWeek = true;\n\n  /** The offset in days since beginning of the week (used for \"fromBeginningOfWeek\" option) */\n  private daysSinceBeginningOfWeek = moment()\n    .startOf(\"day\")\n    .diff(moment().startOf(\"week\"), \"days\");\n\n  /** true while data is not ready/available yet */\n  isLoading: boolean;\n\n  /** children displayed in the template\n   * Child entities with additional \"daysSinceLastNote\" field\n   */\n  concernedChildren: ChildWithRecentNoteInfo[] = [];\n\n  columnsToDisplay: string[] = [\"name\", \"daysSinceLastNote\"];\n  childrenWithNoteInfoDataSource: MatTableDataSource<\n    ChildWithRecentNoteInfo\n  > = new MatTableDataSource<ChildWithRecentNoteInfo>();\n  @ViewChild(MatSort) sort: MatSort;\n  @ViewChild(MatPaginator) paginator: MatPaginator;\n\n  constructor(private childrenService: ChildrenService) {}\n\n  initFromConfig(config: any) {\n    if (config?.sinceDays) {\n      this.sinceDays = config.sinceDays;\n    }\n    if (config?.fromBeginningOfWeek) {\n      this.fromBeginningOfWeek = config.fromBeginningOfWeek;\n    }\n  }\n\n  async ngOnInit() {\n    await this.loadConcernedChildrenFromIndex();\n    this.childrenWithNoteInfoDataSource.data = this.concernedChildren;\n  }\n\n  ngAfterViewInit() {\n    this.childrenWithNoteInfoDataSource.sort = this.sort;\n    this.childrenWithNoteInfoDataSource.paginator = this.paginator;\n  }\n\n  private async loadConcernedChildrenFromIndex() {\n    this.isLoading = true;\n\n    const children = ((await this.childrenService\n      .getChildren()\n      .pipe(take(1))\n      .toPromise()) as ChildWithRecentNoteInfo[]).filter((c) => c.isActive());\n\n    const lastNoteStats = await this.childrenService.getDaysSinceLastNoteOfEachChild();\n\n    const resultChildren = [];\n    for (const child of children) {\n      if (lastNoteStats.has(child.getId())) {\n        child.daysSinceLastNote = lastNoteStats.get(child.getId());\n        if (!this.isWithinDayRange(child.daysSinceLastNote)) {\n          resultChildren.push(child);\n        }\n      } else {\n        child.daysSinceLastNote = 0;\n        resultChildren.push(child);\n      }\n    }\n\n    this.concernedChildren = resultChildren.sort(\n      (a, b) => b.daysSinceLastNote - a.daysSinceLastNote\n    );\n\n    this.isLoading = false;\n  }\n\n  private isWithinDayRange(daysSinceLastNote: number) {\n    if (this.fromBeginningOfWeek) {\n      return (\n        daysSinceLastNote <= this.sinceDays + this.daysSinceBeginningOfWeek\n      );\n    } else {\n      return daysSinceLastNote <= this.sinceDays;\n    }\n  }\n}\n\ntype ChildWithRecentNoteInfo = Child & { daysSinceLastNote: number };\n","<mat-card class=\"dashboard-widget\">\n  <mat-card-header class=\"app-note\">\n    <div mat-card-avatar>\n      <mat-icon fontIcon=\"fa-file-text-o\"></mat-icon>\n    </div>\n    <mat-card-title style=\"position: relative;\">\n      <span *ngIf=\"isLoading\">\n        <mat-spinner [diameter]=\"40\" class=\"loading-indicator\"></mat-spinner>\n        &nbsp;\n      </span>\n      <span *ngIf=\"!isLoading\">\n        {{ count }}\n      </span>\n    </mat-card-title>\n    <mat-card-subtitle\n      [matTooltip]=\"\n        'includes children with a note ' +\n        (fromBeginningOfWeek ? 'since beginning of week ' : '') +\n        (sinceDays > 0 ? 'within the last ' + sinceDays + ' days' : '')\n      \"\n    >\n      Children\n      <span class=\"subtitle-highlight\">with</span>\n      recent report\n    </mat-card-subtitle>\n  </mat-card-header>\n  <mat-card-content>\n    <div\n      class=\"dashboard-content\"\n      [routerLink]=\"['/note']\"\n      angulartics2On=\"click\"\n      angularticsCategory=\"Navigation\"\n      angularticsAction=\"dashboard_recent_notes_link_go_to_notes\"\n      [angularticsLabel]=\"'children-with-recent-report-count-' + count\"\n    >\n      Go to Notes <span class=\"fa fa-external-link-square\"></span>\n    </div>\n  </mat-card-content>\n</mat-card>\n","import { Component, Input, OnInit } from \"@angular/core\";\nimport { ChildrenService } from \"../../../children/children.service\";\nimport moment from \"moment\";\nimport { DashboardWidgetComponent } from \"app/child-dev-project/dashboard/dashboard-widget.component\";\n\n/**\n * Dashboard Widget displaying children that have a recently added Note.\n */\n@Component({\n  selector: \"app-recent-notes-dashboard\",\n  templateUrl: \"./recent-notes-dashboard.component.html\",\n  styleUrls: [\"./recent-notes-dashboard.component.scss\"],\n})\nexport class RecentNotesDashboardComponent\n  implements DashboardWidgetComponent, OnInit {\n  /**\n   * number of days since last note that children should be considered having a \"recent\" note.\n   */\n  @Input() sinceDays: number = 0;\n\n  /** Whether an additional offset should be automatically added to include notes from the beginning of the week */\n  @Input() fromBeginningOfWeek = true;\n\n  /** The offset in days since beginning of the week (used for \"fromBeginningOfWeek\" option) */\n  private daysSinceBeginningOfWeek = moment()\n    .startOf(\"day\")\n    .diff(moment().startOf(\"week\"), \"days\");\n\n  /** true while data is not ready/available yet */\n  isLoading: boolean;\n\n  /** number of children with recent notes */\n  count: number = 0;\n\n  constructor(private childrenService: ChildrenService) {}\n\n  initFromConfig(config: any) {\n    if (config?.sinceDays) {\n      this.sinceDays = config.sinceDays;\n    }\n    if (config?.fromBeginningOfWeek) {\n      this.fromBeginningOfWeek = config.fromBeginningOfWeek;\n    }\n  }\n\n  async ngOnInit() {\n    await this.loadConcernedChildrenFromIndex();\n  }\n\n  private async loadConcernedChildrenFromIndex() {\n    this.isLoading = true;\n\n    const lastNoteStats = await this.childrenService.getDaysSinceLastNoteOfEachChild();\n\n    this.count = 0;\n    for (const entry of lastNoteStats.entries()) {\n      if (this.isWithinDayRange(entry[1])) {\n        this.count++;\n      }\n    }\n\n    this.isLoading = false;\n  }\n\n  private isWithinDayRange(daysSinceLastNote: number) {\n    if (this.fromBeginningOfWeek) {\n      return (\n        daysSinceLastNote <= this.sinceDays + this.daysSinceBeginningOfWeek\n      );\n    } else {\n      return daysSinceLastNote <= this.sinceDays;\n    }\n  }\n}\n","import { DemoChildGenerator } from \"../../children/demo-data-generators/demo-child-generator.service\";\nimport { DemoDataGenerator } from \"../../../core/demo-data/demo-data-generator\";\nimport { Injectable } from \"@angular/core\";\nimport { Child } from \"../../children/model/child\";\nimport { Note } from \"../model/note\";\nimport { MeetingNoteAttendance } from \"../meeting-note-attendance\";\nimport { faker } from \"../../../core/demo-data/faker\";\nimport { WarningLevel } from \"../../warning-level\";\nimport { noteIndividualStories } from \"./notes_individual-stories\";\nimport { noteGroupStories } from \"./notes_group-stories\";\nimport { centersUnique } from \"../../children/demo-data-generators/fixtures/centers\";\nimport { absenceRemarks } from \"./remarks\";\n\nexport class DemoNoteConfig {\n  minNotesPerChild: number;\n  maxNotesPerChild: number;\n  groupNotes: number;\n}\n\n/**\n * Generate a number of Note entities for each Child.\n * Builds upon the generated demo Child entities.\n */\n@Injectable()\nexport class DemoNoteGeneratorService extends DemoDataGenerator<Note> {\n  /**\n   * This function returns a provider object to be used in an Angular Module configuration:\n   *   `providers: [DemoNoteGeneratorService.provider()]`\n   */\n  static provider(\n    config: DemoNoteConfig = {\n      minNotesPerChild: 2,\n      maxNotesPerChild: 10,\n      groupNotes: 5,\n    }\n  ) {\n    return [\n      { provide: DemoNoteGeneratorService, useClass: DemoNoteGeneratorService },\n      { provide: DemoNoteConfig, useValue: config },\n    ];\n  }\n\n  private _teamMembers;\n  get teamMembers(): string[] {\n    const numberOfTeamMembers = 5;\n    if (!this._teamMembers) {\n      this._teamMembers = Array(numberOfTeamMembers)\n        .fill(\"\")\n        .map(() => faker.name.firstName());\n    }\n\n    return this._teamMembers;\n  }\n\n  constructor(\n    private config: DemoNoteConfig,\n    private demoChildren: DemoChildGenerator\n  ) {\n    super();\n  }\n\n  public generateEntities(): Note[] {\n    const data = [];\n\n    for (const child of this.demoChildren.entities) {\n      const numberOfNotes = faker.random.number({\n        min: this.config.minNotesPerChild,\n        max: this.config.maxNotesPerChild,\n      });\n      for (let i = 0; i < numberOfNotes; i++) {\n        data.push(this.generateNoteForChild(child));\n      }\n    }\n\n    for (const center of centersUnique) {\n      const children: Child[] = this.demoChildren.entities.filter(\n        (c) => c.center === center\n      );\n      for (let i = 0; i < this.config.groupNotes; i++) {\n        data.push(this.generateGroupNote(children));\n      }\n    }\n\n    return data;\n  }\n\n  private generateNoteForChild(child: Child): Note {\n    const note = new Note(faker.random.uuid());\n\n    const selectedStory = faker.random.arrayElement(noteIndividualStories);\n    Object.assign(note, selectedStory);\n\n    note.addChild(child.getId());\n    note.author = faker.random.arrayElement(this.teamMembers);\n    note.date = faker.date.between(\n      child.admissionDate,\n      faker.getEarlierDateOrToday(child.dropoutDate)\n    );\n\n    this.removeFollowUpMarkerForOldNotes(note);\n\n    return note;\n  }\n\n  private removeFollowUpMarkerForOldNotes(note: Note) {\n    const lastMonths = new Date();\n    lastMonths.setMonth(lastMonths.getMonth() - 1);\n    if (note.date < lastMonths) {\n      note.warningLevel = WarningLevel.OK;\n    }\n  }\n\n  private generateGroupNote(children: Child[]) {\n    const note = new Note(faker.random.uuid());\n\n    const selectedStory = faker.random.arrayElement(noteGroupStories);\n    Object.assign(note, selectedStory);\n\n    note.children = children.map((c) => c.getId());\n    note.attendances = children.map((child) => {\n      const attendance = new MeetingNoteAttendance(child.getId());\n      // get an approximate presence of 85%\n      if (faker.random.number(100) <= 15) {\n        attendance.present = false;\n        attendance.remarks = faker.random.arrayElement(absenceRemarks);\n      }\n      return attendance;\n    });\n\n    note.author = faker.random.arrayElement(this.teamMembers);\n    note.date = faker.date.past(1);\n\n    this.removeFollowUpMarkerForOldNotes(note);\n\n    return note;\n  }\n}\n","import { WarningLevel } from \"../../warning-level\";\n\nexport const noteGroupStories = [\n  {\n    category: \"Guardians' Meeting\",\n    warningLevel: WarningLevel.OK,\n    subject: \"Guardians Meeting\",\n    text:\n      \"Our regular monthly meeting. Find the agenda and minutes in our meeting folder.\",\n  },\n  {\n    category: \"Guardians' Meeting\",\n    warningLevel: WarningLevel.OK,\n    subject: \"Guardians Meeting\",\n    text:\n      \"Our regular monthly meeting. Find the agenda and minutes in our meeting folder.\",\n  },\n\n  {\n    category: \"Children's Meeting\",\n    warningLevel: WarningLevel.OK,\n    subject: \"Children Meeting\",\n    text:\n      \"Our regular monthly meeting. Find the agenda and minutes in our meeting folder.\",\n  },\n  {\n    category: \"Children's Meeting\",\n    warningLevel: WarningLevel.OK,\n    subject: \"Children Meeting\",\n    text:\n      \"Our regular monthly meeting. Find the agenda and minutes in our meeting folder.\",\n  },\n  {\n    category: \"Children's Meeting\",\n    warningLevel: WarningLevel.OK,\n    subject: \"Drug Prevention Workshop\",\n    text: \"Expert conducted a two day workshop on drug prevention.\",\n  },\n];\n","import { WarningLevel } from \"../../warning-level\";\n\nexport const noteIndividualStories = [\n  {\n    category: \"Home Visit\",\n    warningLevel: WarningLevel.WARNING,\n    subject: \"Mother sick\",\n    text:\n      \"Visited family after we heard that mother is seriously ill. She cannot get up. \" +\n      \"Children are taking care of housework. \" +\n      \"Told her to see doctor. We should follow up next week.\",\n  },\n  {\n    category: \"Talk with Guardians\",\n    warningLevel: WarningLevel.WARNING,\n    subject: \"Discussed school change\",\n    text:\n      \"Discussed future of the child with the parents. They agree that changing school can be a good option. \" +\n      \"Will discuss further together with the child.\",\n  },\n\n  {\n    category: \"Phone Call\",\n    warningLevel: WarningLevel.OK,\n    subject: \"Follow up for school absence\",\n    text:\n      \"Called to ask for reason about absence. Mother made excuses but promised to send the child tomorrow.\",\n  },\n  {\n    category: \"Phone Call\",\n    warningLevel: WarningLevel.OK,\n    subject: \"absent because ill\",\n    text:\n      \"Mother has called in the morning. Child cannot come to class because of fever.\",\n  },\n  {\n    category: \"Phone Call\",\n    warningLevel: WarningLevel.URGENT,\n    subject: \"Absence without information\",\n    text:\n      \"Child was not in school whole last week again. When calling the mother she didn't know about it. \" +\n      \"Need to follow up urgently to discuss with the child and the guardians.\",\n  },\n\n  {\n    category: \"School/Hostel Visit\",\n    warningLevel: WarningLevel.OK,\n    subject: \"School is happy about progress\",\n    text:\n      \"Visited the school and talked to the class teacher and principal. They are happy about the progress \" +\n      \"and behaviour.\",\n  },\n  {\n    category: \"Talk with Coaching Teacher\",\n    warningLevel: WarningLevel.WARNING,\n    subject: \"Needs to work more for school\",\n    text:\n      \"Discussed the child's progress with coaching teacher. He is still a weak student and needs more support. \" +\n      \"We should consider arranging an extra class for him. Discuss next social worker meeting.\",\n  },\n\n  {\n    category: \"Incident\",\n    warningLevel: WarningLevel.URGENT,\n    subject: \"Fight at school\",\n    text:\n      \"Principal called us today. Our student got into a fight and was suspended for a week. \" +\n      \"Need to follow up with the child and discuss the matter.\",\n  },\n\n  {\n    category: \"Discussion/Decision\",\n    warningLevel: WarningLevel.OK,\n    subject: \"Special help for family\",\n    text:\n      \"Since the father has lost his job the family is struggling to survive. \" +\n      \"After home visits and discussion in our team we decided to refer them to a special support programme.\",\n  },\n  {\n    category: \"Discussion/Decision\",\n    warningLevel: WarningLevel.OK,\n    subject: \"Chance to repeat class\",\n    text:\n      \"Child has failed this school year as she did not go to school regularly. \" +\n      \"After a long discussion with the child and her parents we agreed to support her to repeat the class \" +\n      \"and she promised to attend school regularly.\",\n  },\n\n  {\n    category: \"Talk with Child\",\n    warningLevel: WarningLevel.WARNING,\n    subject: \"Distracted in class\",\n    text:\n      \"Teacher has let us know that he is very unfocused during class these days. \" +\n      \"Discussed with him - there are a lot of problems in the family currently.\",\n  },\n  {\n    category: \"Talk with Child\",\n    warningLevel: WarningLevel.WARNING,\n    subject: \"Disturbing class\",\n    text:\n      \"She refused to listen to the teacher was disturbing the class. \" +\n      \"Did counselling session with her.\",\n  },\n];\n","export const absenceRemarks = [\n  \"got excused by it's mother\",\n  \"absent without excuse\",\n  \"absent because ill\",\n  \"\",\n  \"\",\n  \"\",\n];\n","export enum InteractionTypes {\n  NONE = \"\",\n  HOME_VISIT = \"Home Visit\",\n  GUARDIAN_TALK = \"Talk with Guardians\",\n  CHILD_TALK = \"Talk with Child\",\n  INCIDENT = \"Incident\",\n  DISCUSSION = \"Discussion/Decision\",\n  VISIT = \"School/Hostel Visit\",\n  PHONE_CALL = \"Phone Call\",\n  COACHING_TALK = \"Talk with Coaching Teacher\",\n  PEER_TALK = \"Talk with Peer\",\n  NEIGHBOUR_TALK = \"Talk with Neighbours\",\n  GUARDIAN_MEETING = \"Guardians' Meeting\",\n  CHILDREN_MEETING = \"Children's Meeting\",\n  DAILY_ROUTINE = \"Daily Routine\",\n  ANNUAL_SURVEY = \"Annual Survey\",\n  EXCURSION = \"Excursion/Trip\",\n  PARTNER_CONTACT = \"Contact with other partners (club/NGO/...)\",\n  RATION_DISTRIBUTION = \"Ration Distribution\",\n}\n\nexport const INTERACTION_TYPE_COLORS: Map<InteractionTypes, string> = new Map([\n  [InteractionTypes.GUARDIAN_MEETING, \"#E1F5FE\"],\n  [InteractionTypes.CHILDREN_MEETING, \"#E1F5FE\"],\n  [InteractionTypes.RATION_DISTRIBUTION, \"#E1F5FE\"],\n  [InteractionTypes.EXCURSION, \"#E1F5FE\"],\n  [InteractionTypes.DISCUSSION, \"#E1BEE7\"],\n  [InteractionTypes.ANNUAL_SURVEY, \"#FFFDE7\"],\n  [InteractionTypes.DAILY_ROUTINE, \"#F1F8E9\"],\n]);\n","export class MeetingNoteAttendance {\n  present: boolean = true;\n  remarks: string = \"\";\n  childId: string;\n\n  constructor(childId: string, presence: boolean = true, remark: string = \"\") {\n    this.childId = childId;\n    this.present = presence;\n    this.remarks = remark;\n  }\n}\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { MeetingNoteAttendance } from \"../meeting-note-attendance\";\nimport {\n  INTERACTION_TYPE_COLORS,\n  InteractionTypes,\n} from \"../interaction-types.enum\";\nimport { DatabaseEntity } from \"../../../core/entity/database-entity.decorator\";\nimport { Entity } from \"../../../core/entity/entity\";\nimport { DatabaseField } from \"../../../core/entity/database-field.decorator\";\nimport { WarningLevel, WarningLevelColor } from \"../../warning-level\";\n\n@DatabaseEntity(\"Note\")\nexport class Note extends Entity {\n  /** IDs of Child entities linked with this note */\n  @DatabaseField() children: string[] = [];\n  /** An array of triplets containing information about the child and it's attendance */\n  @DatabaseField() attendances: MeetingNoteAttendance[] = [];\n  @DatabaseField() date: Date;\n  @DatabaseField() subject: string = \"\";\n  @DatabaseField() text: string = \"\";\n  @DatabaseField() author: string = \"\";\n  @DatabaseField() category: InteractionTypes = InteractionTypes.NONE;\n  @DatabaseField({ dataType: \"string\" }) warningLevel: WarningLevel =\n    WarningLevel.OK;\n\n  getWarningLevel(): WarningLevel {\n    return this.warningLevel;\n  }\n\n  // TODO: color logic should not be part of entity/model but rather in the component responsible for displaying it\n  public getColor() {\n    if (this.warningLevel === WarningLevel.URGENT) {\n      return WarningLevelColor(WarningLevel.URGENT);\n    }\n    if (this.warningLevel === WarningLevel.WARNING) {\n      return WarningLevelColor(WarningLevel.WARNING);\n    }\n\n    const color = INTERACTION_TYPE_COLORS.get(this.category);\n    return color === undefined ? \"\" : color;\n  }\n\n  public getColorForId(entityId: string) {\n    if (this.isMeeting() && !this.isPresent(entityId)) {\n      // child is absent, highlight the entry\n      return WarningLevelColor(WarningLevel.URGENT);\n    }\n\n    return this.getColor();\n  }\n\n  /**\n   * whether a specific child with given childId is linked to this not\n   * @param childId The childId to check for\n   */\n  isLinkedWithChild(childId: string): boolean {\n    return this.children.includes(childId);\n  }\n\n  /**\n   * whether or not this note's contents describe a meeting\n   */\n  isMeeting(): boolean {\n    return (\n      this.category === InteractionTypes.GUARDIAN_MEETING ||\n      this.category === InteractionTypes.CHILDREN_MEETING ||\n      this.category === InteractionTypes.EXCURSION ||\n      this.category === InteractionTypes.RATION_DISTRIBUTION\n    );\n  }\n\n  /**\n   * returns the children that were either present or absent\n   * @param presence true to get the children that were present, false to get the children that were absent\n   */\n  childrenWithPresence(presence: boolean): MeetingNoteAttendance[] {\n    return this.attendances.filter(\n      (attendance) => attendance.present === presence\n    );\n  }\n\n  /**\n   * whether or not a specific child was present or not.\n   * This does not check whether or not this note is a meeting and will not return\n   * a sensible value, if this child couldn't be found\n   * @param childId The id of the child to check for\n   */\n  isPresent(childId: string): boolean {\n    const child = this.attendances.find(\n      (attendance) => attendance.childId === childId\n    );\n    if (child !== undefined) {\n      return child.present;\n    }\n  }\n\n  /**\n   * removes a specific child from this note\n   * @param childId The id of the child to exclude from the notes\n   */\n  removeChild(childId: string) {\n    this.children.splice(this.children.indexOf(childId), 1);\n    this.attendances.splice(\n      this.attendances.findIndex(\n        (attendance) => attendance.childId === childId\n      ),\n      1\n    );\n  }\n\n  /**\n   * adds a new child to this note\n   * @param childId The id of the child to add to the notes\n   */\n  addChild(childId: string) {\n    this.children.splice(0, 0, childId);\n    this.attendances.splice(0, 0, new MeetingNoteAttendance(childId));\n  }\n\n  /**\n   * adds multiple children to this note\n   * @param childIds The id's of the children to add\n   */\n  addChildren(...childIds: string[]) {\n    childIds.forEach((child) => this.addChild(child));\n  }\n\n  /**\n   * Toggles for a given child it's presence.\n   * If the child was absent, the presence-field will be true for that child.\n   * If the child was present, the presence-field will be false for that child\n   * @param childId The ID of the child\n   */\n  togglePresence(childId: string) {\n    const child = this.attendances.find(\n      (attendance) => attendance.childId === childId\n    );\n    if (child !== undefined) {\n      child.present = !child.present;\n    }\n  }\n}\n","import { Component, EventEmitter, Input, Output } from \"@angular/core\";\nimport { MeetingNoteAttendance } from \"../../meeting-note-attendance\";\n\n@Component({\n  selector: \"app-child-meeting-note-attendance\",\n  templateUrl: \"./child-meeting-note-attendance.component.html\",\n  styleUrls: [\"./child-meeting-note-attendance.component.scss\"],\n})\nexport class ChildMeetingNoteAttendanceComponent {\n  @Input() noteChildAttendance: MeetingNoteAttendance;\n  @Output() change = new EventEmitter();\n  @Output() remove = new EventEmitter();\n  showRemarks: boolean = false;\n}\n","\n<div fxLayout=\"col\" fxLayoutGap=\"4px\">\n\n  <div class=\"actions\" fxFlex=\"40px\">\n    <!-- deactivated to keep the UI simple and understandable\n    <span class=\"fa fa-window-maximize\" *ngIf=\"!showRemarks\" (click)=\"showRemarks=true\"></span>\n    <span class=\"fa fa-window-minimize\" *ngIf=\"showRemarks\" (click)=\"showRemarks=false\"></span>\n    -->\n    <button mat-icon-button (click)='remove.emit()'>\n      <mat-icon fontIcon=\"fa-times\"></mat-icon>\n    </button>\n  </div>\n\n  <div fxFlex=\"125px\">\n    <mat-button-toggle-group name=\"present\" class=\"presence-toggle\"\n                             [(ngModel)]=\"noteChildAttendance.present\" (change)='change.emit(noteChildAttendance)'>\n      <mat-button-toggle [value]=\"true\" class=\"presence-toggle-button\"\n                         [ngClass]=\"{'button-present': noteChildAttendance.present}\">\n        Present\n      </mat-button-toggle>\n      <mat-button-toggle [value]=\"false\" class=\"presence-toggle-button\"\n                         [ngClass]=\"{'button-absent': !noteChildAttendance.present}\">\n        Absent\n      </mat-button-toggle>\n    </mat-button-toggle-group>\n  </div>\n\n  <app-child-block [entityId]=\"noteChildAttendance.childId\" fxFlex>\n  </app-child-block>\n</div>\n\n<!-- deactivated to keep the UI simple and understandable\n<div [ngClass]=\"{ 'hide-remarks': !showRemarks }\">\n  <mat-form-field class=\"input-max\">\n    <input matInput placeholder=\"Remarks\"\n           [(ngModel)]=\"noteChildAttendance.remarks\"\n           [ngModelOptions]=\"{standalone:true}\">\n  </mat-form-field>\n</div>\n-->\n","import { Component, Input, ViewChild } from \"@angular/core\";\nimport { InteractionTypes } from \"../interaction-types.enum\";\nimport { Note } from \"../model/note\";\nimport { ShowsEntity } from \"../../../core/form-dialog/shows-entity.interface\";\n\n@Component({\n  selector: \"app-note-details\",\n  templateUrl: \"./note-details.component.html\",\n  styleUrls: [\"./note-details.component.scss\"],\n})\nexport class NoteDetailsComponent implements ShowsEntity {\n  @Input() entity: Note;\n  @ViewChild(\"dialogForm\", { static: true }) formDialogWrapper;\n\n  smallScreen: boolean;\n\n  interactionTypes = Object.values(InteractionTypes);\n\n  constructor() {\n    this.smallScreen = window.innerWidth < 500;\n  }\n}\n","<!--\n  ~     This file is part of ndb-core.\n  ~\n  ~     ndb-core is free software: you can redistribute it and/or modify\n  ~     it under the terms of the GNU General Public License as published by\n  ~     the Free Software Foundation, either version 3 of the License, or\n  ~     (at your option) any later version.\n  ~\n  ~     ndb-core is distributed in the hope that it will be useful,\n  ~     but WITHOUT ANY WARRANTY; without even the implied warranty of\n  ~     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n  ~     GNU General Public License for more details.\n  ~\n  ~     You should have received a copy of the GNU General Public License\n  ~     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n  -->\n\n<app-form-dialog-wrapper #dialogForm [entity]=\"entity\">\n  <h1>{{ entity.date?.toLocaleDateString() }}: {{ entity.subject }}</h1>\n\n  <form #entityForm=\"ngForm\">\n    <!-- General context of Note -->\n    <div class=\"form-section-secondary\">\n      <div fxLayout=\"row wrap\" fxLayoutGap=\"20px\">\n        <div fxFlex>\n          <mat-form-field>\n            <input\n              matInput\n              placeholder=\"Date\"\n              name=\"date\"\n              [(ngModel)]=\"entity.date\"\n              [matDatepicker]=\"picker\"\n            />\n            <mat-datepicker-toggle\n              matSuffix\n              [for]=\"picker\"\n            ></mat-datepicker-toggle>\n            <mat-datepicker #picker></mat-datepicker>\n          </mat-form-field>\n        </div>\n\n        <div fxFlex>\n          <mat-form-field>\n            <mat-label>\n              Status\n            </mat-label>\n            <mat-select name=\"followup\" [(ngModel)]=\"entity.warningLevel\">\n              <mat-option value=\"OK\">Solved</mat-option>\n              <mat-option value=\"WARNING\">Needs Follow-Up</mat-option>\n              <mat-option value=\"URGENT\">Urgent Follow-Up</mat-option>\n            </mat-select>\n          </mat-form-field>\n        </div>\n      </div>\n      <div fxLayout=\"row wrap\" fxLayoutGap=\"20px\">\n        <div fxFlex>\n          <mat-form-field class=\"input-medium\">\n            <mat-select\n              placeholder=\"Type of Interaction\"\n              name=\"type\"\n              [(ngModel)]=\"entity.category\"\n            >\n              <mat-option\n                *ngFor=\"let interaction of interactionTypes\"\n                [value]=\"interaction\"\n              >\n                {{ interaction }}\n              </mat-option>\n            </mat-select>\n          </mat-form-field>\n        </div>\n        <div fxFlex>\n          <mat-form-field class=\"input-medium\">\n            <!-- TODO: should be multi-select or auto-complete field of user names? -->\n            <input\n              matInput\n              placeholder=\"Team Member\"\n              name=\"teammember\"\n              type=\"text\"\n              [(ngModel)]=\"entity.author\"\n            />\n          </mat-form-field>\n        </div>\n      </div>\n    </div>\n\n    <!-- Primary information of Note -->\n    <div class=\"mat-elevation-z2 primary-section-elevated form-section-primary\">\n      <div fxLayout=\"row wrap\" fxLayoutGap=\"20px\">\n        <div fxFlex>\n          <mat-form-field class=\"input-medium\">\n            <input\n              matInput\n              placeholder=\"Topic / Summary\"\n              name=\"subject\"\n              type=\"text\"\n              [(ngModel)]=\"entity.subject\"\n            />\n          </mat-form-field>\n        </div>\n      </div>\n\n      <div fxLayout=\"row wrap\" fxLayoutGap=\"20px\">\n        <mat-form-field class=\"input-max\">\n          <textarea\n            matInput\n            placeholder=\"Notes\"\n            name=\"notes\"\n            [(ngModel)]=\"entity.text\"\n            cdkTextareaAutosize\n            cdkAutosizeMinRows=\"4\"\n          ></textarea>\n        </mat-form-field>\n      </div>\n    </div>\n\n    <div fxLayout=\"row wrap\" fxLayoutGap=\"20px\">\n      <div fxFlex *ngIf=\"!entity.isMeeting()\">\n        <app-child-select\n          [valueAsIds]=\"entity.children\"\n          (newIdAdded)=\"entity.addChild($event); entityForm.form.markAsDirty()\"\n          (idRemoved)=\"\n            entity.removeChild($event); entityForm.form.markAsDirty()\n          \"\n          class=\"input-medium\"\n        >\n        </app-child-select>\n      </div>\n      <app-note-presence-list\n        *ngIf=\"entity.isMeeting()\"\n        [recordForm]=\"entityForm\"\n        [entity]=\"entity\"\n        fxFlex\n      >\n      </app-note-presence-list>\n    </div>\n  </form>\n</app-form-dialog-wrapper>\n","import {\n  Component,\n  Input,\n  OnChanges,\n  SimpleChanges,\n  ViewChild,\n} from \"@angular/core\";\nimport { Note } from \"../../model/note\";\nimport { NgForm } from \"@angular/forms\";\nimport { ChildSelectComponent } from \"../../../children/child-select/child-select.component\";\n\n@Component({\n  selector: \"app-note-presence-list\",\n  templateUrl: \"./note-presence-list.component.html\",\n  styleUrls: [\"./note-presence-list.component.scss\"],\n})\nexport class NotePresenceListComponent implements OnChanges {\n  @Input() entity: Note = new Note(\"\");\n  @Input() recordForm: NgForm;\n  smallScreen: boolean;\n\n  @ViewChild(\"childSelect\", { static: true })\n  childSelectComponent: ChildSelectComponent;\n\n  constructor() {\n    this.smallScreen = window.innerWidth < 500;\n    this.sortEntries();\n  }\n\n  ngOnChanges(changes: SimpleChanges) {\n    if (changes.hasOwnProperty(\"entity\")) {\n      this.sortEntries();\n    }\n  }\n\n  private sortEntries() {\n    if (!this.entity) {\n      return;\n    }\n\n    this.entity.attendances.sort((a, b) => {\n      if (a.present === b.present) {\n        return 0;\n      }\n      if (a.present) {\n        return -1;\n      }\n      return 1;\n    });\n  }\n}\n","\n<app-child-select #childSelect [valueAsIds]='entity.children'\n                  (newIdAdded)=\"entity.addChild($event); recordForm.form.markAsDirty()\"\n                  (idRemoved)=\"entity.removeChild($event); recordForm.form.markAsDirty()\"\n                  class='input-medium'>\n</app-child-select>\n\n\n<app-child-meeting-note-attendance *ngFor=\"let att of entity.attendances\"\n                         [noteChildAttendance]=\"att\"\n                         (change)='recordForm.form.markAsDirty();'\n                         (remove)='childSelectComponent.unselectChildId(att.childId)'\n                         [ngClass]=\"{'child-absent': !att.present}\">\n</app-child-meeting-note-attendance>\n","<h1>Notes &amp; Reports</h1>\n\n<mat-expansion-panel\n  expanded=\"true\"\n  fxLayout=\"column\"\n  fxLayoutGap=\"10px\"\n  class=\"filter-panel\"\n>\n  <div fxLayout=\"row\" fxLayoutGap=\"10px\" fxLayoutAlign=\"none end\">\n    <div fxFlex=\"50\">\n      <mat-form-field style=\"width: 100%;\">\n        <input\n          matInput\n          placeholder=\"Filter\"\n          (ngModelChange)=\"applyFilter($event)\"\n          [(ngModel)]=\"filterString\"\n        />\n        <button\n          mat-icon-button\n          *ngIf=\"filterString\"\n          matSuffix\n          aria-label=\"Clear\"\n          (click)=\"filterString = ''; applyFilter('')\"\n        >\n          <mat-icon fontIcon=\"fa-times\"></mat-icon>\n        </button>\n      </mat-form-field>\n    </div>\n\n    <div class=\"align-form-field\" fxHide.xs=\"true\">\n      (Showing {{ notesDataSource.filteredData.length }} Notes)\n    </div>\n\n    <div class=\"align-form-field\">\n      <button\n        mat-stroked-button\n        color=\"accent\"\n        (click)=\"addNoteClick()\"\n        angulartics2On=\"click\"\n        angularticsCategory=\"UserAction\"\n        angularticsAction=\"notes_manager_add_note\"\n      >\n        <mat-icon\n          class=\"button-icon\"\n          aria-label=\"add child\"\n          fontIcon=\"fa-plus-circle\"\n        ></mat-icon>\n        <span fxHide.lt-md=\"true\">\n          Add New\n        </span>\n      </button>\n    </div>\n  </div>\n\n  <div\n    fxLayout=\"row wrap\"\n    fxLayoutGap=\"10px\"\n    class=\"filter-button\"\n    fxHide.lt-sm\n  >\n    <mat-button-toggle-group\n      *ngFor=\"let filterSelection of filterSelections\"\n      [name]=\"filterSelection.name\"\n      [value]=\"filterSelection.selectedOption\"\n    >\n      <mat-button-toggle\n        *ngFor=\"let option of filterSelection.options\"\n        [value]=\"option.key\"\n        (click)=\"\n          filterSelection.selectedOption = option.key; applyFilterSelections()\n        \"\n      >\n        {{ option.label }}\n      </mat-button-toggle>\n    </mat-button-toggle-group>\n  </div>\n  <div fxLayout=\"row wrap\" fxHide.gt-xs>\n    <mat-form-field\n      *ngFor=\"let filterSelection of filterSelections\"\n      style=\"padding-right: 1%;\"\n    >\n      <mat-label>{{ filterSelection.name }}</mat-label>\n      <mat-select\n        [id]=\"filterSelection.name\"\n        [value]=\"filterSelection.selectedOption\"\n        placeholder=\"filterSelection.name\"\n      >\n        <mat-option\n          *ngFor=\"let option of filterSelection.options\"\n          [value]=\"option.key\"\n          (click)=\"\n            filterSelection.selectedOption = option.key; applyFilterSelections()\n          \"\n        >\n          {{ option.label }}\n        </mat-option>\n      </mat-select>\n    </mat-form-field>\n  </div>\n\n  <div fxLayout=\"row\" fxLayoutGap=\"10px\" style=\"margin-top: 20px;\">\n    <mat-form-field *ngFor=\"let filterSelection of filterSelectionsDropdown\">\n      <mat-select\n        [placeholder]=\"filterSelection.name\"\n        [value]=\"filterSelection.selectedOption\"\n      >\n        <mat-option\n          *ngFor=\"let option of filterSelection.options\"\n          [value]=\"option.key\"\n          (click)=\"\n            filterSelection.selectedOption = option.key; applyFilterSelections()\n          \"\n          >{{ option.label }}</mat-option\n        >\n      </mat-select>\n    </mat-form-field>\n  </div>\n</mat-expansion-panel>\n\n<!--<mat-divider></mat-divider>-->\n\n<div class=\"mat-elevation-z8 table-list\">\n  <table mat-table [dataSource]=\"notesDataSource\" matSort>\n    <ng-container matColumnDef=\"date\">\n      <th mat-header-cell *matHeaderCellDef mat-sort-header>Date</th>\n      <td mat-cell *matCellDef=\"let note\">\n        {{ note.date | date: \"yyyy-MM-dd\" }}\n      </td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"subject\">\n      <th mat-header-cell *matHeaderCellDef mat-sort-header>Subject</th>\n      <td mat-cell *matCellDef=\"let note\">{{ note.subject }}</td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"category\">\n      <th mat-header-cell *matHeaderCellDef mat-sort-header>Category</th>\n      <td mat-cell *matCellDef=\"let note\">{{ note.category }}</td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"author\">\n      <th mat-header-cell *matHeaderCellDef mat-sort-header>Author</th>\n      <td mat-cell *matCellDef=\"let note\">{{ note.author }}</td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"children\">\n      <th mat-header-cell *matHeaderCellDef mat-sort-header>Children</th>\n      <td mat-cell *matCellDef=\"let note\">\n        <app-child-block\n          *ngFor=\"let child of note.children\"\n          [entityId]=\"child\"\n        ></app-child-block>\n      </td>\n    </ng-container>\n\n    <tr mat-header-row *matHeaderRowDef=\"columnsToDisplay\"></tr>\n    <tr\n      mat-row\n      *matRowDef=\"let note; columns: columnsToDisplay; let i=index;\"\n      (click)=\"showDetails(note)\"\n      style=\"cursor: pointer;\"\n      [ngStyle]=\"{ 'background-color': note.getColor() }\"\n      angulartics2On=\"click\"\n      angularticsCategory=\"Navigation\"\n      angularticsAction=\"notes_manager_list_link\"\n      [angularticsLabel]=\"'list-entry-' + i\"\n    ></tr>\n  </table>\n  <mat-paginator\n    (page)=\"onPaginateChange($event)\"\n    [pageSize]=\"paginatorPageSize\"\n    [pageIndex]=\"paginatorPageIndex\"\n    [pageSizeOptions]=\"[3, 10, 20, 50]\"\n    [showFirstLastButtons]=\"true\"\n  ></mat-paginator>\n</div>\n","import { AfterViewInit, Component, OnInit, ViewChild } from \"@angular/core\";\nimport { Note } from \"../model/note\";\nimport { MatTableDataSource } from \"@angular/material/table\";\nimport { MatSort } from \"@angular/material/sort\";\nimport { MediaChange, MediaObserver } from \"@angular/flex-layout\";\nimport { NoteDetailsComponent } from \"../note-details/note-details.component\";\nimport { InteractionTypes } from \"../interaction-types.enum\";\nimport { MatPaginator, PageEvent } from \"@angular/material/paginator\";\nimport { WarningLevel } from \"../../warning-level\";\nimport { EntityMapperService } from \"../../../core/entity/entity-mapper.service\";\nimport { FilterSelection } from \"../../../core/filter/filter-selection/filter-selection\";\nimport { SessionService } from \"../../../core/session/session-service/session.service\";\nimport { FormDialogService } from \"../../../core/form-dialog/form-dialog.service\";\nimport { UntilDestroy, untilDestroyed } from \"@ngneat/until-destroy\";\nimport { User } from \"app/core/user/user\";\n\n@UntilDestroy()\n@Component({\n  selector: \"app-notes-manager\",\n  templateUrl: \"./notes-manager.component.html\",\n  styleUrls: [\"./notes-manager.component.scss\"],\n})\nexport class NotesManagerComponent implements OnInit, AfterViewInit {\n  entityList = new Array<Note>();\n  notesDataSource = new MatTableDataSource();\n\n  @ViewChild(MatSort) sort: MatSort;\n  @ViewChild(MatPaginator) paginator: MatPaginator;\n\n  columnsToDisplay = [\"date\", \"subject\", \"category\", \"author\", \"children\"];\n\n  columnGroups = {\n    standard: [\"date\", \"subject\", \"category\", \"author\", \"children\"],\n    mobile: [\"date\", \"subject\", \"children\"],\n  };\n\n  filterString = \"\";\n\n  followUpFS = new FilterSelection<Note>(\"status\", [\n    {\n      key: \"urgent\",\n      label: \"Urgent\",\n      filterFun: (n: Note) => n.warningLevel === WarningLevel.URGENT,\n    },\n    {\n      key: \"follow-up\",\n      label: \"Needs Follow-Up\",\n      filterFun: (n: Note) =>\n        n.warningLevel === WarningLevel.WARNING ||\n        n.warningLevel === WarningLevel.URGENT,\n    },\n    { key: \"\", label: \"All\", filterFun: () => true },\n  ]);\n\n  dateFS = new FilterSelection<Note>(\"date\", [\n    {\n      key: \"current-week\",\n      label: \"This Week\",\n      filterFun: (n: Note) => n.date > this.getPreviousSunday(0),\n    },\n    {\n      key: \"last-week\",\n      label: \"Since Last Week\",\n      filterFun: (n: Note) => n.date > this.getPreviousSunday(1),\n    },\n    { key: \"\", label: \"All\", filterFun: () => true },\n  ]);\n\n  filterSelections = [this.followUpFS, this.dateFS];\n\n  categoryFS = new FilterSelection<Note>(\"category\", []);\n  filterSelectionsDropdown = [this.categoryFS];\n\n  public paginatorPageSize: number;\n  public paginatorPageIndex: number;\n  private user: User;\n\n  constructor(\n    private formDialog: FormDialogService,\n    private sessionService: SessionService,\n    private media: MediaObserver,\n    private entityMapperService: EntityMapperService\n  ) {}\n\n  ngOnInit() {\n    this.user = this.sessionService.getCurrentUser();\n    this.paginatorPageSize = this.user.paginatorSettingsPageSize.notesList;\n    this.paginatorPageIndex = this.user.paginatorSettingsPageIndex.notesList;\n\n    // activate default filter to current week\n    this.dateFS.selectedOption = this.dateFS.options[0].key;\n\n    this.entityMapperService.loadType<Note>(Note).then((notes) => {\n      this.sortAndAdd(notes);\n    });\n\n    this.displayColumnGroup(\"standard\");\n    this.media.media$\n      .pipe(untilDestroyed(this))\n      .subscribe((change: MediaChange) => {\n        if (change.mqAlias === \"xs\" || change.mqAlias === \"sm\") {\n          console.log(\"smaller screen toggled\");\n          this.displayColumnGroup(\"mobile\");\n        }\n      });\n\n    this.initCategoryFilter();\n  }\n\n  onPaginateChange(event: PageEvent) {\n    this.paginatorPageSize = event.pageSize;\n    this.paginatorPageIndex = event.pageIndex;\n    this.user.paginatorSettingsPageSize.notesList = this.paginatorPageSize;\n    this.user.paginatorSettingsPageIndex.notesList = this.paginatorPageIndex;\n    this.entityMapperService.save<User>(this.user);\n  }\n\n  private sortAndAdd(newNotes: Note[]) {\n    newNotes.forEach((newNote) => {\n      this.entityList.push(newNote);\n    });\n    this.entityList.sort(\n      (a, b) =>\n        (b.date ? b.date.getTime() : 0) - (a.date ? a.date.getTime() : 0)\n    );\n    this.applyFilterSelections();\n  }\n\n  displayColumnGroup(columnGroup: string) {\n    this.columnsToDisplay = this.columnGroups[columnGroup];\n  }\n\n  private initCategoryFilter() {\n    this.categoryFS.options = [{ key: \"\", label: \"\", filterFun: () => true }];\n\n    Object.values(InteractionTypes).forEach((interaction) => {\n      this.categoryFS.options.push({\n        key: interaction,\n        label: interaction,\n        filterFun: (note: Note) => {\n          return interaction === InteractionTypes.NONE\n            ? true\n            : note.category === interaction;\n        },\n      });\n    });\n\n    this.applyFilterSelections();\n  }\n\n  ngAfterViewInit() {\n    this.notesDataSource.sort = this.sort;\n    this.notesDataSource.paginator = this.paginator;\n    setTimeout(() => {\n      this.paginator.pageIndex = this.paginatorPageIndex;\n      this.paginator.page.next({\n        pageIndex: this.paginator.pageIndex,\n        pageSize: this.paginator.pageSize,\n        length: this.paginator.length,\n      });\n    });\n  }\n\n  private getPreviousSunday(weeksBack: number) {\n    const today = new Date();\n    const day = today.getDay();\n    const diff = today.getDate() - day - 7 * weeksBack; // adjust when day is sunday\n    return new Date(today.setDate(diff));\n  }\n\n  applyFilter(filterValue: string) {\n    filterValue = filterValue.trim();\n    filterValue = filterValue.toLowerCase(); // MatTableDataSource defaults to lowercase matches\n    this.notesDataSource.filter = filterValue;\n  }\n\n  applyFilterSelections() {\n    let filteredData = this.entityList;\n\n    this.filterSelections.forEach((f) => {\n      filteredData = filteredData.filter(f.getSelectedFilterFunction());\n    });\n    this.filterSelectionsDropdown.forEach((f) => {\n      filteredData = filteredData.filter(f.getSelectedFilterFunction());\n    });\n\n    this.notesDataSource.data = filteredData;\n  }\n\n  addNoteClick() {\n    const newNote = new Note(Date.now().toString());\n    newNote.date = new Date();\n    newNote.author = this.sessionService.getCurrentUser().name;\n\n    const noteDialogRef = this.showDetails(newNote);\n    noteDialogRef.afterClosed().subscribe((val) => {\n      this.entityList = [val].concat(this.entityList);\n      this.applyFilterSelections();\n    });\n  }\n\n  showDetails(entity: Note) {\n    return this.formDialog.openDialog(NoteDetailsComponent, entity);\n  }\n}\n","import {\n  Component,\n  Input,\n  OnChanges,\n  OnInit,\n  SimpleChanges,\n} from \"@angular/core\";\nimport { Note } from \"../model/note\";\nimport { NoteDetailsComponent } from \"../note-details/note-details.component\";\nimport { DatePipe } from \"@angular/common\";\nimport { ChildrenService } from \"../../children/children.service\";\nimport moment from \"moment\";\nimport { SessionService } from \"../../../core/session/session-service/session.service\";\nimport { ColumnDescription } from \"../../../core/entity-subrecord/entity-subrecord/column-description\";\nimport { ColumnDescriptionInputType } from \"../../../core/entity-subrecord/entity-subrecord/column-description-input-type.enum\";\nimport { UntilDestroy, untilDestroyed } from \"@ngneat/until-destroy\";\n\n/**\n * The component that is responsible for listing the Notes that are related to a certain child\n */\n@UntilDestroy()\n@Component({\n  selector: \"app-notes-of-child\",\n  templateUrl: \"./notes-of-child.component.html\",\n  styleUrls: [\"./notes-of-child.component.scss\"],\n})\nexport class NotesOfChildComponent implements OnInit, OnChanges {\n  @Input() childId: string;\n  records: Array<Note> = [];\n  detailsComponent = NoteDetailsComponent;\n\n  columns: Array<ColumnDescription> = [\n    new ColumnDescription(\n      \"date\",\n      \"Date\",\n      ColumnDescriptionInputType.DATE,\n      null,\n      (v: Date) => this.datePipe.transform(v, \"yyyy-MM-dd\"),\n      \"xs\"\n    ),\n    new ColumnDescription(\n      \"subject\",\n      \"Topic\",\n      ColumnDescriptionInputType.TEXT,\n      null,\n      undefined,\n      \"xs\"\n    ),\n    new ColumnDescription(\n      \"text\",\n      \"Notes\",\n      ColumnDescriptionInputType.TEXTAREA,\n      null,\n      undefined,\n      \"md\"\n    ),\n    new ColumnDescription(\n      \"author\",\n      \"SW\",\n      ColumnDescriptionInputType.TEXT,\n      null,\n      undefined,\n      \"md\"\n    ),\n    new ColumnDescription(\n      \"warningLevel\",\n      \"\",\n      ColumnDescriptionInputType.SELECT,\n      [\n        { value: \"OK\", label: \"Solved\" },\n        { value: \"WARNING\", label: \"Needs Follow-Up\" },\n        { value: \"URGENT\", label: \"Urgent Follow-Up\" },\n      ],\n      () => \"\",\n      \"md\"\n    ),\n  ];\n\n  constructor(\n    private childrenService: ChildrenService,\n    private sessionService: SessionService,\n    private datePipe: DatePipe\n  ) {}\n\n  ngOnInit() {\n    this.initNotesOfChild();\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    if (changes.hasOwnProperty(\"childId\")) {\n      this.initNotesOfChild();\n    }\n  }\n\n  private initNotesOfChild() {\n    if (!this.childId || this.childId === \"\") {\n      return;\n    }\n\n    this.childrenService\n      .getNotesOfChild(this.childId)\n      .pipe(untilDestroyed(this))\n      .subscribe((notes: Note[]) => {\n        notes.sort((a, b) => {\n          if (!a.date && b.date) {\n            // note without date should be first\n            return -1;\n          }\n          return moment(b.date).valueOf() - moment(a.date).valueOf();\n        });\n        this.records = notes;\n      });\n  }\n\n  generateNewRecordFactory() {\n    // define values locally because \"this\" is a different scope after passing a function as input to another component\n    const user = this.sessionService.getCurrentUser()\n      ? this.sessionService.getCurrentUser().name\n      : \"\";\n    const childId = this.childId;\n\n    return () => {\n      const newNote = new Note(Date.now().toString());\n      newNote.date = new Date();\n      newNote.addChild(childId);\n      newNote.author = user;\n\n      return newNote;\n    };\n  }\n}\n","<app-entity-subrecord [records]=\"records\"\n                      [columns]=\"columns\"\n                      [newRecordFactory]=\"generateNewRecordFactory()\"\n                      [detailsComponent]=\"detailsComponent\"\n                      [entityId]=\"childId\">\n</app-entity-subrecord>\n","import { NgModule } from \"@angular/core\";\nimport { CommonModule } from \"@angular/common\";\nimport { NoteDetailsComponent } from \"./note-details/note-details.component\";\nimport { FormsModule, ReactiveFormsModule } from \"@angular/forms\";\nimport { MatDialogModule } from \"@angular/material/dialog\";\nimport { MatSelectModule } from \"@angular/material/select\";\nimport { NotesManagerComponent } from \"./notes-manager/notes-manager.component\";\nimport { MatIconModule } from \"@angular/material/icon\";\nimport { MatExpansionModule } from \"@angular/material/expansion\";\nimport { MatButtonToggleModule } from \"@angular/material/button-toggle\";\nimport { MatTableModule } from \"@angular/material/table\";\nimport { FlexLayoutModule } from \"@angular/flex-layout\";\nimport { RouterModule } from \"@angular/router\";\nimport { MatFormFieldModule } from \"@angular/material/form-field\";\nimport { MatInputModule } from \"@angular/material/input\";\nimport { MatCheckboxModule } from \"@angular/material/checkbox\";\nimport { MatDatepickerModule } from \"@angular/material/datepicker\";\nimport { MatSortModule } from \"@angular/material/sort\";\nimport { MatSidenavModule } from \"@angular/material/sidenav\";\nimport { MatButtonModule } from \"@angular/material/button\";\nimport { MatCardModule } from \"@angular/material/card\";\nimport { MatSnackBarModule } from \"@angular/material/snack-bar\";\nimport { MatProgressBarModule } from \"@angular/material/progress-bar\";\nimport { MatAutocompleteModule } from \"@angular/material/autocomplete\";\nimport { MatTooltipModule } from \"@angular/material/tooltip\";\nimport { BrowserAnimationsModule } from \"@angular/platform-browser/animations\";\nimport { FilterPipeModule } from \"ngx-filter-pipe\";\nimport { SchoolsModule } from \"../schools/schools.module\";\nimport { MatListModule } from \"@angular/material/list\";\nimport { ChildrenModule } from \"../children/children.module\";\nimport { DragDropModule } from \"@angular/cdk/drag-drop\";\nimport { MatTreeModule } from \"@angular/material/tree\";\nimport { ChildMeetingNoteAttendanceComponent } from \"./note-details/child-meeting-attendance/child-meeting-note-attendance.component\";\nimport { MatTabsModule } from \"@angular/material/tabs\";\nimport { MatPaginatorModule } from \"@angular/material/paginator\";\nimport { NotePresenceListComponent } from \"./note-details/note-presence-list/note-presence-list.component\";\nimport { EntitySubrecordModule } from \"../../core/entity-subrecord/entity-subrecord.module\";\nimport { ConfirmationDialogModule } from \"../../core/confirmation-dialog/confirmation-dialog.module\";\nimport { FormDialogModule } from \"../../core/form-dialog/form-dialog.module\";\nimport { Angulartics2Module } from \"angulartics2\";\n\n@NgModule({\n  declarations: [\n    NoteDetailsComponent,\n    NotesManagerComponent,\n    ChildMeetingNoteAttendanceComponent,\n    NotePresenceListComponent,\n  ],\n  imports: [\n    CommonModule,\n    FormsModule,\n    EntitySubrecordModule,\n    ConfirmationDialogModule,\n    FlexLayoutModule,\n    RouterModule,\n    MatFormFieldModule,\n    MatInputModule,\n    MatCheckboxModule,\n    MatSelectModule,\n    MatDatepickerModule,\n    MatExpansionModule,\n    MatTableModule,\n    MatSortModule,\n    MatSidenavModule,\n    MatButtonModule,\n    MatButtonToggleModule,\n    MatIconModule,\n    MatCardModule,\n    MatSnackBarModule,\n    MatDialogModule,\n    MatProgressBarModule,\n    MatAutocompleteModule,\n    MatTooltipModule,\n    MatTabsModule,\n    BrowserAnimationsModule,\n    ReactiveFormsModule,\n    FilterPipeModule,\n    SchoolsModule,\n    ReactiveFormsModule,\n    MatDialogModule,\n    MatListModule,\n    ChildrenModule,\n    DragDropModule,\n    MatTreeModule,\n    MatTabsModule,\n    MatPaginatorModule,\n    FormDialogModule,\n    Angulartics2Module,\n  ],\n  providers: [],\n})\nexport class NotesModule {}\n","import {\n  Component,\n  EventEmitter,\n  Input,\n  OnChanges,\n  OnInit,\n  Output,\n  SimpleChanges,\n} from \"@angular/core\";\nimport { DatePipe } from \"@angular/common\";\nimport { ChildSchoolRelation } from \"../children/model/childSchoolRelation\";\nimport { ChildrenService } from \"../children/children.service\";\nimport { SchoolsService } from \"../schools/schools.service\";\nimport * as uniqid from \"uniqid\";\nimport { ColumnDescription } from \"../../core/entity-subrecord/entity-subrecord/column-description\";\nimport { ColumnDescriptionInputType } from \"../../core/entity-subrecord/entity-subrecord/column-description-input-type.enum\";\nimport moment from \"moment\";\nimport { isValidDate } from \"../../utils/utils\";\n\n@Component({\n  selector: \"app-previous-schools\",\n  templateUrl: \"./previous-schools.component.html\",\n})\nexport class PreviousSchoolsComponent implements OnInit, OnChanges {\n  /**\n   * returns a css-compatible color value from green to red using the given\n   * input value\n   * @param percent The percentage from 0-100 (both inclusive). 0 will be completely red, 100 will be completely green\n   * Everything between will have suitable colors (orange, yellow,...)\n   * If the color is NaN, the color will be a light grey\n   */\n  private static fromPercent(percent: number): string {\n    if (Number.isNaN(percent)) {\n      return \"rgba(130,130,130,0.4)\";\n    }\n    // the hsv color-value is to be between 0 (red) and 120 (green)\n    // percent is between 0-100, so we have to normalize it first\n    const color = (percent / 100) * 120;\n    return \"hsl(\" + color + \", 100%, 85%)\";\n  }\n\n  @Input() childId: string;\n  @Output() changedRecordInEntitySubrecord = new EventEmitter<any>();\n  records = new Array<ChildSchoolRelation>();\n  columns = new Array<ColumnDescription>();\n\n  constructor(\n    private childrenService: ChildrenService,\n    private schoolsService: SchoolsService,\n    private datePipe: DatePipe\n  ) {}\n\n  ngOnInit() {\n    this.initColumnDefinitions();\n  }\n\n  ngOnChanges(changes: SimpleChanges) {\n    if (changes.hasOwnProperty(\"childId\")) {\n      this.loadData(this.childId);\n    }\n  }\n\n  async loadData(id: string) {\n    if (!this.childId || this.childId === \"\") {\n      return;\n    }\n\n    this.records = await this.childrenService.getSchoolsWithRelations(id);\n  }\n\n  private async initColumnDefinitions() {\n    const schools = await this.schoolsService.getSchools().toPromise();\n    const schoolMap = {};\n    schools.forEach((s) => (schoolMap[s.getId()] = s.name));\n\n    this.columns = [\n      new ColumnDescription(\n        \"schoolId\",\n        \"School\",\n        ColumnDescriptionInputType.SELECT,\n        schools.map((t) => {\n          return { value: t.getId(), label: t.name };\n        }),\n        (schoolId) => schoolMap[schoolId]\n      ),\n\n      new ColumnDescription(\n        \"schoolClass\",\n        \"Class\",\n        ColumnDescriptionInputType.NUMBER\n      ),\n\n      new ColumnDescription(\n        \"start\",\n        \"From\",\n        ColumnDescriptionInputType.DATE,\n        null,\n        (v: Date) =>\n          isValidDate(v) ? this.datePipe.transform(v, \"yyyy-MM-dd\") : \"\"\n      ),\n\n      new ColumnDescription(\n        \"end\",\n        \"To\",\n        ColumnDescriptionInputType.DATE,\n        null,\n        (v: Date) =>\n          isValidDate(v) ? this.datePipe.transform(v, \"yyyy-MM-dd\") : \"\"\n      ),\n\n      new ColumnDescription(\n        \"result\",\n        \"Result\",\n        ColumnDescriptionInputType.NUMBER,\n        null,\n        (n: number) => (n >= 0 && !Number.isNaN(n) ? n + \"%\" : \"N/A\"),\n        null,\n        this.resultColorStyleBuilder\n      ),\n    ];\n  }\n\n  generateNewRecordFactory() {\n    const childId = this.childId;\n    return () => {\n      const newPreviousSchool = new ChildSchoolRelation(uniqid());\n      newPreviousSchool.childId = childId;\n      // last to-date (of first entry in records); if the first entry doesn't have any to-date, lastToDate is set to yesterday\n      const lastToDate =\n        this.records.length && this.records[0].end\n          ? new Date(this.records[0].end)\n          : new Date(new Date().setDate(new Date().getDate() + -1));\n      newPreviousSchool.start = new Date(\n        lastToDate.setDate(lastToDate.getDate() + 1)\n      ); // one day after last to-date\n      newPreviousSchool.end = null; // void date\n      newPreviousSchool.result = Number.NaN; // NaN represents no data available\n      return newPreviousSchool;\n    };\n  }\n\n  formValidation = (record) => {\n    const validationResult = {\n      hasPassedValidation: false,\n      validationMessage: \"\",\n    };\n    if (!record.schoolId) {\n      validationResult.validationMessage =\n        '\"Name\" is empty. Please select a school.';\n    } else if (moment(record.start).isAfter(record.end, \"days\")) {\n      validationResult.validationMessage =\n        '\"To\"-date lies before \"From\"-date. Please enter correct dates.';\n    } else if (record.result > 100) {\n      validationResult.validationMessage = \"Result cannot be greater than 100\";\n    } else if (record.result < 0) {\n      validationResult.validationMessage = \"Result cannot be smaller than 0\";\n    } else {\n      validationResult.hasPassedValidation = true;\n    }\n    return validationResult;\n  };\n\n  resultColorStyleBuilder(value: number) {\n    return {\n      \"background-color\": PreviousSchoolsComponent.fromPercent(value),\n      \"border-radius\": \"5%\",\n      padding: \"5px\",\n      width: \"min-content\",\n    };\n  }\n}\n","<app-entity-subrecord\n  (changedRecordsInEntitySubrecordEvent)=\"changedRecordInEntitySubrecord.emit()\"\n  [records]=\"records\"\n  [columns]=\"columns\"\n  [newRecordFactory]=\"generateNewRecordFactory()\"\n  [formValidation]=\"formValidation\">\n</app-entity-subrecord>\n","import { faker } from \"../../core/demo-data/faker\";\nimport { School } from \"./model/school\";\nimport { Injectable } from \"@angular/core\";\nimport { DemoDataGenerator } from \"../../core/demo-data/demo-data-generator\";\n\nexport class DemoSchoolConfig {\n  count: number;\n}\n\n@Injectable()\nexport class DemoSchoolGenerator extends DemoDataGenerator<School> {\n  /**\n   * This function returns a provider object to be used in an Angular Module configuration:\n   *   `providers: [DemoSchoolGenerator.provider({count: 10})]`\n   * @param config A config object specifying the number of entities the service should generate.\n   */\n  static provider(config: DemoSchoolConfig) {\n    return [\n      { provide: DemoSchoolGenerator, useClass: DemoSchoolGenerator },\n      { provide: DemoSchoolConfig, useValue: config },\n    ];\n  }\n\n  constructor(public config: DemoSchoolConfig) {\n    super();\n  }\n\n  generateEntities(): School[] {\n    const data = [];\n\n    for (let i = 1; i <= this.config.count; i++) {\n      const school = new School(String(i));\n      school.medium = faker.random.arrayElement([\n        \"Hindi\",\n        \"English\",\n        \"Bengali\",\n      ]);\n      school.name =\n        faker.name.firstName() +\n        \" \" +\n        faker.random.arrayElement([\n          \"School\",\n          \"High School\",\n          school.medium + \" Medium\",\n        ]);\n      school.address = faker.address.streetAddress();\n      school.phone = faker.phone.phoneNumberFormat();\n      school.privateSchool = faker.random.boolean();\n      school.upToClass = faker.random.arrayElement([8, 10, 12]);\n      school.academicBoard = faker.random.arrayElement([\n        \"CBSE\",\n        \"ICSE\",\n        \"WBBSE\",\n      ]);\n      school.timing = faker.random.arrayElement([\n        \"6 a.m. - 11 a.m.\",\n        \"11 a.m. - 4 p.m.\",\n        \"6:30-11:00 and 11:30-16:00\",\n      ]);\n      school.workingDays = faker.random.arrayElement([\n        \"Mon - Fri\",\n        \"Mon - Fri\",\n        \"Mon - Sat\",\n      ]);\n\n      data.push(school);\n    }\n    return data;\n  }\n}\n","import { Entity } from \"../../../core/entity/entity\";\nimport { DatabaseEntity } from \"../../../core/entity/database-entity.decorator\";\nimport { DatabaseField } from \"../../../core/entity/database-field.decorator\";\n\n@DatabaseEntity(\"School\")\nexport class School extends Entity {\n  @DatabaseField() name: string = \"\";\n  @DatabaseField() address: string = \"\";\n  @DatabaseField() medium: string = \"\";\n  @DatabaseField() remarks: string = \"\";\n  @DatabaseField() website: string = \"\";\n  @DatabaseField() privateSchool: boolean;\n  @DatabaseField() phone: string = \"\";\n  @DatabaseField() upToClass: number;\n  @DatabaseField() academicBoard: string = \"\";\n  @DatabaseField() timing: string = \"\";\n  @DatabaseField() workingDays: string = \"\";\n\n  public toString() {\n    return this.name;\n  }\n}\n","<span (mouseenter)=\"showTooltip()\" (mouseleave)=\"hideTooltip()\">\n  <mat-icon class=\"school-pic\" fontIcon=\"fa-university\"></mat-icon> {{entity?.name}} <span style=\"font-size: x-small\">({{entity?.getId()}})</span>\n</span>\n\n<div style=\"position:absolute;\" *ngIf=\"tooltip\">\n  <div class=\"mat-elevation-z5 school-tooltip\" (mouseenter)=\"showTooltip()\" (mouseleave)=\"hideTooltip()\">\n    <div>{{entity?.medium}}</div>\n  </div>\n</div>\n","import {\n  Component,\n  HostListener,\n  Input,\n  OnChanges,\n  SimpleChanges,\n} from \"@angular/core\";\nimport { Router } from \"@angular/router\";\nimport { EntityMapperService } from \"../../../core/entity/entity-mapper.service\";\nimport { School } from \"../model/school\";\n\n@Component({\n  selector: \"app-school-block\",\n  templateUrl: \"./school-block.component.html\",\n  styleUrls: [\"./school-block.component.scss\"],\n})\nexport class SchoolBlockComponent implements OnChanges {\n  @Input() entity: School = new School(\"\");\n  @Input() entityId: string;\n  @Input() linkDisabled: boolean;\n  tooltip = false;\n  tooltipTimeout;\n\n  constructor(\n    private router: Router,\n    private entityMapper: EntityMapperService\n  ) {}\n\n  ngOnChanges(changes: SimpleChanges) {\n    if (changes.hasOwnProperty(\"entityId\")) {\n      this.initFromEntityId();\n    }\n  }\n\n  private async initFromEntityId() {\n    if (!this.entityId) {\n      return;\n    }\n    this.entity = await this.entityMapper.load(School, this.entityId);\n  }\n\n  showTooltip() {\n    this.tooltip = true;\n    if (this.tooltipTimeout) {\n      clearTimeout(this.tooltipTimeout);\n    }\n  }\n  hideTooltip() {\n    this.tooltipTimeout = setTimeout(() => (this.tooltip = false), 250);\n  }\n\n  @HostListener(\"click\") onClick() {\n    this.showDetailsPage();\n  }\n\n  showDetailsPage() {\n    if (!this.linkDisabled) {\n      this.router.navigate([\"/school\", this.entity.getId()]);\n    }\n  }\n}\n","<div fxLayout=\"row\" fxLayoutAlign=\"space-between\">\n  <h1 class=\"page-header section-school\">\n    <button\n      mat-icon-button\n      (click)=\"navigateBack()\"\n      matTooltip=\"Back\"\n      style=\"vertical-align: middle;\"\n    >\n      <mat-icon fontIcon=\"fa-backward\"></mat-icon>\n    </button>\n\n    <i class=\"fa fa-university fa-fw\"></i>\n    <span *ngIf=\"!creatingNew\">{{ school.name }}</span>\n    <span *ngIf=\"creatingNew\">Adding new School</span>\n  </h1>\n\n  <div>\n    <button\n      *ngIf=\"creatingNew || editing\"\n      mat-stroked-button\n      class=\"edit-button\"\n      (click)=\"saveSchool()\"\n      angulartics2On=\"click\"\n      angularticsCategory=\"UserAction\"\n      [angularticsAction]=\"creatingNew ? 'create_school_save' : 'school_details_save'\"\n    >\n      Save\n    </button>\n\n    <button\n      *ngIf=\"!creatingNew && editing\"\n      mat-stroked-button\n      class=\"edit-button\"\n      style=\"color: red;\"\n      (click)=\"removeSchool()\"\n      angulartics2On=\"click\"\n      angularticsCategory=\"UserAction\"\n      angularticsAction=\"school_details_remove\"\n    >\n      Delete\n    </button>\n\n    <button\n      *ngIf=\"creatingNew || editing\"\n      mat-stroked-button\n      class=\"edit-button\"\n      (click)=\"switchEdit()\"\n      angulartics2On=\"click\"\n      angularticsCategory=\"UserAction\"\n      angularticsAction=\"school_details_cancel\"\n    >\n      Cancel\n    </button>\n\n    <button\n      *ngIf=\"!editing\"\n      mat-stroked-button\n      class=\"edit-button\"\n      (click)=\"switchEdit()\"\n      angulartics2On=\"click\"\n      angularticsCategory=\"UserAction\"\n      angularticsAction=\"school_details_edit\"\n    >\n      Edit\n    </button>\n  </div>\n</div>\n\n<form [formGroup]=\"form\">\n  <mat-expansion-panel hideToggle=\"true\" expanded=\"true\">\n    <mat-expansion-panel-header>\n      <mat-panel-title> </mat-panel-title>\n    </mat-expansion-panel-header>\n    <div>\n      <mat-form-field style=\"width: 300px;\">\n        <input matInput formControlName=\"name\" placeholder=\"Name\" type=\"text\" />\n      </mat-form-field>\n\n      <mat-form-field style=\"width: 100px;\">\n        <input\n          matInput\n          formControlName=\"medium\"\n          placeholder=\"Medium\"\n          type=\"text\"\n        />\n      </mat-form-field>\n\n      <mat-checkbox formControlName=\"privateSchool\" [disabled]=\"!editing\"\n        >Private school</mat-checkbox\n      >\n\n      <mat-form-field style=\"width: 100px;\">\n        <input\n          matInput\n          formControlName=\"academicBoard\"\n          placeholder=\"Board\"\n          type=\"text\"\n        />\n      </mat-form-field>\n    </div>\n\n    <div>\n      <mat-form-field>\n        <input\n          matInput\n          formControlName=\"phone\"\n          placeholder=\"Contact Number\"\n          type=\"text\"\n        />\n      </mat-form-field>\n\n      <mat-form-field>\n        <input\n          matInput\n          formControlName=\"address\"\n          placeholder=\"Address\"\n          type=\"text\"\n        />\n      </mat-form-field>\n\n      <mat-form-field>\n        <input\n          formControlName=\"website\"\n          matInput\n          placeholder=\"Website\"\n          type=\"text\"\n        />\n      </mat-form-field>\n    </div>\n\n    <div>\n      <mat-form-field>\n        <input\n          matInput\n          formControlName=\"timing\"\n          placeholder=\"School Timing\"\n          type=\"text\"\n        />\n      </mat-form-field>\n\n      <mat-form-field>\n        <input\n          matInput\n          formControlName=\"workingDays\"\n          placeholder=\"Working Days\"\n          type=\"text\"\n        />\n      </mat-form-field>\n\n      <mat-form-field>\n        <input\n          matInput\n          formControlName=\"upToClass\"\n          placeholder=\"Teaching up to class\"\n          type=\"text\"\n        />\n      </mat-form-field>\n    </div>\n\n    <div>\n      <mat-form-field style=\"width: 100%;\">\n        <textarea\n          matInput\n          formControlName=\"remarks\"\n          placeholder=\"Remarks\"\n        ></textarea>\n      </mat-form-field>\n    </div>\n  </mat-expansion-panel>\n\n  <mat-expansion-panel hideToggle=\"false\" expanded=\"true\">\n    <mat-expansion-panel-header>\n      <mat-panel-title>\n        Students\n      </mat-panel-title>\n    </mat-expansion-panel-header>\n    <div class=\"example-container mat-elevation-z8\">\n      <table\n        mat-table\n        #table\n        [dataSource]=\"studentDataSource\"\n        matSort\n        style=\"width: 100%;\"\n      >\n        <ng-container matColumnDef=\"id\">\n          <mat-header-cell *matHeaderCellDef mat-sort-header>\n            PN\n          </mat-header-cell>\n          <mat-cell *matCellDef=\"let student\">\n            {{ student.projectNumber }}\n          </mat-cell>\n        </ng-container>\n\n        <ng-container matColumnDef=\"name\">\n          <mat-header-cell *matHeaderCellDef mat-sort-header>\n            Name\n          </mat-header-cell>\n          <mat-cell *matCellDef=\"let student\"> {{ student.name }} </mat-cell>\n        </ng-container>\n\n        <ng-container matColumnDef=\"schoolClass\">\n          <mat-header-cell *matHeaderCellDef mat-sort-header>\n            Class\n          </mat-header-cell>\n          <mat-cell *matCellDef=\"let student\">\n            {{ student.schoolClass }}\n          </mat-cell>\n        </ng-container>\n\n        <ng-container matColumnDef=\"age\">\n          <mat-header-cell *matHeaderCellDef mat-sort-header>\n            Age\n          </mat-header-cell>\n          <mat-cell *matCellDef=\"let student\"> {{ student.age }} </mat-cell>\n        </ng-container>\n\n        <mat-header-row *matHeaderRowDef=\"displayedColumns\"></mat-header-row>\n        <mat-row\n          *matRowDef=\"let row; columns: displayedColumns\"\n          [routerLink]=\"['/child', row.getId()]\"\n          style=\"cursor: pointer;\"\n        ></mat-row>\n      </table>\n    </div>\n  </mat-expansion-panel>\n</form>\n","import { Component, Inject, OnInit } from \"@angular/core\";\nimport { ActivatedRoute, Router } from \"@angular/router\";\nimport { School } from \"../model/school\";\nimport { SchoolsService } from \"../schools.service\";\nimport { EntityMapperService } from \"../../../core/entity/entity-mapper.service\";\nimport { FormBuilder, FormGroup } from \"@angular/forms\";\nimport * as uniqid from \"uniqid\";\nimport { AlertService } from \"../../../core/alerts/alert.service\";\nimport { MatSnackBar } from \"@angular/material/snack-bar\";\nimport { MatTableDataSource } from \"@angular/material/table\";\nimport { ConfirmationDialogService } from \"../../../core/confirmation-dialog/confirmation-dialog.service\";\nimport { Location } from \"@angular/common\";\nimport { Child } from \"../../children/model/child\";\n@Component({\n  selector: \"app-school-details\",\n  templateUrl: \"./school-details.component.html\",\n  styleUrls: [\"./school-details.component.scss\"],\n})\nexport class SchoolDetailsComponent implements OnInit {\n  school = new School(\"\");\n\n  studentDataSource: MatTableDataSource<Child> = new MatTableDataSource();\n  displayedColumns = [\"id\", \"name\", \"schoolClass\", \"age\"];\n\n  form: FormGroup;\n  creatingNew = false;\n  editing = false;\n\n  constructor(\n    private route: ActivatedRoute,\n    private router: Router,\n    private location: Location,\n    @Inject(FormBuilder) public fb: FormBuilder,\n    private entityMapperService: EntityMapperService,\n    private alertService: AlertService,\n    private snackBar: MatSnackBar,\n    private confirmationDialog: ConfirmationDialogService,\n    private schoolService: SchoolsService\n  ) {\n    this.initializeForm();\n  }\n\n  initializeForm() {\n    this.form = this.fb.group({\n      name: [{ value: this.school.name, disabled: !this.editing }],\n      address: [{ value: this.school.address, disabled: !this.editing }],\n      phone: [{ value: this.school.phone, disabled: !this.editing }],\n      medium: [{ value: this.school.medium, disabled: !this.editing }],\n      timing: [{ value: this.school.timing, disabled: !this.editing }],\n      upToClass: [{ value: this.school.upToClass, disabled: !this.editing }],\n      remarks: [{ value: this.school.remarks, disabled: !this.editing }],\n      academicBoard: [\n        { value: this.school.academicBoard, disabled: !this.editing },\n      ],\n      workingDays: [\n        { value: this.school.workingDays, disabled: !this.editing },\n      ],\n      website: [{ value: this.school.website, disabled: !this.editing }],\n      privateSchool: [\n        { value: this.school.privateSchool, disabled: !this.editing },\n      ],\n    });\n  }\n\n  ngOnInit() {\n    this.route.paramMap.subscribe((paramMap) => {\n      this.loadSchool(paramMap.get(\"id\"));\n    });\n  }\n\n  switchEdit() {\n    this.editing = !this.editing;\n    this.initializeForm();\n  }\n\n  async loadSchool(id: string) {\n    if (id === \"new\") {\n      this.creatingNew = true;\n      this.editing = true;\n      this.school = new School(uniqid());\n    } else {\n      this.studentDataSource.data = [];\n      this.school = await this.entityMapperService.load<School>(School, id);\n    }\n    this.initializeForm();\n    await this.loadStudents();\n  }\n\n  async loadStudents() {\n    this.studentDataSource.data = await this.schoolService.getChildrenForSchool(\n      this.school.getId()\n    );\n  }\n\n  removeSchool() {\n    const dialogRef = this.confirmationDialog.openDialog(\n      \"Delete?\",\n      \"Are you sure you want to delete this School?\"\n    );\n\n    dialogRef.afterClosed().subscribe(async (confirmed) => {\n      if (confirmed) {\n        await this.entityMapperService.remove<School>(this.school);\n\n        await this.router.navigate([\"/school\"]);\n\n        const snackBarRef = this.snackBar.open(\n          'Deleted School \"' + this.school.name + '\"',\n          \"Undo\",\n          { duration: 8000 }\n        );\n        snackBarRef.onAction().subscribe(() => {\n          this.entityMapperService.save(this.school, true);\n          this.router.navigate([\"/school\", this.school.getId()]);\n        });\n      }\n    });\n  }\n\n  saveSchool() {\n    this.assignFormValuesToSchool(this.school, this.form);\n\n    this.entityMapperService\n      .save<School>(this.school)\n      .then(() => {\n        if (this.creatingNew) {\n          this.router.navigate([\"/school\", this.school.getId()]);\n          this.creatingNew = false;\n        }\n        this.switchEdit();\n      })\n      .catch((err) =>\n        this.alertService.addDanger(\n          'Could not save School \"' + this.school.name + '\": ' + err\n        )\n      );\n  }\n\n  private assignFormValuesToSchool(school: School, form: FormGroup) {\n    Object.keys(form.controls).forEach((key) => {\n      school[key] = form.get(key).value;\n    });\n  }\n\n  navigateBack() {\n    this.location.back();\n  }\n}\n","<h1>Schools List</h1>\n\n<mat-expansion-panel\n  expanded=\"true\"\n  fxLayout=\"column wrap\"\n  fxLayoutGap=\"10px\"\n  class=\"filter-panel\"\n>\n  <div fxLayout=\"row\" fxLayoutGap=\"10px\" fxLayoutAlign=\"none end\">\n    <div fxFlex=\"50\">\n      <mat-form-field style=\"width: 100%;\">\n        <input\n          matInput\n          placeholder=\"Filter\"\n          (ngModelChange)=\"applyFilter($event)\"\n          [(ngModel)]=\"filterString\"\n        />\n        <button\n          mat-icon-button\n          *ngIf=\"filterString\"\n          matSuffix\n          aria-label=\"Clear\"\n          (click)=\"filterString = ''; applyFilter('')\"\n        >\n          <mat-icon fontIcon=\"fa-times\"></mat-icon>\n        </button>\n      </mat-form-field>\n    </div>\n\n    <div fxFlex=\"25\" class=\"align-form-field\" fxHide.xs=\"true\">\n      (Showing {{ schoolDataSource.filteredData.length }} schools)\n    </div>\n\n    <div fxFlex=\"25\" class=\"align-form-field\">\n      <button\n        mat-stroked-button\n        color=\"accent\"\n        (click)=\"addSchoolClick()\"\n        fxFlexAlign=\"end\"\n        angulartics2On=\"click\"\n        angularticsCategory=\"UserAction\"\n        angularticsAction=\"school_list_add_school\"\n      >\n        <mat-icon\n          class=\"button-icon\"\n          aria-label=\"add child\"\n          fontIcon=\"fa-plus-circle\"\n        ></mat-icon>\n        <span fxHide.lt-sm>\n          <span fxHide.lt-md=\"true\">\n            Add New\n          </span>\n        </span>\n      </button>\n    </div>\n  </div>\n\n  <div fxLayout=\"row wrap\" fxLayoutGap=\"10px\" fxHide.lt-sm>\n    <mat-button-toggle-group\n      *ngFor=\"let filterSelection of filterSelections\"\n      [name]=\"filterSelection.name\"\n      [value]=\"filterSelection.selectedOption\"\n    >\n      <mat-button-toggle\n        *ngFor=\"let option of filterSelection.options\"\n        [value]=\"option.key\"\n        (click)=\"\n          filterSelection.selectedOption = option.key; applyFilterSelections()\n        \"\n      >\n        {{ option.label }}\n      </mat-button-toggle>\n    </mat-button-toggle-group>\n  </div>\n  <div fxLayout=\"row wrap\" fxHide.gt-xs>\n    <mat-form-field\n      *ngFor=\"let filterSelection of filterSelections\"\n      style=\"padding-right: 1%;\"\n    >\n      <mat-label>{{ filterSelection.name }}</mat-label>\n      <mat-select\n        [id]=\"filterSelection.name\"\n        [value]=\"filterSelection.selectedOption\"\n        placeholder=\"filterSelection.name\"\n      >\n        <mat-option\n          *ngFor=\"let option of filterSelection.options\"\n          [value]=\"option.key\"\n          (click)=\"\n            filterSelection.selectedOption = option.key; applyFilterSelections()\n          \"\n        >\n          {{ option.label }}\n        </mat-option>\n      </mat-select>\n    </mat-form-field>\n  </div>\n</mat-expansion-panel>\n\n<!--<mat-divider></mat-divider>-->\n\n<div *ngIf=\"schoolDataSource\" class=\"mat-elevation-z8 table-list\">\n  <table mat-table [dataSource]=\"schoolDataSource\" matSort width=\"100%\">\n    <ng-container matColumnDef=\"name\">\n      <th mat-header-cell *matHeaderCellDef mat-sort-header>Name</th>\n      <td mat-cell *matCellDef=\"let school\">{{ school.name }}</td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"medium\">\n      <th mat-header-cell *matHeaderCellDef mat-sort-header>Medium</th>\n      <td mat-cell *matCellDef=\"let school\">{{ school.medium }}</td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"privateSchool\">\n      <th mat-header-cell *matHeaderCellDef mat-sort-header>Private School</th>\n      <td mat-cell *matCellDef=\"let school\">\n        {{ school.privateSchool ? \"\" : \"\" }}\n      </td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"academicBoard\">\n      <th mat-header-cell *matHeaderCellDef mat-sort-header>Board</th>\n      <td mat-cell *matCellDef=\"let school\">{{ school.academicBoard }}</td>\n    </ng-container>\n\n    <ng-container matColumnDef=\"upToClass\">\n      <th mat-header-cell *matHeaderCellDef mat-sort-header>Up to class</th>\n      <td mat-cell *matCellDef=\"let school\">{{ school.upToClass }}</td>\n    </ng-container>\n\n    <tr mat-header-row *matHeaderRowDef=\"columnsToDisplay\"></tr>\n    <tr\n      mat-row\n      *matRowDef=\"let school; columns: columnsToDisplay\"\n      (click)=\"showSchoolDetails(school)\"\n      style=\"cursor: pointer;\"\n    ></tr>\n  </table>\n  <mat-paginator\n    (page)=\"onPaginateChange($event)\"\n    [pageSize]=\"paginatorPageSize\"\n    [pageIndex]=\"paginatorPageIndex\"\n    [pageSizeOptions]=\"[3, 10, 20, 50]\"\n    [showFirstLastButtons]=\"true\"\n  ></mat-paginator>\n</div>\n","import { Component, OnInit, AfterViewInit, ViewChild } from \"@angular/core\";\nimport { MatSort } from \"@angular/material/sort\";\nimport { MatTableDataSource } from \"@angular/material/table\";\nimport { School } from \"../model/school\";\nimport { SchoolsService } from \"../schools.service\";\nimport { Router } from \"@angular/router\";\nimport { FilterSelection } from \"../../../core/filter/filter-selection/filter-selection\";\nimport { MatPaginator, PageEvent } from \"@angular/material/paginator\";\nimport { SessionService } from \"../../../core/session/session-service/session.service\";\nimport { User } from \"../../../core/user/user\";\nimport { UntilDestroy, untilDestroyed } from \"@ngneat/until-destroy\";\nimport { EntityMapperService } from \"../../../core/entity/entity-mapper.service\";\n\n@UntilDestroy()\n@Component({\n  selector: \"app-schools-list\",\n  templateUrl: \"./schools-list.component.html\",\n  styleUrls: [\"./schools-list.component.scss\"],\n})\nexport class SchoolsListComponent implements OnInit, AfterViewInit {\n  schoolList: School[];\n  schoolDataSource: MatTableDataSource<School> = new MatTableDataSource<\n    School\n  >();\n\n  @ViewChild(MatSort) sort: MatSort;\n  @ViewChild(MatPaginator) paginator: MatPaginator;\n  filterString = \"\";\n  columnsToDisplay: string[] = [\n    \"name\",\n    \"medium\",\n    \"privateSchool\",\n    \"academicBoard\",\n    \"upToClass\",\n  ];\n\n  mediumFS = new FilterSelection(\"medium\", []);\n  privateFS = new FilterSelection(\"private\", [\n    {\n      key: \"private\",\n      label: \"Private School\",\n      filterFun: (s: School) => s.privateSchool,\n    },\n    {\n      key: \"government\",\n      label: \"Government School\",\n      filterFun: (s: School) => !s.privateSchool,\n    },\n    { key: \"\", label: \"All\", filterFun: () => true },\n  ]);\n  filterSelections = [this.mediumFS, this.privateFS];\n\n  public paginatorPageSize: number;\n  public paginatorPageIndex: number;\n  private user: User;\n\n  constructor(\n    private schoolService: SchoolsService,\n    private router: Router,\n    private sessionService: SessionService,\n    private entityMapperService: EntityMapperService\n  ) {}\n\n  ngOnInit() {\n    this.user = this.sessionService.getCurrentUser();\n    this.paginatorPageSize = this.user.paginatorSettingsPageSize.schoolsList;\n    this.paginatorPageIndex = this.user.paginatorSettingsPageIndex.schoolsList;\n    this.schoolService\n      .getSchools()\n      .pipe(untilDestroyed(this))\n      .subscribe((data) => {\n        this.schoolList = data;\n        this.schoolDataSource.data = data;\n\n        const mediums = data\n          .map((s) => s.medium)\n          .filter((value, index, arr) => value && arr.indexOf(value) === index);\n        this.mediumFS.initOptions(mediums, \"medium\");\n      });\n  }\n\n  ngAfterViewInit() {\n    this.schoolDataSource.sort = this.sort;\n    this.schoolDataSource.paginator = this.paginator;\n    setTimeout(() => {\n      this.paginator.pageIndex = this.paginatorPageIndex;\n      this.paginator.page.next({\n        pageIndex: this.paginator.pageIndex,\n        pageSize: this.paginator.pageSize,\n        length: this.paginator.length,\n      });\n    });\n  }\n\n  onPaginateChange(event: PageEvent) {\n    this.paginatorPageSize = event.pageSize;\n    this.paginatorPageIndex = event.pageIndex;\n    this.user.paginatorSettingsPageSize.schoolsList = this.paginatorPageSize;\n    this.user.paginatorSettingsPageIndex.schoolsList = this.paginatorPageIndex;\n    this.entityMapperService.save<User>(this.user);\n  }\n\n  applyFilter(filterValue: string) {\n    filterValue = filterValue.trim();\n    filterValue = filterValue.toLowerCase(); // MatTableDataSource defaults to lowercase matches\n    this.schoolDataSource.filter = filterValue;\n  }\n\n  applyFilterSelections() {\n    let filteredData = this.schoolList;\n\n    this.filterSelections.forEach((f) => {\n      filteredData = filteredData.filter(f.getSelectedFilterFunction());\n    });\n\n    this.schoolDataSource.data = filteredData;\n  }\n\n  addSchoolClick() {\n    this.router.navigate([this.router.url, \"new\"]);\n  }\n\n  showSchoolDetails(school: School) {\n    this.router.navigate([this.router.url, school.getId()]);\n  }\n}\n","import { NgModule } from \"@angular/core\";\nimport { CommonModule } from \"@angular/common\";\nimport { SchoolsListComponent } from \"./schools-list/schools-list.component\";\nimport { MatAutocompleteModule } from \"@angular/material/autocomplete\";\nimport { MatButtonModule } from \"@angular/material/button\";\nimport { MatButtonToggleModule } from \"@angular/material/button-toggle\";\nimport { MatCardModule } from \"@angular/material/card\";\nimport { MatCheckboxModule } from \"@angular/material/checkbox\";\nimport { MatDialogModule } from \"@angular/material/dialog\";\nimport { MatExpansionModule } from \"@angular/material/expansion\";\nimport { MatFormFieldModule } from \"@angular/material/form-field\";\nimport { MatIconModule } from \"@angular/material/icon\";\nimport { MatInputModule } from \"@angular/material/input\";\nimport { MatSidenavModule } from \"@angular/material/sidenav\";\nimport { MatSnackBarModule } from \"@angular/material/snack-bar\";\nimport { MatSortModule } from \"@angular/material/sort\";\nimport { MatTableModule } from \"@angular/material/table\";\nimport { SchoolDetailsComponent } from \"./school-details/school-details.component\";\nimport { SchoolBlockComponent } from \"./school-block/school-block.component\";\nimport { FormsModule, ReactiveFormsModule } from \"@angular/forms\";\nimport { FlexLayoutModule } from \"@angular/flex-layout\";\nimport { MatPaginatorModule } from \"@angular/material/paginator\";\nimport { MatProgressSpinnerModule } from \"@angular/material/progress-spinner\";\nimport { MatSelectModule } from \"@angular/material/select\";\nimport { EntitySubrecordModule } from \"../../core/entity-subrecord/entity-subrecord.module\";\nimport { RouterModule } from \"@angular/router\";\nimport { SchoolsService } from \"./schools.service\";\nimport { MatTooltipModule } from \"@angular/material/tooltip\";\nimport { Angulartics2Module } from \"angulartics2\";\n\n@NgModule({\n  imports: [\n    CommonModule,\n    MatTableModule,\n    MatFormFieldModule,\n    MatInputModule,\n    MatSortModule,\n    MatExpansionModule,\n    MatButtonModule,\n    FlexLayoutModule,\n    MatSnackBarModule,\n    MatIconModule,\n    MatCheckboxModule,\n    ReactiveFormsModule,\n    MatInputModule,\n    MatTableModule,\n    MatPaginatorModule,\n    MatSortModule,\n    MatProgressSpinnerModule,\n    CommonModule,\n    FormsModule,\n    FlexLayoutModule,\n    RouterModule,\n    MatFormFieldModule,\n    MatInputModule,\n    MatSelectModule,\n    MatExpansionModule,\n    MatSortModule,\n    MatSidenavModule,\n    MatButtonModule,\n    MatButtonToggleModule,\n    MatIconModule,\n    MatCardModule,\n    MatSnackBarModule,\n    MatDialogModule,\n    MatAutocompleteModule,\n    EntitySubrecordModule,\n    ReactiveFormsModule,\n    MatTooltipModule,\n    Angulartics2Module,\n  ],\n  declarations: [\n    SchoolBlockComponent,\n    SchoolsListComponent,\n    SchoolDetailsComponent,\n  ],\n  exports: [SchoolBlockComponent],\n  providers: [SchoolsService],\n})\nexport class SchoolsModule {}\n","import { Injectable } from \"@angular/core\";\nimport { School } from \"./model/school\";\nimport { EntityMapperService } from \"../../core/entity/entity-mapper.service\";\nimport { from, Observable } from \"rxjs\";\nimport { Database } from \"../../core/database/database\";\nimport { Child } from \"../children/model/child\";\nimport { EntitySchemaService } from \"../../core/entity/schema/entity-schema.service\";\nimport { ChildrenService } from \"../children/children.service\";\n\n@Injectable()\nexport class SchoolsService {\n  constructor(\n    private entityMapper: EntityMapperService,\n    private entitySchemaService: EntitySchemaService,\n    private db: Database,\n    private childrenService: ChildrenService\n  ) {}\n\n  getSchools(): Observable<School[]> {\n    return from(this.entityMapper.loadType<School>(School));\n  }\n\n  async getChildrenForSchool(schoolId: string): Promise<Child[]> {\n    const relations = await this.childrenService.queryRelationsOf(\n      \"school\",\n      schoolId\n    );\n    const children: Child[] = [];\n    for (const relation of relations) {\n      children.push(\n        await this.childrenService.getChild(relation.childId).toPromise()\n      );\n    }\n    return children;\n  }\n}\n","export enum WarningLevel {\n  OK = \"OK\",\n  WARNING = \"WARNING\",\n  URGENT = \"URGENT\",\n  NONE = \"\",\n}\n\nexport function WarningLevelColor(warningLevel: WarningLevel): string {\n  switch (warningLevel) {\n    case WarningLevel.OK:\n      return \"#90ee9040\";\n    case WarningLevel.WARNING:\n      return \"#ffa50080\";\n    case WarningLevel.URGENT:\n      return \"#fd727280\";\n    default:\n      return \"\";\n  }\n}\n","import { InjectionToken } from \"@angular/core\";\n\n/**\n * Use this token to provide (and thereby register) custom implementations of {@link ConflictResolutionStrategy}.\n *\n * `{ provide: CONFLICT_RESOLUTION_STRATEGY, useClass: MyConflictResolutionStrategy, multi: true }`\n *\n * see {@link ConflictResolutionModule}\n */\nexport const CONFLICT_RESOLUTION_STRATEGY = new InjectionToken<\n  ConflictResolutionStrategy\n>(\"ConflictResolutionStrategy\");\n\n/**\n * Implement this interface to provide custom strategies how certain conflicts of an Entity type can be resolved automatically.\n *\n * see {@link ConflictResolutionModule}\n */\nexport interface ConflictResolutionStrategy {\n  autoDeleteConflictingRevision(currentDoc: any, conflictingDoc: any): boolean;\n}\n","import { Injectable } from \"@angular/core\";\nimport {\n  CanActivate,\n  ActivatedRouteSnapshot,\n  RouterStateSnapshot,\n} from \"@angular/router\";\nimport { Observable } from \"rxjs\";\nimport { SessionService } from \"../session/session-service/session.service\";\n\n/**\n * Guard checking for the currently logged in user's admin permissions.\n */\n@Injectable({\n  providedIn: \"root\",\n})\nexport class AdminGuard implements CanActivate {\n  constructor(private _sessionService: SessionService) {}\n\n  /**\n   * Whether the currently logged in user (if any) has administrative rights.\n   */\n  public isAdmin(): boolean {\n    if (this._sessionService.isLoggedIn()) {\n      return this._sessionService.getCurrentUser().isAdmin();\n    }\n  }\n\n  /**\n   * Allows activation (i.e. returns true) only if a user with admin rights is currently logged in.\n   * (used by Angular Routing system when added to certain routes)\n   *\n   * @param next The next route navigated to if allowed (provided by Angular Routing)\n   * @param state The current state (provided by Angular Routing)\n   */\n  canActivate(\n    next: ActivatedRouteSnapshot,\n    state: RouterStateSnapshot\n  ): Observable<boolean> | Promise<boolean> | boolean {\n    return this.isAdmin();\n  }\n}\n","import { NgModule } from \"@angular/core\";\nimport { CommonModule } from \"@angular/common\";\nimport { AdminComponent } from \"./admin/admin.component\";\nimport { MatButtonModule } from \"@angular/material/button\";\nimport { MatSnackBarModule } from \"@angular/material/snack-bar\";\nimport { BrowserModule } from \"@angular/platform-browser\";\nimport { AlertsModule } from \"../alerts/alerts.module\";\nimport { EntitySubrecordModule } from \"../entity-subrecord/entity-subrecord.module\";\nimport { AdminGuard } from \"./admin.guard\";\nimport { EntityModule } from \"../entity/entity.module\";\nimport { HttpClientModule } from \"@angular/common/http\";\nimport { ChildPhotoUpdateService } from \"./services/child-photo-update.service\";\nimport { MatCheckboxModule } from \"@angular/material/checkbox\";\nimport { MatTableModule } from \"@angular/material/table\";\nimport { FormsModule, ReactiveFormsModule } from \"@angular/forms\";\nimport { MatDialogModule } from \"@angular/material/dialog\";\nimport { MatFormFieldModule } from \"@angular/material/form-field\";\nimport { MatInputModule } from \"@angular/material/input\";\nimport { MatIconModule } from \"@angular/material/icon\";\nimport { UserListComponent } from \"./user-list/user-list.component\";\nimport { ExportDataComponent } from \"./export-data/export-data.component\";\nimport { BackupService } from \"./services/backup.service\";\nimport { MatTooltipModule } from \"@angular/material/tooltip\";\n\n/**\n * GUI for administrative users to manage and maintain background and technical aspects of the app.\n */\n@NgModule({\n  imports: [\n    CommonModule,\n    BrowserModule,\n    MatButtonModule,\n    MatSnackBarModule,\n    MatTableModule,\n    MatCheckboxModule,\n    AlertsModule,\n    EntitySubrecordModule,\n    EntityModule,\n    HttpClientModule,\n    FormsModule,\n    MatDialogModule,\n    ReactiveFormsModule,\n    MatFormFieldModule,\n    MatInputModule,\n    MatIconModule,\n    MatTooltipModule,\n  ],\n  declarations: [AdminComponent, UserListComponent, ExportDataComponent],\n  providers: [\n    AdminGuard,\n    ChildPhotoUpdateService,\n    BackupService,\n    ExportDataComponent,\n  ],\n  exports: [ExportDataComponent],\n})\nexport class AdminModule {}\n","import { Component, OnInit } from \"@angular/core\";\nimport { AppConfig } from \"../../app-config/app-config\";\nimport { AlertService } from \"../../alerts/alert.service\";\nimport { Alert } from \"../../alerts/alert\";\nimport FileSaver from \"file-saver\";\nimport { BackupService } from \"../services/backup.service\";\nimport { ConfirmationDialogService } from \"../../confirmation-dialog/confirmation-dialog.service\";\nimport { MatSnackBar } from \"@angular/material/snack-bar\";\nimport PouchDB from \"pouchdb-browser\";\nimport { ChildPhotoUpdateService } from \"../services/child-photo-update.service\";\n\n/**\n * Admin GUI giving administrative users different options/actions.\n */\n@Component({\n  selector: \"app-admin\",\n  templateUrl: \"./admin.component.html\",\n  styleUrls: [\"./admin.component.scss\"],\n})\nexport class AdminComponent implements OnInit {\n  /** app-wide configuration */\n  appConfig = AppConfig.settings;\n\n  /** all alerts */\n  alerts: Alert[];\n\n  /** direct database instance */\n  private db;\n\n  constructor(\n    private alertService: AlertService,\n    private backupService: BackupService,\n    private confirmationDialog: ConfirmationDialogService,\n    private snackBar: MatSnackBar,\n    private childPhotoUpdateService: ChildPhotoUpdateService\n  ) {}\n\n  ngOnInit() {\n    this.alerts = this.alertService.alerts;\n    this.db = new PouchDB(AppConfig.settings.database.name);\n  }\n\n  /**\n   * Trigger an automatic detection & update of Child entities' photo filenames.\n   */\n  updatePhotoFilenames() {\n    this.childPhotoUpdateService.updateChildrenPhotoFilenames();\n  }\n\n  /**\n   * Send a reference of the PouchDB to the browser's developer console for real-time debugging.\n   */\n  debugDatabase() {\n    console.log(this.db);\n  }\n\n  /**\n   * Download a full backup of the database as (json) file.\n   */\n  saveBackup() {\n    this.backupService\n      .getJsonExport()\n      .then((bac) => this.startDownload(bac, \"text/json\", \"backup.json\"));\n  }\n\n  /**\n   * Download a full export of the database as csv file.\n   */\n  saveCsvExport() {\n    this.backupService\n      .getCsvExport()\n      .then((csv) => this.startDownload(csv, \"text/csv\", \"export.csv\"));\n  }\n\n  private startDownload(data: string, type: string, name: string) {\n    const blob = new Blob([data], { type: type });\n    FileSaver.saveAs(blob, name);\n  }\n\n  private readFile(file): Promise<string> {\n    return new Promise((resolve) => {\n      const fileReader = new FileReader();\n      fileReader.onload = () => {\n        resolve(fileReader.result as string);\n      };\n      fileReader.readAsText(file);\n    });\n  }\n\n  /**\n   * Reset the database to the state from the loaded backup file.\n   * @param file The file object of the backup to be restored\n   */\n  loadBackup(file) {\n    const pRestorePoint = this.backupService.getJsonExport();\n    const pLoadedData = this.readFile(file);\n    Promise.all([pLoadedData, pRestorePoint]).then((r) => {\n      const newData = r[0];\n      const restorePoint = r[1];\n\n      const dialogRef = this.confirmationDialog.openDialog(\n        \"Overwrite complete database?\",\n        \"Are you sure you want to restore this backup? \" +\n          \"This will delete all \" +\n          restorePoint.split(\"\\n\").length +\n          \" existing records in the database, \" +\n          \"restoring \" +\n          newData.split(\"\\n\").length +\n          \" records from the loaded file.\"\n      );\n\n      dialogRef.afterClosed().subscribe((confirmed) => {\n        if (confirmed) {\n          this.backupService.clearDatabase();\n          this.backupService.importJson(newData, true);\n\n          const snackBarRef = this.snackBar.open(\"Backup restored\", \"Undo\", {\n            duration: 8000,\n          });\n          snackBarRef.onAction().subscribe(() => {\n            this.backupService.clearDatabase();\n            this.backupService.importJson(restorePoint, true);\n          });\n        }\n      });\n    });\n  }\n\n  /**\n   * Add the data from the loaded file to the database, inserting and updating records.\n   * @param file The file object of the csv data to be loaded\n   */\n  loadCsv(file) {\n    const pRestorePoint = this.backupService.getJsonExport();\n    const pLoadedData = this.readFile(file);\n    Promise.all([pLoadedData, pRestorePoint]).then((r) => {\n      const newData = r[0];\n      const restorePoint = r[1];\n\n      const dialogRef = this.confirmationDialog.openDialog(\n        \"Import new data?\",\n        \"Are you sure you want to import this file? \" +\n          \"This will add or update \" +\n          (newData.trim().split(\"\\n\").length - 1) +\n          \" records from the loaded file. \" +\n          'Existing records with same \"_id\" in the database will be overwritten!'\n      );\n\n      dialogRef.afterClosed().subscribe((confirmed) => {\n        if (confirmed) {\n          this.backupService.importCsv(newData, true);\n\n          const snackBarRef = this.snackBar.open(\"Import completed\", \"Undo\", {\n            duration: 8000,\n          });\n          snackBarRef.onAction().subscribe(() => {\n            this.backupService.clearDatabase();\n            this.backupService.importJson(restorePoint, true);\n          });\n        }\n      });\n    });\n  }\n\n  /**\n   * Reset the database removing all entities except user accounts.\n   */\n  clearDatabase() {\n    this.backupService.getJsonExport().then((restorePoint) => {\n      const dialogRef = this.confirmationDialog.openDialog(\n        \"Empty complete database?\",\n        \"Are you sure you want to clear the database? \" +\n          \"This will delete all \" +\n          restorePoint.split(\"\\n\").length +\n          \" existing records in the database!\"\n      );\n\n      dialogRef.afterClosed().subscribe((confirmed) => {\n        if (confirmed) {\n          this.backupService.clearDatabase();\n\n          const snackBarRef = this.snackBar.open(\"Import completed\", \"Undo\", {\n            duration: 8000,\n          });\n          snackBarRef.onAction().subscribe(() => {\n            this.backupService.importJson(restorePoint, true);\n          });\n        }\n      });\n    });\n  }\n}\n","<h1>\n  Administration & Configuration\n</h1>\n\n<p style=\"font-style:italic; font-weight:bold;\">\n  Warning: This section is intended for system administrators only.\n  Make sure you know what you are doing.\n</p>\n\n<br><hr>\n<h2>Utility Functions</h2>\n<p>\n  <button (click)=\"updatePhotoFilenames()\" mat-stroked-button>Auto-Update children's photo filenames</button>\n</p>\n\n<br><hr>\n<h2>Backup</h2>\n<p>\n  <button (click)=\"saveBackup()\" mat-stroked-button>Download Backup (.json)</button>&nbsp;\n  <button (click)=\"backupImport.click()\" mat-stroked-button>Restore Backup (.json)</button>\n  <input #backupImport type=\"file\" style=\"display:none\" (change)=\"loadBackup($event.target.files[0])\" />\n</p>\n\n<br><hr>\n<h2>Export</h2>\n<p>\n  <button (click)=\"saveCsvExport()\" mat-stroked-button>Download whole database (.csv)</button>&nbsp;\n  <button (click)=\"csvImport.click()\" mat-stroked-button>Import (.csv)</button>\n  <input #csvImport type=\"file\" style=\"display:none\" (change)=\"loadCsv($event.target.files[0])\" />\n</p>\n\n\n<br><hr>\n<h2>AppConfig</h2>\n<p>{{appConfig | json}}</p>\n\n<br><hr>\n<h2>Debug the PouchDB</h2>\n<p>\n  <button (click)=\"debugDatabase()\" mat-stroked-button>Send to console.log()</button>\n</p>\n<p>\n  <button (click)=\"clearDatabase()\" mat-stroked-button>Empty Database</button>\n</p>\n\n<br><hr>\n<h2>Alert Log</h2>\n<table>\n  <tr *ngFor=\"let alert of alerts.reverse()\">\n    <td>{{alert.type}}</td>\n    <td>{{alert.message}}</td>\n  </tr>\n</table>\n","import { Component, Input } from \"@angular/core\";\nimport { BackupService } from \"../services/backup.service\";\n\n/**\n * Generic export data button that allows the user to download a file of the given data.\n */\n@Component({\n  selector: \"app-export-data\",\n  templateUrl: \"./export-data.component.html\",\n  styleUrls: [\"./export-data.component.scss\"],\n})\nexport class ExportDataComponent {\n  /** data to be exported */\n  @Input() data: any = [];\n\n  /** What kind of data should be export? Currently implemented are 'json', 'csv' */\n  @Input() format: string = \"csv\";\n\n  /** filename for the download of the exported data */\n  @Input() filename: string = \"exportedData\";\n\n  constructor(private backupService: BackupService) {}\n\n  /**\n   * Trigger the download of the export file.\n   */\n  exportData() {\n    const blobData = this.getFormattedBlobData();\n    const link = this.createDownloadLink(blobData);\n    link.click();\n  }\n\n  private createDownloadLink(blobData): HTMLAnchorElement {\n    const link = document.createElement(\"a\");\n    link.setAttribute(\"style\", \"display:none;\");\n    document.body.appendChild(link);\n    link.href = window.URL.createObjectURL(blobData);\n    link.download = this.filename + \".\" + this.format.toLowerCase();\n    link.addEventListener(\"click\", () => window.URL.revokeObjectURL(blobData));\n    return link;\n  }\n\n  private getFormattedBlobData(): Blob {\n    let result = \"\";\n    switch (this.format.toLowerCase()) {\n      case \"json\":\n        result = this.backupService.createJson(this.data);\n        return new Blob([result], { type: \"application/json\" });\n      case \"csv\":\n        result = this.backupService.createCsv(this.data);\n        return new Blob([result], { type: \"text/csv\" });\n      default:\n        console.warn(\"Not supported format:\", this.format);\n        return new Blob([\"\"]);\n    }\n  }\n}\n","<button mat-stroked-button color=\"accent\" (click)=\"exportData()\">\n    <ng-content></ng-content>\n</button>\n","import { Injectable } from \"@angular/core\";\nimport { Database } from \"../../database/database\";\nimport { User } from \"../../user/user\";\nimport { Papa } from \"ngx-papaparse\";\n\n/**\n * Create and load backups of the database.\n */\n@Injectable({\n  providedIn: \"root\",\n})\nexport class BackupService {\n  /** CSV row separator */\n  static readonly SEPARATOR_ROW = \"\\n\";\n  /** CSV column/field separator */\n  static readonly SEPARATOR_COL = \",\";\n\n  constructor(private db: Database, private papa: Papa) {}\n\n  /**\n   * Creates a List of JSON elements separated by `BackupService.SEPARATOR_ROW` holding all elements of the database.\n   * This method can be used to created a backup of the data.\n   *\n   * @returns Promise<string> a string containing all elements of the database separated by SEPARATOR_ROW\n   */\n  getJsonExport(): Promise<string> {\n    return this.db.getAll().then((results) => this.createJson(results));\n  }\n\n  /**\n   * Creates a JSON string of the given data.\n   *\n   * @param data the data which should be converted to JSON\n   * @returns string containing all the values stringified elements of the input data\n   */\n  createJson(data): string {\n    let res = \"\";\n    data.forEach((r) => {\n      res += JSON.stringify(r) + BackupService.SEPARATOR_ROW;\n    });\n\n    return res.trim();\n  }\n\n  /**\n   * Creates a CSV string of the whole database\n   *\n   * @returns string a valid CSV string\n   */\n  getCsvExport(): Promise<string> {\n    return this.db.getAll().then((results) => this.createCsv(results));\n  }\n\n  /**\n   * Creates a CSV string of the input data\n   *\n   * @param data an array of elements\n   * @returns string a valid CSV string of the input data\n   */\n  createCsv(data): string {\n    // create list of row descriptions for the csv string\n    const allFields = [\"_id\", \"_rev\"];\n    data.forEach((element) => allFields.push(...Object.keys(element)));\n    const uniqueFields = [...new Set(allFields)]; // creates list with unique elements\n\n    return this.papa.unparse(\n      { data: data, fields: uniqueFields },\n      { quotes: true, header: true }\n    );\n  }\n\n  /**\n   * Removes all but the user entities of the database\n   *\n   * @returns Promise<any> a promise that resolves after all remove operations are done\n   */\n  clearDatabase(): Promise<any> {\n    const userEntityPrefix = new User(\"\").getType() + \":\";\n\n    return this.db.getAll().then((allDocs) => {\n      const p = [];\n      allDocs.forEach((row) => {\n        if (!row._id.startsWith(userEntityPrefix)) {\n          // skip User entities in order to not break login!\n          p.push(this.db.remove(row));\n        }\n      });\n      return Promise.all(p);\n    });\n  }\n\n  /**\n   * Fills the database with the provided JSON data.\n   * Data should be generated by the `getJsonExport` function\n   *\n   * @param json An array of entities to be written to the database\n   * @param forceUpdate should existing objects be overridden? Default false\n   *\n   * @returns Promise<any> a promise that resolves after all save operations are done\n   */\n  importJson(json, forceUpdate = false) {\n    const promises = [];\n    json.split(BackupService.SEPARATOR_ROW).forEach((record) => {\n      promises.push(this.db.put(JSON.parse(record), forceUpdate));\n    });\n    return Promise.all(promises);\n  }\n\n  /**\n   * Fills the database with the elements of the CSV string\n   *\n   * @param csv a valid CSV string\n   * @param forceUpdate should existing elements be overridden? Default false\n   *\n   * @returns Promise<any> a promise that resolves after all save operations are done\n   */\n  importCsv(csv, forceUpdate = false): Promise<any> {\n    const promises = [];\n\n    const parsedCsv = this.papa.parse(csv, {\n      header: true,\n      dynamicTyping: true,\n      skipEmptyLines: true,\n    });\n    parsedCsv.data.forEach((record) => {\n      // remove undefined properties\n      for (const propertyName in record) {\n        if (record[propertyName] === null) {\n          delete record[propertyName];\n        }\n      }\n\n      promises.push(this.db.put(record, forceUpdate));\n    });\n\n    return Promise.all(promises);\n  }\n}\n","import { Injectable } from \"@angular/core\";\nimport { EntityMapperService } from \"../../entity/entity-mapper.service\";\nimport { HttpClient } from \"@angular/common/http\";\nimport { Child } from \"../../../child-dev-project/children/model/child\";\n\n/**\n * Utility service to automatically detect and update filenames for Child entities' photos.\n */\n@Injectable({\n  providedIn: \"root\",\n})\nexport class ChildPhotoUpdateService {\n  constructor(\n    private entityService: EntityMapperService,\n    private httpClient: HttpClient\n  ) {}\n\n  /**\n   * Tries to detect and update the filename of an existing photo for all Child entities,\n   * saving the entities that were updated.\n   */\n  public async updateChildrenPhotoFilenames() {\n    const children = await this.entityService.loadType<Child>(Child);\n    for (const child of children) {\n      await this.updatePhotoIfFileExists(child, `${child.projectNumber}.png`);\n      await this.updatePhotoIfFileExists(child, `${child.projectNumber}.jpg`);\n    }\n  }\n\n  /**\n   * Check (and if it exists update) the Child's photo file.\n   * @param child The child to be updated\n   * @param filename A guess for a likely filename that needs to be checked\n   */\n  private async updatePhotoIfFileExists(child: Child, filename: string) {\n    if (child.photoFile && child.photoFile !== \"\") {\n      // do not overwrite existing path\n      return;\n    }\n\n    const fileExists = await this.checkIfFileExists(\n      Child.generatePhotoPath(filename)\n    );\n    if (fileExists) {\n      child.photoFile = filename;\n      this.entityService.save<Child>(child);\n      console.log(\n        `set photoFile for Child:${child.getId()} (${\n          child.projectNumber\n        }) to ${filename}`\n      );\n    }\n  }\n\n  private async checkIfFileExists(filename): Promise<boolean> {\n    try {\n      await this.httpClient.get(filename).toPromise();\n      return true;\n    } catch (e) {\n      if (e.status === 200) {\n        return true;\n      }\n      return false;\n    }\n  }\n}\n","<table mat-table [dataSource]=\"dataSource\" class=\"user-table mat-elevation-z8\">\n  <ng-container matColumnDef=\"id\">\n    <th mat-header-cell *matHeaderCellDef> ID </th>\n    <td mat-cell *matCellDef=\"let user\"> {{user.getId()}}</td>\n  </ng-container>\n  <ng-container matColumnDef=\"name\">\n    <th mat-header-cell *matHeaderCellDef> Username </th>\n    <td mat-cell *matCellDef=\"let user\"> {{user.name}}</td>\n  </ng-container>\n  <ng-container matColumnDef=\"admin\">\n    <th mat-header-cell *matHeaderCellDef> Admin </th>\n    <td mat-cell *matCellDef=\"let user\">\n      <mat-checkbox [checked]='user.isAdmin()' (change)='makeAdmin(user, $event.checked)'></mat-checkbox>\n    </td>\n  </ng-container>\n  <ng-container matColumnDef=\"details\">\n    <th mat-header-cell *matHeaderCellDef> Details </th>\n    <td mat-cell *matCellDef=\"let user\">\n      <mat-icon fontIcon='fa-info-circle' [matTooltip]='debugDetails.get(user.getId())'></mat-icon>\n    </td>\n  </ng-container>\n\n  <tr mat-header-row *matHeaderRowDef=\"displayedColumns\"></tr>\n  <tr mat-row *matRowDef=\"let user; columns: displayedColumns;\"></tr>\n</table>\n","import { User } from \"../../user/user\";\nimport { EntityMapperService } from \"../../entity/entity-mapper.service\";\nimport { MatTableDataSource } from \"@angular/material/table\";\nimport { Component, OnInit } from \"@angular/core\";\nimport { SessionService } from \"../../session/session-service/session.service\";\n\n/**\n * Display all available users.\n */\n@Component({\n  selector: \"app-user-list\",\n  templateUrl: \"./user-list.component.html\",\n  styleUrls: [\"./user-list.component.scss\"],\n})\nexport class UserListComponent implements OnInit {\n  /** displayed columns for the list table in the template */\n  displayedColumns = [\"id\", \"name\", \"admin\", \"details\"];\n  /** datasource for the list table in the template */\n  dataSource = new MatTableDataSource<User>();\n\n  /** additional technical details of a user mapped to the user id as key */\n  debugDetails = new Map<string, string>();\n\n  constructor(\n    private entityMapperService: EntityMapperService,\n    private sessionService: SessionService\n  ) {}\n\n  async ngOnInit() {\n    await this.loadData();\n  }\n\n  private async loadData() {\n    this.dataSource.data = await this.entityMapperService.loadType<User>(User);\n    this.dataSource.data.forEach((user) =>\n      this.debugDetails.set(user.getId(), JSON.stringify(user))\n    );\n  }\n\n  /**\n   * Change the admin role of the given user and save the entity.\n   *\n   * This requires the currently logged in user to be admin.\n   *\n   * @param user The user to be updated\n   * @param admin Whether to assign or remove admin role to the given user\n   */\n  async makeAdmin(user: User, admin: boolean) {\n    if (!this.sessionService.getCurrentUser().isAdmin()) {\n      this.loadData();\n      return;\n    }\n    if (this.sessionService.getCurrentUser().getId() === user.getId()) {\n      // do not change own user to avoid removing your own admin rights by accident\n      this.loadData();\n      return;\n    }\n\n    user.setAdmin(admin);\n    await this.entityMapperService.save<User>(user);\n  }\n}\n","/**\n * Different settings how to display an Alert.\n */\nexport enum AlertDisplay {\n  /** Never displayed */\n  NONE,\n\n  /** Disappears automatically after a certain amount of time */\n  TEMPORARY,\n\n  /** Remains visible until the user interacts with the element */\n  PERSISTENT,\n}\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { Injectable } from \"@angular/core\";\nimport { MatSnackBar } from \"@angular/material/snack-bar\";\n\nimport { Alert } from \"./alert\";\nimport { AlertComponent } from \"./alerts/alert.component\";\nimport { LoggingService } from \"../logging/logging.service\";\nimport { AlertDisplay } from \"./alert-display\";\n\n/**\n * Display alerts to the user as a hovering message at the bottom of the view.\n * (Angular Material \"SnackBar\")\n *\n * Inject this service in your classes to easily trigger alerts in the app consistent style.\n */\n@Injectable()\nexport class AlertService {\n  /** All alerts currently to be displayed */\n  alerts: Alert[] = [];\n\n  constructor(\n    public snackBar: MatSnackBar,\n    private loggingService: LoggingService\n  ) {}\n\n  /**\n   * Display the given alert.\n   * @param alert The alert instance to be displayed\n   */\n  addAlert(alert: Alert) {\n    this.alerts.push(alert);\n    this.displayAlert(alert);\n    this.logToConsole(alert);\n  }\n\n  private displayAlert(alert: Alert) {\n    const snackConfig = {\n      data: alert,\n      duration: 10000,\n      panelClass: \"alerts-snackbar\",\n    };\n\n    switch (alert.display) {\n      case AlertDisplay.NONE:\n        return;\n      case AlertDisplay.TEMPORARY:\n        snackConfig.duration = 5000;\n        break;\n      case AlertDisplay.PERSISTENT:\n        snackConfig.duration = 3600000;\n        break;\n    }\n\n    alert.notificationRef = this.snackBar.openFromComponent(\n      AlertComponent,\n      snackConfig\n    );\n  }\n\n  private logToConsole(alert: Alert) {\n    switch (alert.type) {\n      case Alert.WARNING:\n      case Alert.DANGER:\n        this.loggingService.warn(alert.message);\n        break;\n      case Alert.INFO:\n        this.loggingService.info(alert.message);\n        break;\n      case Alert.DEBUG:\n        this.loggingService.debug(alert.message);\n        break;\n    }\n  }\n\n  /**\n   * Remove an existing alert so that it is no longer displayed.\n   * @param alert The alert to be removed\n   */\n  removeAlert(alert: Alert) {\n    const index = this.alerts.indexOf(alert, 0);\n    if (index > -1) {\n      this.alerts.splice(index, 1);\n    }\n  }\n\n  /**\n   * Display an alert message of \"Info\" level, that will automatically dismiss itself after a timeout.\n   * @param message The text to be displayed\n   * @param display Optional override of the display style (e.g. whether the alert has to be actively dismissed by the user)\n   */\n  public addInfo(\n    message: string,\n    display: AlertDisplay = AlertDisplay.TEMPORARY\n  ) {\n    this.addAlert(new Alert(message, Alert.INFO, display));\n  }\n\n  /**\n   * Display an alert message of \"Warning\" level, that will have to be actively dismissed by the user.\n   * @param message The text to be displayed\n   * @param display Optional override of the display style (e.g. whether the alert has to be actively dismissed by the user)\n   */\n  public addWarning(\n    message: string,\n    display: AlertDisplay = AlertDisplay.PERSISTENT\n  ) {\n    this.addAlert(new Alert(message, Alert.WARNING, display));\n  }\n\n  /**\n   * Display an alert message of \"Danger\" level, that is highlighted and will have to be actively dismissed by the user.\n   * @param message The text to be displayed\n   * @param display Optional override of the display style (e.g. whether the alert has to be actively dismissed by the user)\n   */\n  public addDanger(\n    message: string,\n    display: AlertDisplay = AlertDisplay.PERSISTENT\n  ) {\n    this.addAlert(new Alert(message, Alert.DANGER, display));\n  }\n\n  /**\n   * Display an alert message of \"Debug\" level, that will not be displayed to the user.\n   * @param message The text to be displayed\n   * @param display Optional override of the display style (e.g. whether the alert has to be actively dismissed by the user)\n   */\n  public addDebug(message: string, display: AlertDisplay = AlertDisplay.NONE) {\n    this.addAlert(new Alert(message, Alert.DEBUG, display));\n  }\n}\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { MatSnackBarRef } from \"@angular/material/snack-bar\";\nimport { AlertComponent } from \"./alerts/alert.component\";\nimport { AlertDisplay } from \"./alert-display\";\n\n/**\n * An Alert message to be displayed to the user through the {@link AlertService}.\n */\nexport class Alert {\n  /** Info messages provide feedback or information to the user without any required action */\n  static INFO = \"info\";\n  /** Warning messages provide feedback about unexpected or potentially unintended events */\n  static WARNING = \"warning\";\n  /** Danger messages inform about errors or critical conditions that the user should not overlook */\n  static DANGER = \"danger\";\n  /** Debug messages are not relevant to the normal user and only needed for developers troubleshooting errors */\n  static DEBUG = \"debug\";\n\n  /** reference to the ui displaying the message */\n  public notificationRef: MatSnackBarRef<AlertComponent>;\n\n  /**\n   * Create a container of a new Alert message.\n   * @param message The text of the message\n   * @param type The type of the message\n   * @param display The display style (e.g. whether the alert has to be actively dismissed by the user)\n   */\n  constructor(\n    public message: string,\n    public type: string,\n    public display: AlertDisplay\n  ) {}\n}\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { NgModule } from \"@angular/core\";\nimport { CommonModule } from \"@angular/common\";\n\nimport { AlertComponent } from \"./alerts/alert.component\";\nimport { AlertService } from \"./alert.service\";\nimport { MatButtonModule } from \"@angular/material/button\";\nimport { MatCardModule } from \"@angular/material/card\";\nimport { MatIconModule } from \"@angular/material/icon\";\nimport { MatSnackBarModule } from \"@angular/material/snack-bar\";\n\n/**\n * Show alert message to the user informing about events or errors.\n */\n@NgModule({\n  imports: [\n    CommonModule,\n    MatSnackBarModule,\n    MatCardModule,\n    MatButtonModule,\n    MatIconModule,\n  ],\n  declarations: [AlertComponent],\n  exports: [AlertComponent],\n  providers: [AlertService],\n})\nexport class AlertsModule {}\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { Component, Inject } from \"@angular/core\";\n\nimport { Alert } from \"../alert\";\nimport { MAT_SNACK_BAR_DATA } from \"@angular/material/snack-bar\";\n\n/**\n * Display an {@link Alert} with basic formatting and UI controls.\n */\n@Component({\n  templateUrl: \"./alert.component.html\",\n  styleUrls: [\"./alert.component.scss\"],\n})\nexport class AlertComponent {\n  /** the displayed alert */\n  alert: Alert;\n\n  /**\n   * This component is created through MatSnackBar which provides the required data during creation.\n   * @param data The alert instance to be displayed\n   */\n  constructor(@Inject(MAT_SNACK_BAR_DATA) private data: any) {\n    this.alert = data;\n  }\n}\n","<!--\n  ~     This file is part of ndb-core.\n  ~\n  ~     ndb-core is free software: you can redistribute it and/or modify\n  ~     it under the terms of the GNU General Public License as published by\n  ~     the Free Software Foundation, either version 3 of the License, or\n  ~     (at your option) any later version.\n  ~\n  ~     ndb-core is distributed in the hope that it will be useful,\n  ~     but WITHOUT ANY WARRANTY; without even the implied warranty of\n  ~     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n  ~     GNU General Public License for more details.\n  ~\n  ~     You should have received a copy of the GNU General Public License\n  ~     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n  -->\n\n<div class=\"ndb-alert ndb-alert-{{alert.type}}\">\n  <button mat-icon-button (click)=\"alert.notificationRef.dismiss()\" class=\"ndb-alert-dismiss\">\n    <mat-icon class=\"ndb-alert-dismiss-icon\" fontIcon=\"fa-window-close-o\"></mat-icon>\n  </button>\n  <p>{{ alert.message }}</p>\n</div>\n","import { Injectable } from \"@angular/core\";\nimport { Angulartics2Piwik } from \"angulartics2/piwik\";\nimport { environment } from \"../../../environments/environment\";\n\nconst md5 = require(\"md5\");\n\n@Injectable({\n  providedIn: \"root\",\n})\nexport class AnalyticsService {\n  static angulartics2Piwik: Angulartics2Piwik;\n\n  static eventTrack(\n    action: string,\n    properties: {\n      category: string;\n      label: string;\n      value: number;\n    } = {\n      category: \"no_category\",\n      label: \"no_label\",\n      value: -1,\n    }\n  ): void {\n    AnalyticsService.angulartics2Piwik.eventTrack(action, properties);\n  }\n\n  static setUser(username: string): void {\n    AnalyticsService.angulartics2Piwik.setUsername(\n      AnalyticsService.getUserHash(username)\n    );\n  }\n\n  static setVersion(): void {\n    AnalyticsService.angulartics2Piwik.setUserProperties({\n      dimension1: \"ndb-core@\" + environment.appVersion,\n    });\n  }\n\n  private static getUserHash(username: string) {\n    return md5(username);\n  }\n\n  constructor(private angulartics2Piwik: Angulartics2Piwik) {\n    AnalyticsService.angulartics2Piwik = angulartics2Piwik;\n  }\n\n  init(): void {\n    AnalyticsService.angulartics2Piwik.startTracking();\n    AnalyticsService.setVersion();\n  }\n}\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { APP_INITIALIZER, NgModule } from \"@angular/core\";\nimport { CommonModule } from \"@angular/common\";\nimport { AppConfig } from \"./app-config\";\nimport { HttpClientModule } from \"@angular/common/http\";\n\n/**\n * Management of central configuration for the app that can a set by an administrator independent of code\n * in the assets/config.json file.\n *\n * Just import this module in your root module to ensure the AppConfig is properly initialized on startup.\n *\n * You can then use the static `AppConfig.settings` object (which exactly represents the contents of the config.json)\n * to access the configuration values without need for dependency injection of a service.\n */\n@NgModule({\n  imports: [CommonModule, HttpClientModule],\n  declarations: [],\n  providers: [\n    AppConfig,\n    {\n      provide: APP_INITIALIZER,\n      useFactory: initializeAppConfig,\n      deps: [AppConfig],\n      multi: true,\n    },\n  ],\n})\nexport class AppConfigModule {}\n\n/**\n * Factory method for APP_INITIALIZER to load essential things before any other modules.\n * This is required to ensure the AppConfig.settings are available before other code needs it.\n *\n * @param appConfig The AppConfig service (through dependency injection)\n */\nexport function initializeAppConfig(appConfig: AppConfig) {\n  return () => appConfig.load();\n}\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { Injectable } from \"@angular/core\";\nimport { IAppConfig } from \"./app-config.model\";\nimport { HttpClient } from \"@angular/common/http\";\n\n/**\n * Central app configuration.\n *\n * The settings are defined in a json file and can therefore be changed for different deployments\n * without code changes.\n *\n * Simply use the static `AppConfig.settings` for easy access to the app's configuration.\n * You do _not_ have to inject the AppConfig service into your code in order to access the app settings.\n * AppConfig is an Angular service only because this is required for initially loading the remote settings into\n * the static AppConfig.settings object.\n *\n * @example\n * this.title = AppConfig.settings.site_name;\n * // just directly use AppConfig and let your IDE add an \"import\" statement to the file\n * // no need for dependency injection here\n */\n@Injectable()\nexport class AppConfig {\n  /** settings for the app */\n  static settings: IAppConfig;\n\n  /** file location of the config file to be created by the administrator */\n  private readonly CONFIG_FILE = \"assets/config.json\";\n\n  /** fallback file location of the config that is part of the project already if the \"real\" config file isn't found */\n  private readonly DEFAULT_CONFIG_FILE = \"assets/config.default.json\";\n\n  constructor(private http: HttpClient) {}\n\n  /**\n   * Load the config file into the `AppConfig.settings` so they can be used synchronously anywhere in the code after that.\n   *\n   * If the config file does not exist, uses the default config as a fallback.\n   */\n  load() {\n    return this.loadAppConfigJson(this.CONFIG_FILE).then(\n      (result) => result,\n      () => this.loadAppConfigJson(this.DEFAULT_CONFIG_FILE)\n    );\n  }\n\n  /**\n   * Load the given file and set it as AppConfig.settings.\n   *\n   * This requires a HTTP request because the \"assets\" folder including the config.json is on our server\n   * while this javascript code is executed in the users browser.\n   *\n   * @param jsonFileLocation The file path of the json file to be loaded as config\n   */\n  private loadAppConfigJson(jsonFileLocation: string) {\n    return new Promise<void>((resolve, reject) => {\n      this.http\n        .get<IAppConfig>(jsonFileLocation)\n        .toPromise()\n        .then((result) => {\n          AppConfig.settings = result;\n          resolve();\n        })\n        .catch((response: any) => {\n          reject(\n            `Could not load file '${jsonFileLocation}': ${JSON.stringify(\n              response\n            )}`\n          );\n        });\n    });\n  }\n}\n","import { NgModule } from \"@angular/core\";\nimport { CommonModule } from \"@angular/common\";\nimport { ConfigService } from \"./config.service\";\n\n@NgModule({\n  declarations: [],\n  imports: [CommonModule],\n  providers: [ConfigService],\n})\nexport class ConfigModule {}\n","import { Injectable } from \"@angular/core\";\nimport config from \"./config-fix.json\";\n\n@Injectable({\n  providedIn: \"root\",\n})\nexport class ConfigService {\n  constructor() {}\n\n  public async loadConfig() {\n    return await new Promise((resolve) => {\n      setTimeout(() => {\n        console.log(\"config loaded\"), resolve();\n      }, 300);\n    });\n  }\n\n  public getConfig<T>(id: string): T {\n    return config[id];\n  }\n\n  public getAllConfigs<T>(prefix: string): T[] {\n    const matchingConfigs = [];\n\n    for (const id of Object.keys(config)) {\n      if (id.startsWith(prefix)) {\n        config[id]._id = id;\n        matchingConfigs.push(config[id]);\n      }\n    }\n\n    return matchingConfigs;\n  }\n}\n","import { NgModule } from \"@angular/core\";\nimport { CommonModule } from \"@angular/common\";\nimport { ConfirmationDialogComponent } from \"./confirmation-dialog/confirmation-dialog.component\";\nimport { MatButtonModule } from \"@angular/material/button\";\nimport { MatDialogModule } from \"@angular/material/dialog\";\nimport { ConfirmationDialogService } from \"./confirmation-dialog.service\";\n\n/**\n * A helper utility module helping to display configurable confirmation dialog boxes\n * without having to create a custom template every time.\n *\n * Use the {@link ConfirmationDialogService} for this.\n */\n@NgModule({\n  imports: [CommonModule, MatDialogModule, MatButtonModule],\n  declarations: [ConfirmationDialogComponent],\n  providers: [ConfirmationDialogService],\n})\nexport class ConfirmationDialogModule {}\n","import { Injectable } from \"@angular/core\";\nimport { MatDialog, MatDialogRef } from \"@angular/material/dialog\";\nimport { ConfirmationDialogComponent } from \"./confirmation-dialog/confirmation-dialog.component\";\n\n/**\n * Inject this service instead of MatDialog if you need a simple, configurable confirmation dialog box\n * to be displayed to the user.\n *\n * Import the {@link ConfirmationDialogModule} in your root module to provide this service.\n *\n * @example\n const dialogRef = this.confirmationDialog.openDialog('Delete?', 'Are you sure you want to delete this record?');\n dialogRef.afterClosed().subscribe(confirmed => {\n    if (confirmed) {\n       // delete\n    }\n });\n */\n@Injectable()\nexport class ConfirmationDialogService {\n  constructor(private dialog: MatDialog) {}\n\n  /**\n   * Open a dialog with the given configuration.\n   * @param title The title displayed for the dialog\n   * @param text The text displayed for the dialog\n   * @param yesNoButtons Whether two buttons (yes/no) are shown to the user. Otherwise only an \"Ok\" button will be shown.\n   * @return The reference to the opened MatDialog.\n   *          You can use this to control the dialog or subscribe to its result:\n   *          (`ref.afterClosed().subscribe(confirmed => myAction(confirmed));`\n   */\n  openDialog(\n    title: string,\n    text: string,\n    yesNoButtons = true\n  ): MatDialogRef<ConfirmationDialogComponent> {\n    return this.dialog.open(ConfirmationDialogComponent, {\n      data: { title: title, text: text, yesNo: yesNoButtons },\n    });\n  }\n}\n","import { Component, Inject } from \"@angular/core\";\nimport { MAT_DIALOG_DATA, MatDialogRef } from \"@angular/material/dialog\";\n\n/**\n * A configurable confirmation dialog box\n * used by the {@link ConfirmationDialogService}.\n */\n@Component({\n  selector: \"app-confirmation-dialog\",\n  templateUrl: \"./confirmation-dialog.component.html\",\n  styleUrls: [\"./confirmation-dialog.component.scss\"],\n})\nexport class ConfirmationDialogComponent {\n  /**\n   * This component is used as a template for MatDialog, created with the required dependencies through that service.\n   * @param dialogRef The reference to the dialog this component is displayed within\n   * @param data The configuration defining what text and buttons will be displayed\n   */\n  constructor(\n    public dialogRef: MatDialogRef<ConfirmationDialogComponent>,\n    @Inject(MAT_DIALOG_DATA) public data: ConfirmationDialogConfig\n  ) {}\n}\n\n/**\n * Options to configure the {@link ConfirmationDialogComponent}.\n */\nexport interface ConfirmationDialogConfig {\n  /** title of the dialog box */\n  title: string;\n\n  /** description text in the dialog box */\n  text: string;\n\n  /** Whether to display an option of yes/no buttons or just a single \"ok\" button */\n  yesNo: boolean;\n}\n","<h1 mat-dialog-title>{{data.title}}</h1>\n<div mat-dialog-content>\n  <p>{{data.text}}</p>\n</div>\n\n<div mat-dialog-actions *ngIf='data.yesNo'>\n  <button mat-stroked-button [mat-dialog-close]=\"true\" cdkFocusInitial>Yes</button>\n  <button mat-stroked-button [mat-dialog-close]=\"false\">No</button>\n</div>\n<div mat-dialog-actions *ngIf='!data.yesNo'>\n  <button mat-stroked-button [mat-dialog-close]=\"true\" cdkFocusInitial>OK</button>\n</div>\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { Database } from \"./database\";\nimport { SessionService } from \"../session/session-service/session.service\";\n\n/**\n * Provider of Database service for the Angular dependency injection.\n *\n * This depends on the SessionService that is set up\n * (which in turn considers the app-config.json to switch between an in-memory database and a synced persistent database).\n */\nexport let databaseServiceProvider = {\n  provide: Database,\n  useFactory: function (_sessionService: SessionService) {\n    return _sessionService.getDatabase();\n  },\n  deps: [SessionService],\n};\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * An implementation of this abstract class provides functions for direct database access.\n * This interface is an extension of the [PouchDB API](https://pouchdb.com/api.html).\n *\n * A `Database` instance is injected into the app through the {@link databaseServiceProvider}\n * with the help of the {@link SessionService}.\n */\nexport abstract class Database {\n  /**\n   * Load a single document by id from the database.\n   * @param id The primary key of the document to be loaded\n   * @param options Optional options for the database engine (PouchDB)\n   */\n  abstract get(id: string, options?: any): Promise<any>;\n\n  /**\n   * Load all documents (matching the given PouchDB options) from the database.\n   *\n   * Normally you should rather use \"getAll()\" or another well typed method of this class\n   * instead of passing PouchDB specific options here\n   * because that will make your code tightly coupled with PouchDB rather than any other database provider.\n   *\n   * @param options PouchDB options object as in the normal PouchDB library\n   */\n  abstract allDocs(options?: any): Promise<any>;\n\n  /**\n   * Save a document to the database.\n   * @param object The document to be saved\n   * @param forceUpdate (Optional) Whether conflicts should be ignored and an existing conflicting document forcefully overwritten.\n   */\n  abstract put(object: any, forceUpdate?: boolean): Promise<any>;\n\n  /**\n   * Delete a document from the database\n   * @param object The document to be deleted (usually this object must at least contain the _id and _rev)\n   */\n  abstract remove(object: any): Promise<any>;\n\n  /**\n   * Query data from the database based on a more complex, indexed request.\n   *\n   * This is directly calling the PouchDB implementation of this function.\n   * Also see the documentation there: {@link https://pouchdb.com/api.html#query_database}\n   *\n   * @param fun The name of a previously saved database index\n   * @param options Additional options for the query, like a `key`. See the PouchDB docs for details.\n   */\n  abstract query(fun: any, options?: any): Promise<any>;\n\n  /**\n   * Create a database index to `query()` certain data more efficiently in the future.\n   *\n   * Also see the PouchDB documentation regarding indices and queries: {@link https://pouchdb.com/api.html#query_database}\n   *\n   * @param designDoc The PouchDB style design document for the map/reduce query\n   */\n  abstract saveDatabaseIndex(designDoc: any): Promise<any>;\n\n  /**\n   * Load all documents (with the given prefix) from the database.\n   * @param prefix The string prefix of document ids that should be retrieved\n   */\n  getAll(prefix = \"\"): Promise<Array<any>> {\n    return this.allDocs({\n      include_docs: true,\n      startkey: prefix,\n      endkey: prefix + \"\\ufff0\",\n    });\n  }\n}\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { Database } from \"./database\";\nimport { Note } from \"../../child-dev-project/notes/model/note\";\nimport { AttendanceMonth } from \"../../child-dev-project/attendance/model/attendance-month\";\nimport { ChildSchoolRelation } from \"../../child-dev-project/children/model/childSchoolRelation\";\n\n/**\n * In-Memory database implementation that works as a drop-in replacement of {@link PouchDatabase}\n *\n * The MockDatabase internally stores all documents in a variable and tries to simulate functionality\n * as similar as possible to the PouchDatabase.\n */\nexport class MockDatabase extends Database {\n  private data = [];\n\n  /**\n   * Create an in-memory database manager.\n   */\n  constructor() {\n    super();\n  }\n\n  /**\n   * see {@link Database}\n   * @param id The primary id of the document\n   */\n  get(id: string) {\n    if (!this.exists(id)) {\n      return Promise.reject({ status: 404, message: \"object not found\" });\n    }\n\n    const index = this.findIndex(id);\n    const result = this.data[index];\n\n    return Promise.resolve(result);\n  }\n\n  /**\n   * see {@link Database}\n   * @param options Only 'startkey' is considered by the MockDatabase implementation\n   */\n  allDocs(options?: any) {\n    let result = this.data;\n\n    // default options provided through getAll(prefix): {include_docs: true, startkey: prefix, endkey: prefix + '\\ufff0'}\n    // MockDatabase ignores endkey and only implements filtering based on startkey/prefix\n    if (options && options.hasOwnProperty(\"startkey\")) {\n      result = this.data.filter((o) => o._id.startsWith(options.startkey));\n    }\n\n    return Promise.resolve(result);\n  }\n\n  /**\n   * see {@link Database}\n   * @param object The document to be saved\n   * @param forceUpdate Whether a conflicting document will be forcefully overwritten\n   */\n  async put(object: any, forceUpdate?: boolean) {\n    if (this.exists(object._id)) {\n      return this.overwriteExisting(object);\n    } else {\n      object._rev = \"x\";\n      this.data.push(object);\n      return Promise.resolve(this.generateWriteResponse(object));\n    }\n  }\n\n  private async overwriteExisting(object: any): Promise<any> {\n    const existingObject = await this.get(object._id);\n\n    if (object._rev !== existingObject._rev) {\n      return Promise.reject({ message: \"_id already exists\" });\n    }\n\n    const index = this.data.findIndex((e) => e._id === object._id);\n    if (index > -1) {\n      object._rev = object._rev + \"x\";\n      this.data[index] = object;\n      return Promise.resolve(this.generateWriteResponse(object));\n    } else {\n      return Promise.reject({ message: \"failed to overwrite existing object\" });\n    }\n  }\n\n  private generateWriteResponse(writtenObject: any) {\n    return {\n      ok: true,\n      id: writtenObject._id,\n      rev: writtenObject._rev,\n    };\n  }\n\n  /**\n   * see {@link Database}\n   * @param object The document to be deleted\n   */\n  remove(object: any) {\n    if (!this.exists(object._id)) {\n      return Promise.reject({ status: 404, message: \"object not found\" });\n    }\n\n    const index = this.findIndex(object._id);\n    if (index > -1) {\n      this.data.splice(index, 1);\n    }\n\n    return Promise.resolve(true);\n  }\n\n  private exists(id: string) {\n    return this.findIndex(id) > -1;\n  }\n\n  private findIndex(id: string) {\n    return this.data.findIndex((o) => o._id === id);\n  }\n\n  /**\n   * A \"simulation\" of queries as the PouchDatabase implementation would handle them.\n   *\n   * This has hard-coded response logic for some individual indices that are used in the app\n   * and at the moment cannot handle generic creating and executing real queries.\n   * You can add a mock implementation here for your specific query/index if necessary.\n   *\n   * @param fun The name of the previously created index\n   * @param options Additional options for the query\n   */\n  async query(fun: any, options?: any): Promise<any> {\n    // TODO: implement generic mock query function\n    /* SAMPLE INPUT:\n      query('notes_index/by_child', {key: childId, include_docs: true});\n      query('avg_attendance_index/three_months', {reduce: true, group: true});\n    */\n\n    // mock specific indices\n    let filterFun;\n    let reducerFun;\n    switch (fun) {\n      case \"notes_index/by_child\":\n        filterFun = (e) =>\n          e._id.startsWith(Note.ENTITY_TYPE) &&\n          e.children.includes(options.key);\n        break;\n      case \"attendances_index/by_child\":\n        filterFun = (e) =>\n          e._id.startsWith(AttendanceMonth.ENTITY_TYPE) &&\n          e.student === options.key;\n        break;\n      case \"attendances_index/by_month\":\n        filterFun = (e) => {\n          if (!e._id.startsWith(AttendanceMonth.ENTITY_TYPE)) {\n            return false;\n          }\n          e.month = new Date(e.month);\n          return (\n            e.month.getFullYear().toString() +\n              \"-\" +\n              (e.month.getMonth() + 1).toString() ===\n            options.key\n          );\n        };\n        break;\n      case \"avg_attendance_index/three_months\":\n        filterFun = (e) =>\n          e._id.startsWith(AttendanceMonth.ENTITY_TYPE) &&\n          this.isWithinLastMonths(e.month, new Date(), 3);\n        reducerFun = this.getStatsReduceFun(\n          (e: AttendanceMonth) => e.student,\n          (e: AttendanceMonth) =>\n            e.daysAttended / (e.daysWorking - e.daysExcused)\n        );\n        break;\n      case \"avg_attendance_index/last_month\":\n        filterFun = (e) =>\n          e._id.startsWith(AttendanceMonth.ENTITY_TYPE) &&\n          this.isWithinLastMonths(e.month, new Date(), 1);\n        reducerFun = this.getStatsReduceFun(\n          (e: AttendanceMonth) => e.student,\n          (e: AttendanceMonth) =>\n            e.daysAttended / (e.daysWorking - e.daysExcused)\n        );\n        break;\n      case \"childSchoolRelations_index/by_child\":\n        filterFun = (e) =>\n          e._id.startsWith(ChildSchoolRelation.ENTITY_TYPE) &&\n          e.childId === options.key;\n        break;\n      case \"childSchoolRelations_index/by_school\":\n        filterFun = (e) =>\n          e._id.startsWith(ChildSchoolRelation.ENTITY_TYPE) &&\n          ((e.start <= new Date().setHours(0, 0, 0, 0) && !e.end) ||\n            e.end >= new Date().setHours(0, 0, 0, 0)) &&\n          e.schoolId === options.key;\n        break;\n      case \"search_index/by_name\":\n        filterFun = (e) => {\n          return (\n            e.hasOwnProperty(\"searchIndices\") &&\n            e.searchIndices.some((word) =>\n              word.toString().toLowerCase().includes(options.startkey)\n            )\n          );\n        };\n        break;\n      case \"childSchoolRelations_index/by_date\":\n        return this.filterForLatestRelationOfChild(\n          options.endkey,\n          options.limit\n        );\n    }\n    if (filterFun !== undefined) {\n      if (reducerFun !== undefined) {\n        const allData = await this.getAll();\n        const filteredResults = allData.filter(filterFun);\n        const reducedResults = filteredResults.reduce(reducerFun, []);\n        return { rows: reducedResults };\n      } else {\n        const allData = await this.getAll();\n        return {\n          rows: allData.filter(filterFun).map((e) => {\n            return { id: e._id, doc: e };\n          }),\n        };\n      }\n    }\n\n    console.warn('MockDatabase does not implement \"query()\"');\n    return { rows: [] };\n  }\n\n  private async filterForLatestRelationOfChild(\n    childKey: string,\n    limit: number\n  ): Promise<any> {\n    return new Promise((resolve) => {\n      this.getAll().then((all) => {\n        const relations = all.filter((e) =>\n          e._id.startsWith(ChildSchoolRelation.ENTITY_TYPE)\n        );\n        const sorted = relations.sort((a, b) => {\n          const aValue =\n            a.childId + \"_\" + this.zeroPad(new Date(a.start).valueOf());\n          const bValue =\n            b.childId + \"_\" + this.zeroPad(new Date(b.start).valueOf());\n          return aValue < bValue ? 1 : aValue === bValue ? 0 : -1;\n        });\n        const filtered: ChildSchoolRelation[] = sorted.filter(\n          (doc) => doc.childId + \"_\" === childKey\n        );\n        let results: { doc: ChildSchoolRelation }[] = filtered.map(\n          (relation) => {\n            return { doc: relation };\n          }\n        );\n        if (limit) {\n          results = results.slice(0, limit);\n        }\n        resolve({ rows: results });\n      });\n    });\n  }\n\n  /**\n   * This function is useful when comparing numbers on string level.\n   * For example: 123 < 1111 but \"123\" > \"1111\"\n   * That is why its being transformed to \"0123\" and \"1111\" so \"0123\" < \"1111\"\n   * @param str the string that should be padded with zeros\n   * @param length the length to which the string should be padded\n   * @return string of the padded input\n   */\n  private zeroPad(str: string | number, length: number = 14): string {\n    // with ECMAScript 2017 you can do a one-liner: 'return str.toString().padStart(length, '0');'\n    let res = str.toString();\n    while (res.length < length) {\n      res = \"0\" + res;\n    }\n    return res;\n  }\n\n  private isWithinLastMonths(\n    date: Date,\n    now: Date,\n    numberOfMonths: number\n  ): boolean {\n    if (!date) {\n      return false;\n    }\n    date = new Date(date);\n\n    let months;\n    months = (now.getFullYear() - date.getFullYear()) * 12;\n    months -= date.getMonth();\n    months += now.getMonth();\n    if (months < 0) {\n      return false;\n    }\n    return months <= numberOfMonths;\n  }\n\n  private getStatsReduceFun(\n    keyFun: (any) => string,\n    valueFun: (any) => number\n  ) {\n    return (acc, value) => {\n      const stats = {\n        key: keyFun(value),\n        value: { count: 1, sum: valueFun(value) },\n      };\n      const existing = acc.filter((x) => x.key === keyFun(value));\n      if (existing.length > 0) {\n        const v = existing[0].value;\n        v.count++;\n        v.sum = v.sum + stats.value.sum;\n      } else {\n        acc.push(stats);\n      }\n\n      return acc;\n    };\n  }\n\n  /**\n   * Currently not implemented for MockDatabase!\n   *\n   * Check (and extend) the `query` method for hard-coded mocks of some specific queries.\n   *\n   * @param designDoc\n   */\n  saveDatabaseIndex(designDoc) {\n    // TODO: implement mock query\n    /* SAMPLE INPUT:\n    const designDoc = {\n      _id: '_design/attendance_index',\n      views: {\n        by_name: {\n          map: (doc) => { emit(doc.child); }\n        },\n        by_month: {\n          map: (doc) => { emit(doc.month); }\n        }\n      }\n    };\n     */\n\n    // tslint:disable-next-line:no-console\n    console.debug('MockDatabase does not implement \"saveDatabaseIndex()\"');\n    return Promise.resolve({});\n  }\n}\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { Database } from \"./database\";\nimport { AlertService } from \"../alerts/alert.service\";\nimport { AlertDisplay } from \"../alerts/alert-display\";\nimport moment from \"moment\";\nimport { LoggingService } from \"../logging/logging.service\";\n\n/**\n * Wrapper for a PouchDB instance to decouple the code from\n * that external library.\n *\n * Additional convenience functions on top of the PouchDB API\n * should be implemented in the abstract {@link Database}.\n */\nexport class PouchDatabase extends Database {\n  /**\n   * Create a PouchDB database manager.\n   * @param _pouchDB An (initialized) PouchDB database instance from the PouchDB library.\n   * @param alertService The AlertService instance of the app to be able to display problems to users.\n   * @param loggingService The LoggingService instance of the app to log and report problems.\n   */\n  constructor(\n    private _pouchDB: any,\n    private alertService: AlertService,\n    private loggingService: LoggingService\n  ) {\n    super();\n  }\n\n  /**\n   * Load a single document by id from the database.\n   * (see {@link Database})\n   * @param id The primary key of the document to be loaded\n   * @param options Optional PouchDB options for the request\n   * @param returnUndefined (Optional) return undefined instead of throwing error if doc is not found in database\n   */\n  get(id: string, options: any = {}, returnUndefined?: boolean): Promise<any> {\n    return this._pouchDB.get(id, options).catch((err) => {\n      if (err.status === 404) {\n        this.loggingService.debug(\"Doc not found in database: \" + id);\n        if (returnUndefined) {\n          return undefined;\n        } else {\n          throw err;\n        }\n      } else {\n        this.notifyError(err);\n        throw err;\n      }\n    });\n  }\n\n  /**\n   * Load all documents (matching the given PouchDB options) from the database.\n   * (see {@link Database})\n   *\n   * Normally you should rather use \"getAll()\" or another well typed method of this class\n   * instead of passing PouchDB specific options here\n   * because that will make your code tightly coupled with PouchDB rather than any other database provider.\n   *\n   * @param options PouchDB options object as in the normal PouchDB library\n   */\n  allDocs(options?: any) {\n    return this._pouchDB.allDocs(options).then((result) => {\n      const resultArray = [];\n      for (const row of result.rows) {\n        resultArray.push(row.doc);\n      }\n      return resultArray;\n    });\n  }\n\n  /**\n   * Save a document to the database.\n   * (see {@link Database})\n   *\n   * @param object The document to be saved\n   * @param forceOverwrite (Optional) Whether conflicts should be ignored and an existing conflicting document forcefully overwritten.\n   */\n  put(object: any, forceOverwrite?: boolean) {\n    const options: any = {};\n    // if (forceOverwrite) {\n    //   options.force = true;\n    // }\n\n    return this._pouchDB.put(object, options).catch((err) => {\n      if (err.status === 409) {\n        this.resolveConflict(object, forceOverwrite, err);\n      } else {\n        this.notifyError(err);\n        throw err;\n      }\n    });\n  }\n\n  /**\n   * Delete a document from the database\n   * (see {@link Database})\n   *\n   * @param object The document to be deleted (usually this object must at least contain the _id and _rev)\n   */\n  remove(object: any) {\n    return this._pouchDB.remove(object).catch((err) => {\n      this.notifyError(err);\n      throw err;\n    });\n  }\n\n  /**\n   * Query data from the database based on a more complex, indexed request.\n   * (see {@link Database})\n   *\n   * This is directly calling the PouchDB implementation of this function.\n   * Also see the documentation there: {@link https://pouchdb.com/api.html#query_database}\n   *\n   * @param fun The name of a previously saved database index\n   * @param options Additional options for the query, like a `key`. See the PouchDB docs for details.\n   */\n  query(\n    fun: string | ((doc: any, emit: any) => void),\n    options: any\n  ): Promise<any> {\n    return this._pouchDB.query(fun, options);\n  }\n\n  /**\n   * Create a database index to `query()` certain data more efficiently in the future.\n   * (see {@link Database})\n   *\n   * Also see the PouchDB documentation regarding indices and queries: {@link https://pouchdb.com/api.html#query_database}\n   *\n   * @param designDoc The PouchDB style design document for the map/reduce query\n   */\n  async saveDatabaseIndex(designDoc: any): Promise<any> {\n    const existingDesignDoc = await this.get(designDoc._id, {}, true);\n    if (!existingDesignDoc) {\n      this.loggingService.debug(\"creating new database index\");\n    } else if (\n      JSON.stringify(existingDesignDoc.views) !==\n      JSON.stringify(designDoc.views)\n    ) {\n      this.loggingService.debug(\"replacing existing database index\");\n      designDoc._rev = existingDesignDoc._rev;\n    } else {\n      // already up to date, nothing more to do\n      return;\n    }\n\n    await this.put(designDoc);\n\n    await this.prebuildViewsOfDesignDoc(designDoc);\n  }\n\n  private async prebuildViewsOfDesignDoc(designDoc: any) {\n    for (const viewName of Object.keys(designDoc.views)) {\n      try {\n        const queryName =\n          designDoc._id.replace(/_design\\//, \"\") + \"/\" + viewName;\n        console.log(\"start indexing \" + queryName);\n        const startTime = moment();\n        await this.query(queryName, { key: \"1\" });\n        const indexingTime = moment().diff(startTime, \"milliseconds\");\n        console.log(\"done indexing \" + queryName, indexingTime);\n        if (indexingTime > 1000) {\n          this.loggingService.warn({\n            action: \"Indexing for query\",\n            query: queryName,\n            duration: indexingTime,\n          });\n        }\n      } catch (err) {\n        this.alertService.addWarning(\n          \"failed to trigger query for new index: \",\n          err\n        );\n      }\n    }\n  }\n\n  private notifyError(err) {\n    this.alertService.addWarning(\n      \"PouchDB Error \" + err.status + \": \" + JSON.stringify(err),\n      AlertDisplay.NONE\n    );\n  }\n\n  /**\n   * Attempt to intelligently resolve conflicting document versions automatically.\n   * @param newObject\n   * @param overwriteChanges\n   * @param existingError\n   */\n  private resolveConflict(\n    newObject: any,\n    overwriteChanges: boolean,\n    existingError: any\n  ) {\n    this.get(newObject._id).then((existingObject) => {\n      const resolvedObject = this.mergeObjects(existingObject, newObject);\n      if (resolvedObject) {\n        this.alertService.addDebug(\n          \"resolved document conflict automatically (\" +\n            resolvedObject._id +\n            \")\"\n        );\n        this.put(resolvedObject);\n      } else if (overwriteChanges) {\n        this.alertService.addDebug(\n          \"overwriting conflicting document version (\" + newObject._id + \")\"\n        );\n        newObject._rev = existingObject._rev;\n        this.put(newObject);\n      } else {\n        existingError.message = existingError.message + \" (unable to resolve)\";\n        throw existingError;\n      }\n    });\n  }\n\n  private mergeObjects(existingObject: any, newObject: any) {\n    // TODO: implement automatic merging of conflicting entity versions\n    return undefined;\n  }\n}\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { Component, OnInit } from \"@angular/core\";\nimport { MatDialog, MatDialogRef } from \"@angular/material/dialog\";\nimport { DemoDataService } from \"./demo-data.service\";\nimport { LoggingService } from \"../logging/logging.service\";\n\n/**\n * Loading box during demo data generation.\n *\n * see {@link DemoDataModule}\n */\n@Component({\n  template:\n    \"<p>Generating sample data for this demo ...</p>\" +\n    '<mat-progress-bar mode=\"indeterminate\"></mat-progress-bar>',\n})\nexport class DemoDataGeneratingProgressDialogComponent implements OnInit {\n  /**\n   * Display a loading dialog while generating demo data from all register generators.\n   * @param dialog\n   */\n  static loadDemoDataWithLoadingDialog(dialog: MatDialog) {\n    dialog.open(DemoDataGeneratingProgressDialogComponent);\n  }\n\n  constructor(\n    private demoDataService: DemoDataService,\n    private dialogRef: MatDialogRef<DemoDataGeneratingProgressDialogComponent>,\n    private loggingService: LoggingService\n  ) {}\n\n  ngOnInit(): void {\n    this.dialogRef.disableClose = true;\n    this.dialogRef.afterOpened().subscribe(() => {\n      this.demoDataService\n        .publishDemoData()\n        .then(() => {\n          // don't use await this.demoDataService - dialogRef.close doesn't seem to work consistently in that case\n          this.dialogRef.close(true);\n        })\n        .catch((err) =>\n          this.loggingService.error({\n            title: \"error during demo data generation\",\n            details: err,\n          })\n        );\n    });\n  }\n}\n","import { Entity } from \"../entity/entity\";\n\n/**\n * Abstract base class for demo data generator services.\n *\n * For usage refer to the How-To Guides:\n * - [How to Generate Demo Data]{@link /additional-documentation/how-to-guides/generate-demo-data.html}\n */\nexport abstract class DemoDataGenerator<T extends Entity> {\n  /** internally used array of the generated entities */\n  protected _entities: T[];\n\n  /**\n   * generated demo entities\n   */\n  get entities() {\n    if (!this._entities) {\n      this._entities = this.generateEntities();\n    }\n    return this._entities;\n  }\n\n  /**\n   * Generate new demo entities.\n   */\n  protected abstract generateEntities(): T[];\n\n  /**\n   * Remove all previously generated entities.\n   */\n  reset() {\n    delete this._entities;\n  }\n}\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { DemoDataServiceConfig, DemoDataService } from \"./demo-data.service\";\nimport {\n  ClassProvider,\n  FactoryProvider,\n  ModuleWithProviders,\n  NgModule,\n  ValueProvider,\n} from \"@angular/core\";\nimport { DemoDataGeneratingProgressDialogComponent } from \"./demo-data-generating-progress-dialog.component\";\nimport { MatProgressBarModule } from \"@angular/material/progress-bar\";\nimport { MatDialogModule } from \"@angular/material/dialog\";\n\n/**\n * Generate realist mock entities for testing and demo purposes.\n *\n * Import this module in the root AppModule to automatically write demo data into the database on loading of the module.\n * You need to pass providers for {@link DemoDataGenerator} implementations to the `forRoot()` method to register them.\n *\n  ```\n  DemoDataModule.forRoot([\n     ...DemoChildGenerator.provider({count: 150}),\n     { provide: DemoUserGeneratorService, useClass: DemoUserGeneratorService }\n  ])\n  ```\n *\n * In addition to importing the `DemoDataModule` you need to call the {@link DemoDataService}'s `publishDemoData()` method\n * to actually start the data generation.\n * Use `DemoDataGeneratingProgressDialogComponent.loadDemoDataWithLoadingDialog(this.dialog);` passing a `MatDialog` service\n * to display a dialog box to the user and automatically handle the data generation.\n *\n * To implement your own demo data generator, refer to the How-To Guides:\n * - [How to Generate Demo Data]{@link /additional-documentation/how-to-guides/generate-demo-data.html}\n */\n@NgModule({\n  imports: [MatProgressBarModule, MatDialogModule],\n  declarations: [DemoDataGeneratingProgressDialogComponent],\n  exports: [DemoDataGeneratingProgressDialogComponent],\n})\nexport class DemoDataModule {\n  /**\n   * Get a provider for the module while also passing the DemoDataGenerator services to be registered with the module.\n   * @param demoDataGeneratorProviders An array of providers of DemoDataGenerator service implementations.\n   *        These generators will be registered and called when demo data generation is triggered.\n   */\n  static forRoot(\n    demoDataGeneratorProviders: (\n      | ValueProvider\n      | ClassProvider\n      | FactoryProvider\n    )[]\n  ): ModuleWithProviders<DemoDataModule> {\n    return {\n      ngModule: DemoDataModule,\n      providers: [\n        DemoDataService,\n        {\n          provide: DemoDataServiceConfig,\n          useValue: { dataGeneratorProviders: demoDataGeneratorProviders },\n        },\n        demoDataGeneratorProviders,\n      ],\n    };\n  }\n}\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport {\n  ClassProvider,\n  FactoryProvider,\n  Injectable,\n  Injector,\n  ValueProvider,\n} from \"@angular/core\";\nimport { DemoDataGenerator } from \"./demo-data-generator\";\nimport { EntityMapperService } from \"../entity/entity-mapper.service\";\nimport { AlertService } from \"../alerts/alert.service\";\nimport { AlertDisplay } from \"../alerts/alert-display\";\n\n/**\n * General config object to pass all initially register DemoDataGenerators\n * with `DemoDataModule.forRoot()`.\n *\n * see docs at {@link DemoDataModule}\n */\nexport class DemoDataServiceConfig {\n  /**\n   * Providers for DemoDataGenerator service implementations to be registered for data generation.\n   *\n   * This may also include providers for services a DemoDataGenerator depends on.\n   */\n  dataGeneratorProviders: (\n    | ValueProvider\n    | ClassProvider\n    | FactoryProvider\n  )[] = [];\n}\n\n/**\n * The DemoDataService is the manager for all provided DemoDataGenerator implementations.\n * It serves as the central service to trigger the demo data generation into the database.\n *\n * To add more demo data generators, refer the documentation\n * [How to Generate Demo Data]{@link /additional-documentation/how-to-guides/generate-demo-data.html}\n */\n@Injectable()\nexport class DemoDataService {\n  /** All registered demo data generator services */\n  readonly dataGenerators: DemoDataGenerator<any>[] = [];\n\n  constructor(\n    private entityMapper: EntityMapperService,\n    private alertService: AlertService,\n    private injector: Injector,\n    private config: DemoDataServiceConfig\n  ) {\n    this.registerAllProvidedDemoDataGenerators();\n  }\n\n  private registerAllProvidedDemoDataGenerators() {\n    for (const provider of this.config.dataGeneratorProviders) {\n      const service = this.injector.get<any>(provider.provide);\n      if (service && service instanceof DemoDataGenerator) {\n        this.dataGenerators.push(service);\n      }\n    }\n  }\n\n  /**\n   * Trigger all registered DemoDataGenerator implementations to generate demo entities\n   * and add all the generated entities to the Database.\n   */\n  async publishDemoData() {\n    // completely generate all data (i.e. call every generator) before starting to save the data\n    // to allow generators to delete unwanted entities of other generators before they are saved\n    // (e.g. the DropoutChildGenerator should be able to delete Attendance records of the Child after its dropout date)\n    this.dataGenerators.forEach((generator) => generator.entities);\n\n    // save the generated data\n    for (const generator of this.dataGenerators) {\n      for (const entity of generator.entities) {\n        try {\n          await this.entityMapper.save(entity);\n        } catch (e) {\n          this.alertService.addWarning(e, AlertDisplay.NONE);\n        }\n      }\n    }\n  }\n}\n","import * as originalFaker_IND from \"faker/locale/en_IND\";\n\n/**\n * Extension of faker.js implementing additional data generation methods.\n */\nclass CustomFaker {\n  /**\n   * Merge the created CustomFaker's implementation with a given faker's standard methods.\n   * @param baseFaker A standard faker.js\n   */\n  constructor(\n    // @ts-ignore\n    private baseFaker: Faker.FakerStatic\n  ) {\n    // make baseFaker methods available from instances of this class\n    Object.assign(this, baseFaker);\n  }\n\n  /**\n   * Generate a date that works as a date of birth in the given age range.\n   * @param minAge The minimum age (today) of a person with the generated random birth date.\n   * @param maxAge The maximum age (today) of a person with the generated random birth date.\n   */\n  public dateOfBirth(minAge: number, maxAge: number): Date {\n    const currentYear = new Date().getFullYear();\n    const latest = new Date();\n    latest.setFullYear(currentYear - minAge);\n    const earliest = new Date();\n    earliest.setFullYear(currentYear - maxAge);\n    return this.baseFaker.date.between(earliest, latest);\n  }\n\n  /**\n   * Return the given date if it is defined and earlier than today's date\n   * otherwise return a Date representing today.\n   * @param date The date to be compared\n   */\n  getEarlierDateOrToday(date: Date): Date {\n    const today = new Date();\n\n    if (!date || date > today) {\n      return today;\n    } else {\n      return date;\n    }\n  }\n}\n\n/**\n * Typing for faker including extended functionality.\n */\nexport type Faker = typeof originalFaker_IND & CustomFaker;\n\noriginalFaker_IND.seed(1);\n\n/**\n * (Extended) faker module\n */\nexport const faker = new CustomFaker(originalFaker_IND) as Faker;\n","import { NgModule } from \"@angular/core\";\nimport { CommonModule } from \"@angular/common\";\nimport { MatAutocompleteModule } from \"@angular/material/autocomplete\";\nimport { MatButtonModule } from \"@angular/material/button\";\nimport { MatDialogModule } from \"@angular/material/dialog\";\nimport { MatIconModule } from \"@angular/material/icon\";\nimport { MatInputModule } from \"@angular/material/input\";\nimport { MatSelectModule } from \"@angular/material/select\";\nimport { MatSnackBarModule } from \"@angular/material/snack-bar\";\nimport { MatSortModule } from \"@angular/material/sort\";\nimport { MatTableModule } from \"@angular/material/table\";\nimport { EntitySubrecordComponent } from \"./entity-subrecord/entity-subrecord.component\";\nimport { KeysPipe } from \"./keys-pipe/keys.pipe\";\nimport { MatDatepickerModule } from \"@angular/material/datepicker\";\nimport { ConfirmationDialogModule } from \"../confirmation-dialog/confirmation-dialog.module\";\nimport { FormDialogModule } from \"../form-dialog/form-dialog.module\";\n\n/**\n * EntitySubrecord provides generic components to display and edit a list of entities\n * which are related to the \"primary\" entity whose details are currently displayed.\n *\n * For example, all Notes related to a certain Child are displayed within the Child's detail view\n * with the help of the {@link EntitySubrecordComponent}.\n */\n@NgModule({\n  imports: [\n    CommonModule,\n    MatDialogModule,\n    MatButtonModule,\n    MatTableModule,\n    MatInputModule,\n    MatSelectModule,\n    MatIconModule,\n    MatSnackBarModule,\n    MatSortModule,\n    MatAutocompleteModule,\n    MatDatepickerModule,\n    FormDialogModule,\n    ConfirmationDialogModule,\n  ],\n  declarations: [EntitySubrecordComponent, KeysPipe],\n  exports: [EntitySubrecordComponent, KeysPipe],\n})\nexport class EntitySubrecordModule {}\n","/**\n * Input types available for columns generated by the {@link EntitySubrecordComponent}.\n * Defines what form field is offered to the user to edit the column's value.\n */\nexport enum ColumnDescriptionInputType {\n  TEXT = \"text\",\n  NUMBER = \"number\",\n  DATE = \"date\",\n  MONTH = \"month\",\n  TEXTAREA = \"textarea\",\n  SELECT = \"select\",\n  AUTOCOMPLETE = \"autocomplete\",\n  FUNCTION = \"function\",\n  READONLY = \"readonly\",\n}\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { ColumnDescriptionInputType } from \"./column-description-input-type.enum\";\n\n/**\n *  Objects of this class are used to define columns for the {@link EntitySubrecordComponent}.\n *  A ColumnDescription describes a single column to be generated in that generic component.\n */\nexport class ColumnDescription {\n  /**\n   * @param name The identifier of the column\n   * @param label The label for the column displayed in the table header\n   * @param inputType How the value of this column is displayed and what kind of form field is provided to edit it\n   * @param selectValues Array of possible values for editing this column; required for inputTypes select and autocomplete\n   * @param formatter Function doing a custom transformation of the column's value before it is displayed.\n   * @param visibleFrom The minimal screen size the column is shown.\n   *           screen size classes: xs\t'screen and (max-width: 599px)'\n   *           sm\t'screen and (min-width: 600px) and (max-width: 959px)'\n   *           md\t'screen and (min-width: 960px) and (max-width: 1279px)'\n   *           lg\t'screen and (min-width: 1280px) and (max-width: 1919px)'\n   *           xl\t'screen and (min-width: 1920px) and (max-width: 5000px)'\n   * @param styleBuilder (Optional) function building a ngStyle value, receiving the value as a parameter\n   */\n  constructor(\n    public name: string,\n    public label: string,\n    public inputType: ColumnDescriptionInputType,\n\n    public selectValues: Array<{ value: any; label: string }> = [],\n\n    public formatter = (value) => {\n      return value;\n    },\n    public visibleFrom: string = undefined,\n    public styleBuilder: (value) => Object = () => {\n      return {};\n    }\n  ) {}\n}\n","<table mat-table [dataSource]=\"recordsDataSource\" matSort class=\"mat-elevation-z8 subrecord-table\">\n\n  <ng-container *ngFor=\"let col of columns\" [matColumnDef]=\"col.name\">\n    <th mat-header-cell *matHeaderCellDef mat-sort-header> {{col.label}} </th>\n    <td mat-cell *matCellDef=\"let rec\"\n        (click)='showRecord(rec)' [ngClass]=\"{'table-link': detailsComponent!==undefined}\">\n\n      <div *ngIf=\"col.inputType === 'function'\" class='table-show-number'>\n        {{ col.formatter( rec[col.name].bind(rec)() ) }}\n      </div>\n\n      <div *ngIf=\"col.inputType === 'readonly'\" class='table-show-number'>\n        {{ col.formatter( rec[col.name] ) }}\n      </div>\n\n\n      <div *ngIf=\"!recordsEditing.get(rec.getId()) && !isReadonlyInputType(col.inputType)\"\n           [ngStyle]=\"col.styleBuilder ? col.styleBuilder(rec[col.name]) : {}\"\n           [ngClass]=\"{ 'table-show-number': col.inputType==='number' }\">\n        {{ col.formatter(rec[col.name]) }}\n      </div>\n\n      <div *ngIf=\"recordsEditing.get(rec.getId()) &&  !isReadonlyInputType(col.inputType)\">\n        <mat-form-field [ngClass]=\"{\n            'table-input-number': col.inputType === 'number',\n            'table-input-month': col.inputType === 'month' || col.inputType === 'date'\n            }\">\n\n          <input *ngIf=\"col.inputType === 'text'\"\n                 matInput type=\"text\" [title]=\"col.label\" [value]=\"rec[col.name]\" (change)=\"rec[col.name]=$event.target.value\">\n\n          <input *ngIf=\"col.inputType === 'number'\"\n                 matInput type=\"number\" min=\"0\" [title]=\"col.label\" [value]=\"rec[col.name]\" (change)=\"rec[col.name]=$event.target.valueAsNumber\">\n\n          <input *ngIf=\"col.inputType === 'date'\"\n                 matInput [title]=\"col.label\" [value]=\"rec[col.name]\" (dateChange)=\"rec[col.name]=$event.target.value\"  [matDatepicker]=\"subrecordDatepicker\">\n          <mat-datepicker-toggle *ngIf=\"col.inputType === 'date'\" matSuffix [for]=\"subrecordDatepicker\"></mat-datepicker-toggle>\n          <mat-datepicker #subrecordDatepicker ></mat-datepicker>\n\n          <input *ngIf=\"col.inputType === 'month'\"\n                 matInput type=\"month\" [title]=\"col.label\" [valueAsDate]=\"rec[col.name]\" (change)=\"rec[col.name]=$event.target.valueAsDate\">\n\n          <textarea *ngIf=\"col.inputType === 'textarea'\"\n                    matInput [title]=\"col.label\" [value]=\"rec[col.name]\" (change)=\"rec[col.name]=$event.target.value\"></textarea>\n\n          <mat-select *ngIf=\"col.inputType === 'select'\" [(value)]=\"rec[col.name]\">\n            <mat-option *ngFor='let option of col.selectValues' [value]=\"option.value\">{{option.label}}</mat-option>\n          </mat-select>\n\n          <span *ngIf=\"col.inputType === 'autocomplete'\">\n            <input [matAutocomplete]=\"auto\" (input)=\"autocompleteSearch(col, $event.target.value)\"\n                   matInput type=\"text\" [title]=\"col.label\" [value]=\"rec[col.name]\" (change)=\"rec[col.name]=$event.target.value\">\n            <mat-autocomplete #auto=\"matAutocomplete\" (optionSelected)=\"rec[col.name]=$event.option.value\">\n              <mat-option *ngFor=\"let option of col.selectValues\" [value]=\"option.value\">{{option.label}}</mat-option>\n            </mat-autocomplete>\n          </span>\n\n        </mat-form-field>\n      </div>\n    </td>\n  </ng-container>\n\n\n  <ng-container matColumnDef=\"actions\">\n    <th mat-header-cell *matHeaderCellDef >\n      <button *ngIf=\"showAddButton\" mat-stroked-button class=\"table-action-button\" color=\"accent\" (click)=\"create()\">\n        <mat-icon class=\"table-action-icon\" aria-label=\"add\" fontIcon=\"fa-plus-circle\"></mat-icon>\n        <!-- fxHide.md=\"false\">Add New -->\n      </button>\n    </th>\n    <td mat-cell *matCellDef=\"let rec\">\n      <button mat-icon-button *ngIf=\"!recordsEditing.get(rec.getId())\" (click)=\"recordsEditing.set(rec.getId(), true)\">\n        <mat-icon class=\"table-action-icon\" aria-label=\"edit\" fontIcon=\"fa-pencil\"></mat-icon>\n      </button>\n      <button mat-icon-button *ngIf=\"recordsEditing.get(rec.getId())\" (click)=\"save(rec)\">\n        <mat-icon class=\"table-action-icon\" aria-label=\"save\" fontIcon=\"fa-check-circle\"></mat-icon>\n      </button>\n      <button mat-icon-button *ngIf=\"recordsEditing.get(rec.getId())\" (click)=\"resetChanges(rec)\">\n        <mat-icon class=\"table-action-icon\" aria-label=\"cancel\" fontIcon=\"fa-times-circle\"></mat-icon>\n      </button>\n      <button mat-icon-button (click)=\"delete(rec)\">\n        <mat-icon class=\"table-action-icon\" aria-label=\"delete\" fontIcon=\"fa-trash\"></mat-icon>\n      </button>\n    </td>\n  </ng-container>\n\n\n  <tr mat-header-row *matHeaderRowDef=\"columnsToDisplay\"></tr>\n  <tr mat-row *matRowDef=\"let rec; columns: columnsToDisplay\"\n      [ngStyle]=\"{'background-color': getColor(rec)}\">\n  </tr>\n</table>\n","import {\n  Component,\n  Input,\n  OnChanges,\n  OnInit,\n  SimpleChanges,\n  ViewChild,\n  Output,\n  EventEmitter,\n} from \"@angular/core\";\nimport { MatSnackBar } from \"@angular/material/snack-bar\";\nimport { MatSort } from \"@angular/material/sort\";\nimport { MatTableDataSource } from \"@angular/material/table\";\nimport { Entity } from \"../../entity/entity\";\nimport { EntityMapperService } from \"../../entity/entity-mapper.service\";\nimport { ColumnDescription } from \"./column-description\";\nimport { MediaChange, MediaObserver } from \"@angular/flex-layout\";\nimport { AlertService } from \"app/core/alerts/alert.service\";\nimport { FormValidationResult } from \"./form-validation-result\";\nimport { ConfirmationDialogService } from \"../../confirmation-dialog/confirmation-dialog.service\";\nimport { ColumnDescriptionInputType } from \"./column-description-input-type.enum\";\nimport { ComponentType } from \"@angular/cdk/overlay\";\nimport { FormDialogService } from \"../../form-dialog/form-dialog.service\";\nimport { ShowsEntity } from \"../../form-dialog/shows-entity.interface\";\nimport { UntilDestroy, untilDestroyed } from \"@ngneat/until-destroy\";\n\n/**\n * Generically configurable component to display and edit a list of entities in a compact way\n * that can especially be used within another entity's details view to display related entities.\n *\n * For example, all Notes related to a certain Child are displayed within the Child's detail view\n * with the help of this component.\n *\n * A detailed Guide on how to use this component is available:\n * - [How to display related entities]{@link /additional-documentation/how-to-guides/display-related-entities.html}\n */\n@UntilDestroy()\n@Component({\n  selector: \"app-entity-subrecord\",\n  templateUrl: \"./entity-subrecord.component.html\",\n  styleUrls: [\"./entity-subrecord.component.scss\"],\n})\nexport class EntitySubrecordComponent implements OnInit, OnChanges {\n  /** data to be displayed */\n  @Input() records: Array<Entity>;\n\n  /** configuration what kind of columns to be generated for the table */\n  @Input() columns: Array<ColumnDescription>;\n\n  /**\n   * factory method to create a new instance of the displayed Entity type\n   * used when the user adds a new entity to the list.\n   */\n  @Input() newRecordFactory: () => Entity;\n\n  /**\n   * A Component to be used to display a detailed view or form of a single instance of the displayed entities.\n   * This is displayed as a modal (hovering) dialog above the active view and allows the user to get\n   * more information or more comfortable editing of a single record.\n   */\n  @Input() detailsComponent: ComponentType<ShowsEntity>;\n\n  /**\n   * Whether an \"Add\" button to create a new entry should be displayed as part of the form.\n   * Default is \"true\".\n   */\n  @Input() showAddButton = true;\n\n  /**\n   * Optional function implementing form validation logic that takes an entity instance, checks it and returns\n   * a {@link FormValidationResult} that is then handled by the EntitySubrecordComponent.\n   */\n  @Input() formValidation?: (record: Entity) => FormValidationResult;\n\n  /**\n   * Event whenever an entity in this table is changed.\n   */\n  @Output() changedRecordsInEntitySubrecordEvent = new EventEmitter<any>();\n\n  /** id of the parent entity of the records being displayed. May be used for custom display logic. */\n  @Input() entityId?: string;\n\n  /** data displayed in the template's table */\n  recordsDataSource = new MatTableDataSource();\n  /** columns displayed in the template's table */\n  columnsToDisplay = [];\n\n  /** map of entities' ids and whether this record's table row is currently in edit mode */\n  recordsEditing = new Map<string, boolean>();\n  /** backup copies of the original state of records to allow reset */\n  private originalRecords = [];\n\n  private screenWidth = \"\";\n\n  @ViewChild(MatSort) sort: MatSort;\n\n  constructor(\n    private _entityMapper: EntityMapperService,\n    private _snackBar: MatSnackBar,\n    private _confirmationDialog: ConfirmationDialogService,\n    private formDialog: FormDialogService,\n    private alertService: AlertService,\n    private media: MediaObserver\n  ) {\n    this.media.media$\n      .pipe(untilDestroyed(this))\n      .subscribe((change: MediaChange) => {\n        if (change.mqAlias !== this.screenWidth) {\n          this.screenWidth = change.mqAlias;\n          this.setupTable();\n        }\n      });\n  }\n\n  ngOnInit() {\n    this.recordsDataSource.sort = this.sort;\n  }\n\n  /**\n   * Update the component if any of the @Input properties were changed from outside.\n   * @param changes\n   */\n  ngOnChanges(changes: SimpleChanges) {\n    if (changes[\"records\"] && this.records !== undefined) {\n      this.recordsDataSource.data = this.records;\n\n      this.records.forEach((e) =>\n        this.originalRecords.push(Object.assign({}, e))\n      );\n    }\n    if (changes[\"columns\"]) {\n      this.columnsToDisplay = this.columns.map((e) => e.name);\n      this.columnsToDisplay.push(\"actions\");\n      this.setupTable();\n    }\n  }\n\n  /**\n   * Save an edited record to the database (if validation succeeds).\n   * @param record The entity to be saved.\n   */\n  save(record: Entity) {\n    if (this.formValidation) {\n      const formValidationResult = this.formValidation(record);\n      if (!formValidationResult.hasPassedValidation) {\n        this.alertService.addWarning(formValidationResult.validationMessage);\n        return;\n      }\n    }\n\n    this._entityMapper.save(record).then(() => {\n      this.changedRecordsInEntitySubrecordEvent.emit();\n    });\n\n    // updated backup copies used for reset\n    const i = this.originalRecords.findIndex(\n      (e) => e.entityId === record.getId()\n    );\n    this.originalRecords[i] = Object.assign({}, record);\n\n    this.recordsEditing.set(record.getId(), false);\n  }\n\n  /**\n   * Discard any changes to the given entity and reset it to the state before the user started editing.\n   * @param record The entity to be reset.\n   */\n  resetChanges(record: Entity) {\n    // reload original record from database\n    const index = this.records.findIndex((a) => a.getId() === record.getId());\n    if (index > -1) {\n      const originalRecord = this.originalRecords.find(\n        (e) => e.entityId === record.getId()\n      );\n      Object.assign(record, originalRecord);\n      this.records[index] = record;\n      this.recordsDataSource.data = this.records;\n    }\n\n    this.recordsEditing.set(record.getId(), false);\n  }\n\n  private removeFromDataTable(record: Entity) {\n    const index = this.records.findIndex((a) => a.getId() === record.getId());\n    if (index > -1) {\n      this.records.splice(index, 1);\n      this.recordsDataSource.data = this.records;\n    }\n  }\n\n  /**\n   * Delete the given entity from the database (after explicit user confirmation).\n   * @param record The entity to be deleted.\n   */\n  delete(record: Entity) {\n    const dialogRef = this._confirmationDialog.openDialog(\n      \"Delete?\",\n      \"Are you sure you want to delete this record?\"\n    );\n\n    dialogRef.afterClosed().subscribe((confirmed) => {\n      if (confirmed) {\n        this._entityMapper.remove(record).then(() => {\n          this.changedRecordsInEntitySubrecordEvent.emit();\n        });\n        this.removeFromDataTable(record);\n\n        const snackBarRef = this._snackBar.open(\"Record deleted\", \"Undo\", {\n          duration: 8000,\n        });\n        snackBarRef.onAction().subscribe(() => {\n          this._entityMapper.save(record, true);\n          this.records.unshift(record);\n          this.recordsDataSource.data = this.records;\n        });\n      }\n    });\n  }\n\n  /**\n   * Create a new entity.\n   * The entity is only written to the database when the user saves this record which is newly added in edit mode.\n   */\n  create() {\n    const newRecord = this.newRecordFactory();\n\n    this.records.unshift(newRecord);\n    this.originalRecords.unshift(Object.assign({}, newRecord));\n    this.recordsDataSource.data = this.records;\n\n    if (this.detailsComponent === undefined) {\n      // edit inline in table\n      this.recordsEditing.set(newRecord.getId(), true);\n    } else {\n      // open in modal for comfortable editing\n      this.showRecord(newRecord);\n    }\n  }\n\n  /**\n   * Show one record's details in a modal dialog (if configured).\n   * @param record The entity whose details should be displayed.\n   */\n  showRecord(record: Entity) {\n    if (\n      this.detailsComponent === undefined ||\n      this.recordsEditing.get(record.getId())\n    ) {\n      return;\n    }\n    this.formDialog.openDialog(this.detailsComponent, record);\n  }\n\n  autocompleteSearch(col, input) {\n    if (col.allSelectValues === undefined) {\n      col.allSelectValues = col.selectValues;\n    }\n    col.selectValues = col.allSelectValues.filter(\n      (v) => v.value.includes(input) || v.label.includes(input)\n    );\n  }\n\n  /**\n   * resets columnsToDisplay depending on current screensize\n   */\n  setupTable() {\n    if (this.columns !== undefined && this.screenWidth !== \"\") {\n      const columnsHelpArray = [];\n      const entitySubrecordComponent = this;\n      this.columns.forEach(function (this, col) {\n        if (entitySubrecordComponent.isVisible(col)) {\n          columnsHelpArray.push(col.name);\n        }\n      });\n      this.columnsToDisplay = columnsHelpArray;\n      if (this.screenWidth !== \"xs\") {\n        this.columnsToDisplay.push(\"actions\");\n      }\n    }\n  }\n\n  /**\n   * isVisible\n   * compares the current screensize to the columns' property visibleFrom. screensize < visibleFrom? column not displayed\n   * @param col column that is checked\n   * @return returns true if column is visible\n   */\n  isVisible(col) {\n    let returnVal;\n    switch (col.visibleFrom) {\n      case \"xl\": {\n        returnVal = this.screenWidth.match(\"xl\");\n        break;\n      }\n      case \"lg\": {\n        returnVal = this.screenWidth.match(\"(lg|xl)\");\n        break;\n      }\n      case \"md\": {\n        returnVal = this.screenWidth.match(\"(md|lg|xl)\");\n        break;\n      }\n      case \"sm\": {\n        returnVal = this.screenWidth.match(\"(sm|md|lg|xl)\");\n        break;\n      }\n      default: {\n        returnVal = true;\n      }\n    }\n    return returnVal;\n  }\n\n  /**\n   * Checks whether the given column configuration's input type is readonly\n   * and therefore not changing its template in edit mode.\n   * @param inputType The input type to be checked.\n   */\n  isReadonlyInputType(inputType: ColumnDescriptionInputType): boolean {\n    return (\n      inputType === ColumnDescriptionInputType.FUNCTION ||\n      inputType === ColumnDescriptionInputType.READONLY\n    );\n  }\n\n  /**\n   * returns the color for a record.\n   * If this entity id is undefined, this will return the default color. Otherwise it will attempt\n   * to get a specific color for this specific entity id\n   * @param record The record to check for. The record must be an entity that has a <code>getColor()</code>-Method specified.\n   * If this entityId is set, a <code>getColorForId()</code>-Method must be specified, that accepts this id.\n   */\n  getColor(record) {\n    if (this.entityId !== undefined) {\n      return record.getColorForId(this.entityId);\n    }\n    return record.getColor();\n  }\n}\n","import { Pipe, PipeTransform } from \"@angular/core\";\n\n/**\n * Angular Pipe to transform a given object to an array of the object's keys.\n *\n * @example in a template to display keys of an enum:\n * `*ngFor=\"let g of enumGenders | keys\"`\n */\n@Pipe({\n  name: \"keys\",\n})\nexport class KeysPipe implements PipeTransform {\n  transform(value: any, args?: any): any {\n    const keys = [];\n    for (const enumMember of Object.keys(value)) {\n      keys.push({ key: enumMember, value: value[enumMember] });\n    }\n    return keys;\n  }\n}\n","/**\n * Decorator (Annotation `@DatabaseEntity()`) to set the string ENTITY_TYPE to an Entity Type.\n *\n * also see {@link /additional-documentation/how-to-guides/create-a-new-entity-type.html}\n *\n * @param entityType The string key for this Entity Type, used as id prefix.\n */\nexport function DatabaseEntity(entityType: string) {\n  return (constructor) => {\n    constructor.ENTITY_TYPE = entityType;\n\n    // append parent schema definitions\n    const parentConstructor = Object.getPrototypeOf(constructor);\n    parentConstructor.schema.forEach((value, key) =>\n      constructor.schema.set(key, value)\n    );\n  };\n}\n","import \"reflect-metadata\";\nimport { EntitySchemaField } from \"./schema/entity-schema-field\";\n\n/**\n * Decorator (Annotation `@DatabaseField()`) to mark a property of an Entity that should be persisted in the database.\n *\n * also see {@link /additional-documentation/how-to-guides/create-a-new-entity-type.html}\n *\n * @param propertySchema (optional) SchemaField definition that configures additional options regarding this field\n */\nexport function DatabaseField(propertySchema: EntitySchemaField = {}) {\n  return (target, propertyName: string) => {\n    target[propertyName] = undefined; // This ensures that the field is not read only\n\n    if (propertySchema.dataType === undefined) {\n      propertySchema.dataType = Reflect.getMetadata(\n        \"design:type\",\n        target,\n        propertyName\n      ).name.toLowerCase();\n    }\n\n    if (Object.getOwnPropertyDescriptor(target.constructor, \"schema\") == null) {\n      target.constructor.schema = new Map<string, EntitySchemaField>();\n    }\n    target.constructor.schema.set(propertyName, propertySchema);\n\n    return target;\n  };\n}\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { Injectable } from \"@angular/core\";\nimport { Database } from \"../../database/database\";\nimport { BehaviorSubject, Observable } from \"rxjs\";\nimport { BackgroundProcessState } from \"../../sync-status/background-process-state.interface\";\n\n/**\n * Manage database query index creation and use, working as a facade in front of the Database service.\n * This allows to track pending indexing processes and also show them to users in the UI.\n */\n@Injectable({\n  providedIn: \"root\",\n})\nexport class DatabaseIndexingService {\n  private _indicesRegistered = new BehaviorSubject<BackgroundProcessState[]>(\n    []\n  );\n\n  /** All currently registered indices with their status */\n  get indicesRegistered(): Observable<BackgroundProcessState[]> {\n    return this._indicesRegistered.asObservable();\n  }\n\n  constructor(private db: Database) {}\n\n  /**\n   * Register a new database query to be created/updated and indexed.\n   *\n   * This also triggers updates to the observable `indicesRegistered`.\n   *\n   * @param designDoc The design document (see @link{Database}) describing the query/index.\n   */\n  async createIndex(designDoc: any): Promise<void> {\n    const indexState: BackgroundProcessState = {\n      title: \"Preparing data (Indexing)\",\n      details: designDoc._id.replace(/_design\\//, \"\"),\n      pending: true,\n    };\n    const indexCreationPromise = this.db.saveDatabaseIndex(designDoc);\n    this._indicesRegistered.next([\n      ...this._indicesRegistered.value,\n      indexState,\n    ]);\n\n    try {\n      await indexCreationPromise;\n    } catch (err) {\n      indexState.pending = false;\n      indexState.error = err;\n      this._indicesRegistered.next(this._indicesRegistered.value);\n      throw err;\n    }\n\n    indexState.pending = false;\n    this._indicesRegistered.next(this._indicesRegistered.value);\n  }\n\n  /**\n   * Load data from the Database through the given, previously created index.\n   * @param indexName The name of the previously created index to be queried.\n   * @param options Additional query options (see @link{Database})\n   */\n  queryIndex(indexName: string, options?: any) {\n    return this.db.query(indexName, options);\n  }\n}\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { Injectable } from \"@angular/core\";\nimport { Database } from \"../database/database\";\nimport { Entity, EntityConstructor } from \"./entity\";\nimport { EntitySchemaService } from \"./schema/entity-schema.service\";\n\n/**\n * Handles loading and saving of data for any higher-level feature module.\n * The EntityMapperService implicitly transforms objects from instances of Entity classes to the format to be written\n * to the database and back - ensuring they you always receive instances of {@link Entity} subclasses, that you can\n * simply treat them as normal javascript class instances without worrying about database persistance logic.\n *\n * To understand more about how to use the Entity system in your own modules, refer to the How-To Guides:\n * - [How to Load and Save Data]{@link /additional-documentation/how-to-guides/load-and-save-data.html}\n * - [How to Create a new Entity Type]{@link /additional-documentation/how-to-guides/create-a-new-entity-type.html}\n */\n@Injectable()\nexport class EntityMapperService {\n  constructor(\n    private _db: Database,\n    private entitySchemaService: EntitySchemaService\n  ) {}\n\n  /**\n   * Load an Entity from the database with the given id.\n   *\n   * @param entityType Class that implements Entity, which is the type of Entity the results should be transformed to\n   * @param id The id of the entity to load\n   * @returns A Promise resolving to an instance of entityType filled with its data.\n   */\n  public async load<T extends Entity>(\n    entityType: EntityConstructor<T>,\n    id: string\n  ): Promise<T> {\n    const resultEntity = new entityType(\"\");\n    const result = await this._db.get(\n      Entity.createPrefixedId(resultEntity.getType(), id)\n    );\n    this.entitySchemaService.loadDataIntoEntity(resultEntity, result);\n    return resultEntity;\n  }\n\n  /**\n   * Load all entities from the database of the given type (for example a list of entities of the type User).\n   *\n   * @param entityType Class that implements Entity, which is the type of Entity the results should be transformed to\n   * @returns A Promise resolving to an array of instances of entityType with the data of the loaded entities.\n   */\n  public async loadType<T extends Entity>(\n    entityType: EntityConstructor<T>\n  ): Promise<T[]> {\n    const resultArray: Array<T> = [];\n\n    const allRecordsOfType = await this._db.getAll(\n      new entityType(\"\").getType() + \":\"\n    );\n\n    for (const record of allRecordsOfType) {\n      const entity = new entityType(\"\");\n      this.entitySchemaService.loadDataIntoEntity(entity, record);\n      resultArray.push(entity);\n    }\n\n    return resultArray;\n  }\n\n  /**\n   * Save an entity to the database after transforming it to its database representation.\n   * @param entity The entity to be saved\n   * @param forceUpdate Optional flag whether any conflicting version in the database will be quietly overwritten.\n   *          if a conflict occurs without the forceUpdate flag being set, the save will fail, rejecting the returned promise.\n   */\n  public async save<T extends Entity>(\n    entity: T,\n    forceUpdate: boolean = false\n  ): Promise<any> {\n    const rawData = this.entitySchemaService.transformEntityToDatabaseFormat(\n      entity\n    );\n    const result = await this._db.put(rawData, forceUpdate);\n    if (result.ok) {\n      entity._rev = result.rev;\n    }\n    return result;\n  }\n\n  /**\n   * Delete an entity from the database.\n   * @param entity The entity to be deleted\n   */\n  public remove<T extends Entity>(entity: T): Promise<any> {\n    return this._db.remove(entity);\n  }\n}\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { NgModule } from \"@angular/core\";\nimport { CommonModule } from \"@angular/common\";\nimport { EntityMapperService } from \"./entity-mapper.service\";\nimport { EntitySchemaService } from \"./schema/entity-schema.service\";\n\n/**\n * Generic system to manage saving and loading documents with the database\n * while offering certain transformations between the object and the database representation.\n * A key part of this is to return instances of {@link Entity} subclasses to other modules of the app\n * which can simply treat them as normal javascript class instances without worrying about database persistance logic.\n *\n * The main service used by other modules is {@link EntityMapperService}, which provides functions to load, save and query\n * data from the database (and return it after transformation to the correct Entity instances).\n *\n * The Entity schema system allows you to use annotations in the Entity classes to define which properties\n * are saved to the database, how they are transformed and which properties are ignored when writing to the database.\n * This is handled by the {@link EntitySchemaService} (which is internally used by the EntityMapperService.\n * You can register your own custom data-type transformations with the EntitySchemaService as well.\n *\n * To understand how to use the Entity system in your own modules, refer to the How-To Guides:\n * - [How to Load and Save Data]{@link /additional-documentation/how-to-guides/load-and-save-data.html}\n * - [How to Create a new Entity Type]{@link /additional-documentation/how-to-guides/create-a-new-entity-type.html}\n */\n@NgModule({\n  imports: [CommonModule],\n  declarations: [],\n  providers: [EntityMapperService, EntitySchemaService],\n})\nexport class EntityModule {}\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { EntitySchema } from \"./schema/entity-schema\";\nimport { DatabaseField } from \"./database-field.decorator\";\nimport {\n  WarningLevel,\n  WarningLevelColor,\n} from \"../../child-dev-project/warning-level\";\n\n/**\n * This represents a static class of type <T>.\n * It can be used for passing a class from which new objects should be created.\n * For example usage check the {@link EntityMapperService}.\n */\nexport type EntityConstructor<T extends Entity> = new (id: string) => T;\n\n/**\n * \"Entity\" is a base class for all domain model classes.\n * It implements the basic general properties and methods that are required for all Entity types\n * e.g. supporting the Entity Schema system or basic database logic.\n *\n * Entity classes do not deal with database actions, use {@link EntityMapperService} with its find/save/delete functions.\n *\n * Do not use the Entity class directly. Instead implement your own Entity types, writing classes that extend \"Entity\".\n * A How-To Guide on how to implement your own types is available:\n * - [How to Create a new Entity Type]{@link /additional-documentation/how-to-guides/create-a-new-entity-type.html}\n */\nexport class Entity {\n  /**\n   * The entity's type.\n   * In classes extending Entity this is usually overridden by the class annotation `@DatabaseEntity('NewEntity')`.\n   */\n  static ENTITY_TYPE = \"Entity\";\n\n  /**\n   * EntitySchema defining property transformations from/to the database.\n   * This is auto-generated from the property annotations `@DatabaseField()`.\n   *\n   * see {@link /additional-documentation/how-to-guides/create-a-new-entity-type.html}\n   */\n  static schema: EntitySchema;\n\n  /**\n   * Extract the ENTITY_TYPE from an id.\n   * @param id An entity's id including prefix.\n   */\n  static extractTypeFromId(id: string): string {\n    const split = id.indexOf(\":\");\n    return id.substring(0, split);\n  }\n\n  /**\n   * Extract entityId without prefix.\n   * @param id An entity's id including prefix.\n   */\n  static extractEntityIdFromId(id: string): string {\n    const split = id.indexOf(\":\");\n    return id.substring(split + 1);\n  }\n\n  /**\n   * Create a prefixed id by adding the type prefix if it isn't already part of the given id.\n   * @param type The type prefix to be added.\n   * @param id The id to be extended with a prefix.\n   */\n  static createPrefixedId(type: string, id: string): string {\n    id = String(id);\n    const prefix = type + \":\";\n    if (!id.startsWith(prefix)) {\n      return prefix + id;\n    } else {\n      return id;\n    }\n  }\n\n  /**\n   * Internal database id.\n   * This is usually combined from the ENTITY_TYPE as a prefix with the entityId field `EntityType:entityId`\n   * @example \"Entity:123\"\n   */\n  @DatabaseField() _id: string;\n\n  /** internal database doc revision, used to detect conflicts by PouchDB/CouchDB */\n  @DatabaseField() _rev: string;\n\n  /** actual id without prefix */\n  get entityId(): string {\n    return Entity.extractEntityIdFromId(this._id);\n  }\n\n  /**\n   * Set id without prefix.\n   * @param newEntityId The new id without prefix.\n   */\n  set entityId(newEntityId: string) {\n    this._id = Entity.createPrefixedId(this.getType(), newEntityId);\n  }\n\n  /**\n   * Creates an entity object with the given id. This id is final and won't be changeable after this object has been\n   * created.\n   *\n   * @param id a unique id for this entity\n   */\n  constructor(id: string) {\n    this.entityId = id;\n  }\n\n  /**\n   * Get the class (Entity or the actual subclass of the instance) to call static methods on the correct class considering inheritance\n   */\n  getConstructor(): typeof Entity {\n    return <typeof Entity>this.constructor;\n  }\n\n  /**\n   * Returns the id of this entity.\n   *\n   * Note that an id is final and can't be changed after the object has been instantiated, hence there is no\n   * <code>setId()</code> method.\n   *\n   * @returns {string} the unique id of this entity\n   */\n  public getId(): string {\n    return this.entityId;\n  }\n\n  /**\n   * Returns the type which is used to categorize this entity in the database.\n   *\n   * <b>Important: Do not overwrite this method! Types are handled internally.</b>\n   *\n   * @returns {string} the entity's type (which is the class name).\n   */\n  public getType(): string {\n    return this.getConstructor().ENTITY_TYPE;\n  }\n\n  /**\n   * Returns a string representation or summary of the instance.\n   *\n   * <b>Important: Overwrite this method in subtypes!</b>\n   *\n   * @returns {string} the instance's string representation.\n   */\n  public toString(): string {\n    return this.getId();\n  }\n\n  /**\n   * Returns an array of strings by which the entity can be searched.\n   *\n   * By default the parts of the \"name\" property (split at spaces) is used if it is present.\n   *\n   * <b>Overwrite this method in subtypes if you want an entity type to be searchable by other properties.</b>\n   *\n   * @returns {string[]} an array of strings through which the entity can be searched.\n   */\n  public generateSearchIndices(): string[] {\n    let indices = [];\n\n    // default indices generated from \"name\" property\n    if (this.hasOwnProperty(\"name\")) {\n      indices = this[\"name\"].split(\" \");\n    }\n\n    return indices;\n  }\n\n  /**\n   * Used by some generic UI components to set the color for the entity instance.\n   * Override this method as needed.\n   */\n  public getColor() {\n    return WarningLevelColor(this.getWarningLevel());\n  }\n\n  /**\n   * Override getWarningLevel() to define when the entity is in a critical condition and should be color-coded\n   * and highlighted in generic components of the UI.\n   */\n  public getWarningLevel(): WarningLevel {\n    return WarningLevel.NONE;\n  }\n}\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { EntitySchemaDatatype } from \"../schema/entity-schema-datatype\";\nimport { EntitySchemaField } from \"../schema/entity-schema-field\";\nimport { EntitySchemaService } from \"../schema/entity-schema.service\";\n\n/**\n * Datatype for the EntitySchemaService transforming values of an array recursively.\n *\n * (De)serialize each item in an array according to the given Datatype transformer.\n *\n * As TypeScript array types are not reliable, you have to explicitly configure the dataType for array items with the annotation.\n * For example:\n *\n * `@DatabaseField({ arrayDataType: 'month' }) dateArr: Date[];`\n * will ensure that in the database this property is saved as an array of \"month\" date strings\n * using the {@link monthEntitySchemaDatatype} (e.g. resulting in `['2020-01', '2020-04']` in the database).\n */\nexport const arrayEntitySchemaDatatype: EntitySchemaDatatype = {\n  name: \"array\",\n\n  transformToDatabaseFormat: (\n    value: any[],\n    schemaField: EntitySchemaField,\n    schemaService: EntitySchemaService,\n    parent\n  ) => {\n    if (!Array.isArray(value)) {\n      console.warn(\n        'property to be transformed with \"array\" EntitySchema is not an array',\n        value\n      );\n      return value;\n    }\n\n    const arrayElementDatatype: EntitySchemaDatatype = schemaService.getDatatypeOrDefault(\n      schemaField.arrayDataType\n    );\n    return value.map((el) =>\n      arrayElementDatatype.transformToDatabaseFormat(\n        el,\n        generateSubSchemaField(schemaField),\n        schemaService,\n        parent\n      )\n    );\n  },\n\n  transformToObjectFormat: (\n    value: any[],\n    schemaField: EntitySchemaField,\n    schemaService: EntitySchemaService,\n    parent\n  ) => {\n    if (!Array.isArray(value)) {\n      console.warn(\n        'property to be transformed with \"array\" EntitySchema is not an array',\n        value\n      );\n      return value;\n    }\n\n    const arrayElementDatatype: EntitySchemaDatatype = schemaService.getDatatypeOrDefault(\n      schemaField.arrayDataType\n    );\n\n    return value.map((el) =>\n      arrayElementDatatype.transformToObjectFormat(\n        el,\n        generateSubSchemaField(schemaField),\n        schemaService,\n        parent\n      )\n    );\n  },\n};\n\n/**\n * Generate an EntitySchemaField configuration object for the recursively called datatype for array items\n * based on the given main config for the array datatype.\n * @ignore\n *\n * @param arraySchemaField The schema field config as received by the array datatype from the annotation\n */\nfunction generateSubSchemaField(arraySchemaField: EntitySchemaField) {\n  const subSchemaField = Object.assign({}, arraySchemaField);\n  subSchemaField.dataType = arraySchemaField.arrayDataType;\n  delete subSchemaField.arrayDataType;\n  return subSchemaField;\n}\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { EntitySchemaDatatype } from \"../schema/entity-schema-datatype\";\n\n/**\n * Datatype for the EntitySchemaService transforming Date values to/from a date string format (\"YYYY-mm-dd\").\n *\n * Throws an exception if the property is set to something that is not a Date instance and cannot be cast to Date either.\n *\n * For example:\n *\n * `@DatabaseField({dataType: 'date-only'}) myDate: Date = new Date('2020-01-15'); // will be \"2020-01-15\" (without time) in the database`\n */\nexport const dateOnlyEntitySchemaDatatype: EntitySchemaDatatype = {\n  name: \"date-only\",\n\n  transformToDatabaseFormat: (value: Date) => {\n    if (!value) {\n      return undefined;\n    }\n\n    return (\n      value.getFullYear() +\n      \"-\" +\n      (value.getMonth() + 1).toString().padStart(2, \"0\") +\n      \"-\" +\n      value.getDate().toString().padStart(2, \"0\")\n    );\n  },\n\n  transformToObjectFormat: (value) => {\n    if (!value) {\n      return undefined;\n    }\n\n    const date = new Date(value);\n    if (Number.isNaN(date.getTime())) {\n      throw new Error(\"failed to convert data to Date object: \" + value);\n    }\n    return date;\n  },\n};\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { EntitySchemaDatatype } from \"../schema/entity-schema-datatype\";\n\n/**\n * Datatype for the EntitySchemaService transforming values to Date instances.\n *\n * This type is automatically used if you annotate a class's property that has the TypeScript type \"Date\"\n * ensuring that even if values in the database might be some kind of date string they will be cast to Date instances.\n *\n * For example:\n *\n * `@DatabaseField() myDate: Date; // will be a valid Date even if the database previously had \"2020-01-15\" as string`\n */\nexport const dateEntitySchemaDatatype: EntitySchemaDatatype = {\n  name: \"date\",\n\n  transformToDatabaseFormat: (value: Date) => {\n    // TODO: should date format be saved as date object or as string \"YYYY-mm-dd\"?\n    // return isValidDate(value) ? value.toISOString().slice(0, 10) : '';\n    // DONE: date format is now being saved as date object\n    return value;\n  },\n\n  transformToObjectFormat: (value) => {\n    if (!value) {\n      return undefined;\n    }\n\n    const date = new Date(value);\n    if (Number.isNaN(date.getTime())) {\n      throw new Error(\"failed to convert data to Date object: \" + value);\n    }\n    return date;\n  },\n};\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { EntitySchemaDatatype } from \"../schema/entity-schema-datatype\";\n\n/**\n * The default fallback Datatype for the EntitySchemaService that keeps values unchanged between database and entity instance.\n *\n * This type is automatically used whenever no fitting Datatype can be found for that config or TypeScript type.\n */\nexport const defaultEntitySchemaDatatype: EntitySchemaDatatype = {\n  name: \"any\",\n\n  transformToDatabaseFormat: (value) => {\n    return value;\n  },\n\n  transformToObjectFormat: (value) => {\n    return value;\n  },\n};\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { EntitySchemaDatatype } from \"../schema/entity-schema-datatype\";\n\n/**\n * Datatype for the EntitySchemaService transforming Date values to/from a short string month format (\"YYYY-mm\").\n *\n * Throws an exception if the property is set to something that is not a Date instance and cannot be cast to Date either.\n *\n * For example:\n *\n * `@DatabaseField({dataType: 'month'}) myMonth: Date = new Date('2020-01-15'); // will be \"2020-01\" in the database`\n */\nexport const monthEntitySchemaDatatype: EntitySchemaDatatype = {\n  name: \"month\",\n\n  transformToDatabaseFormat: (value) => {\n    if (!value) {\n      return undefined;\n    }\n\n    if (!(value instanceof Date)) {\n      value = new Date(value);\n    }\n    return (\n      value.getFullYear().toString() +\n      \"-\" +\n      (value.getMonth() + 1).toString().replace(/^(\\d)$/g, \"0$1\")\n    );\n  },\n\n  transformToObjectFormat: (value) => {\n    if (!value || value === \"\") {\n      return undefined;\n    }\n\n    value = value\n      .toString()\n      .replace(/-(\\d)-/g, \"-0$1-\")\n      .replace(/-(\\d)$/g, \"-0$1\");\n    const date = new Date(value);\n    if (Number.isNaN(date.getTime())) {\n      console.log(\"value aus datatype-month.ts: \" + value);\n      throw new Error(\"failed to convert data to Date object: \" + value);\n    }\n    return date;\n  },\n};\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { EntitySchemaDatatype } from \"../schema/entity-schema-datatype\";\n\n/**\n * Datatype for the EntitySchemaService transforming values to \"number\".\n *\n * This type is automatically used if you annotate a class's property that has the TypeScript type \"number\"\n * ensuring that even if values in the database from other sources are not of type number they will be cast to number.\n *\n * For example:\n *\n * `@DatabaseField() myNumber: number;`\n *\n * `@DatabaseField({dataType: 'number'}) myValue: any;`\n */\nexport const numberEntitySchemaDatatype: EntitySchemaDatatype = {\n  name: \"number\",\n\n  transformToDatabaseFormat: (value) => {\n    if (!value) {\n      return undefined;\n    }\n    return Number(value);\n  },\n\n  transformToObjectFormat: (value) => {\n    if (!value) {\n      return undefined;\n    }\n    return Number(value);\n  },\n};\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { EntitySchemaDatatype } from \"../schema/entity-schema-datatype\";\nimport { EntitySchemaField } from \"../schema/entity-schema-field\";\nimport { EntitySchemaService } from \"../schema/entity-schema.service\";\n\n/**\n * Datatype for the EntitySchemaService transforming values of complex objects recursively.\n *\n * (De)serialize instances of any class recognizing the normal @DatabaseField() annotations within that referenced class.\n * This is useful if your Entity type is complex and has properties that are instances of other classes\n * rather just basic value types like string or number.\n * You can then annotate some properties of that referenced class so they will be saved to the database while ignoring other properties.\n * The referenced class instance will be saved embedded into the entity's object and not as an own \"stand-alone\" entity.\n *\n * see the unit tests in entity-schema.service.spec.ts for an example\n *\n * Requires the class constructor as extension field in the schema field annotation:\n *\n * `@DatabaseField({ dataType: 'schema-embed', ext: MyClass })`\n */\nexport const schemaEmbedEntitySchemaDatatype: EntitySchemaDatatype = {\n  name: \"schema-embed\",\n\n  transformToDatabaseFormat: (\n    value: any,\n    schemaField: EntitySchemaField,\n    schemaService: EntitySchemaService\n  ) => {\n    return schemaService.transformEntityToDatabaseFormat(\n      value,\n      schemaField.ext.schema\n    );\n  },\n\n  transformToObjectFormat: (\n    value: any,\n    schemaField: EntitySchemaField,\n    schemaService: EntitySchemaService\n  ) => {\n    return schemaService.transformDatabaseToEntityFormat(\n      value,\n      schemaField.ext.schema\n    );\n  },\n};\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { EntitySchemaDatatype } from \"../schema/entity-schema-datatype\";\n\n/**\n * Datatype for the EntitySchemaService transforming values to \"string\".\n *\n * This type is automatically used if you annotate a class's property that has the TypeScript type \"string\"\n * ensuring that even if values in the database from other sources are not of type string, the property will be a string.\n *\n * For example:\n *\n * `@DatabaseField() myString: string;`\n *\n * `@DatabaseField({dataType: 'string'}) myValue: any;`\n */\nexport const stringEntitySchemaDatatype: EntitySchemaDatatype = {\n  name: \"string\",\n\n  transformToDatabaseFormat: (value) => {\n    if (!value) {\n      return undefined;\n    }\n    return String(value);\n  },\n\n  transformToObjectFormat: (value) => {\n    if (!value) {\n      return undefined;\n    }\n    return String(value);\n  },\n};\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { Entity } from \"../entity\";\nimport { EntitySchemaDatatype } from \"./entity-schema-datatype\";\nimport { Injectable } from \"@angular/core\";\nimport { defaultEntitySchemaDatatype } from \"../schema-datatypes/datatype-default\";\nimport { EntitySchema } from \"./entity-schema\";\nimport { EntitySchemaField } from \"./entity-schema-field\";\nimport { stringEntitySchemaDatatype } from \"../schema-datatypes/datatype-string\";\nimport { numberEntitySchemaDatatype } from \"../schema-datatypes/datatype-number\";\nimport { dateEntitySchemaDatatype } from \"../schema-datatypes/datatype-date\";\nimport { monthEntitySchemaDatatype } from \"../schema-datatypes/datatype-month\";\nimport { arrayEntitySchemaDatatype } from \"../schema-datatypes/datatype-array\";\nimport { schemaEmbedEntitySchemaDatatype } from \"../schema-datatypes/datatype-schema-embed\";\nimport { dateOnlyEntitySchemaDatatype } from \"../schema-datatypes/datatype-date-only\";\n\n/**\n * Transform between entity instances and database objects\n * based on the dataType set for properties in Entity classes using the {@link DatabaseField} annotation.\n *\n * You can inject the EntitySchemaService in your code to register your custom {@link EntitySchemaDatatype} implementations.\n *\n * This service is used by the {@link EntityMapperService} to internally transform objects.\n * You should normally use the EntityMapperService instead of transforming objects yourself with the EntitySchemaService.\n *\n * also see the How-To Guides:\n * - [Create A New Entity Type]{@link /additional-documentation/how-to-guides/create-a-new-entity-type.html}\n */\n@Injectable()\nexport class EntitySchemaService {\n  /**\n   * Internal registry of data type definitions.\n   * You can extend the Schema system with your data type conversions by using EntitySchema.registerSchemaDatatype()\n   */\n  private schemaTypes = new Map<string, EntitySchemaDatatype>();\n\n  constructor() {\n    this.registerBasicDatatypes();\n  }\n\n  private registerBasicDatatypes() {\n    this.registerSchemaDatatype(stringEntitySchemaDatatype);\n    this.registerSchemaDatatype(numberEntitySchemaDatatype);\n    this.registerSchemaDatatype(dateEntitySchemaDatatype);\n    this.registerSchemaDatatype(dateOnlyEntitySchemaDatatype);\n    this.registerSchemaDatatype(monthEntitySchemaDatatype);\n    this.registerSchemaDatatype(arrayEntitySchemaDatatype);\n    this.registerSchemaDatatype(schemaEmbedEntitySchemaDatatype);\n  }\n\n  /**\n   * Add a datatype definition to the registry to provide a conversion between what is written into the database\n   * and what is available in Entity objects.\n   * @param type The EntitySchemaDatatype object definition providing data transformation functions.\n   */\n  public registerSchemaDatatype(type: EntitySchemaDatatype) {\n    this.schemaTypes.set(type.name, type);\n  }\n\n  /**\n   * Get the datatype for the giving name (or the default datatype if no other registered type fits)\n   * @param datatypeName The key/name of the datatype\n   */\n  public getDatatypeOrDefault(datatypeName: string) {\n    datatypeName = datatypeName ? datatypeName.toLowerCase() : undefined;\n\n    if (this.schemaTypes.has(datatypeName)) {\n      return this.schemaTypes.get(datatypeName);\n    } else {\n      return defaultEntitySchemaDatatype;\n    }\n  }\n\n  /**\n   * Transform a database object to entity format according to the schema.\n   * @param data The database object that will be transformed to the given entity format\n   * @param schema A schema defining the transformation\n   */\n  public transformDatabaseToEntityFormat(data: any, schema: EntitySchema) {\n    for (const key of schema.keys()) {\n      const schemaField: EntitySchemaField = schema.get(key);\n      const newValue = this.getDatatypeOrDefault(\n        schemaField.dataType\n      ).transformToObjectFormat(data[key], schemaField, this, data);\n      if (newValue !== undefined) {\n        data[key] = newValue;\n      }\n\n      if (schemaField.generateIndex) {\n        throw new Error('schema option \"isIndexed\" not implemented yet');\n      }\n    }\n\n    return data;\n  }\n\n  /**\n   * Helper function to assign the giving data to the given entity instance after transforming it according to the schema.\n   * @param entity An entity instance whose properties will be overwritten with the transformed data\n   * @param data The database object that will be transformed and assigned to the entity\n   */\n  public loadDataIntoEntity(entity: Entity, data: any) {\n    data = this.transformDatabaseToEntityFormat(\n      data,\n      entity.getConstructor().schema\n    );\n    Object.assign(entity, data);\n  }\n\n  /**\n   * Transform an entity instance to a database object according to the schema.\n   * @param entity The object (an instance of an entity type)\n   * @param schema The schema of the entity (if not explicitly defined the schema of the given entity is used)\n   */\n  public transformEntityToDatabaseFormat(\n    entity: Entity,\n    schema?: EntitySchema\n  ): any {\n    if (!schema) {\n      schema = entity.getConstructor().schema;\n    }\n\n    const data = {};\n\n    for (const key of schema.keys()) {\n      const schemaField: EntitySchemaField = schema.get(key);\n\n      if (entity[key] !== undefined) {\n        data[key] = this.getDatatypeOrDefault(\n          schemaField.dataType\n        ).transformToDatabaseFormat(entity[key], schemaField, this, entity);\n      }\n    }\n\n    if (entity.generateSearchIndices) {\n      data[\"searchIndices\"] = entity.generateSearchIndices();\n    }\n\n    return data;\n  }\n}\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * Generic configuration for a filter with different selectable {@link FilterSelectionOption} options.\n *\n * This is a reusable format for any kind of dropdown or selection component that offers the user a choice\n * to narrow down a list of data items.\n * As the filter function is provided as part of each {@link FilterSelectionOption}\n * an instance of this FilterSelection class can manage all filter selection logic.\n */\nexport class FilterSelection<T> {\n  /** key of currently selected option */\n  public selectedOption: string = \"\";\n\n  /**\n   * Create a FilterSelection with different options to be selected.\n   * @param name The name or id describing this filter\n   * @param options An array of different filtering variants to chose between\n   */\n  constructor(\n    public name: string,\n    public options: FilterSelectionOption<T>[]\n  ) {}\n\n  /** default filter will keep all items in the result */\n  defaultFilterFunction = (c: T) => true;\n\n  /**\n   * Get the full filter option by its key.\n   * @param key The identifier of the requested option\n   */\n  getOption(key: string): FilterSelectionOption<T> {\n    return this.options.find((option) => option.key === key);\n  }\n\n  private getFilterFunction(key: string) {\n    const option = this.getOption(key);\n\n    if (!option) {\n      return this.defaultFilterFunction;\n    } else {\n      return option.filterFun;\n    }\n  }\n\n  /**\n   * Get the filter function of the currently selected option.\n   * If no option has been selected yet, the returned filter function will keep all items in the result if applied.\n   *\n   * This can be directly used on a data array, e.g. \"data.filter(filterSelection.getFilterFunction('a'))\"\n   */\n  public getSelectedFilterFunction() {\n    return this.getFilterFunction(this.selectedOption);\n  }\n\n  /**\n   * Reset the available filter options to the ones dynamically generated from the given value to be matched.\n   *\n   * This is a utility function to make it easier to generate {@link FilterSelectionOption}s for standard cases\n   * if you simply want each option to filter items having the given attribute matching different values.\n   * If you have more sophisticated filtering needs, use the constructor to set {@link FilterSelectionOption}s that\n   * you created yourself.\n   *\n   * @param valuesToMatchAsOptions An array of values to be matched.\n   *        A separate FilterSelectionOption is created for each value with a filter\n   *        that is true of a data item's property exactly matches that value.\n   * @param attributeName The name of the property of a data item that is compared to the value in the filter function.\n   */\n  public initOptions(valuesToMatchAsOptions: any[], attributeName: string) {\n    const options = [{ key: \"\", label: \"All\", filterFun: (e: T) => true }];\n\n    valuesToMatchAsOptions.forEach((k) => {\n      options.push({\n        key: k.toLowerCase(),\n        label: k.toString(),\n        filterFun: (e: T) => e[attributeName] === k,\n      });\n    });\n\n    this.options = options;\n  }\n}\n\n/**\n * Represents one specific option to filter data in a certain way.\n * used by {@link FilterSelection}\n */\nexport interface FilterSelectionOption<T> {\n  /** identifier for this option in the parent FilterSelection instance */\n  key: string;\n\n  /** label displayed for this option to the user in the UI */\n  label: string;\n\n  /**\n   * function that filters a dataset.\n   * This filter logic will be applied to data when this option is selected.\n   */\n  filterFun: (c: T) => boolean;\n}\n","import {\n  Component,\n  ContentChild,\n  EventEmitter,\n  Input,\n  Output,\n} from \"@angular/core\";\nimport { EntityMapperService } from \"../../entity/entity-mapper.service\";\nimport { Entity } from \"../../entity/entity\";\n\n/**\n * Use `<app-form-dialog-wrapper>` in your form templates to handle the saving and resetting of the edited entity.\n * This wrapper component ensures that the UI looks consistent for all forms\n * and also allows you to easily show the form in a dialog using the {@link FormDialogService}.\n *\n * @example\n <app-form-dialog-wrapper [entity]=\"myEntity\">\n   <h1>\n     <!-- h1 element is used for dialog title -->\n   </h1>\n   <form #entityForm=\"ngForm\"> <!-- marking your form with #entityForm is required -->\n     <!-- add your form fields here -->\n     <!-- save/cancel buttons are added by the wrapper automatically  -->\n   </form>\n </app-form-dialog-wrapper>\n */\n@Component({\n  selector: \"app-form-dialog-wrapper\",\n  templateUrl: \"./form-dialog-wrapper.component.html\",\n  styleUrls: [\"./form-dialog-wrapper.component.scss\"],\n})\nexport class FormDialogWrapperComponent {\n  /** entity to be edited */\n  @Input() set entity(value: Entity) {\n    this.originalEntity = Object.assign({}, value);\n    this._entity = value;\n  }\n  get entity(): Entity {\n    return this._entity;\n  }\n\n  /** actual reference to the entity to be edited in the form used by the getter/setter */\n  private _entity: Entity;\n  /** clone of the initially given entity as backup for resetting changes */\n  private originalEntity: Entity;\n\n  /**\n   * (Optional) callback before saving the entity to the database.\n   *\n   * You can here do any prerequisites or editing of the entity object if required.\n   * You can abort the saving by returning undefined.\n   */\n  @Input() beforeSave?: (entity: Entity) => Promise<Entity>;\n\n  /**\n   * Triggered when the form should be closed (after save or reset is completed).\n   *\n   * This emits the saved entity or undefined if the form was canceled.\n   */\n  @Output() onClose = new EventEmitter<Entity>();\n\n  /** ngForm component of the child component that is set through the ng-content */\n  @ContentChild(\"entityForm\", { static: true }) contentForm;\n\n  constructor(private entityMapper: EntityMapperService) {}\n\n  /**\n   * whether the contained form has been changed\n   */\n  public get isFormDirty(): boolean {\n    return this.contentForm.form.dirty;\n  }\n\n  /**\n   * Save the entity with the changes made in the current form.\n   *\n   * You can hook into the saving through the `beforeSave` Input.\n   */\n  public async save() {\n    if (this.beforeSave) {\n      const transformedEntity = await this.beforeSave(this.entity);\n      if (!transformedEntity) {\n        // abort saving\n        return;\n      }\n      this.entity = transformedEntity;\n    }\n\n    await this.entityMapper.save<Entity>(this.entity);\n    this.onClose.emit(this.entity);\n  }\n\n  /**\n   * Reset any changes made to the entity in the current form (and trigger an `onClose` event).\n   */\n  public async cancel() {\n    Object.assign(this._entity, this.originalEntity);\n    this.onClose.emit(undefined);\n  }\n}\n","<div mat-dialog-title class=\"form-dialog-title\">\n  <ng-content select=\"h1\"></ng-content>\n</div>\n\n<mat-dialog-content>\n  <ng-content select=\"form\"></ng-content>\n</mat-dialog-content>\n\n<mat-dialog-actions>\n  <button\n    mat-stroked-button\n    [disabled]=\"!contentForm.form.dirty\"\n    (click)=\"save()\"\n    angulartics2On=\"click\"\n    angularticsCategory=\"UserAction\"\n    angularticsAction=\"form_dialog_save\"\n  >\n    Save\n  </button>\n  <button\n    mat-stroked-button\n    (click)=\"cancel()\"\n    angulartics2On=\"click\"\n    angularticsCategory=\"UserAction\"\n    angularticsAction=\"form_dialog_cancel\"\n  >\n    Cancel\n  </button>\n</mat-dialog-actions>\n","import { NgModule } from \"@angular/core\";\nimport { CommonModule } from \"@angular/common\";\nimport { MatButtonModule } from \"@angular/material/button\";\nimport { MatDialogModule } from \"@angular/material/dialog\";\nimport { FormDialogService } from \"./form-dialog.service\";\nimport { FormDialogWrapperComponent } from \"./form-dialog-wrapper/form-dialog-wrapper.component\";\nimport { FormsModule } from \"@angular/forms\";\nimport { ConfirmationDialogModule } from \"../confirmation-dialog/confirmation-dialog.module\";\nimport { Angulartics2Module } from \"angulartics2\";\n\n/**\n * A helper utility module to consistently and easily display forms\n *\n * Use the {@link FormDialogService} to display forms as a dialog hovering over the other UI.\n *\n * Use the {@link FormDialogWrapperComponent} to get generic logic and UI for saving/cancelling forms.\n */\n@NgModule({\n  imports: [\n    CommonModule,\n    MatDialogModule,\n    MatButtonModule,\n    FormsModule,\n    ConfirmationDialogModule,\n    Angulartics2Module,\n  ],\n  declarations: [FormDialogWrapperComponent],\n  providers: [FormDialogService],\n  exports: [FormDialogWrapperComponent],\n})\nexport class FormDialogModule {}\n","import { Injectable } from \"@angular/core\";\nimport { MatDialog, MatDialogRef } from \"@angular/material/dialog\";\nimport { ComponentType } from \"@angular/cdk/overlay\";\nimport { ConfirmationDialogService } from \"../confirmation-dialog/confirmation-dialog.service\";\nimport { FormDialogWrapperComponent } from \"./form-dialog-wrapper/form-dialog-wrapper.component\";\nimport { ShowsEntity } from \"./shows-entity.interface\";\n\n/**\n * Inject this service instead of MatDialog to display a form or details view as a modal\n * (hovering over the rest of the UI).\n *\n * This takes care of generic logic like a user prompt asking whether changes should be saved before leaving the dialog.\n * Components used with this have to use {@link FormDialogWrapperComponent} and implement {@link ShowsEntity}.\n *\n * Import the {@link FormDialogModule} in your root module to provide this service.\n *\n * @example\n formDialog.openDialog(NoteDetailsComponent, noteEntity);\n */\n@Injectable()\nexport class FormDialogService {\n  constructor(\n    private dialog: MatDialog,\n    private confirmationDialog: ConfirmationDialogService\n  ) {}\n\n  openDialog<T extends ShowsEntity>(\n    entityDetailsComponent: ComponentType<T>,\n    entity: any\n  ): MatDialogRef<T> {\n    const dialogRef = this.dialog.open(entityDetailsComponent, {\n      width: \"80%\",\n    });\n    dialogRef.componentInstance.entity = entity;\n\n    const dialogWrapper = dialogRef.componentInstance.formDialogWrapper;\n    dialogWrapper.onClose.subscribe(() => dialogRef.close(true));\n\n    dialogRef.beforeClosed().subscribe((activelyClosed) => {\n      if (!activelyClosed && dialogWrapper.isFormDirty) {\n        this.confirmationDialog\n          .openDialog(\n            \"Save Changes?\",\n            \"Do you want to save the changes you made to the record?\"\n          )\n          .afterClosed()\n          .subscribe((confirmed) => {\n            if (confirmed) {\n              dialogWrapper.save();\n            } else {\n              dialogWrapper.cancel();\n            }\n          });\n      }\n    });\n\n    return dialogRef;\n  }\n}\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { NgModule } from \"@angular/core\";\nimport { CommonModule } from \"@angular/common\";\nimport { HowToComponent } from \"./how-to/how-to.component\";\nimport { HttpClient, HttpClientModule } from \"@angular/common/http\";\nimport { MarkdownModule } from \"ngx-markdown\";\n\n/**\n * Display help information to users.\n */\n@NgModule({\n  declarations: [HowToComponent],\n  imports: [\n    CommonModule,\n    HttpClientModule,\n    MarkdownModule.forRoot({ loader: HttpClient }),\n  ],\n})\nexport class HelpModule {}\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { Component } from \"@angular/core\";\n\n/**\n * Display markdown formatted help that is dynamically loaded from a file in the assets folder.\n * Displayed file: assets/How_To.md\n */\n@Component({\n  selector: \"app-help\",\n  templateUrl: \"./how-to.component.html\",\n  styleUrls: [\"./how-to.component.scss\"],\n})\nexport class HowToComponent {}\n","<div markdown src='assets/How_To.md'></div>\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { Component, OnInit } from \"@angular/core\";\nimport { LatestChangesDialogService } from \"../latest-changes-dialog.service\";\n\n/**\n * Simple component displaying the current app version\n * including functionality to open an info dialog showing the latest change when the user clicks on it.\n */\n@Component({\n  selector: \"app-version\",\n  templateUrl: \"./app-version.component.html\",\n  styleUrls: [\"./app-version.component.scss\"],\n})\nexport class AppVersionComponent implements OnInit {\n  /** the current app version */\n  currentVersion: string;\n\n  constructor(private changelogDialog: LatestChangesDialogService) {}\n\n  ngOnInit(): void {\n    this.currentVersion = this.changelogDialog.getCurrentVersion();\n  }\n\n  /**\n   * Open dialog box to display changelog information about the latest version to the user.\n   */\n  public showLatestChanges(): void {\n    this.changelogDialog.showLatestChanges();\n  }\n}\n","<!--\n  ~     This file is part of ndb-core.\n  ~\n  ~     ndb-core is free software: you can redistribute it and/or modify\n  ~     it under the terms of the GNU General Public License as published by\n  ~     the Free Software Foundation, either version 3 of the License, or\n  ~     (at your option) any later version.\n  ~\n  ~     ndb-core is distributed in the hope that it will be useful,\n  ~     but WITHOUT ANY WARRANTY; without even the implied warranty of\n  ~     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n  ~     GNU General Public License for more details.\n  ~\n  ~     You should have received a copy of the GNU General Public License\n  ~     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n  -->\n\n<div class=\"version-footer\">\n  <a (click)=\"showLatestChanges()\" style=\"cursor: pointer\">{{currentVersion}}</a>\n</div>\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport {\n  Component,\n  ElementRef,\n  Inject,\n  OnInit,\n  ViewChild,\n} from \"@angular/core\";\nimport { Changelog } from \"../changelog\";\nimport { MAT_DIALOG_DATA, MatDialogRef } from \"@angular/material/dialog\";\nimport { isObservable, Observable } from \"rxjs\";\nimport { LatestChangesService } from \"../latest-changes.service\";\n\n/**\n * Display information from the changelog for the latest version.\n *\n * This component is used as content of a dialog.\n */\n@Component({\n  templateUrl: \"./changelog.component.html\",\n  styleUrls: [\"./changelog.component.scss\"],\n})\nexport class ChangelogComponent implements OnInit {\n  /** The array of relevant changelog entries to be displayed */\n  changelogs: Changelog[];\n\n  /** Display advanced information that may not be useful to normal users */\n  showAdvancedDetails = false;\n\n  @ViewChild(\"changelogContainer\") contentContainer: ElementRef;\n\n  /**\n   * This component is to be created through a MatDialog that should pass in the relevant data.\n   *\n   * @example\n   * dialog.open(ChangelogComponent, { data: { changelogData: latestChangesService.getChangelogs() } });\n   *\n   * @param dialogRef Reference to the parent dialog.\n   * @param data Changelog data to be display initially\n   * @param latestChangesService\n   */\n  constructor(\n    public dialogRef: MatDialogRef<ChangelogComponent>,\n    @Inject(MAT_DIALOG_DATA) public data: Observable<Changelog[]>,\n    private latestChangesService: LatestChangesService\n  ) {}\n\n  ngOnInit(): void {\n    if (this.data && isObservable(this.data)) {\n      this.data.subscribe((changelog) => (this.changelogs = changelog));\n    }\n  }\n\n  /**\n   * Add one more previous release card to the end of the currently displayed list of changelogs.\n   */\n  loadPreviousRelease() {\n    const lastDisplayedVersion = this.changelogs[this.changelogs.length - 1]\n      .tag_name;\n    this.latestChangesService\n      .getChangelogsBeforeVersion(lastDisplayedVersion, 1)\n      .subscribe((additionalChangelog) => {\n        this.changelogs.push(...additionalChangelog);\n\n        setTimeout(() => this.scrollToBottomOfReleases());\n      });\n  }\n\n  private scrollToBottomOfReleases() {\n    this.contentContainer.nativeElement.scrollTop = this.contentContainer.nativeElement.scrollHeight;\n  }\n}\n","<!--\n  ~     This file is part of ndb-core.\n  ~\n  ~     ndb-core is free software: you can redistribute it and/or modify\n  ~     it under the terms of the GNU General Public License as published by\n  ~     the Free Software Foundation, either version 3 of the License, or\n  ~     (at your option) any later version.\n  ~\n  ~     ndb-core is distributed in the hope that it will be useful,\n  ~     but WITHOUT ANY WARRANTY; without even the implied warranty of\n  ~     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n  ~     GNU General Public License for more details.\n  ~\n  ~     You should have received a copy of the GNU General Public License\n  ~     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n  -->\n\n\n<h1 mat-dialog-title>Latest Changes</h1>\n\n<mat-dialog-content #changelogContainer>\n  <mat-card *ngFor=\"let changelog of changelogs\" class=\"mat-elevation-z3\">\n    <mat-card-header>\n      <mat-card-title>{{ changelog ? changelog.name : \"No Changelog Available\" }}</mat-card-title>\n      <mat-card-subtitle>\n        <span class=\"meta-info\"><mat-icon fontIcon=\"fa-calendar-o\"></mat-icon>{{ changelog?.published_at | date }}</span>\n        <span class=\"meta-info\"><mat-icon fontIcon=\"fa-tag\"></mat-icon>{{ changelog?.tag_name }}</span>\n      </mat-card-subtitle>\n    </mat-card-header>\n\n    <mat-card-content>\n      <markdown [data]=\"changelog?.body\"></markdown>\n    </mat-card-content>\n\n    <mat-card-actions *ngIf=\"showAdvancedDetails\">\n      <button mat-stroked-button><a [href]=\"'https://www.github.com'\" target=\"_blank\">More Information</a></button>\n    </mat-card-actions>\n  </mat-card>\n</mat-dialog-content>\n\n<mat-dialog-actions class=\"general-actions\">\n  <button mat-raised-button (click)=\"loadPreviousRelease()\">Show previous changes</button>\n  <button mat-raised-button color=\"accent\" [mat-dialog-close]=\"true\">Close</button>\n</mat-dialog-actions>\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { Injectable } from \"@angular/core\";\nimport { MatDialog } from \"@angular/material/dialog\";\nimport { ChangelogComponent } from \"./changelog/changelog.component\";\nimport { CookieService } from \"ngx-cookie-service\";\nimport { environment } from \"../../../environments/environment\";\nimport { LatestChangesService } from \"./latest-changes.service\";\n\n/**\n * Manage the changelog information and display it to the user\n * on request or automatically on the first visit of a new version after update.\n */\n@Injectable()\nexport class LatestChangesDialogService {\n  private static COOKIE_NAME = \"AppVersion\";\n\n  constructor(\n    private dialog: MatDialog,\n    private cookieService: CookieService,\n    private latestChangesService: LatestChangesService\n  ) {}\n\n  /**\n   * Get current app version inferred from the latest changelog entry.\n   */\n  getCurrentVersion(): string {\n    return environment.appVersion;\n  }\n\n  /**\n   * Open a modal window displaying the changelog of the latest version.\n   * @param previousVersion (Optional) previous version back to which all changes should be displayed\n   */\n  public showLatestChanges(previousVersion?: string): void {\n    this.dialog.open(ChangelogComponent, {\n      width: \"80%\",\n      data: this.latestChangesService.getChangelogsBetweenVersions(\n        this.getCurrentVersion(),\n        previousVersion\n      ),\n    });\n  }\n\n  /**\n   * Display the latest changes info box automatically if the current user has not seen this version before.\n   */\n  public showLatestChangesIfUpdated() {\n    if (this.cookieService.check(LatestChangesDialogService.COOKIE_NAME)) {\n      const previousVersion = this.cookieService.get(\n        LatestChangesDialogService.COOKIE_NAME\n      );\n      if (this.getCurrentVersion() !== previousVersion) {\n        this.showLatestChanges(previousVersion);\n      }\n    }\n    this.cookieService.set(\n      LatestChangesDialogService.COOKIE_NAME,\n      this.getCurrentVersion()\n    );\n  }\n}\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { NgModule } from \"@angular/core\";\nimport { CommonModule } from \"@angular/common\";\nimport { AppVersionComponent } from \"./app-version/app-version.component\";\nimport { AlertsModule } from \"../alerts/alerts.module\";\nimport { HttpClientModule } from \"@angular/common/http\";\nimport { SessionModule } from \"../session/session.module\";\nimport { MatButtonModule } from \"@angular/material/button\";\nimport { MatDialogModule } from \"@angular/material/dialog\";\nimport { MatSnackBarModule } from \"@angular/material/snack-bar\";\nimport { ChangelogComponent } from \"./changelog/changelog.component\";\nimport { SwUpdate } from \"@angular/service-worker\";\nimport { UpdateManagerService } from \"./update-manager.service\";\nimport { FlexModule } from \"@angular/flex-layout\";\nimport { MarkdownModule } from \"ngx-markdown\";\nimport { MatIconModule } from \"@angular/material/icon\";\nimport { MatCardModule } from \"@angular/material/card\";\nimport { LatestChangesDialogService } from \"./latest-changes-dialog.service\";\nimport { LatestChangesService } from \"./latest-changes.service\";\n\n/**\n * Displaying app version and changelog information to the user\n * through components that can be used in other templates\n * as well as automatic popups on updates (see {@link UpdateManagerService}, {@link LatestChangesService}).\n */\n@NgModule({\n  imports: [\n    CommonModule,\n    AlertsModule,\n    SessionModule,\n    MatDialogModule,\n    MatButtonModule,\n    MatSnackBarModule,\n    HttpClientModule,\n    FlexModule,\n    MarkdownModule,\n    MatIconModule,\n    MatCardModule,\n  ],\n  declarations: [AppVersionComponent, ChangelogComponent],\n  exports: [AppVersionComponent],\n  providers: [\n    LatestChangesService,\n    LatestChangesDialogService,\n    UpdateManagerService,\n  ],\n})\nexport class LatestChangesModule {\n  constructor(\n    private updates: SwUpdate,\n    private latestChangesDialogService: LatestChangesDialogService,\n    private updateManagerService: UpdateManagerService\n  ) {\n    this.latestChangesDialogService.showLatestChangesIfUpdated();\n\n    this.updateManagerService.notifyUserWhenUpdateAvailable();\n    this.updateManagerService.regularlyCheckForUpdates();\n  }\n}\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { catchError, map } from \"rxjs/operators\";\nimport { Injectable } from \"@angular/core\";\nimport { Observable, throwError } from \"rxjs\";\nimport { Changelog } from \"./changelog\";\nimport { AlertService } from \"../alerts/alert.service\";\nimport { HttpClient } from \"@angular/common/http\";\nimport { environment } from \"../../../environments/environment\";\n\n/**\n * Manage the changelog information and display it to the user\n * on request or automatically on the first visit of a new version after update.\n */\n@Injectable()\nexport class LatestChangesService {\n  private static GITHUB_API = \"https://api.github.com/repos/\";\n\n  constructor(private http: HttpClient, private alertService: AlertService) {}\n\n  /**\n   * Load the changelog information of changes since the last update.\n   * @param currentVersion The current version for which changes are to be loaded.\n   * @param previousVersion (Optional) The older version since which changes of all versions until the currentVersion will be loaded.\n   */\n  getChangelogsBetweenVersions(\n    currentVersion: string,\n    previousVersion?: string\n  ): Observable<Changelog[]> {\n    return this.getChangelogs((releases: any[]) =>\n      this.filterReleasesBetween(releases, currentVersion, previousVersion)\n    );\n  }\n\n  private filterReleasesBetween(\n    releases: any[],\n    currentVersion: string,\n    previousVersion?: string\n  ) {\n    let relevantReleases;\n\n    const releasesUpToCurrentVersion = releases.filter(\n      (r) => r.tag_name <= currentVersion\n    );\n    if (releasesUpToCurrentVersion.length < 1) {\n      return [];\n    }\n\n    if (previousVersion) {\n      const releasesBackToPreviousVersion = releasesUpToCurrentVersion.filter(\n        (r) => r.tag_name > previousVersion\n      );\n      relevantReleases = releasesBackToPreviousVersion.sort((a, b) =>\n        (b.tag_name as string).localeCompare(a.tag_name, \"en\")\n      );\n    } else {\n      relevantReleases = [releasesUpToCurrentVersion[0]];\n    }\n\n    return relevantReleases;\n  }\n\n  /**\n   * Load the changelog information of a number of releases before (excluding) the given version.\n   * @param version The version for which preceding releases should be returned.\n   * @param count The number of releases before the given version to be returned\n   */\n  getChangelogsBeforeVersion(\n    version: string,\n    count: number\n  ): Observable<Changelog[]> {\n    return this.getChangelogs((releases: any) =>\n      this.filterReleasesBefore(releases, version, count)\n    );\n  }\n\n  private filterReleasesBefore(\n    releases: any[],\n    version: string,\n    count: number\n  ) {\n    let relevantReleases;\n\n    const releasesUpToCurrentVersion = releases.filter(\n      (r) => r.tag_name < version\n    );\n    if (releasesUpToCurrentVersion.length < 1) {\n      return [];\n    }\n\n    relevantReleases = releasesUpToCurrentVersion.sort((a, b) =>\n      (b.tag_name as string).localeCompare(a.tag_name, \"en\")\n    );\n    return relevantReleases.slice(0, count);\n  }\n\n  /**\n   * Load release information from GitHub based on a given filter to select relevant releases.\n   * @param releaseFilter Filter function that is selecting relevant objects from the array of GitHub releases\n   */\n  private getChangelogs(releaseFilter: ([]) => any[]): Observable<Changelog[]> {\n    return this.http\n      .get<any[]>(\n        LatestChangesService.GITHUB_API + environment.repositoryId + \"/releases\"\n      )\n      .pipe(\n        map(releaseFilter),\n        map((relevantReleases) =>\n          relevantReleases.map((r) => this.parseGithubApiRelease(r))\n        ),\n        catchError((error) => {\n          this.alertService.addWarning(\n            \"Could not load latest changes: \" + error\n          );\n          return throwError(\"Could not load latest changes.\");\n        })\n      );\n  }\n\n  private parseGithubApiRelease(githubResponse: any): Changelog {\n    const releaseNotesWithoutHeading = githubResponse.body.replace(\n      /#{1,2}[^###]*/,\n      \"\"\n    );\n    const releaseNotesWithoutCommitRefs = releaseNotesWithoutHeading.replace(\n      / \\(\\[\\w{7}\\]\\([^\\)]*\\)\\)/g,\n      \"\"\n    );\n\n    return {\n      tag_name: githubResponse.tag_name,\n      name: githubResponse.name,\n      published_at: githubResponse.published_at,\n      body: releaseNotesWithoutCommitRefs,\n    };\n  }\n}\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { ApplicationRef, Injectable } from \"@angular/core\";\nimport { SwUpdate } from \"@angular/service-worker\";\nimport { first } from \"rxjs/operators\";\nimport { concat, interval } from \"rxjs\";\nimport { MatSnackBar } from \"@angular/material/snack-bar\";\nimport { LoggingService } from \"../logging/logging.service\";\n\n/**\n * Check with the server whether a new version of the app is available in order to notify the user.\n *\n * As we are using ServiceWorkers to cache the app to also work offline, explicit checking for updates is necessary.\n * The user receives a toast (hover message) if an update is available\n * and can click that to reload the app with the new version.\n */\n@Injectable()\nexport class UpdateManagerService {\n  private notificationRef;\n\n  constructor(\n    private appRef: ApplicationRef,\n    private updates: SwUpdate,\n    private snackBar: MatSnackBar,\n    private logger: LoggingService\n  ) {}\n\n  /**\n   * Display a notification to the user in case a new app version is detected by the ServiceWorker.\n   */\n  public notifyUserWhenUpdateAvailable() {\n    if (!this.updates.isEnabled) {\n      return;\n    }\n\n    this.updates.available.subscribe(() => {\n      this.showUpdateNotification();\n    });\n  }\n\n  /**\n   * Schedule a regular check with the server for updates.\n   */\n  public regularlyCheckForUpdates() {\n    if (!this.updates.isEnabled) {\n      return;\n    }\n\n    // Allow the app to stabilize first, before starting polling for updates with `interval()`.\n    const appIsStable$ = this.appRef.isStable.pipe(\n      first((isStable) => isStable === true)\n    );\n    const everyHours$ = interval(60 * 60 * 1000);\n    const everyHoursOnceAppIsStable$ = concat(appIsStable$, everyHours$);\n\n    everyHoursOnceAppIsStable$.subscribe(async () => {\n      try {\n        await this.updates.checkForUpdate();\n      } catch (err) {\n        this.logger.error(err);\n      }\n    });\n  }\n\n  private showUpdateNotification() {\n    this.notificationRef = this.snackBar.open(\n      \"A new version of the app is available!\",\n      \"Update\"\n    );\n    this.notificationRef.onAction().subscribe(() => {\n      location.reload();\n    });\n  }\n}\n","/**\n * Log level indicates the context and severity of a message.\n */\nexport enum LogLevel {\n  /** for development and analysis */\n  DEBUG,\n\n  /** event during the regular functioning of the app */\n  INFO,\n\n  /** unexpected event that can still be handled */\n  WARN,\n\n  /** critical unexpected event that will affect the functioning of the app */\n  ERROR,\n}\n","import { ErrorHandler, Injectable } from \"@angular/core\";\nimport { LoggingService } from \"./logging.service\";\n\n/**\n * A simple ErrorHandler that logs any unhandled errors that occur in the app.\n * This is particularly useful if remote error logging with Sentry is set up so the development team receives such info.\n *\n * To enable this, add it as an ErrorHandler provider to your main AppModule's \"providers\" list:\n *\n * @example\n * { provide: ErrorHandler, useClass: LoggingErrorHandler }\n */\n@Injectable()\nexport class LoggingErrorHandler implements ErrorHandler {\n  constructor(private logger: LoggingService) {}\n\n  /**\n   * Handle until now uncaught error by logging it.\n   * @param error\n   */\n  handleError(error) {\n    this.logger.error(error);\n    // It is possible to show a feedback dialog to the user through Sentry:\n    // const eventId = Sentry.captureException(error.originalError || error);\n    // Sentry.showReportDialog({ eventId });\n  }\n}\n","import { Injectable } from \"@angular/core\";\nimport { LogLevel } from \"./log-level\";\nimport * as Sentry from \"@sentry/browser\";\nimport { environment } from \"../../../environments/environment\";\n\n/* tslint:disable:no-console */\n\n/**\n * Centrally managed logging to allow log messages to be filtered by level and even sent to a remote logging service\n * that allows developers to monitor and analyse problems.\n *\n * Logging to the remote monitoring server is set only for warnings and errors.\n *\n * To allow remote logging, call Sentry.init during bootstrap in your AppModule or somewhere early on during startup.\n */\n@Injectable({\n  providedIn: \"root\",\n})\nexport class LoggingService {\n  /**\n   * Initialize the remote logging module with the given options.\n   * If set up this will be used to send errors to a remote endpoint for analysis.\n   * @param options\n   */\n  static initRemoteLogging(options: any) {\n    if (!options.dsn) {\n      // abort if no target url is set\n      return;\n    }\n\n    const defaultOptions = {\n      release: \"ndb-core@\" + environment.appVersion,\n    };\n    Sentry.init(Object.assign(defaultOptions, options));\n  }\n\n  /**\n   * Update a piece of context information that will be attached to all log messages for easier debugging,\n   * especially in remote logging.\n   * @param tagName Identifier of the key-value pair\n   * @param value Value of the key-value pair\n   */\n  static setLoggingContext(tagName: string, value: any) {\n    Sentry.configureScope((scope) => {\n      scope.setTag(tagName, value);\n    });\n  }\n\n  /**\n   * Update the username to be attached to all log messages for easier debugging,\n   * especially in remote logging.\n   * @param username\n   */\n  static setLoggingContextUser(username: string) {\n    Sentry.setUser({ username: username });\n  }\n\n  /**\n   * Log the message with \"debug\" level - for very detailed, non-essential information.\n   * @param message\n   */\n  public debug(message: any) {\n    this.log(message, LogLevel.DEBUG);\n  }\n\n  /**\n   * Log the message with \"info\" level - for relevant information that occurs during regular functioning of the app.\n   * @param message\n   */\n  public info(message: any) {\n    this.log(message, LogLevel.INFO);\n  }\n\n  /**\n   * Log the message with \"warning\" level - for unexpected events that the app can still handle gracefully.\n   * @param message\n   */\n  public warn(message: any) {\n    this.log(message, LogLevel.WARN);\n  }\n\n  /**\n   * Log the message with \"error\" level - for unexpected critical events that cannot be handled and will affect functions.\n   * @param message\n   */\n  public error(message: any) {\n    this.log(message, LogLevel.ERROR);\n  }\n\n  /**\n   * Generic logging of a message.\n   * @param message Message to be logged\n   * @param logLevel Optional log level - default is \"info\"\n   */\n  public log(message: any, logLevel: LogLevel = LogLevel.INFO) {\n    this.logToConsole(message, logLevel);\n\n    if (logLevel !== LogLevel.DEBUG && logLevel !== LogLevel.INFO) {\n      this.logToRemoteMonitoring(message, logLevel);\n    }\n  }\n\n  private logToConsole(message: any, logLevel: LogLevel) {\n    switch (+logLevel) {\n      case LogLevel.DEBUG:\n        console.debug(message);\n        break;\n      case LogLevel.INFO:\n        console.info(message);\n        break;\n      case LogLevel.WARN:\n        console.warn(message);\n        break;\n      case LogLevel.ERROR:\n        console.error(message);\n        break;\n      default:\n        console.log(message);\n        break;\n    }\n  }\n\n  private logToRemoteMonitoring(message: any, logLevel: LogLevel) {\n    Sentry.captureMessage(message, this.translateLogLevel(logLevel));\n  }\n\n  private translateLogLevel(logLevel: LogLevel): Sentry.Severity {\n    switch (+logLevel) {\n      case LogLevel.DEBUG:\n        return Sentry.Severity.Debug;\n      case LogLevel.INFO:\n        return Sentry.Severity.Info;\n      case LogLevel.WARN:\n        return Sentry.Severity.Warning;\n      case LogLevel.ERROR:\n        return Sentry.Severity.Error;\n      default:\n        return Sentry.Severity.Info;\n    }\n  }\n}\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * Structure for menu items to be displayed.\n *\n * also see {@link NavigationItemsService}\n */\nexport class MenuItem {\n  /**\n   * Create a menu item.\n   * @param label The text to be displayed in the menu.\n   * @param icon The icon to be displayed left of the label.\n   * @param routerLinkParameters The Angular routerLink parameters to which the item will route to (e.g. ['/dashboard'])\n   */\n  constructor(\n    public label: string,\n    public icon: string,\n    public routerLinkParameters: any[]\n  ) {}\n}\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { NgModule } from \"@angular/core\";\nimport { CommonModule } from \"@angular/common\";\nimport { NavigationComponent } from \"./navigation/navigation.component\";\nimport { SessionModule } from \"../session/session.module\";\nimport { RouterModule } from \"@angular/router\";\nimport { MatButtonModule } from \"@angular/material/button\";\nimport { MatIconModule } from \"@angular/material/icon\";\nimport { MatListModule } from \"@angular/material/list\";\nimport { MatTooltipModule } from \"@angular/material/tooltip\";\nimport { Angulartics2Module } from \"angulartics2\";\nimport { ConfigModule } from \"../config/config.module\";\n\n/**\n * Manages the main app navigation menu\n * which can dynamically be configured through the {@link NavigationItemsService}.\n */\n@NgModule({\n  imports: [\n    CommonModule,\n    SessionModule,\n    RouterModule,\n    MatListModule,\n    MatIconModule,\n    MatButtonModule,\n    MatTooltipModule,\n    Angulartics2Module,\n    ConfigModule,\n  ],\n  declarations: [NavigationComponent],\n  exports: [NavigationComponent],\n  providers: [],\n})\nexport class NavigationModule {}\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { Component, OnInit } from \"@angular/core\";\nimport { MenuItem } from \"../menu-item\";\nimport { AdminGuard } from \"../../admin/admin.guard\";\nimport { ConfigService } from \"app/core/config/config.service\";\nimport { NavigationMenuConfig } from \"../navigation-menu-config.interface\";\nimport { RouterService } from \"../../view/router.service\";\n\n/**\n * Main app menu listing.\n *\n * To add new entries use {@link NavigationItemsService}.\n */\n@Component({\n  selector: \"app-navigation\",\n  templateUrl: \"./navigation.component.html\",\n  styleUrls: [\"./navigation.component.scss\"],\n})\nexport class NavigationComponent implements OnInit {\n  /** name of config array in the config json file */\n  private readonly CONFIG_ID = \"navigationMenu\";\n  /** all menu items to be displayed */\n  public menuItems: MenuItem[] = [];\n\n  constructor(\n    private adminGuard: AdminGuard,\n    private configService: ConfigService\n  ) {}\n\n  ngOnInit(): void {\n    this.initMenuItemsFromConfig();\n  }\n\n  /**\n   * Load menu items from config file\n   */\n  private initMenuItemsFromConfig() {\n    const config: NavigationMenuConfig = this.configService.getConfig<\n      NavigationMenuConfig\n    >(this.CONFIG_ID);\n    for (const configItem of config.items) {\n      if (this.checkMenuItemPermissions(configItem.link)) {\n        this.menuItems.push(\n          new MenuItem(configItem.name, configItem.icon, [configItem.link])\n        );\n      }\n    }\n  }\n\n  /**\n   * Check whether the user has the required rights\n   */\n  private checkMenuItemPermissions(link: string): boolean {\n    const viewConfig = this.configService.getConfig<any>(\n      RouterService.PREFIX_VIEW_CONFIG + link.replace(/^\\//, \"\")\n    );\n    return !viewConfig?.requiresAdmin || this.adminGuard.isAdmin();\n  }\n}\n","<!--\n  ~     This file is part of ndb-core.\n  ~\n  ~     ndb-core is free software: you can redistribute it and/or modify\n  ~     it under the terms of the GNU General Public License as published by\n  ~     the Free Software Foundation, either version 3 of the License, or\n  ~     (at your option) any later version.\n  ~\n  ~     ndb-core is distributed in the hope that it will be useful,\n  ~     but WITHOUT ANY WARRANTY; without even the implied warranty of\n  ~     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n  ~     GNU General Public License for more details.\n  ~\n  ~     You should have received a copy of the GNU General Public License\n  ~     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n  -->\n\n<mat-nav-list>\n  <mat-list-item\n    angulartics2On=\"click\"\n    angularticsCategory=\"Navigation\"\n    angularticsAction=\"app_navigation_link_click\"\n    [angularticsLabel]=\"item.label\"\n    *ngFor=\"let item of menuItems\"\n    [routerLink]=\"item.routerLinkParameters\"\n  >\n    <a\n      ><mat-icon class=\"nav-icon\" fontIcon=\"fa-{{ item.icon }}\"></mat-icon\n      >{{ item.label }}</a\n    >\n    <mat-divider></mat-divider>\n  </mat-list-item>\n</mat-nav-list>\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { Injectable } from \"@angular/core\";\nimport { CanActivate } from \"@angular/router\";\nimport { SessionService } from \"../session-service/session.service\";\n\n/**\n * Angular guard to prevent routing if no user is currently logged in.\n */\n@Injectable()\nexport class LoggedInGuard implements CanActivate {\n  constructor(private _sessionService: SessionService) {}\n\n  /**\n   * Allow if a user is logged in currently.\n   */\n  canActivate() {\n    return this._sessionService.isLoggedIn();\n  }\n}\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { Component } from \"@angular/core\";\nimport { SyncState } from \"../session-states/sync-state.enum\";\nimport { SessionService } from \"../session-service/session.service\";\nimport { LoginState } from \"../session-states/login-state.enum\";\nimport { ConnectionState } from \"../session-states/connection-state.enum\";\n\n/**\n * Form to allow users to enter their credentials and log in.\n */\n@Component({\n  selector: \"app-login\",\n  templateUrl: \"./login.component.html\",\n  styleUrls: [\"./login.component.scss\"],\n})\nexport class LoginComponent {\n  /** true while a login is started but result is not received yet */\n  loginInProgress = false;\n\n  /** username as entered in form */\n  username: string;\n\n  /** password as entered in form */\n  password: string;\n\n  /** errorMessage displayed in form */\n  errorMessage: string;\n\n  constructor(private _sessionService: SessionService) {}\n\n  /**\n   * Do a login with the SessionService.\n   */\n  login() {\n    this.loginInProgress = true;\n\n    this._sessionService\n      .login(this.username, this.password)\n      .then((loginState) => {\n        if (loginState === LoginState.LOGGED_IN) {\n          this.onLoginSuccess();\n        } else {\n          if (\n            this._sessionService.getSyncState().getState() ===\n              SyncState.ABORTED &&\n            this._sessionService.getConnectionState().getState() ===\n              ConnectionState.OFFLINE\n          ) {\n            this.onLoginFailure(\n              \"Can't login for the first time when offline. Please try again later.\"\n            );\n          } else if (\n            this._sessionService.getConnectionState().getState() ===\n            ConnectionState.OFFLINE\n          ) {\n            this.onLoginFailure(\n              \"Username or password incorrect!\" +\n                \" You might also face this problem because you are currently offline.\" +\n                \" Please connect to the internet to synchronize the latest user data.\"\n            );\n          } else {\n            this.onLoginFailure(\"Username or password incorrect!\");\n          }\n        }\n      })\n      .catch((reason) =>\n        this.onLoginFailure(\n          typeof reason === \"string\" ? reason : JSON.stringify(reason)\n        )\n      );\n  }\n\n  private onLoginSuccess() {\n    this.reset();\n    // login component is automatically hidden based on _sessionService.isLoggedIn()\n  }\n\n  private onLoginFailure(reason: any) {\n    this.reset();\n    this.errorMessage = reason;\n  }\n\n  private reset() {\n    this.errorMessage = \"\";\n    this.password = \"\";\n    this.loginInProgress = false;\n  }\n}\n","<!--\n  ~     This file is part of ndb-core.\n  ~\n  ~     ndb-core is free software: you can redistribute it and/or modify\n  ~     it under the terms of the GNU General Public License as published by\n  ~     the Free Software Foundation, either version 3 of the License, or\n  ~     (at your option) any later version.\n  ~\n  ~     ndb-core is distributed in the hope that it will be useful,\n  ~     but WITHOUT ANY WARRANTY; without even the implied warranty of\n  ~     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n  ~     GNU General Public License for more details.\n  ~\n  ~     You should have received a copy of the GNU General Public License\n  ~     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n  -->\n\n<mat-card class=\"login-panel centered\">\n  <mat-card-title>\n    Please Sign In\n  </mat-card-title>\n\n\n  <mat-card-content>\n    <form>\n      <p class=\"login-error\">\n        {{errorMessage}}\n      </p>\n\n      <p>\n        <mat-form-field class=\"login-field\">\n          <input matInput placeholder=\"Username\" type=\"text\" [(ngModel)]=\"username\" (keyup.enter)=\"login()\" required autofocus\n                 name=\"username\" autocomplete=\"username\">\n          <mat-error>{{errorMessage}}</mat-error>\n        </mat-form-field>\n      </p>\n      <p>\n        <mat-form-field class=\"login-field\">\n          <input matInput placeholder=\"Password\" type=\"password\" [(ngModel)]=\"password\" (keyup.enter)=\"login()\" required\n                 name=\"password\" autocomplete=\"current-password\">\n        </mat-form-field>\n      </p>\n\n      <p>\n        <button mat-raised-button type=\"submit\" [disabled]=\"loginInProgress\" (click)=\"login()\">\n          Login\n        </button>\n      </p>\n    </form>\n  </mat-card-content>\n</mat-card>\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport PouchDB from \"pouchdb-browser\";\n\nimport { Injectable } from \"@angular/core\";\n\nimport { AppConfig } from \"../../app-config/app-config\";\nimport { User } from \"../../user/user\";\n\nimport { SyncState } from \"../session-states/sync-state.enum\";\nimport { LoginState } from \"../session-states/login-state.enum\";\nimport { StateHandler } from \"../session-states/state-handler\";\nimport { EntitySchemaService } from \"app/core/entity/schema/entity-schema.service\";\nimport { AlertService } from \"app/core/alerts/alert.service\";\nimport { LoggingService } from \"../../logging/logging.service\";\nimport { AnalyticsService } from \"../../analytics/analytics.service\";\n\n/**\n * Responsibilities:\n * - Hold the local DB\n * - Hold local user\n * - Check credentials against DB\n * - Provide the state of the synchronisation of the local db\n *   - we want to block before the first full sync\n * - Provide an interface to access the data\n */\n@Injectable()\nexport class LocalSession {\n  /** local (IndexedDb) database PouchDB */\n  public database: any;\n  public liveSyncHandle: any;\n\n  /** StateHandler for login state changes */\n  public loginState: StateHandler<LoginState>;\n  /** StateHandler for sync state changes */\n  public syncState: StateHandler<SyncState>;\n\n  /** The currently authenticated user entity */\n  public currentUser: User;\n\n  /**\n   * Create a LocalSession and set up the local PouchDB instance based on AppConfig settings.\n   * @param _alertService\n   * @param _entitySchemaService\n   * @param _analyticsService\n   */\n  constructor(\n    private _alertService: AlertService,\n    private _entitySchemaService: EntitySchemaService\n  ) {\n    this.database = new PouchDB(AppConfig.settings.database.name);\n\n    this.loginState = new StateHandler<LoginState>(LoginState.LOGGED_OUT);\n    this.syncState = new StateHandler<SyncState>(SyncState.UNSYNCED);\n  }\n\n  /**\n   * Get a login at the local session by fetching the user from the local database and validating the password.\n   * Returns a Promise resolving with the loginState.\n   * Attention: This method waits for the first synchronisation of the database (or a fail of said initial sync).\n   * @param username Username\n   * @param password Password\n   */\n  public async login(username: string, password: string): Promise<LoginState> {\n    try {\n      await this.waitForFirstSync();\n      const userEntity = await this.loadUser(username);\n      if (userEntity.checkPassword(password)) {\n        this.currentUser = userEntity;\n        this.currentUser.decryptCloudPassword(password);\n        LoggingService.setLoggingContextUser(this.currentUser.name);\n        AnalyticsService.setUser(this.currentUser.name);\n        AnalyticsService.eventTrack(\"user_login\", {\n          category: \"Auth\",\n          label: \"successful\",\n          value: 1,\n        });\n        this.loginState.setState(LoginState.LOGGED_IN);\n        return LoginState.LOGGED_IN;\n      } else {\n        this.loginState.setState(LoginState.LOGIN_FAILED);\n        AnalyticsService.eventTrack(\"user_login\", {\n          category: \"Auth\",\n          label: \"failed_wrong_credentials\",\n          value: 0,\n        });\n        return LoginState.LOGIN_FAILED;\n      }\n    } catch (error) {\n      // possible error: initial sync failed or aborted\n      if (\n        error &&\n        error.toState &&\n        [SyncState.ABORTED, SyncState.FAILED].includes(error.toState)\n      ) {\n        if (this.loginState.getState() === LoginState.LOGIN_FAILED) {\n          AnalyticsService.eventTrack(\"user_login\", {\n            category: \"Auth\",\n            label: \"failed_sync_failed_remote_reject\",\n            value: 10,\n          });\n          // The sync failed because the remote rejected\n          return LoginState.LOGIN_FAILED;\n        }\n        AnalyticsService.eventTrack(\"user_login\", {\n          category: \"Auth\",\n          label: \"failed_sync_failed_unknown\",\n          value: 20,\n        });\n        // The sync failed for other reasons. The user should try again\n        this.loginState.setState(LoginState.LOGGED_OUT);\n        return LoginState.LOGGED_OUT;\n      }\n      // possible error: user object not found locally, which should return loginFailed.\n      if (error && error.status && error.status === 404) {\n        AnalyticsService.eventTrack(\"user_login\", {\n          category: \"Auth\",\n          label: \"failed\",\n          value: 30,\n        });\n        this.loginState.setState(LoginState.LOGIN_FAILED);\n        return LoginState.LOGIN_FAILED;\n      }\n      // all other cases must throw an error\n      throw error;\n    }\n  }\n\n  /**\n   * Wait for the first sync of the database, returns a Promise.\n   * Resolves directly, if the database is not initial, otherwise waits for the first change of the SyncState to completed (or failed)\n   */\n  public async waitForFirstSync() {\n    if (await this.isInitial()) {\n      return await this.syncState.waitForChangeTo(SyncState.COMPLETED, [\n        SyncState.FAILED,\n        SyncState.ABORTED,\n      ]);\n    }\n  }\n\n  /**\n   * Check whether the local database is in an initial state.\n   * This check can only be performed async, so this method returns a Promise\n   */\n  public isInitial(): Promise<Boolean> {\n    // `doc_count === 0 => initial` is a valid assumptions, as documents for users must always be present, even after db-clean\n    return this.database.info().then((result) => result.doc_count === 0);\n  }\n\n  /**\n   * Logout\n   */\n  public logout() {\n    this.currentUser = undefined;\n    AnalyticsService.eventTrack(\"user_logout\", {\n      category: \"Auth\",\n      label: \"successful\",\n      value: 1,\n    });\n    this.loginState.setState(LoginState.LOGGED_OUT);\n  }\n\n  /**\n   * Helper to get a User Entity from the Database without needing the EntityMapperService\n   * @param userId Id of the User to be loaded\n   */\n  public async loadUser(userId: string): Promise<User> {\n    const user = new User(\"\");\n    const userData = await this.database.get(\"User:\" + userId);\n    this._entitySchemaService.loadDataIntoEntity(user, userData);\n    return user;\n  }\n}\n","import { SessionService } from \"./session.service\";\nimport { User } from \"app/core/user/user\";\nimport { StateHandler } from \"../session-states/state-handler\";\nimport { ConnectionState } from \"../session-states/connection-state.enum\";\nimport { LoginState } from \"../session-states/login-state.enum\";\nimport { SyncState } from \"../session-states/sync-state.enum\";\nimport { MockDatabase } from \"app/core/database/mock-database\";\nimport { Database } from \"app/core/database/database\";\nimport { EntitySchemaService } from \"app/core/entity/schema/entity-schema.service\";\n\n/**\n * SessionService implementation for testing and demo purposes.\n * The MockSessionService does not set up a remote connection or sync and only creates an in-memory database,\n * which will lose any changes after closing the browser.\n *\n * Set `\"database\": { \"useTemporaryDatabase\": true }` in your app-config.json\n * to use the MockSessionService which will also generate demo data.\n *\n * For an CouchDB/PouchDB sync based session implementation see {@link SyncedSessionService}\n */\nexport class MockSessionService extends SessionService {\n  private database: MockDatabase;\n  private currentUser: User;\n  private loginState: StateHandler<LoginState> = new StateHandler<LoginState>(\n    LoginState.LOGGED_OUT\n  );\n  private connectionState: StateHandler<ConnectionState> = new StateHandler<\n    ConnectionState\n  >(ConnectionState.DISCONNECTED);\n  private syncState: StateHandler<SyncState> = new StateHandler<SyncState>(\n    SyncState.UNSYNCED\n  );\n\n  constructor(private _entitySchemaService: EntitySchemaService) {\n    super();\n    this.database = new MockDatabase();\n  }\n\n  /** see {@link SessionService} */\n  public getCurrentUser(): User {\n    return this.currentUser;\n  }\n\n  /** see {@link SessionService} */\n  public isLoggedIn(): boolean {\n    return this.loginState.getState() === LoginState.LOGGED_IN;\n  }\n  /** see {@link SessionService} */\n  public getConnectionState(): StateHandler<ConnectionState> {\n    return this.connectionState;\n  }\n  /** see {@link SessionService} */\n  public getLoginState(): StateHandler<LoginState> {\n    return this.loginState;\n  }\n  /** see {@link SessionService} */\n  public getSyncState(): StateHandler<SyncState> {\n    return this.syncState;\n  }\n  /** see {@link SessionService} */\n  public getDatabase(): Database {\n    return this.database;\n  }\n\n  /**\n   * Log in the given user.\n   * Checks the in-memory database for User Entities to authenticate against.\n   *\n   * also see {@link SessionService}\n   */\n  public async login(username, password): Promise<LoginState> {\n    try {\n      const userEntity = await this.loadUser(username);\n      if (userEntity.checkPassword(password)) {\n        this.loginState.setState(LoginState.LOGGED_IN);\n        this.connectionState.setState(ConnectionState.CONNECTED);\n        this.currentUser = userEntity;\n        this.currentUser.decryptCloudPassword(password);\n        setTimeout(() => this.sync(), 0);\n        return LoginState.LOGGED_IN;\n      } else {\n        this.loginState.setState(LoginState.LOGIN_FAILED);\n        this.connectionState.setState(ConnectionState.REJECTED);\n        return LoginState.LOGIN_FAILED;\n      }\n    } catch (error) {\n      // possible error: user object not found locally, which should return loginFailed.\n      if (error && error.status && error.status === 404) {\n        this.loginState.setState(LoginState.LOGIN_FAILED);\n        this.connectionState.setState(ConnectionState.REJECTED);\n        return LoginState.LOGIN_FAILED;\n      }\n      // all other cases must throw an error\n      throw error;\n    }\n  }\n  /** see {@link SessionService} */\n  public logout(): void {\n    this.loginState.setState(LoginState.LOGGED_OUT);\n    this.connectionState.setState(ConnectionState.DISCONNECTED);\n  }\n\n  /**\n   * Dummy implementation, will trigger syncState to quickly switch to SyncState.COMPLETED.\n   */\n  public sync(): Promise<any> {\n    this.syncState.setState(SyncState.STARTED);\n    return new Promise((resolve) =>\n      setTimeout(() => {\n        this.syncState.setState(SyncState.COMPLETED);\n        resolve();\n      }, 0)\n    );\n  }\n\n  /**\n   * Helper to get a User Entity from the Database without needing the EntityMapperService\n   * @param userId Id of the User to be loaded\n   */\n  public async loadUser(userId: string): Promise<User> {\n    const user = new User(\"\");\n    const userData = await this.database.get(\"User:\" + userId);\n    this._entitySchemaService.loadDataIntoEntity(user, userData);\n    return user;\n  }\n}\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport PouchDB from \"pouchdb-browser\";\nimport PouchDBAuthentication from \"pouchdb-authentication\";\n\nimport { AppConfig } from \"../../app-config/app-config\";\nimport { Injectable } from \"@angular/core\";\nimport { StateHandler } from \"../session-states/state-handler\";\nimport { ConnectionState } from \"../session-states/connection-state.enum\";\n\nPouchDB.plugin(PouchDBAuthentication);\n\n/**\n * Responsibilities:\n * - Hold the remote DB\n * - Handle auth\n * - provide \"am i online\"-info\n */\n@Injectable()\nexport class RemoteSession {\n  /** remote (!) database PouchDB */\n  public database: any;\n\n  /** state of the remote connection */\n  public connectionState: StateHandler<ConnectionState> = new StateHandler<\n    ConnectionState\n  >(ConnectionState.DISCONNECTED);\n\n  /**\n   * Create a RemoteSession and set up connection to the remote database CouchDB server configured in AppConfig.\n   */\n  constructor() {\n    const thisRemoteSession = this;\n    this.database = new PouchDB(\n      AppConfig.settings.database.remote_url + AppConfig.settings.database.name,\n      {\n        ajax: {\n          rejectUnauthorized: false,\n          timeout: AppConfig.settings.database.timeout,\n        },\n        // This is a workaround for PouchDB 7.0.0 with pouchdb-authentication 1.1.3:\n        // https://github.com/pouchdb-community/pouchdb-authentication/issues/239\n        // It is necessary, until this merged PR will be published in PouchDB 7.0.1\n        // https://github.com/pouchdb/pouchdb/pull/7395\n        fetch(url, opts) {\n          opts.credentials = \"include\";\n          const req = fetch(url, opts);\n          req.then((result) => {\n            if (\n              thisRemoteSession.connectionState.getState() ===\n              ConnectionState.OFFLINE\n            ) {\n              thisRemoteSession.connectionState.setState(\n                ConnectionState.CONNECTED\n              );\n            }\n            return result;\n          });\n          req.catch((error) => {\n            // fetch will throw on network errors, giving us a chance to check the online status\n            // if we are offline at the start, this will already be set on login, so we need not check that initial condition here\n            // do not set offline on AbortErrors, as these are fine:\n            // https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/fetch#Exceptions\n            if (\n              error.name !== \"AbortError\" &&\n              thisRemoteSession.connectionState.getState() ===\n                ConnectionState.CONNECTED\n            ) {\n              thisRemoteSession.connectionState.setState(\n                ConnectionState.OFFLINE\n              );\n            }\n            throw error;\n          });\n          return req;\n        },\n        skip_setup: true,\n      } as PouchDB.Configuration.RemoteDatabaseConfiguration\n    );\n  }\n\n  /**\n   * Connect to the remote Database. Tries to determine from a possible error whether the login was rejected or the user is offline.\n   * @param username Username\n   * @param password Password\n   */\n  public async login(\n    username: string,\n    password: string\n  ): Promise<ConnectionState> {\n    const ajaxOpts = {\n      ajax: {\n        headers: {\n          Authorization: \"Basic \" + window.btoa(username + \":\" + password),\n        },\n      },\n    };\n\n    try {\n      await this.database.login(username, password, ajaxOpts);\n      this.connectionState.setState(ConnectionState.CONNECTED);\n      return ConnectionState.CONNECTED;\n    } catch (error) {\n      if (error.name === \"unauthorized\" || error.name === \"forbidden\") {\n        this.connectionState.setState(ConnectionState.REJECTED);\n        return ConnectionState.REJECTED;\n      } else {\n        this.connectionState.setState(ConnectionState.OFFLINE);\n        return ConnectionState.OFFLINE;\n      }\n    }\n  }\n\n  /**\n   * Logout at the remote database.\n   */\n  public logout(): void {\n    this.database.logout();\n    this.connectionState.setState(ConnectionState.DISCONNECTED);\n  }\n}\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { Injectable } from \"@angular/core\";\n\nimport { LoginState } from \"../session-states/login-state.enum\";\nimport { Database } from \"../../database/database\";\nimport { ConnectionState } from \"../session-states/connection-state.enum\";\nimport { SyncState } from \"../session-states/sync-state.enum\";\nimport { User } from \"../../user/user\";\nimport { StateHandler } from \"../session-states/state-handler\";\n\n/**\n * A session manages user authentication and database connection for the app.\n *\n * To get the current user object in any other class, inject the SessionService.\n *\n * The SessionService also sets up and provides the Database.\n * To access the database in other classes\n * you should use rather inject the `Database` or the `EntityMapperService` directly, however.\n *\n * This SessionService is the abstract base class for the concrete implementations like SyncedSessionService.\n * You should still use `SessionService` as the dependency injection key to get access to the functionality,\n * providers are set up in a way that you will get the correct implementation during runtime.\n */\n@Injectable()\nexport abstract class SessionService {\n  /**\n   * Authenticate a user.\n   * @param username\n   * @param password\n   */\n  abstract login(username: string, password: string): Promise<LoginState>;\n\n  /**\n   * Logout the current user.\n   */\n  abstract logout();\n\n  /**\n   * Get the currently logged in user (or undefined).\n   */\n  abstract getCurrentUser(): User;\n\n  /**\n   * Get the session status - whether a user is authenticated currently.\n   */\n  abstract isLoggedIn(): boolean;\n\n  /**\n   * Get the state of the session.\n   */\n  abstract getLoginState(): StateHandler<LoginState>;\n\n  /**\n   * Get the state of the connection to the remote server.\n   */\n  abstract getConnectionState(): StateHandler<ConnectionState>;\n\n  /**\n   * Get the state of the synchronization with the remote server.\n   */\n  abstract getSyncState(): StateHandler<SyncState>;\n\n  /**\n   * Start a synchronization process.\n   */\n  abstract sync(): Promise<any>;\n\n  /**\n   * Get the database for the current session.\n   */\n  abstract getDatabase(): Database;\n}\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { Injectable } from \"@angular/core\";\nimport { AlertService } from \"../../alerts/alert.service\";\n\nimport { SessionService } from \"./session.service\";\nimport { LocalSession } from \"./local-session\";\nimport { RemoteSession } from \"./remote-session\";\nimport { LoginState } from \"../session-states/login-state.enum\";\nimport { Database } from \"../../database/database\";\nimport { PouchDatabase } from \"../../database/pouch-database\";\nimport { ConnectionState } from \"../session-states/connection-state.enum\";\nimport { SyncState } from \"../session-states/sync-state.enum\";\nimport { User } from \"../../user/user\";\nimport { EntitySchemaService } from \"app/core/entity/schema/entity-schema.service\";\nimport { LoggingService } from \"../../logging/logging.service\";\n\n/**\n * A synced session creates and manages a LocalSession and a RemoteSession\n * and handles the setup of synchronisation.\n *\n * also see\n * [Session Handling, Authentication & Synchronisation]{@link /additional-documentation/concepts/session-and-authentication-system.html}\n */\n@Injectable()\nexport class SyncedSessionService extends SessionService {\n  private _localSession: LocalSession;\n  private _remoteSession: RemoteSession;\n  private _liveSyncHandle: any;\n  private _liveSyncScheduledHandle: any;\n  private _offlineRetryLoginScheduleHandle: any;\n\n  constructor(\n    private _alertService: AlertService,\n    private _loggingService: LoggingService,\n    private _entitySchemaService: EntitySchemaService\n  ) {\n    super();\n    this._localSession = new LocalSession(\n      this._alertService,\n      this._entitySchemaService\n    );\n    this._remoteSession = new RemoteSession();\n  }\n\n  /** see {@link SessionService} */\n  public isLoggedIn(): boolean {\n    return this._localSession.loginState.getState() === LoginState.LOGGED_IN;\n  }\n\n  /**\n   * Perform a login. The result will only be the login at the local DB, as we might be offline.\n   * Calling this function will trigger a login in the background.\n   * - If it is successful, a sync is performed in the background\n   * - If it fails due to wrong credentials, yet the local login was successful somehow, we fail local login after the fact\n   *\n   * If the localSession is empty, the local login waits for the result of the sync triggered by the remote login (see local-session.ts).\n   * If the remote login fails for some reason, this sync will never be performed, which is why it must be failed manually here\n   * to abort the local login and prevent a deadlock.\n   * @param username Username\n   * @param password Password\n   * @returns a promise resolving with the local LoginState\n   */\n  public login(username: string, password: string): Promise<LoginState> {\n    this.cancelLoginOfflineRetry(); // in case this is running in the background\n    this.getSyncState().setState(SyncState.UNSYNCED);\n\n    const localLogin = this._localSession.login(username, password);\n    const remoteLogin = this._remoteSession.login(username, password);\n\n    remoteLogin.then(async (connectionState: ConnectionState) => {\n      // remote connected -- sync!\n      if (connectionState === ConnectionState.CONNECTED) {\n        const syncPromise = this.sync(); // no liveSync() here, as we can't know when that's finished if there are no changes.\n\n        // no matter the result of the non-live sync(), start liveSync() once it is done\n        syncPromise.then(\n          // successful -> start liveSync()\n          () => this.liveSyncDeferred(),\n          // not successful -> only start a liveSync() to retry, if we are logged in locally\n          // otherwise the UI is in a fairly unusable state.\n          async () => {\n            if ((await localLogin) === LoginState.LOGGED_IN) {\n              this.liveSyncDeferred();\n            } else {\n              // TODO(lh): Alert the AlertService: Your password was changed recently, but there is an issue with sync. Try again later!\n            }\n          }\n        );\n\n        // asynchronously check if the local login failed --> this happens, when the password was changed at the remote\n        localLogin.then(async (loginState: LoginState) => {\n          if (loginState === LoginState.LOGIN_FAILED) {\n            // in this case: when the sync is completed, retry the local login after the sync\n            await syncPromise;\n            return this._localSession.login(username, password);\n          }\n        });\n\n        return syncPromise;\n      }\n\n      // If we are not connected, we must check (asynchronously), whether the local database is initial\n      this._localSession.isInitial().then((isInitial) => {\n        if (isInitial) {\n          // If we were initial, the local session was waiting for a sync.\n          if (connectionState === ConnectionState.REJECTED) {\n            // Explicitly fail the login if the Connection was rejected, so the LocalSession knows what's going on\n            // additionally, fail sync to resolve deadlock\n            this._localSession.loginState.setState(LoginState.LOGIN_FAILED);\n            this._localSession.syncState.setState(SyncState.FAILED);\n          } else {\n            // Explicitly abort the sync to resolve the deadlock\n            this._localSession.syncState.setState(SyncState.ABORTED);\n          }\n        }\n      });\n\n      // remote rejected but local logged in\n      if (connectionState === ConnectionState.REJECTED) {\n        if ((await localLogin) === LoginState.LOGGED_IN) {\n          // Someone changed the password remotely --> log out and signal failed login\n          this._localSession.logout();\n          this._localSession.loginState.setState(LoginState.LOGIN_FAILED);\n          this._alertService.addDanger(\n            \"Your password was changed recently. Please retry with your new password!\"\n          );\n        }\n      }\n\n      // offline? retry (unless we are in an initial state)! TODO(lh): Backoff\n      if (\n        connectionState === ConnectionState.OFFLINE &&\n        !(await this._localSession.isInitial())\n      ) {\n        this._offlineRetryLoginScheduleHandle = setTimeout(() => {\n          this.login(username, password);\n        }, 2000);\n      }\n    });\n    return localLogin; // the local login is the Promise that counts\n  }\n\n  /** see {@link SessionService} */\n  public getCurrentUser(): User {\n    return this._localSession.currentUser;\n  }\n\n  /** see {@link SessionService} */\n  public getLoginState() {\n    return this._localSession.loginState;\n  }\n  /** see {@link SessionService} */\n  public getConnectionState() {\n    return this._remoteSession.connectionState;\n  }\n  /** see {@link SessionService} */\n  public getSyncState() {\n    return this._localSession.syncState;\n  }\n\n  /** see {@link SessionService} */\n  public async sync(): Promise<any> {\n    this._localSession.syncState.setState(SyncState.STARTED);\n    try {\n      const result = await this._localSession.database.sync(\n        this._remoteSession.database,\n        { batch_size: 500 }\n      );\n      this._localSession.syncState.setState(SyncState.COMPLETED);\n      return result;\n    } catch (error) {\n      this._localSession.syncState.setState(SyncState.FAILED);\n      throw error; // rethrow, so later Promise-handling lands in .catch, too\n    }\n  }\n\n  /**\n   * Start live sync in background.\n   */\n  public liveSync() {\n    this.cancelLiveSync(); // cancel any liveSync that may have been alive before\n    this._localSession.syncState.setState(SyncState.STARTED);\n    this._liveSyncHandle = this._localSession.database\n      .sync(this._remoteSession.database, {\n        live: true,\n        retry: true,\n      })\n      .on(\"change\", (change) => {\n        // after sync. change has direction and changes with info on errors etc\n      })\n      .on(\"paused\", (info) => {\n        // replication was paused: either because sync is finished or because of a failed sync (mostly due to lost connection). info is empty.\n        if (this.getConnectionState().getState() !== ConnectionState.OFFLINE) {\n          this._localSession.syncState.setState(SyncState.COMPLETED);\n          // We might end up here after a failed sync that is not due to offline errors.\n          // It shouldn't happen too often, as we have an initial non-live sync to catch those situations, but we can't find that out here\n        }\n      })\n      .on(\"active\", (info) => {\n        // replication was resumed: either because new things to sync or because connection is available again. info contains the direction\n        this._localSession.syncState.setState(SyncState.STARTED);\n      })\n      .on(\"error\", (err) => {\n        // totally unhandled error (shouldn't happen)\n        this._localSession.syncState.setState(SyncState.FAILED);\n      })\n      .on(\"complete\", (info) => {\n        // replication was canceled!\n        this._liveSyncHandle = null;\n      });\n    return this._liveSyncHandle;\n  }\n\n  /**\n   * Schedules liveSync to be started.\n   * This method should be used to start the liveSync after the initial non-live sync,\n   * so the browser makes a round trip to the UI and hides the potentially visible first-sync dialog.\n   * @param timeout ms to wait before starting the liveSync\n   */\n  public liveSyncDeferred(timeout = 1000) {\n    this.cancelLiveSync(); // cancel any liveSync that may have been alive before\n    this._liveSyncScheduledHandle = setTimeout(() => this.liveSync(), timeout);\n  }\n\n  /**\n   * Cancels a pending login retry scheduled to start in the future.\n   */\n  public cancelLoginOfflineRetry() {\n    if (this._offlineRetryLoginScheduleHandle) {\n      clearTimeout(this._offlineRetryLoginScheduleHandle);\n    }\n  }\n\n  /**\n   * Cancels a currently running liveSync or a liveSync scheduled to start in the future.\n   */\n  public cancelLiveSync() {\n    if (this._liveSyncScheduledHandle) {\n      clearTimeout(this._liveSyncScheduledHandle);\n    }\n    if (this._liveSyncHandle) {\n      this._liveSyncHandle.cancel();\n    }\n  }\n\n  /**\n   * Get the local database instance that should be used for regular data access.\n   * als see {@link SessionService}\n   */\n  public getDatabase(): Database {\n    return new PouchDatabase(\n      this._localSession.database,\n      this._alertService,\n      this._loggingService\n    );\n  }\n\n  /**\n   * Logout and stop any existing sync.\n   * also see {@link SessionService}\n   */\n  public logout() {\n    this.cancelLoginOfflineRetry();\n    this.cancelLiveSync();\n    this._localSession.logout();\n    this._remoteSession.logout();\n  }\n}\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\n/** State of the connection to the remote database  */\nexport enum ConnectionState {\n  /** we are offline and therefor not connected to the remote db */\n  OFFLINE,\n  /** we tried to login, but it failed, so we are not connected to the remote db */\n  REJECTED,\n  /** we are intentionally not connected to the remote db */\n  DISCONNECTED,\n  /** we are connected to the remote db */\n  CONNECTED,\n}\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\n/** State of the login at the local database, which is synonymous to login at the whole application */\nexport enum LoginState {\n  /** Login failed due to wrong credentials */\n  LOGIN_FAILED,\n  /** Login state either before first login-attempt or after logout */\n  LOGGED_OUT,\n  /** Successfully logged in */\n  LOGGED_IN,\n}\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { EventEmitter } from \"@angular/core\";\n\n/**\n * Interface of state transition events.\n */\nexport interface StateChangedEvent<StateEnum> {\n  /** previous state before change */\n  fromState: StateEnum;\n\n  /** new state after change */\n  toState: StateEnum;\n}\n\n/**\n * Utility class supporting generic state transitions by emitting change events\n * and allowing to wait for a certain state transition.\n */\nexport class StateHandler<StateEnum> {\n  private state: StateEnum;\n  private stateChanged: EventEmitter<\n    StateChangedEvent<StateEnum>\n  > = new EventEmitter<StateChangedEvent<StateEnum>>();\n\n  /**\n   * Create a StateHandler helper.\n   * @param defaultState Optional initial state.\n   */\n  constructor(defaultState?: StateEnum) {\n    this.state = defaultState;\n  }\n\n  /**\n   * Get the current state.\n   */\n  public getState(): StateEnum {\n    return this.state;\n  }\n\n  /**\n   * Change to the given new state.\n   * The state handler ensures an event is emitted.\n   * @param state The new state\n   */\n  public setState(state: StateEnum): StateHandler<StateEnum> {\n    const oldState = this.state;\n    this.state = state;\n    this.stateChanged.emit({\n      fromState: oldState,\n      toState: this.state,\n    });\n    return this;\n  }\n\n  /**\n   * Subscribe to all state change events.\n   */\n  public getStateChangedStream(): EventEmitter<StateChangedEvent<StateEnum>> {\n    return this.stateChanged;\n  }\n\n  /**\n   * Subscribe to a certain state transition.\n   * @param toState The state for which to wait for and resolve the Promise.\n   * @param failOnStates Optional array of states for which the reject the Promise.\n   */\n  public waitForChangeTo(\n    toState: StateEnum,\n    failOnStates?: StateEnum[]\n  ): Promise<StateChangedEvent<StateEnum>> {\n    return new Promise((resolve, reject) => {\n      if (this.getState() === toState) {\n        resolve({ fromState: undefined, toState });\n        return;\n      } else if (failOnStates && failOnStates.includes(this.getState())) {\n        reject({ fromState: undefined, toState: this.getState() });\n        return;\n      }\n      const subscription = this.getStateChangedStream().subscribe((change) => {\n        if (change.toState === toState) {\n          subscription.unsubscribe(); // only once\n          resolve(change);\n        } else if (failOnStates && failOnStates.includes(change.toState)) {\n          subscription.unsubscribe(); // only once\n          reject(change);\n        }\n      });\n    });\n  }\n}\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * State of the Synchronization between local and remote database\n */\nexport enum SyncState {\n  /** Sync started. In case of liveSync, this means the sync was resumed */\n  STARTED,\n  /** Sync completed. In case of liveSync, this means the sync was paused (and waits for more changes) */\n  COMPLETED,\n  /** Sync failed. This may be, because we are offline, or due to some other reason */\n  FAILED,\n  /** (Potentially) Unsynced. This is the state before the first sync after startup */\n  UNSYNCED,\n  /** Sync was aborted. Currently only used when the initial login takes place offline */\n  ABORTED,\n}\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { NgModule } from \"@angular/core\";\nimport { CommonModule } from \"@angular/common\";\nimport { LoginComponent } from \"./login/login.component\";\nimport { FormsModule } from \"@angular/forms\";\nimport { EntityModule } from \"app/core/entity/entity.module\";\nimport { AlertsModule } from \"../alerts/alerts.module\";\nimport { LoggedInGuard } from \"./logged-in-guard/logged-in.guard\";\nimport { sessionServiceProvider } from \"./session.service.provider\";\nimport { databaseServiceProvider } from \"../database/database.service.provider\";\nimport { UserModule } from \"app/core/user/user.module\";\nimport { MatButtonModule } from \"@angular/material/button\";\nimport { MatCardModule } from \"@angular/material/card\";\nimport { MatFormFieldModule } from \"@angular/material/form-field\";\nimport { MatInputModule } from \"@angular/material/input\";\nimport { RouterModule } from \"@angular/router\";\n\n/**\n * The core session logic handling user login as well as connection and synchronization with the remote database.\n *\n * A detailed discussion about the Session concept is available separately:\n * [Session Handling, Authentication & Synchronisation]{@link /additional-documentation/concepts/session-and-authentication-system.html}\n */\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    EntityModule,\n    AlertsModule,\n    MatCardModule,\n    MatFormFieldModule,\n    MatInputModule,\n    MatButtonModule,\n    RouterModule,\n    UserModule,\n  ],\n  declarations: [LoginComponent],\n  exports: [LoginComponent],\n  providers: [LoggedInGuard, sessionServiceProvider, databaseServiceProvider],\n})\nexport class SessionModule {}\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { SyncedSessionService } from \"./session-service/synced-session.service\";\nimport { AppConfig } from \"../app-config/app-config\";\nimport { MockSessionService } from \"./session-service/mock-session.service\";\nimport { SessionService } from \"./session-service/session.service\";\nimport { AlertService } from \"../alerts/alert.service\";\nimport { EntitySchemaService } from \"app/core/entity/schema/entity-schema.service\";\nimport { LoggingService } from \"../logging/logging.service\";\n\n/**\n * Factory method for Angular DI provider of SessionService.\n *\n * see [sessionServiceProvider]{@link sessionServiceProvider} for details.\n *\n * @param alertService\n * @param loggingService\n * @param entitySchemaService\n */\nexport function sessionServiceFactory(\n  alertService: AlertService,\n  loggingService: LoggingService,\n  entitySchemaService: EntitySchemaService\n): SessionService {\n  if (AppConfig.settings.database.useTemporaryDatabase) {\n    return new MockSessionService(entitySchemaService);\n  } else {\n    return new SyncedSessionService(\n      alertService,\n      loggingService,\n      entitySchemaService\n    );\n\n    // TODO: requires a configuration or UI option to select OnlineSession: https://github.com/Aam-Digital/ndb-core/issues/434\n    // return new OnlineSessionService(alertService, entitySchemaService);\n  }\n}\n\n/**\n * Provider for SessionService implementation based on the AppConfig settings.\n *\n * Set `\"database\": { \"useTemporaryDatabase\": true }` in your app-config.json\n * to use the MockSessionService which will set up an in-memory database with demo data.\n * Otherwise the SyncedSessionService is used, establishing a local and remote session and setting up sync between them.\n */\nexport const sessionServiceProvider = {\n  provide: SessionService,\n  useFactory: sessionServiceFactory,\n  deps: [AlertService, LoggingService, EntitySchemaService],\n};\n","import {\n  Component,\n  Input,\n  OnChanges,\n  SimpleChanges,\n  ViewChild,\n} from \"@angular/core\";\nimport { MatMenuTrigger } from \"@angular/material/menu\";\nimport { BackgroundProcessState } from \"../background-process-state.interface\";\n\n/**\n * A dumb component handling presentation of the sync indicator icon\n * and an additional details dropdown listing all currently running background processes.\n */\n@Component({\n  selector: \"app-background-processing-indicator\",\n  templateUrl: \"./background-processing-indicator.component.html\",\n  styleUrls: [\"./background-processing-indicator.component.scss\"],\n})\nexport class BackgroundProcessingIndicatorComponent implements OnChanges {\n  /** details on current background processes to be displayed to user */\n  @Input() backgroundProcesses: BackgroundProcessState[] = [];\n\n  /** whether processes of with the same title shall be summarized into one line */\n  @Input() summarize: boolean = true;\n\n  /** how many special tasks (e.g. index creations) are currently being processed */\n  taskCounter: number;\n\n  /** handle to programmatically open/close the details dropdown */\n  @ViewChild(MatMenuTrigger) taskListDropdownTrigger: MatMenuTrigger;\n\n  constructor() {}\n\n  ngOnChanges(changes: SimpleChanges) {\n    if (!changes.backgroundProcesses) {\n      return;\n    }\n\n    if (this.summarize && this.backgroundProcesses) {\n      this.backgroundProcesses = this.summarizeProcesses(\n        this.backgroundProcesses\n      );\n    }\n\n    this.taskCounter = this.backgroundProcesses?.filter(\n      (s) => s.pending\n    ).length;\n\n    if (this.taskCounter > 1) {\n      if (\n        !(\n          changes.backgroundProcesses.previousValue?.filter((s) => s.pending)\n            .length > 1\n        )\n      ) {\n        // open menu automatically only if it has not been opened previously, to avoid reopening after user closed it\n        this.taskListDropdownTrigger?.openMenu();\n      }\n    } else if (this.taskCounter === 0) {\n      this.taskListDropdownTrigger?.closeMenu();\n    }\n  }\n\n  private summarizeProcesses(\n    processes: BackgroundProcessState[]\n  ): BackgroundProcessState[] {\n    return processes.reduce((accumulator, currentEntry) => {\n      const summaryEntry = accumulator.find(\n        (i) => i.title === currentEntry.title\n      );\n      if (!summaryEntry) {\n        accumulator.push(currentEntry);\n      } else {\n        delete summaryEntry.details;\n        summaryEntry.pending = summaryEntry.pending || currentEntry.pending;\n      }\n      return accumulator;\n    }, []);\n  }\n}\n","<button mat-icon-button class=\"sync-icon\" [hidden]=\"!taskCounter\"\n        [matMenuTriggerFor]=\"taskListDropdown\">\n  <span [matBadge]=\"taskCounter\" matBadgeColor=\"accent\" [matBadgeHidden]=\"taskCounter <= 1\">\n    <mat-icon class=\"header-icon\" fontIcon=\"fa-refresh\"></mat-icon>\n  </span>\n</button>\n\n<mat-menu #taskListDropdown=\"matMenu\" class=\"details-container\">\n  <div class=\"details-header details-container\">\n    The following processes are still running in the background.\n    Until these are finished some pages may be slow or incomplete.\n  </div>\n\n  <div *ngFor=\"let process of backgroundProcesses\" class=\"details-line details-container\" fxLayout=\"row\">\n    <div fxFlex=\"28px\">\n      <mat-spinner *ngIf=\"process.pending\" [diameter]='20' class=\"process-spinner\"></mat-spinner>\n      <mat-icon *ngIf=\"!process.pending\" fontIcon=\"fa-check\" class=\"process-checkmark\"></mat-icon>\n    </div>\n    <div class=\"process-title\" [matTooltip]=\"process.description\" fxFlex>\n      {{process.title}} <span *ngIf=\"process.details\">({{process.details}})</span>\n    </div>\n  </div>\n\n  <div class=\"details-container\">\n    <button mat-stroked-button class=\"details-close\" (click)=\"taskListDropdownTrigger.closeMenu()\">Close</button>\n  </div>\n</mat-menu>\n\n\n\n\n\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { NgModule } from \"@angular/core\";\nimport { CommonModule } from \"@angular/common\";\nimport { SyncStatusComponent } from \"./sync-status/sync-status.component\";\nimport { SessionModule } from \"../session/session.module\";\nimport { AlertsModule } from \"../alerts/alerts.module\";\nimport { MatButtonModule } from \"@angular/material/button\";\nimport { MatDialogModule } from \"@angular/material/dialog\";\nimport { MatIconModule } from \"@angular/material/icon\";\nimport { MatProgressBarModule } from \"@angular/material/progress-bar\";\nimport { InitialSyncDialogComponent } from \"./sync-status/initial-sync-dialog.component\";\nimport { MatBadgeModule } from \"@angular/material/badge\";\nimport { MatMenuModule } from \"@angular/material/menu\";\nimport { BackgroundProcessingIndicatorComponent } from \"./background-processing-indicator/background-processing-indicator.component\";\nimport { MatProgressSpinnerModule } from \"@angular/material/progress-spinner\";\nimport { FlexModule } from \"@angular/flex-layout\";\nimport { MatTooltipModule } from \"@angular/material/tooltip\";\n\n@NgModule({\n  imports: [\n    CommonModule,\n    SessionModule,\n    AlertsModule,\n    MatIconModule,\n    MatButtonModule,\n    MatDialogModule,\n    MatProgressBarModule,\n    MatBadgeModule,\n    MatMenuModule,\n    MatProgressSpinnerModule,\n    FlexModule,\n    MatTooltipModule,\n  ],\n  declarations: [\n    InitialSyncDialogComponent,\n    SyncStatusComponent,\n    BackgroundProcessingIndicatorComponent,\n  ],\n  exports: [SyncStatusComponent],\n  providers: [],\n})\nexport class SyncStatusModule {}\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { Component } from \"@angular/core\";\nimport { MatDialogRef } from \"@angular/material/dialog\";\n\n/**\n * Content for the dialog being displayed during an initial synchronization which blocks login\n * (because user accounts need to be synced first).\n */\n@Component({\n  templateUrl: \"./initial-sync-dialog.component.html\",\n})\nexport class InitialSyncDialogComponent {\n  /**\n   * This component is usually instanciated through the MatDialog service which provides the necessary paramters.\n   * @param dialogRef Reference to the dialog in which the component is being displayed.\n   */\n  constructor(public dialogRef: MatDialogRef<InitialSyncDialogComponent>) {\n    this.dialogRef.disableClose = true;\n  }\n}\n","<h1 mat-dialog-title>Downloading Initial Database ...</h1>\n<div mat-dialog-content>\n  <p>Synchronizing with remote database.</p>\n  <p>Login may not be possible until this is completed.</p>\n  <p><mat-progress-bar mode=\"indeterminate\"></mat-progress-bar></p>\n</div>\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { Component, OnInit } from \"@angular/core\";\nimport { SessionService } from \"../../session/session-service/session.service\";\nimport { SyncState } from \"../../session/session-states/sync-state.enum\";\nimport { AlertService } from \"../../alerts/alert.service\";\nimport { MatDialog, MatDialogRef } from \"@angular/material/dialog\";\nimport { InitialSyncDialogComponent } from \"./initial-sync-dialog.component\";\nimport { StateChangedEvent } from \"app/core/session/session-states/state-handler\";\nimport { DatabaseIndexingService } from \"../../entity/database-indexing/database-indexing.service\";\nimport { BackgroundProcessState } from \"../background-process-state.interface\";\nimport { BehaviorSubject } from \"rxjs\";\nimport { debounceTime } from \"rxjs/operators\";\n\n/**\n * A small indicator component that displays an icon when there is currently synchronization\n * with the remote server going on in the background.\n *\n * This component also triggers a blocking dialog box when an initial sync is detected that prevents\n * user login (because user accounts need to be synced first).\n */\n@Component({\n  selector: \"app-sync-status\",\n  templateUrl: \"./sync-status.component.html\",\n  styleUrls: [\"./sync-status.component.scss\"],\n})\nexport class SyncStatusComponent implements OnInit {\n  private syncInProgress: boolean;\n  private indexingProcesses: BackgroundProcessState[];\n\n  private _backgroundProcesses: BehaviorSubject<\n    BackgroundProcessState[]\n  > = new BehaviorSubject([]);\n  /** background processes to be displayed to users, with short delay to avoid flickering */\n  backgroundProcesses = this._backgroundProcesses\n    .asObservable()\n    .pipe(debounceTime(1000));\n\n  private dialogRef: MatDialogRef<InitialSyncDialogComponent>;\n\n  constructor(\n    public dialog: MatDialog,\n    private sessionService: SessionService,\n    private dbIndexingService: DatabaseIndexingService,\n    private alertService: AlertService\n  ) {}\n\n  ngOnInit(): void {\n    this.dbIndexingService.indicesRegistered.subscribe((indicesStatus) =>\n      this.handleIndexingState(indicesStatus)\n    );\n\n    this.sessionService\n      .getSyncState()\n      .getStateChangedStream()\n      .subscribe((state) => this.handleSyncState(state));\n  }\n\n  private handleSyncState(state: StateChangedEvent<SyncState>) {\n    switch (state.toState) {\n      case SyncState.STARTED:\n        this.syncInProgress = true;\n        if (!this.sessionService.isLoggedIn() && !this.dialogRef) {\n          this.dialogRef = this.dialog.open(InitialSyncDialogComponent);\n        }\n        break;\n      case SyncState.COMPLETED:\n        this.syncInProgress = false;\n        if (this.dialogRef) {\n          this.dialogRef.close();\n        }\n        this.alertService.addInfo(\"Database sync completed.\");\n        break;\n      case SyncState.FAILED:\n        this.syncInProgress = false;\n        if (this.dialogRef) {\n          this.dialogRef.close();\n        }\n        this.alertService.addWarning(\"Database sync failed.\");\n        break;\n    }\n    this.updateBackgroundProcessesList();\n  }\n\n  private handleIndexingState(indicesStatus: BackgroundProcessState[]) {\n    this.indexingProcesses = indicesStatus;\n    this.updateBackgroundProcessesList();\n  }\n\n  /**\n   * Build and emit an updated array of current background processes\n   * @private\n   */\n  private updateBackgroundProcessesList() {\n    let currentProcesses: BackgroundProcessState[] = [];\n    if (this.syncInProgress) {\n      currentProcesses.push({ title: \"Synchronizing database\", pending: true });\n    } else {\n      currentProcesses.push({ title: \"Database up-to-date\", pending: false });\n    }\n    currentProcesses = currentProcesses.concat(this.indexingProcesses);\n    this._backgroundProcesses.next(currentProcesses);\n  }\n}\n","<!--\n  ~     This file is part of ndb-core.\n  ~\n  ~     ndb-core is free software: you can redistribute it and/or modify\n  ~     it under the terms of the GNU General Public License as published by\n  ~     the Free Software Foundation, either version 3 of the License, or\n  ~     (at your option) any later version.\n  ~\n  ~     ndb-core is distributed in the hope that it will be useful,\n  ~     but WITHOUT ANY WARRANTY; without even the implied warranty of\n  ~     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n  ~     GNU General Public License for more details.\n  ~\n  ~     You should have received a copy of the GNU General Public License\n  ~     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n  -->\n\n<app-background-processing-indicator [backgroundProcesses]=\"backgroundProcesses | async\">\n</app-background-processing-indicator>\n","import { Component } from \"@angular/core\";\nimport { Note } from \"../../../child-dev-project/notes/model/note\";\nimport { SessionService } from \"../../session/session-service/session.service\";\nimport { NoteDetailsComponent } from \"../../../child-dev-project/notes/note-details/note-details.component\";\nimport { FormDialogService } from \"../../form-dialog/form-dialog.service\";\n\n/**\n * The \"Primary Action\" is always displayed hovering over the rest of the app as a quick action for the user.\n *\n * This is a UX concept also used in many Android apps.\n * see {@link https://material.io/components/buttons-floating-action-button/}\n */\n@Component({\n  selector: \"app-primary-action\",\n  templateUrl: \"./primary-action.component.html\",\n  styleUrls: [\"./primary-action.component.scss\"],\n})\nexport class PrimaryActionComponent {\n  constructor(\n    private sessionService: SessionService,\n    private formDialog: FormDialogService\n  ) {}\n\n  /**\n   * The primary action to be triggered when the user clicks the hovering button.\n   */\n  primaryAction() {\n    this.formDialog.openDialog(NoteDetailsComponent, this.createNewNote());\n  }\n\n  private createNewNote() {\n    const newNote = new Note(Date.now().toString());\n    newNote.date = new Date();\n    newNote.author = this.sessionService.getCurrentUser().name;\n    return newNote;\n  }\n}\n","<button\n  mat-fab\n  class=\"primary-action\"\n  (click)=\"primaryAction()\"\n  angulartics2On=\"click\"\n  angularticsCategory=\"Navigation\"\n  angularticsAction=\"dashboard_primary_action_click\"\n>\n  <span class=\"fa fa-file-text-o\"></span>\n</button>\n","<div class=\"desktop-search-bar\" fxHide.xs=\"true\" fxHide=\"false\">\n  <mat-form-field fxFill class=\"search-field\" floatLabel=\"never\">\n    <span matPrefix>\n      <mat-icon matPrefix class=\"search-icon\" fontIcon=\"fa-search\"></mat-icon>\n    </span>\n    <mat-label>Search</mat-label>\n    <input\n      matInput\n      title=\"Search\"\n      [matAutocomplete]=\"autoResults\"\n      [(ngModel)]=\"searchText\"\n      (ngModelChange)=\"searchStringChanged.next($event)\"\n      #searchInput\n    />\n  </mat-form-field>\n\n  <mat-autocomplete\n    #autoResults=\"matAutocomplete\"\n    (optionSelected)=\"clickOption($event.option)\"\n  >\n    <mat-option\n      class=\"result-hint\"\n      *ngIf=\"\n        searchInput.value.length > 0 &&\n        searchInput.value.length < MIN_CHARACTERS_FOR_SEARCH\n      \"\n    >\n      <p>Insert at least {{ MIN_CHARACTERS_FOR_SEARCH }} characters</p>\n    </mat-option>\n\n    <mat-option\n      class=\"result-hint\"\n      *ngIf=\"\n        results.length === 0 &&\n        searchInput.value.length >= MIN_CHARACTERS_FOR_SEARCH &&\n        !isSearching\n      \"\n    >\n      <p>There were no results</p>\n    </mat-option>\n\n    <mat-option class=\"result-hint\" *ngIf=\"isSearching\">\n      <p>Search in progress...</p>\n    </mat-option>\n\n    <mat-option *ngFor=\"let res of results\" [value]=\"res\">\n      <app-child-block\n        *ngIf=\"res.getType() === 'Child'\"\n        [entity]=\"res\"\n        angulartics2On=\"click\"\n        angularticsCategory=\"Navigation\"\n        angularticsAction=\"search_result_list_link\"\n        [angularticsLabel]=\"'search-result-type-child'\"\n      ></app-child-block>\n      <app-school-block\n        *ngIf=\"res.getType() === 'School'\"\n        [entity]=\"res\"\n        angulartics2On=\"click\"\n        angularticsCategory=\"Navigation\"\n        angularticsAction=\"search_result_list_link\"\n        [angularticsLabel]=\"'search-result-type-school'\"\n      ></app-school-block>\n    </mat-option>\n  </mat-autocomplete>\n</div>\n\n<button\n  mat-icon-button\n  fxHide.xs=\"false\"\n  fxHide=\"true\"\n  (click)=\"toggleSearchToolbar()\"\n>\n  <mat-icon class=\"header-icon\" fontIcon=\"fa-search\"></mat-icon>\n</button>\n\n<mat-toolbar\n  *ngIf=\"showSearchToolbar\"\n  class=\"search-header mat-elevation-z7 mat-typography\"\n>\n  <mat-toolbar-row fxLayout=\"row\">\n    <span matPrefix>\n      <mat-icon class=\"search-icon\" fontIcon=\"fa-search\"></mat-icon>\n    </span>\n    <input\n      #searchInput\n      fxFlex=\"grow\"\n      matInput\n      title=\"Search\"\n      [matAutocomplete]=\"autoResults\"\n      [(ngModel)]=\"searchText\"\n      (ngModelChange)=\"searchStringChanged.next($event)\"\n    />\n    {{ searchInput.focus() }}\n    <button mat-icon-button (click)=\"toggleSearchToolbar()\">\n      <mat-icon class=\"search-icon\" fontIcon=\"fa-times\"></mat-icon>\n    </button>\n  </mat-toolbar-row>\n</mat-toolbar>\n","import { Component, OnInit } from \"@angular/core\";\nimport { Child } from \"../../../child-dev-project/children/model/child\";\nimport { School } from \"../../../child-dev-project/schools/model/school\";\nimport { Entity } from \"../../entity/entity\";\nimport { EntitySchemaService } from \"../../entity/schema/entity-schema.service\";\nimport { Subject } from \"rxjs\";\nimport { debounceTime, switchMap } from \"rxjs/operators\";\nimport { LoggingService } from \"../../logging/logging.service\";\nimport { LogLevel } from \"../../logging/log-level\";\nimport { AlertService } from \"../../alerts/alert.service\";\nimport { DatabaseIndexingService } from \"../../entity/database-indexing/database-indexing.service\";\nimport { Router } from \"@angular/router\";\n\n/**\n * General search box that provides results out of any kind of entities from the system\n * as soon as the user starts typing.\n *\n * This is usually displayed in the app header to be available to the user anywhere, allowing to navigate quickly.\n */\n@Component({\n  selector: \"app-search\",\n  templateUrl: \"./search.component.html\",\n  styleUrls: [\"./search.component.scss\"],\n})\nexport class SearchComponent implements OnInit {\n  results = [];\n  searchText = \"\";\n  showSearchToolbar = false;\n  isSearching: boolean = false;\n\n  MIN_CHARACTERS_FOR_SEARCH: number = 3;\n  INPUT_DEBOUNCE_TIME_MS: number = 400;\n\n  searchStringChanged: Subject<string> = new Subject<string>();\n  searchQuery: Subject<Promise<any>> = new Subject<Promise<any>>();\n\n  constructor(\n    private dbIndexingService: DatabaseIndexingService,\n    private entitySchemaService: EntitySchemaService,\n    private router: Router,\n    private loggingService: LoggingService,\n    private alertService: AlertService\n  ) {}\n\n  ngOnInit() {\n    this.createSearchIndex();\n\n    this.searchStringChanged\n      .pipe(debounceTime(this.INPUT_DEBOUNCE_TIME_MS))\n      .subscribe((searchString) => {\n        if (typeof searchString !== \"string\") {\n          // abort if a result object was selected rather than a search term entered\n          return;\n        }\n\n        this.searchQuery.next(this.startSearch(searchString));\n      });\n\n    this.searchQuery\n      .pipe(\n        switchMap((value) => {\n          return value;\n        })\n      )\n      .subscribe(\n        (result: { queryResults: any; searchTerms: string[] }) => {\n          this.handleSearchQueryResult(result);\n        },\n        (error) => {\n          this.loggingService.log(\n            {\n              message: \"[Search] An error has occurred in a search query.\",\n              error,\n            },\n            LogLevel.ERROR\n          );\n          this.alertService.addWarning(\n            \"An error has occurred in your search query. Please try again.\"\n          );\n        }\n      );\n  }\n\n  async startSearch(searchString: string): Promise<any> {\n    this.isSearching = true;\n    this.results = [];\n\n    if (!searchString) {\n      return Promise.resolve();\n    }\n\n    searchString = searchString.toLowerCase();\n\n    if (!this.isRelevantSearchInput(searchString)) {\n      return Promise.resolve();\n    }\n\n    const searchTerms = searchString.split(\" \");\n\n    const queryResults = await this.dbIndexingService.queryIndex(\n      \"search_index/by_name\",\n      {\n        startkey: searchTerms[0],\n        endkey: searchTerms[0] + \"\\ufff0\",\n        include_docs: true,\n      }\n    );\n\n    return {\n      queryResults,\n      searchTerms,\n    };\n  }\n\n  async clickOption(optionElement) {\n    const resultEntity: Entity = optionElement.value;\n    await this.router.navigate([\n      resultEntity.getType().toLowerCase(),\n      resultEntity.getId(),\n    ]);\n\n    this.searchText = \"\";\n    this.showSearchToolbar = false;\n  }\n\n  toggleSearchToolbar() {\n    this.showSearchToolbar = !this.showSearchToolbar;\n  }\n\n  handleSearchQueryResult(result: {\n    queryResults: any;\n    searchTerms: string[];\n  }) {\n    this.isSearching = false;\n\n    if (!result || !result.queryResults) {\n      this.results = [];\n      return;\n    }\n\n    this.results = this.prepareResults(\n      result.queryResults.rows,\n      result.searchTerms\n    );\n  }\n\n  private createSearchIndex(): Promise<any> {\n    // `emit(x)` to add x as a key to the index that can be searched\n    const searchMapFunction =\n      \"(doc) => {\" +\n      'if (doc.hasOwnProperty(\"searchIndices\")) { doc.searchIndices.forEach(word => emit(word.toString().toLowerCase())) }' +\n      \"}\";\n\n    const designDoc = {\n      _id: \"_design/search_index\",\n      views: {\n        by_name: {\n          map: searchMapFunction,\n        },\n      },\n    };\n\n    return this.dbIndexingService.createIndex(designDoc);\n  }\n\n  /**\n   * Check if the input should start an actual search.\n   * Only search for words starting with a char or number -> no searching for space or no input\n   * @param searchText\n   */\n  private isRelevantSearchInput(searchText: string) {\n    const regexp = new RegExp(\"[a-z]+|[0-9]+\");\n    return (\n      searchText.match(regexp) &&\n      searchText.length >= this.MIN_CHARACTERS_FOR_SEARCH\n    );\n  }\n\n  private prepareResults(rows, searchTerms: string[]): any[] {\n    return this.getResultsWithoutDuplicates(rows)\n      .map((doc) => this.transformDocToEntity(doc))\n      .filter((r) => r !== null)\n      .filter((r) => this.containsSecondarySearchTerms(r, searchTerms))\n      .sort((a, b) => this.sortResults(a, b));\n  }\n\n  private getResultsWithoutDuplicates(rows): any[] {\n    const filteredResults = new Map<string, any>();\n    for (const row of rows) {\n      filteredResults.set(row.id, row.doc);\n    }\n    return Array.from(filteredResults.values());\n  }\n\n  private transformDocToEntity(doc: any): Entity {\n    let resultEntity;\n    if (doc._id.startsWith(Child.ENTITY_TYPE + \":\")) {\n      resultEntity = new Child(doc.entityId);\n    } else if (doc._id.startsWith(School.ENTITY_TYPE + \":\")) {\n      resultEntity = new School(doc.entityId);\n    }\n\n    if (resultEntity) {\n      this.entitySchemaService.loadDataIntoEntity(resultEntity, doc);\n      return resultEntity;\n    } else {\n      return null;\n    }\n  }\n\n  private containsSecondarySearchTerms(item, searchTerms: string[]) {\n    const itemKey = item.generateSearchIndices().join(\" \").toLowerCase();\n    for (let i = 1; i < searchTerms.length; i++) {\n      if (!itemKey.includes(searchTerms[i])) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  private sortResults(a, b) {\n    const entityComparison = this.compareEntityTypes(a, b);\n    if (entityComparison === 0) {\n      return a.toString().localeCompare(b.toString());\n    } else {\n      return entityComparison;\n    }\n  }\n\n  private compareEntityTypes(a: Entity, b: Entity) {\n    const e = [a, b];\n    const t = [a.getType(), b.getType()];\n\n    // special sorting for Child entities\n    for (let i = 0; i < 2; i++) {\n      if (e[i].getType() === Child.ENTITY_TYPE) {\n        if ((e[i] as Child).isActive()) {\n          // show first\n          t[i] = \"!\" + t[i];\n        } else {\n          // show last\n          t[i] = \"\\ufff0\" + t[i];\n        }\n      }\n    }\n\n    return t[0].localeCompare(t[1]);\n  }\n}\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { NgModule } from \"@angular/core\";\nimport { CommonModule } from \"@angular/common\";\nimport { UiComponent } from \"./ui/ui.component\";\nimport { NavigationModule } from \"../navigation/navigation.module\";\nimport { SessionModule } from \"../session/session.module\";\nimport { SyncStatusModule } from \"../sync-status/sync-status.module\";\nimport { RouterModule } from \"@angular/router\";\nimport { LatestChangesModule } from \"../latest-changes/latest-changes.module\";\nimport { MatAutocompleteModule } from \"@angular/material/autocomplete\";\nimport { MatButtonModule } from \"@angular/material/button\";\nimport { MatFormFieldModule } from \"@angular/material/form-field\";\nimport { MatIconModule } from \"@angular/material/icon\";\nimport { MatInputModule } from \"@angular/material/input\";\nimport { MatSidenavModule } from \"@angular/material/sidenav\";\nimport { MatToolbarModule } from \"@angular/material/toolbar\";\nimport { SearchComponent } from \"./search/search.component\";\nimport { FormsModule } from \"@angular/forms\";\nimport { ChildrenModule } from \"../../child-dev-project/children/children.module\";\nimport { SchoolsModule } from \"../../child-dev-project/schools/schools.module\";\nimport { FlexLayoutModule } from \"@angular/flex-layout\";\nimport { PrimaryActionComponent } from \"./primary-action/primary-action.component\";\nimport { NotesModule } from \"../../child-dev-project/notes/notes.module\";\nimport { Angulartics2Module } from \"angulartics2\";\n\n/**\n * The core user interface structure that ties different components together into the overall app layout.\n */\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    LatestChangesModule,\n    NavigationModule,\n    RouterModule,\n    SessionModule,\n    SyncStatusModule,\n    MatSidenavModule,\n    MatToolbarModule,\n    MatIconModule,\n    MatButtonModule,\n    MatFormFieldModule,\n    MatInputModule,\n    MatAutocompleteModule,\n    FlexLayoutModule,\n    ChildrenModule,\n    SchoolsModule,\n    NotesModule,\n    Angulartics2Module,\n  ],\n  declarations: [SearchComponent, UiComponent, PrimaryActionComponent],\n  exports: [UiComponent],\n})\nexport class UiModule {}\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { Component, OnInit, ViewChild } from \"@angular/core\";\nimport { SessionService } from \"../../session/session-service/session.service\";\nimport { AppConfig } from \"../../app-config/app-config\";\nimport { Title } from \"@angular/platform-browser\";\nimport { MediaObserver, MediaChange } from \"@angular/flex-layout\";\nimport { UntilDestroy, untilDestroyed } from \"@ngneat/until-destroy\";\n\n/**\n * The main user interface component as root element for the app structure\n * which also ties different components together into the overall app layout.\n */\n@UntilDestroy()\n@Component({\n  moduleId: module.id,\n  selector: \"app-ui\",\n  templateUrl: \"./ui.component.html\",\n  styleUrls: [\"./ui.component.scss\"],\n})\nexport class UiComponent implements OnInit {\n  /** display mode for the menu to make it responive and usable on smaller screens */\n  sideNavMode: string;\n  /** reference to sideNav component in template, required for toggling the menu on user actions */\n  @ViewChild(\"sideNav\") sideNav;\n\n  /** title displayed in the app header bar */\n  title: string;\n\n  constructor(\n    private _sessionService: SessionService,\n    private titleService: Title,\n    mediaObserver: MediaObserver\n  ) {\n    // watch screen width to change sidenav mode\n    mediaObserver.media$\n      .pipe(untilDestroyed(this))\n      .subscribe((change: MediaChange) => {\n        this.sideNavMode = change.mqAlias === (\"xs\" || \"sm\") ? \"over\" : \"side\";\n      });\n  }\n\n  ngOnInit(): void {\n    this.title = AppConfig.settings.site_name;\n    this.titleService.setTitle(this.title);\n  }\n\n  /**\n   * Check if user is logged in.\n   */\n  isLoggedIn(): boolean {\n    return this._sessionService.isLoggedIn();\n  }\n\n  /**\n   * Trigger logout of user.\n   */\n  logout() {\n    this._sessionService.logout();\n  }\n}\n","<!--\n  ~     This file is part of ndb-core.\n  ~\n  ~     ndb-core is free software: you can redistribute it and/or modify\n  ~     it under the terms of the GNU General Public License as published by\n  ~     the Free Software Foundation, either version 3 of the License, or\n  ~     (at your option) any later version.\n  ~\n  ~     ndb-core is distributed in the hope that it will be useful,\n  ~     but WITHOUT ANY WARRANTY; without even the implied warranty of\n  ~     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n  ~     GNU General Public License for more details.\n  ~\n  ~     You should have received a copy of the GNU General Public License\n  ~     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n  -->\n\n<!-- HEADER -->\n<mat-toolbar color=\"primary\" class=\"app-header mat-elevation-z6 mat-typography\">\n  <mat-toolbar-row fxLayout=\"row\">\n    <span fxFlex *ngIf=\"isLoggedIn()\">\n      <button\n        mat-icon-button\n        fxHide.lt-md=\"false\"\n        fxHide=\"true\"\n        (click)=\"sideNav.toggle()\"\n      >\n        <mat-icon class=\"header-icon\" fontIcon=\"fa-bars\"></mat-icon>\n      </button>\n    </span>\n    <span fxFlex=\"\"\n      ><a\n        class=\"header-title\"\n        [routerLink]=\"['']\"\n        angulartics2On=\"click\"\n        angularticsCategory=\"Navigation\"\n        angularticsAction=\"navbar_site_title_link\"\n        >{{ title }}</a\n      ></span\n    >\n    <span fxFlex=\"grow\">&nbsp;</span>\n    <span fxFlex=\"grow\">&nbsp;</span>\n    <!--top right icons and search-->\n    <app-search\n      *ngIf=\"isLoggedIn()\"\n      [fxFlex]=\"sideNavMode == 'side' ? 'grow' : 'none'\"\n    ></app-search>\n    <app-sync-status></app-sync-status>\n    <button\n      mat-icon-button\n      [routerLink]=\"['/user']\"\n      *ngIf=\"isLoggedIn()\"\n      angulartics2On=\"click\"\n      angularticsCategory=\"Navigation\"\n      angularticsAction=\"navbar_profile_link\"\n    >\n      <mat-icon class=\"header-icon\" fontIcon=\"fa-user-circle-o\"></mat-icon>\n    </button>\n    <button\n      mat-icon-button\n      (click)=\"logout()\"\n      [routerLink]=\"['']\"\n      *ngIf=\"isLoggedIn()\"\n    >\n      <mat-icon class=\"header-icon\" fontIcon=\"fa-sign-out\"></mat-icon>\n    </button>\n  </mat-toolbar-row>\n</mat-toolbar>\n\n<app-primary-action *ngIf=\"isLoggedIn()\"></app-primary-action>\n\n<!-- MAIN NAVIGATION + CONTENT -->\n<mat-sidenav-container class=\"app-content mat-typography\">\n  <mat-sidenav\n    #sideNav\n    *ngIf=\"isLoggedIn()\"\n    [autoFocus]=\"false\"\n    [mode]=\"sideNavMode\"\n    [opened]=\"sideNavMode == 'side'\"\n    disableClose\n    fixedInViewport=\"true\"\n    class=\"sidenav-menu mat-elevation-z6\"\n  >\n    <app-navigation\n      (click)=\"sideNavMode == 'over' && sideNav.close()\"\n    ></app-navigation>\n    <app-version style=\"position: absolute; bottom: 0;\"></app-version>\n  </mat-sidenav>\n\n  <mat-sidenav-content>\n    <div class=\"sidenav-content\">\n      <router-outlet *ngIf=\"isLoggedIn()\"></router-outlet>\n      <app-login *ngIf=\"!isLoggedIn()\"></app-login>\n    </div>\n  </mat-sidenav-content>\n</mat-sidenav-container>\n","import { DemoDataGenerator } from \"../demo-data/demo-data-generator\";\nimport { Injectable } from \"@angular/core\";\nimport { User } from \"./user\";\n\n/**\n * Generate demo users for the application with its DemoDataModule.\n */\n@Injectable()\nexport class DemoUserGeneratorService extends DemoDataGenerator<User> {\n  /**\n   * This function returns a provider object to be used in an Angular Module configuration\n   *\n   * @return `providers: [DemoUserGeneratorService.provider()]`\n   */\n  static provider() {\n    return [\n      { provide: DemoUserGeneratorService, useClass: DemoUserGeneratorService },\n    ];\n  }\n\n  constructor() {\n    super();\n  }\n\n  /**\n   * Generate User entities to be loaded by the DemoDataModule.\n   */\n  public generateEntities(): User[] {\n    const demoUser = new User(\"demo\");\n    demoUser.name = \"demo\";\n    demoUser.setNewPassword(\"pass\");\n\n    const demoAdmin = new User(\"demo-admin\");\n    demoUser.name = \"demo-admin\";\n    demoAdmin.admin = true;\n    demoAdmin.setNewPassword(\"pass\");\n\n    return [demoUser, demoAdmin];\n  }\n}\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { Component, OnInit } from \"@angular/core\";\nimport { User } from \"../user\";\nimport { SessionService } from \"../../session/session-service/session.service\";\nimport { EntityMapperService } from \"app/core/entity/entity-mapper.service\";\nimport { AppConfig } from \"../../app-config/app-config\";\n\n/**\n * User account form to allow the user to view and edit information.\n */\n@Component({\n  selector: \"app-user-account\",\n  templateUrl: \"./user-account.component.html\",\n  styleUrls: [\"./user-account.component.scss\"],\n})\nexport class UserAccountComponent implements OnInit {\n  /** user to be edited */\n  user: User;\n\n  /** whether webdav integration is configured and the cloud settings section should be displayed */\n  webdavEnabled = !!AppConfig.settings.webdav;\n\n  constructor(\n    private entityMapperService: EntityMapperService,\n    private sessionService: SessionService\n  ) {}\n\n  ngOnInit() {\n    this.user = this.sessionService.getCurrentUser();\n  }\n\n  /**\n   * Change the user's password.\n   *\n   * @todo This is not implemented yet!\n   *\n   * @param pwd New password to be set\n   * @param rpwd Confirmation of new password (second input by the user to prevent typos)\n   */\n  changePassword(pwd, rpwd) {\n    if (pwd === rpwd) {\n      // TODO: update the password for this remote database user first and deny the password change if that fails\n      this.user.setNewPassword(pwd);\n      // TODO: Show success message\n    } else {\n      // TODO: Show error message\n    }\n  }\n}\n","<!--\n  ~     This file is part of ndb-core.\n  ~\n  ~     ndb-core is free software: you can redistribute it and/or modify\n  ~     it under the terms of the GNU General Public License as published by\n  ~     the Free Software Foundation, either version 3 of the License, or\n  ~     (at your option) any later version.\n  ~\n  ~     ndb-core is distributed in the hope that it will be useful,\n  ~     but WITHOUT ANY WARRANTY; without even the implied warranty of\n  ~     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n  ~     GNU General Public License for more details.\n  ~\n  ~     You should have received a copy of the GNU General Public License\n  ~     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n  -->\n\n<mat-tab-group>\n\n  <mat-tab label=\"User Account\">\n    <ng-template matTabContent>\n      <div class='user-profile-tab'>\n        <p>\n          <mat-form-field>\n            <input placeholder=\"Username\" matInput=\"text\" id=\"username\" type=\"text\" [(value)]=\"user.name\" disabled>\n          </mat-form-field>\n        </p>\n\n        <p>\n          <mat-form-field>\n            <input placeholder=\"New Password\" matInput=\"text\" id=\"password1\" type=\"password\" value=\"pass\" #passwordInp disabled>\n          </mat-form-field>\n          <br>\n          <mat-form-field>\n            <input placeholder=\"Confirm New Password\" matInput=\"text\" id=\"confirm\" type=\"password\" value=\"pass\" #confirmationInp disabled>\n          </mat-form-field>\n        </p>\n\n        <p>\n          <i>Changes currently not supported. Please talk to your administrator for password changes.</i>\n        </p>\n\n        <p>\n          <button mat-raised-button (click)=\"changePassword(passwordInp.value,confirmationInp.value)\" disabled>Save</button>\n        </p>\n      </div>\n    </ng-template>\n  </mat-tab>\n\n\n  <mat-tab label=\"Image Service\" *ngIf='webdavEnabled'>\n    <ng-template matTabContent>\n      <div class='user-profile-tab'>\n        <app-cloud-file-service-user-settings [user]='user'></app-cloud-file-service-user-settings>\n      </div>\n    </ng-template>\n  </mat-tab>\n\n</mat-tab-group>\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { NgModule } from \"@angular/core\";\nimport { UserAccountComponent } from \"./user-account/user-account.component\";\nimport { MatButtonModule } from \"@angular/material/button\";\nimport { MatFormFieldModule } from \"@angular/material/form-field\";\nimport { MatInputModule } from \"@angular/material/input\";\nimport { CommonModule } from \"@angular/common\";\nimport { MatTabsModule } from \"@angular/material/tabs\";\nimport { WebdavModule } from \"../webdav/webdav.module\";\n\n/**\n * Provides a User functionality including user account forms.\n */\n@NgModule({\n  imports: [\n    CommonModule,\n    MatFormFieldModule,\n    MatInputModule,\n    MatButtonModule,\n    MatTabsModule,\n    WebdavModule,\n  ],\n  declarations: [UserAccountComponent],\n})\nexport class UserModule {}\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { Entity } from \"../entity/entity\";\nimport { DatabaseEntity } from \"../entity/database-entity.decorator\";\nimport { DatabaseField } from \"../entity/database-field.decorator\";\n\nimport * as CryptoJS from \"crypto-js\";\n\n/**\n * Entity representing a User object including password.\n *\n * Note that in addition to the User Entity there also is a \"regular\" CouchDB user with the same name and password\n * in the CouchDB _users database which is used for remote database authentication.\n */\n@DatabaseEntity(\"User\")\nexport class User extends Entity {\n  /** username used for login and identification */\n  @DatabaseField() name: string;\n\n  /** whether this user has admin rights */\n  @DatabaseField() admin: boolean;\n\n  /** password object (encrypted) */\n  @DatabaseField() private password: any;\n\n  /** settings for the mat-paginator for tables\n   * pageSizeOptions is set in the corresponding html of the component,\n   * pageSize is stored persistently in the database and\n   * pageIndex is saved only temporarily for the session\n   */\n  @DatabaseField() paginatorSettingsPageSize: PaginatorSettings = {\n    childrenList: 10,\n    schoolsList: 10,\n    notesList: 10,\n  };\n  public paginatorSettingsPageIndex: PaginatorSettings = {\n    childrenList: 0,\n    schoolsList: 0,\n    notesList: 0,\n  };\n\n  /** password for webdav account (encrypted with user.password) */\n  @DatabaseField() private cloudPasswordEnc: any;\n\n  /** username for webdav account */\n  @DatabaseField() public cloudUserName: string;\n\n  /** password for webdav account (plaintext, decrypted during runtime from user.cloudPasswordEnc, not written to db) */\n  public cloudPasswordDec: any;\n\n  /** base folder for webdav, all actions of the app will happen relative to this as the root folder */\n  @DatabaseField() public cloudBaseFolder: string = \"/aam-digital/\";\n\n  /**\n   * Set a new user password.\n   * This will be encrypted before saving.\n   *\n   * Warning: User password must be identical to the CouchDB user password. Otherwise database sync will fail!\n   *\n   * @param password The new password to be set\n   */\n  public setNewPassword(password: string) {\n    const cryptKeySize = 256 / 32;\n    const cryptIterations = 128;\n    const cryptSalt = CryptoJS.lib.WordArray.random(128 / 8).toString();\n    const hash = CryptoJS.PBKDF2(password, cryptSalt, {\n      keySize: cryptKeySize,\n      iterations: cryptIterations,\n    }).toString();\n\n    this.password = {\n      hash: hash,\n      salt: cryptSalt,\n      iterations: cryptIterations,\n      keysize: cryptKeySize,\n    };\n\n    // update encrypted nextcloud password\n    this.cloudPasswordEnc = CryptoJS.AES.encrypt(\n      this.cloudPasswordDec,\n      password\n    ).toString();\n  }\n\n  /**\n   * Check whether the given password is correct.\n   * @param givenPassword Password attempted\n   */\n  public checkPassword(givenPassword: string): boolean {\n    // hash the given password string and compare it with the stored hash\n    return this.hashPassword(givenPassword) === this.password.hash;\n  }\n\n  private hashPassword(givenPassword: string): string {\n    const options = {\n      keySize: this.password.keysize,\n      iterations: this.password.iterations,\n    };\n    return CryptoJS.PBKDF2(\n      givenPassword,\n      this.password.salt,\n      options\n    ).toString();\n  }\n\n  /**\n   * Decrypt the stored cloud password with the user's regular password.\n   * @param givenPassword The user entity's password (not the webdav cloud password)\n   * @return the decrypted cloud password\n   */\n  public decryptCloudPassword(givenPassword: string): string {\n    if (!this.cloudPasswordEnc) {\n      return;\n    }\n\n    this.cloudPasswordDec = CryptoJS.AES.decrypt(\n      this.cloudPasswordEnc.toString(),\n      givenPassword\n    ).toString(CryptoJS.enc.Utf8);\n    return this.cloudPasswordDec;\n  }\n\n  /**\n   * Set a new webdav cloud password.\n   * @param blobPassword The password for the cloud account.\n   * @param givenPassword The user entity's password (used for encrypting the cloud password before storage)\n   */\n  public setCloudPassword(blobPassword: string, givenPassword: string) {\n    if (this.checkPassword(givenPassword)) {\n      this.cloudPasswordDec = blobPassword;\n      this.cloudPasswordEnc = CryptoJS.AES.encrypt(\n        blobPassword,\n        givenPassword\n      ).toString();\n    }\n  }\n\n  /**\n   * Check admin rights of the user.\n   */\n  public isAdmin(): boolean {\n    return this.admin;\n  }\n\n  /**\n   * Change this user's admin status\n   * @param admin New admin status to be set\n   */\n  public setAdmin(admin: boolean) {\n    this.admin = admin;\n  }\n}\n\n/** Interface for the PaginatorSettings for the three components\n * childrenList, schoolsList and notesList.\n */\nexport interface PaginatorSettings {\n  childrenList: number;\n  schoolsList: number;\n  notesList: number;\n}\n","import { Injectable } from \"@angular/core\";\nimport { Route, Router } from \"@angular/router\";\nimport { COMPONENT_MAP } from \"app/app.routing\";\nimport { AdminGuard } from \"../admin/admin.guard\";\nimport { ConfigService } from \"../config/config.service\";\nimport { LoggingService } from \"../logging/logging.service\";\nimport { ViewConfig } from \"./view-config.interface\";\n\n@Injectable({\n  providedIn: \"root\",\n})\nexport class RouterService {\n  static readonly PREFIX_VIEW_CONFIG = \"view:\";\n\n  constructor(\n    private configService: ConfigService,\n    private router: Router,\n    private loggingService: LoggingService\n  ) {}\n\n  /**\n   * Initialize routes from the config while respecting existing routes.\n   */\n  initRouting() {\n    this.reloadRouting(this.router.config);\n  }\n\n  /**\n   * Reset the routing config and reload it from the global config.\n   *\n   * @param additionalRoutes Optional array of routes to keep in addition to the ones loaded from config\n   */\n  reloadRouting(additionalRoutes: Route[] = []) {\n    const routes = [];\n\n    const viewConfigs = this.configService.getAllConfigs<ViewConfig>(\n      RouterService.PREFIX_VIEW_CONFIG\n    );\n    for (const view of viewConfigs) {\n      const path = view._id.substring(RouterService.PREFIX_VIEW_CONFIG.length); // remove prefix to get actual path\n\n      if (additionalRoutes.find((r) => r.path === path)) {\n        this.loggingService.warn(\n          \"ignoring route from view config because the path is already defined: \" +\n            view._id\n        );\n        continue;\n      }\n\n      const route: Route = {\n        path: path,\n      };\n\n      if (view.component) {\n        route.component = COMPONENT_MAP[view.component];\n      } else if (view.importModulePath) {\n        route.loadChildren = async () => {\n          const m = await COMPONENT_MAP[view.importModulePath]();\n          return m[view.importModuleName];\n        };\n      } else {\n        this.loggingService.warn(\n          \"Error in config: Neither 'component' nor 'importModulePath' defined\"\n        );\n      }\n\n      if (view.requiresAdmin) {\n        route.canActivate = [AdminGuard];\n      }\n\n      if (view.config) {\n        route.data = view.config;\n      }\n\n      routes.push(route);\n    }\n\n    routes.push(...additionalRoutes);\n\n    this.router.resetConfig(routes);\n  }\n}\n","import { APP_INITIALIZER, NgModule } from \"@angular/core\";\nimport { CommonModule } from \"@angular/common\";\nimport { RouterService } from \"./router.service\";\nimport { ConfigService } from \"../config/config.service\";\nimport { Router } from \"@angular/router\";\nimport { LoggingService } from \"../logging/logging.service\";\n\n@NgModule({\n  declarations: [],\n  imports: [CommonModule],\n})\nexport class ViewModule {}\n","<form [formGroup]='form' (ngSubmit)=\"updateCloudServiceSettings()\">\n  <p>\n    <i>Please enter your username and password for your Nextcloud account. This will be used for photo uploads.</i>\n  </p>\n  <p>\n    <mat-form-field>\n      <input matInput required formControlName='cloudUser'\n             placeholder=\"Cloud Image Service User\">\n    </mat-form-field>\n    <br>\n    <mat-form-field>\n      <input matInput type=\"password\" required formControlName='cloudPassword'\n             placeholder=\"Cloud Image Service Password\">\n      <mat-error *ngIf=\"form.controls.cloudPassword.errors?.connectionFailed\">\n        Couldn't connect to the cloud service.\n        Please check your username and password or try again later.\n      </mat-error>\n    </mat-form-field>\n    <br>\n  </p>\n  <p>\n    <i>Please enter your password for this app, so your cloud service password above will then be encrypted and stored for future uses.</i>\n  </p>\n  <p>\n    <mat-form-field>\n      <input matInput type=\"password\" required formControlName='userPassword'\n             placeholder=\"Password\">\n      <mat-error *ngIf=\"form.controls.userPassword.errors?.incorrectPassword\">\n        The password you entered is not correct.\n        Please enter your user account password for this app here (not your password for the cloud service above).\n      </mat-error>\n    </mat-form-field>\n  </p>\n  <p class='p-submit'>\n    <button mat-raised-button type='submit' [disabled]='!form.valid || processing'>Save</button>\n    &nbsp;<mat-spinner diameter='20' *ngIf='processing'></mat-spinner>\n  </p>\n</form>\n","import { Component, Input, OnInit } from \"@angular/core\";\nimport { User } from \"../../user/user\";\nimport { CloudFileService } from \"../cloud-file-service.service\";\nimport { AppConfig } from \"../../app-config/app-config\";\nimport { EntityMapperService } from \"../../entity/entity-mapper.service\";\nimport { AlertService } from \"../../alerts/alert.service\";\nimport { FormBuilder, FormGroup, Validators } from \"@angular/forms\";\n\n/**\n * User Profile form to allow the user to set up credentials for a webdav server to be used by the CloudFileService.\n */\n@Component({\n  selector: \"app-cloud-file-service-user-settings\",\n  templateUrl: \"./cloud-file-service-user-settings.component.html\",\n  styleUrls: [\"./cloud-file-service-user-settings.component.scss\"],\n})\nexport class CloudFileServiceUserSettingsComponent implements OnInit {\n  /** The user for who this form edits data */\n  @Input() user: User;\n\n  /** Webdav server URL */\n  webdavUrl: string;\n\n  /** whether checking and saving the webdav credentials is currently in progress */\n  processing: boolean;\n\n  form: FormGroup;\n\n  constructor(\n    private fb: FormBuilder,\n    private entityMapperService: EntityMapperService,\n    private cloudFileService: CloudFileService,\n    private alertService: AlertService\n  ) {}\n\n  ngOnInit() {\n    this.webdavUrl = AppConfig.settings.webdav.remote_url;\n\n    this.form = this.fb.group({\n      cloudUser: [this.user.cloudUserName, Validators.required],\n      cloudPassword: [\"\", Validators.required],\n      userPassword: [\"\", Validators.required],\n    });\n  }\n\n  /**\n   * Sets the username and password for the cloud-service, provided the login password is correct\n   * and saves the user entity.\n   */\n  async updateCloudServiceSettings() {\n    const password = this.form.controls.userPassword.value;\n    if (!this.user.checkPassword(password)) {\n      this.form.controls.userPassword.setErrors({ incorrectPassword: true });\n      return;\n    }\n\n    this.processing = true;\n\n    this.user.cloudUserName = this.form.controls.cloudUser.value;\n    this.user.setCloudPassword(\n      this.form.controls.cloudPassword.value,\n      password\n    );\n\n    try {\n      await this.cloudFileService.connect();\n      const isConnected = await this.cloudFileService.checkConnection();\n      if (!isConnected) {\n        // noinspection ExceptionCaughtLocallyJS\n        throw new Error(\"Connection check failed.\");\n      }\n    } catch (error) {\n      this.form.controls.cloudPassword.setErrors({ connectionFailed: true });\n      console.warn(error);\n      this.processing = false;\n      return;\n    }\n\n    await this.entityMapperService.save<User>(this.user);\n    this.alertService.addInfo(\"Successfully saved cloud service credentials.\");\n    this.processing = false;\n  }\n}\n","import { Injectable } from \"@angular/core\";\nimport { AppConfig } from \"../app-config/app-config\";\nimport webdav from \"webdav\";\nimport { DomSanitizer, SafeUrl } from \"@angular/platform-browser\";\nimport { SessionService } from \"../session/session-service/session.service\";\n\n/**\n * Connect and access a remote cloud file system like Nextcloud\n * to upload and download files.\n *\n * Connection requires setup of the server in the AppConfig\n * as well as valid user credentials for that server in the currently logged in user entity.\n */\n@Injectable()\nexport class CloudFileService {\n  // TODO Check connection/login success?\n  private client: any;\n  private basePath: string;\n  private fileList: string;\n  private currentlyGettingList: Promise<boolean>;\n\n  /**\n   * Construct the service and immediately attempt to connect to the server with the current user.\n   * @param domSanitizer\n   * @param sessionService\n   */\n  constructor(\n    private domSanitizer: DomSanitizer,\n    private sessionService: SessionService\n  ) {\n    this.connect();\n  }\n\n  /**\n   * (Re)-initialize the client connecting to the webdav server.\n   * @param username Optional webdav username, otherwise the one set in the current user entity is used.\n   * @param password Optional webdav password, otherwise the one set in the current user entity is used.\n   */\n  public async connect(username: string = null, password: string = null) {\n    if (!AppConfig.settings.webdav || !this.sessionService.getCurrentUser()) {\n      return;\n    }\n\n    this.reset();\n\n    const currentUser = this.sessionService.getCurrentUser();\n    this.basePath = currentUser.cloudBaseFolder;\n\n    if (username === null && password == null) {\n      username = currentUser.cloudUserName;\n      password = currentUser.cloudPasswordDec;\n    }\n\n    if (!username || !password) {\n      // abort if account is not configured\n      this.client = null;\n      return;\n    }\n\n    this.client = await webdav.createClient(\n      AppConfig.settings.webdav.remote_url,\n      {\n        username: username,\n        password: password,\n      }\n    );\n  }\n\n  /**\n   * Reset the current state and requests.\n   * e.g. clear promise that retrieves the root dir\n   */\n  private reset() {\n    this.currentlyGettingList = null;\n    this.fileList = null;\n  }\n\n  /**\n   * checkConnection\n   *\n   * tries to upload and redownload a file.\n   */\n  public async checkConnection(): Promise<boolean> {\n    // delete 'tmp.txt' if it exists\n    const fileName: string = this.basePath + \"/test.txt\";\n    if (await this.doesFileExist(fileName)) {\n      await this.client.deleteFile(fileName);\n    }\n\n    await this.client.putFileContents(fileName, \"TestString\");\n    const buffer = await this.client.getFileContents(fileName);\n    const tmpContent = String.fromCharCode.apply(null, new Uint8Array(buffer));\n    await this.client.deleteFile(fileName);\n\n    if (tmpContent === \"TestString\") {\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Returns the content path.\n   * @param path File path relative to the base path, without leading slash; example 'folder1'\n   */\n  public async getDir(path: string): Promise<string> {\n    const contents = await this.client.getDirectoryContents(\n      this.basePath + path\n    );\n    return JSON.stringify(contents, undefined, 4);\n  }\n\n  /**\n   * Checks if the file exists in the root directory.\n   * @param name file name to check\n   */\n  public async doesFileExist(name: string): Promise<boolean> {\n    // TODO: doesFileExist seems to have problems at least with nested files?\n\n    if (!this.fileList && !this.currentlyGettingList) {\n      // create promise that resolves when the file list is loaded\n      // if this function gets called mulitple times this ensures that the list will only be loaded once\n      this.currentlyGettingList = new Promise((resolve) => {\n        this.getDir(\"\").then((list) => {\n          this.fileList = list;\n          resolve(true);\n        });\n      });\n    }\n    if (!this.fileList) {\n      await this.currentlyGettingList;\n    }\n    // hacky way of checking if file exists, subject to change\n    // TODO fix this\n    if (this.fileList.includes('\"basename\": \"' + name.split(\"/\").pop() + '\"')) {\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * creates new directory\n   * @param path path to directory to be created, without leading slash; e.g. 'new-folder'\n   */\n  public async createDir(path: string) {\n    this.client.createDirectory(this.basePath + path);\n  }\n\n  /**\n   * Uploads a given file to the nextcloud server.\n   * @param file The file to be stored\n   * @param filePath the filename and path to which the file will be uploaded, no leading slash\n   */\n  public async uploadFile(file: any, filePath: string): Promise<void> {\n    return this.client.putFileContents(\n      this.basePath + filePath,\n      file\n      // { onUploadProgress: progress => {  console.log(`Uploaded ${progress.loaded} / ${progress.total} bytes`); } },\n    );\n  }\n\n  /**\n   * Returns a Promise which resolves as an ArrayBuffer of the file located at the given path\n   * @param filePath the filename and path relative to the base path without leading slash; e.g. 'photos/105.png'\n   */\n  public async getFile(filePath: string): Promise<SafeUrl> {\n    let file;\n    try {\n      file = await this.client.getFileContents(this.basePath + filePath);\n      return this.bufferArrayToBase64(file);\n    } catch (err) {\n      return Promise.reject(\"Could not load file.\");\n    }\n  }\n\n  /**\n   * converts an ArrayBuffer to a SafeUrl and returns it\n   * @param arrayBuffer ArrayBuffer to be converted\n   */\n  private bufferArrayToBase64(arrayBuffer: ArrayBuffer): SafeUrl {\n    const base64String = btoa(\n      new Uint8Array(arrayBuffer).reduce((data, byte) => {\n        return data + String.fromCharCode(byte);\n      }, \"\")\n    );\n    return this.domSanitizer.bypassSecurityTrustUrl(\n      \"data:image/jpg;base64,\" + base64String\n    );\n  }\n\n  /**\n   * Check whether the client is connected and therefore this service is able to execute its remote actions.\n   */\n  public isConnected() {\n    return !!this.client;\n  }\n}\n","import { NgModule } from \"@angular/core\";\nimport { CommonModule } from \"@angular/common\";\nimport { CloudFileService } from \"./cloud-file-service.service\";\nimport { CloudFileServiceUserSettingsComponent } from \"./cloud-file-service-user-settings/cloud-file-service-user-settings.component\";\nimport { MatFormFieldModule } from \"@angular/material/form-field\";\nimport { MatInputModule } from \"@angular/material/input\";\nimport { MatButtonModule } from \"@angular/material/button\";\nimport { FormsModule, ReactiveFormsModule } from \"@angular/forms\";\nimport { MatProgressSpinnerModule } from \"@angular/material/progress-spinner\";\n\n/**\n * Provides cloud file storage integration with platforms like Nextcloud.\n * Configuration is described in the main README.\n */\n@NgModule({\n  declarations: [CloudFileServiceUserSettingsComponent],\n  imports: [\n    CommonModule,\n    MatFormFieldModule,\n    MatInputModule,\n    MatButtonModule,\n    FormsModule,\n    MatProgressSpinnerModule,\n    ReactiveFormsModule,\n  ],\n  providers: [CloudFileService],\n  exports: [CloudFileServiceUserSettingsComponent],\n})\nexport class WebdavModule {}\n","/**\n * Checks if the given value is an instance of Date and holds a valid date value.\n * @param date The date to be checked\n */\nexport function isValidDate(date: any): boolean {\n  return (\n    date &&\n    Object.prototype.toString.call(date) === \"[object Date]\" &&\n    !Number.isNaN(date.getTime())\n  );\n}\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * Central environment that allows to configure differences between a \"dev\" and a \"prod\" build.\n *\n * The file contents for the current environment will overwrite these during build.\n * The build system defaults to the dev environment which uses `environment.ts`, but if you do\n * `ng build --env=prod` then `environment.prod.ts` will be used instead.\n * The list of which env maps to which file can be found in `.angular-cli.json`.\n */\nexport const environment = {\n  production: false,\n  appVersion: \"2.19.1\", // replaced automatically by semantic-release\n  repositoryId: \"Aam-Digital/ndb-core\",\n  remoteLoggingDsn: undefined, // only set for production mode in environment.prod.ts\n};\n","/*\n *     This file is part of ndb-core.\n *\n *     ndb-core is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     ndb-core is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { enableProdMode } from \"@angular/core\";\nimport { platformBrowserDynamic } from \"@angular/platform-browser-dynamic\";\n\nimport { AppModule } from \"./app/app.module\";\nimport { environment } from \"./environments/environment\";\n\nif (environment.production) {\n  enableProdMode();\n}\n\nplatformBrowserDynamic().bootstrapModule(AppModule);\n","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */"]}